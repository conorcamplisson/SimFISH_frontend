<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>chromoMap</title>
<script src="data:application/x-javascript,%28function%28%29%20%7B%0A%20%20%2F%2F%20If%20window%2EHTMLWidgets%20is%20already%20defined%2C%20then%20use%20it%3B%20otherwise%20create%20a%0A%20%20%2F%2F%20new%20object%2E%20This%20allows%20preceding%20code%20to%20set%20options%20that%20affect%20the%0A%20%20%2F%2F%20initialization%20process%20%28though%20none%20currently%20exist%29%2E%0A%20%20window%2EHTMLWidgets%20%3D%20window%2EHTMLWidgets%20%7C%7C%20%7B%7D%3B%0A%0A%20%20%2F%2F%20See%20if%20we%27re%20running%20in%20a%20viewer%20pane%2E%20If%20not%2C%20we%27re%20in%20a%20web%20browser%2E%0A%20%20var%20viewerMode%20%3D%20window%2EHTMLWidgets%2EviewerMode%20%3D%0A%20%20%20%20%20%20%2F%5Cbviewer%5Fpane%3D1%5Cb%2F%2Etest%28window%2Elocation%29%3B%0A%0A%20%20%2F%2F%20See%20if%20we%27re%20running%20in%20Shiny%20mode%2E%20If%20not%2C%20it%27s%20a%20static%20document%2E%0A%20%20%2F%2F%20Note%20that%20static%20widgets%20can%20appear%20in%20both%20Shiny%20and%20static%20modes%2C%20but%0A%20%20%2F%2F%20obviously%2C%20Shiny%20widgets%20can%20only%20appear%20in%20Shiny%20apps%2Fdocuments%2E%0A%20%20var%20shinyMode%20%3D%20window%2EHTMLWidgets%2EshinyMode%20%3D%0A%20%20%20%20%20%20typeof%28window%2EShiny%29%20%21%3D%3D%20%22undefined%22%20%26%26%20%21%21window%2EShiny%2EoutputBindings%3B%0A%0A%20%20%2F%2F%20We%20can%27t%20count%20on%20jQuery%20being%20available%2C%20so%20we%20implement%20our%20own%0A%20%20%2F%2F%20version%20if%20necessary%2E%0A%20%20function%20querySelectorAll%28scope%2C%20selector%29%20%7B%0A%20%20%20%20if%20%28typeof%28jQuery%29%20%21%3D%3D%20%22undefined%22%20%26%26%20scope%20instanceof%20jQuery%29%20%7B%0A%20%20%20%20%20%20return%20scope%2Efind%28selector%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28scope%2EquerySelectorAll%29%20%7B%0A%20%20%20%20%20%20return%20scope%2EquerySelectorAll%28selector%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20asArray%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20null%29%0A%20%20%20%20%20%20return%20%5B%5D%3B%0A%20%20%20%20if%20%28%24%2EisArray%28value%29%29%0A%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20return%20%5Bvalue%5D%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Implement%20jQuery%27s%20extend%0A%20%20function%20extend%28target%20%2F%2A%2C%20%2E%2E%2E%20%2A%2F%29%20%7B%0A%20%20%20%20if%20%28arguments%2Elength%20%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20return%20target%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28var%20i%20%3D%201%3B%20i%20%3C%20arguments%2Elength%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20var%20source%20%3D%20arguments%5Bi%5D%3B%0A%20%20%20%20%20%20for%20%28var%20prop%20in%20source%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28source%2EhasOwnProperty%28prop%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20target%5Bprop%5D%20%3D%20source%5Bprop%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20IE8%20doesn%27t%20support%20Array%2EforEach%2E%0A%20%20function%20forEach%28values%2C%20callback%2C%20thisArg%29%20%7B%0A%20%20%20%20if%20%28values%2EforEach%29%20%7B%0A%20%20%20%20%20%20values%2EforEach%28callback%2C%20thisArg%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20values%2Elength%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20callback%2Ecall%28thisArg%2C%20values%5Bi%5D%2C%20i%2C%20values%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20Replaces%20the%20specified%20method%20with%20the%20return%20value%20of%20funcSource%2E%0A%20%20%2F%2F%0A%20%20%2F%2F%20Note%20that%20funcSource%20should%20not%20BE%20the%20new%20method%2C%20it%20should%20be%20a%20function%0A%20%20%2F%2F%20that%20RETURNS%20the%20new%20method%2E%20funcSource%20receives%20a%20single%20argument%20that%20is%0A%20%20%2F%2F%20the%20overridden%20method%2C%20it%20can%20be%20called%20from%20the%20new%20method%2E%20The%20overridden%0A%20%20%2F%2F%20method%20can%20be%20called%20like%20a%20regular%20function%2C%20it%20has%20the%20target%20permanently%0A%20%20%2F%2F%20bound%20to%20it%20so%20%22this%22%20will%20work%20correctly%2E%0A%20%20function%20overrideMethod%28target%2C%20methodName%2C%20funcSource%29%20%7B%0A%20%20%20%20var%20superFunc%20%3D%20target%5BmethodName%5D%20%7C%7C%20function%28%29%20%7B%7D%3B%0A%20%20%20%20var%20superFuncBound%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20superFunc%2Eapply%28target%2C%20arguments%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20target%5BmethodName%5D%20%3D%20funcSource%28superFuncBound%29%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Add%20a%20method%20to%20delegator%20that%2C%20when%20invoked%2C%20calls%0A%20%20%2F%2F%20delegatee%2EmethodName%2E%20If%20there%20is%20no%20such%20method%20on%0A%20%20%2F%2F%20the%20delegatee%2C%20but%20there%20was%20one%20on%20delegator%20before%0A%20%20%2F%2F%20delegateMethod%20was%20called%2C%20then%20the%20original%20version%0A%20%20%2F%2F%20is%20invoked%20instead%2E%0A%20%20%2F%2F%20For%20example%3A%0A%20%20%2F%2F%0A%20%20%2F%2F%20var%20a%20%3D%20%7B%0A%20%20%2F%2F%20%20%20method1%3A%20function%28%29%20%7B%20console%2Elog%28%27a1%27%29%3B%20%7D%0A%20%20%2F%2F%20%20%20method2%3A%20function%28%29%20%7B%20console%2Elog%28%27a2%27%29%3B%20%7D%0A%20%20%2F%2F%20%7D%3B%0A%20%20%2F%2F%20var%20b%20%3D%20%7B%0A%20%20%2F%2F%20%20%20method1%3A%20function%28%29%20%7B%20console%2Elog%28%27b1%27%29%3B%20%7D%0A%20%20%2F%2F%20%7D%3B%0A%20%20%2F%2F%20delegateMethod%28a%2C%20b%2C%20%22method1%22%29%3B%0A%20%20%2F%2F%20delegateMethod%28a%2C%20b%2C%20%22method2%22%29%3B%0A%20%20%2F%2F%20a%2Emethod1%28%29%3B%0A%20%20%2F%2F%20a%2Emethod2%28%29%3B%0A%20%20%2F%2F%0A%20%20%2F%2F%20The%20output%20would%20be%20%22b1%22%2C%20%22a2%22%2E%0A%20%20function%20delegateMethod%28delegator%2C%20delegatee%2C%20methodName%29%20%7B%0A%20%20%20%20var%20inherited%20%3D%20delegator%5BmethodName%5D%3B%0A%20%20%20%20delegator%5BmethodName%5D%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20target%20%3D%20delegatee%3B%0A%20%20%20%20%20%20var%20method%20%3D%20delegatee%5BmethodName%5D%3B%0A%0A%20%20%20%20%20%20%2F%2F%20The%20method%20doesn%27t%20exist%20on%20the%20delegatee%2E%20Instead%2C%0A%20%20%20%20%20%20%2F%2F%20call%20the%20method%20on%20the%20delegator%2C%20if%20it%20exists%2E%0A%20%20%20%20%20%20if%20%28%21method%29%20%7B%0A%20%20%20%20%20%20%20%20target%20%3D%20delegator%3B%0A%20%20%20%20%20%20%20%20method%20%3D%20inherited%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20if%20%28method%29%20%7B%0A%20%20%20%20%20%20%20%20return%20method%2Eapply%28target%2C%20arguments%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Implement%20a%20vague%20facsimilie%20of%20jQuery%27s%20data%20method%0A%20%20function%20elementData%28el%2C%20name%2C%20value%29%20%7B%0A%20%20%20%20if%20%28arguments%2Elength%20%3D%3D%202%29%20%7B%0A%20%20%20%20%20%20return%20el%5B%22htmlwidget%5Fdata%5F%22%20%2B%20name%5D%3B%0A%20%20%20%20%7D%20else%20if%20%28arguments%2Elength%20%3D%3D%203%29%20%7B%0A%20%20%20%20%20%20el%5B%22htmlwidget%5Fdata%5F%22%20%2B%20name%5D%20%3D%20value%3B%0A%20%20%20%20%20%20return%20el%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22Wrong%20number%20of%20arguments%20for%20elementData%3A%20%22%20%2B%0A%20%20%20%20%20%20%20%20arguments%2Elength%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20http%3A%2F%2Fstackoverflow%2Ecom%2Fquestions%2F3446170%2Fescape%2Dstring%2Dfor%2Duse%2Din%2Djavascript%2Dregex%0A%20%20function%20escapeRegExp%28str%29%20%7B%0A%20%20%20%20return%20str%2Ereplace%28%2F%5B%5C%2D%5C%5B%5C%5D%5C%2F%5C%7B%5C%7D%5C%28%5C%29%5C%2A%5C%2B%5C%3F%5C%2E%5C%5C%5C%5E%5C%24%5C%7C%5D%2Fg%2C%20%22%5C%5C%24%26%22%29%3B%0A%20%20%7D%0A%0A%20%20function%20hasClass%28el%2C%20className%29%20%7B%0A%20%20%20%20var%20re%20%3D%20new%20RegExp%28%22%5C%5Cb%22%20%2B%20escapeRegExp%28className%29%20%2B%20%22%5C%5Cb%22%29%3B%0A%20%20%20%20return%20re%2Etest%28el%2EclassName%29%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20elements%20%2D%20array%20%28or%20array%2Dlike%20object%29%20of%20HTML%20elements%0A%20%20%2F%2F%20className%20%2D%20class%20name%20to%20test%20for%0A%20%20%2F%2F%20include%20%2D%20if%20true%2C%20only%20return%20elements%20with%20given%20className%3B%0A%20%20%2F%2F%20%20%20if%20false%2C%20only%20return%20elements%20%2Awithout%2A%20given%20className%0A%20%20function%20filterByClass%28elements%2C%20className%2C%20include%29%20%7B%0A%20%20%20%20var%20results%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20elements%2Elength%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28hasClass%28elements%5Bi%5D%2C%20className%29%20%3D%3D%20include%29%0A%20%20%20%20%20%20%20%20results%2Epush%28elements%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20results%3B%0A%20%20%7D%0A%0A%20%20function%20on%28obj%2C%20eventName%2C%20func%29%20%7B%0A%20%20%20%20if%20%28obj%2EaddEventListener%29%20%7B%0A%20%20%20%20%20%20obj%2EaddEventListener%28eventName%2C%20func%2C%20false%29%3B%0A%20%20%20%20%7D%20else%20if%20%28obj%2EattachEvent%29%20%7B%0A%20%20%20%20%20%20obj%2EattachEvent%28eventName%2C%20func%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20off%28obj%2C%20eventName%2C%20func%29%20%7B%0A%20%20%20%20if%20%28obj%2EremoveEventListener%29%0A%20%20%20%20%20%20obj%2EremoveEventListener%28eventName%2C%20func%2C%20false%29%3B%0A%20%20%20%20else%20if%20%28obj%2EdetachEvent%29%20%7B%0A%20%20%20%20%20%20obj%2EdetachEvent%28eventName%2C%20func%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20Translate%20array%20of%20values%20to%20top%2Fright%2Fbottom%2Fleft%2C%20as%20usual%20with%0A%20%20%2F%2F%20the%20%22padding%22%20CSS%20property%0A%20%20%2F%2F%20https%3A%2F%2Fdeveloper%2Emozilla%2Eorg%2Fen%2DUS%2Fdocs%2FWeb%2FCSS%2Fpadding%0A%20%20function%20unpackPadding%28value%29%20%7B%0A%20%20%20%20if%20%28typeof%28value%29%20%3D%3D%3D%20%22number%22%29%0A%20%20%20%20%20%20value%20%3D%20%5Bvalue%5D%3B%0A%20%20%20%20if%20%28value%2Elength%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20return%20%7Btop%3A%20value%5B0%5D%2C%20right%3A%20value%5B0%5D%2C%20bottom%3A%20value%5B0%5D%2C%20left%3A%20value%5B0%5D%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28value%2Elength%20%3D%3D%3D%202%29%20%7B%0A%20%20%20%20%20%20return%20%7Btop%3A%20value%5B0%5D%2C%20right%3A%20value%5B1%5D%2C%20bottom%3A%20value%5B0%5D%2C%20left%3A%20value%5B1%5D%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28value%2Elength%20%3D%3D%3D%203%29%20%7B%0A%20%20%20%20%20%20return%20%7Btop%3A%20value%5B0%5D%2C%20right%3A%20value%5B1%5D%2C%20bottom%3A%20value%5B2%5D%2C%20left%3A%20value%5B1%5D%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28value%2Elength%20%3D%3D%3D%204%29%20%7B%0A%20%20%20%20%20%20return%20%7Btop%3A%20value%5B0%5D%2C%20right%3A%20value%5B1%5D%2C%20bottom%3A%20value%5B2%5D%2C%20left%3A%20value%5B3%5D%7D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20Convert%20an%20unpacked%20padding%20object%20to%20a%20CSS%20value%0A%20%20function%20paddingToCss%28paddingObj%29%20%7B%0A%20%20%20%20return%20paddingObj%2Etop%20%2B%20%22px%20%22%20%2B%20paddingObj%2Eright%20%2B%20%22px%20%22%20%2B%20paddingObj%2Ebottom%20%2B%20%22px%20%22%20%2B%20paddingObj%2Eleft%20%2B%20%22px%22%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Makes%20a%20number%20suitable%20for%20CSS%0A%20%20function%20px%28x%29%20%7B%0A%20%20%20%20if%20%28typeof%28x%29%20%3D%3D%3D%20%22number%22%29%0A%20%20%20%20%20%20return%20x%20%2B%20%22px%22%3B%0A%20%20%20%20else%0A%20%20%20%20%20%20return%20x%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Retrieves%20runtime%20widget%20sizing%20information%20for%20an%20element%2E%0A%20%20%2F%2F%20The%20return%20value%20is%20either%20null%2C%20or%20an%20object%20with%20fill%2C%20padding%2C%0A%20%20%2F%2F%20defaultWidth%2C%20defaultHeight%20fields%2E%0A%20%20function%20sizingPolicy%28el%29%20%7B%0A%20%20%20%20var%20sizingEl%20%3D%20document%2EquerySelector%28%22script%5Bdata%2Dfor%3D%27%22%20%2B%20el%2Eid%20%2B%20%22%27%5D%5Btype%3D%27application%2Fhtmlwidget%2Dsizing%27%5D%22%29%3B%0A%20%20%20%20if%20%28%21sizingEl%29%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20var%20sp%20%3D%20JSON%2Eparse%28sizingEl%2EtextContent%20%7C%7C%20sizingEl%2Etext%20%7C%7C%20%22%7B%7D%22%29%3B%0A%20%20%20%20if%20%28viewerMode%29%20%7B%0A%20%20%20%20%20%20return%20sp%2Eviewer%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20sp%2Ebrowser%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20%40param%20tasks%20Array%20of%20strings%20%28or%20falsy%20value%2C%20in%20which%20case%20no%2Dop%29%2E%0A%20%20%2F%2F%20%20%20Each%20element%20must%20be%20a%20valid%20JavaScript%20expression%20that%20yields%20a%0A%20%20%2F%2F%20%20%20function%2E%20Or%2C%20can%20be%20an%20array%20of%20objects%20with%20%22code%22%20and%20%22data%22%0A%20%20%2F%2F%20%20%20properties%3B%20in%20this%20case%2C%20the%20%22code%22%20property%20should%20be%20a%20string%0A%20%20%2F%2F%20%20%20of%20JS%20that%27s%20an%20expr%20that%20yields%20a%20function%2C%20and%20%22data%22%20should%20be%0A%20%20%2F%2F%20%20%20an%20object%20that%20will%20be%20added%20as%20an%20additional%20argument%20when%20that%0A%20%20%2F%2F%20%20%20function%20is%20called%2E%0A%20%20%2F%2F%20%40param%20target%20The%20object%20that%20will%20be%20%22this%22%20for%20each%20function%0A%20%20%2F%2F%20%20%20execution%2E%0A%20%20%2F%2F%20%40param%20args%20Array%20of%20arguments%20to%20be%20passed%20to%20the%20functions%2E%20%28The%0A%20%20%2F%2F%20%20%20same%20arguments%20will%20be%20passed%20to%20all%20functions%2E%29%0A%20%20function%20evalAndRun%28tasks%2C%20target%2C%20args%29%20%7B%0A%20%20%20%20if%20%28tasks%29%20%7B%0A%20%20%20%20%20%20forEach%28tasks%2C%20function%28task%29%20%7B%0A%20%20%20%20%20%20%20%20var%20theseArgs%20%3D%20args%3B%0A%20%20%20%20%20%20%20%20if%20%28typeof%28task%29%20%3D%3D%3D%20%22object%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20theseArgs%20%3D%20theseArgs%2Econcat%28%5Btask%2Edata%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20task%20%3D%20task%2Ecode%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20taskFunc%20%3D%20tryEval%28task%29%3B%0A%20%20%20%20%20%20%20%20if%20%28typeof%28taskFunc%29%20%21%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22Task%20must%20be%20a%20function%21%20Source%3A%5Cn%22%20%2B%20task%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20taskFunc%2Eapply%28target%2C%20theseArgs%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20Attempt%20eval%28%29%20both%20with%20and%20without%20enclosing%20in%20parentheses%2E%0A%20%20%2F%2F%20Note%20that%20enclosing%20coerces%20a%20function%20declaration%20into%0A%20%20%2F%2F%20an%20expression%20that%20eval%28%29%20can%20parse%0A%20%20%2F%2F%20%28otherwise%2C%20a%20SyntaxError%20is%20thrown%29%0A%20%20function%20tryEval%28code%29%20%7B%0A%20%20%20%20var%20result%20%3D%20null%3B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20result%20%3D%20eval%28%22%28%22%20%2B%20code%20%2B%20%22%29%22%29%3B%0A%20%20%20%20%7D%20catch%28error%29%20%7B%0A%20%20%20%20%20%20if%20%28%21%28error%20instanceof%20SyntaxError%29%29%20%7B%0A%20%20%20%20%20%20%20%20throw%20error%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20result%20%3D%20eval%28code%29%3B%0A%20%20%20%20%20%20%7D%20catch%28e%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28e%20instanceof%20SyntaxError%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20error%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20e%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%0A%20%20function%20initSizing%28el%29%20%7B%0A%20%20%20%20var%20sizing%20%3D%20sizingPolicy%28el%29%3B%0A%20%20%20%20if%20%28%21sizing%29%0A%20%20%20%20%20%20return%3B%0A%0A%20%20%20%20var%20cel%20%3D%20document%2EgetElementById%28%22htmlwidget%5Fcontainer%22%29%3B%0A%20%20%20%20if%20%28%21cel%29%0A%20%20%20%20%20%20return%3B%0A%0A%20%20%20%20if%20%28typeof%28sizing%2Epadding%29%20%21%3D%3D%20%22undefined%22%29%20%7B%0A%20%20%20%20%20%20document%2Ebody%2Estyle%2Emargin%20%3D%20%220%22%3B%0A%20%20%20%20%20%20document%2Ebody%2Estyle%2Epadding%20%3D%20paddingToCss%28unpackPadding%28sizing%2Epadding%29%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28sizing%2Efill%29%20%7B%0A%20%20%20%20%20%20document%2Ebody%2Estyle%2Eoverflow%20%3D%20%22hidden%22%3B%0A%20%20%20%20%20%20document%2Ebody%2Estyle%2Ewidth%20%3D%20%22100%25%22%3B%0A%20%20%20%20%20%20document%2Ebody%2Estyle%2Eheight%20%3D%20%22100%25%22%3B%0A%20%20%20%20%20%20document%2EdocumentElement%2Estyle%2Ewidth%20%3D%20%22100%25%22%3B%0A%20%20%20%20%20%20document%2EdocumentElement%2Estyle%2Eheight%20%3D%20%22100%25%22%3B%0A%20%20%20%20%20%20cel%2Estyle%2Eposition%20%3D%20%22absolute%22%3B%0A%20%20%20%20%20%20var%20pad%20%3D%20unpackPadding%28sizing%2Epadding%29%3B%0A%20%20%20%20%20%20cel%2Estyle%2Etop%20%3D%20pad%2Etop%20%2B%20%22px%22%3B%0A%20%20%20%20%20%20cel%2Estyle%2Eright%20%3D%20pad%2Eright%20%2B%20%22px%22%3B%0A%20%20%20%20%20%20cel%2Estyle%2Ebottom%20%3D%20pad%2Ebottom%20%2B%20%22px%22%3B%0A%20%20%20%20%20%20cel%2Estyle%2Eleft%20%3D%20pad%2Eleft%20%2B%20%22px%22%3B%0A%20%20%20%20%20%20el%2Estyle%2Ewidth%20%3D%20%22100%25%22%3B%0A%20%20%20%20%20%20el%2Estyle%2Eheight%20%3D%20%22100%25%22%3B%0A%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20getWidth%3A%20function%28%29%20%7B%20return%20cel%2EgetBoundingClientRect%28%29%2Ewidth%3B%20%7D%2C%0A%20%20%20%20%20%20%20%20getHeight%3A%20function%28%29%20%7B%20return%20cel%2EgetBoundingClientRect%28%29%2Eheight%3B%20%7D%0A%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20el%2Estyle%2Ewidth%20%3D%20px%28sizing%2Ewidth%29%3B%0A%20%20%20%20%20%20el%2Estyle%2Eheight%20%3D%20px%28sizing%2Eheight%29%3B%0A%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20getWidth%3A%20function%28%29%20%7B%20return%20cel%2EgetBoundingClientRect%28%29%2Ewidth%3B%20%7D%2C%0A%20%20%20%20%20%20%20%20getHeight%3A%20function%28%29%20%7B%20return%20cel%2EgetBoundingClientRect%28%29%2Eheight%3B%20%7D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20Default%20implementations%20for%20methods%0A%20%20var%20defaults%20%3D%20%7B%0A%20%20%20%20find%3A%20function%28scope%29%20%7B%0A%20%20%20%20%20%20return%20querySelectorAll%28scope%2C%20%22%2E%22%20%2B%20this%2Ename%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20renderError%3A%20function%28el%2C%20err%29%20%7B%0A%20%20%20%20%20%20var%20%24el%20%3D%20%24%28el%29%3B%0A%0A%20%20%20%20%20%20this%2EclearError%28el%29%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Add%20all%20these%20error%20classes%2C%20as%20Shiny%20does%0A%20%20%20%20%20%20var%20errClass%20%3D%20%22shiny%2Doutput%2Derror%22%3B%0A%20%20%20%20%20%20if%20%28err%2Etype%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20use%20the%20classes%20of%20the%20error%20condition%20as%20CSS%20class%20names%0A%20%20%20%20%20%20%20%20errClass%20%3D%20errClass%20%2B%20%22%20%22%20%2B%20%24%2Emap%28asArray%28err%2Etype%29%2C%20function%28type%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20errClass%20%2B%20%22%2D%22%20%2B%20type%3B%0A%20%20%20%20%20%20%20%20%7D%29%2Ejoin%28%22%20%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20errClass%20%3D%20errClass%20%2B%20%22%20htmlwidgets%2Derror%22%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Is%20el%20inline%20or%20block%3F%20If%20inline%20or%20inline%2Dblock%2C%20just%20display%3Anone%20it%0A%20%20%20%20%20%20%2F%2F%20and%20add%20an%20inline%20error%2E%0A%20%20%20%20%20%20var%20display%20%3D%20%24el%2Ecss%28%22display%22%29%3B%0A%20%20%20%20%20%20%24el%2Edata%28%22restore%2Ddisplay%2Dmode%22%2C%20display%29%3B%0A%0A%20%20%20%20%20%20if%20%28display%20%3D%3D%3D%20%22inline%22%20%7C%7C%20display%20%3D%3D%3D%20%22inline%2Dblock%22%29%20%7B%0A%20%20%20%20%20%20%20%20%24el%2Ehide%28%29%3B%0A%20%20%20%20%20%20%20%20if%20%28err%2Emessage%20%21%3D%3D%20%22%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20errorSpan%20%3D%20%24%28%22%3Cspan%3E%22%29%2EaddClass%28errClass%29%3B%0A%20%20%20%20%20%20%20%20%20%20errorSpan%2Etext%28err%2Emessage%29%3B%0A%20%20%20%20%20%20%20%20%20%20%24el%2Eafter%28errorSpan%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28display%20%3D%3D%3D%20%22block%22%29%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20If%20block%2C%20add%20an%20error%20just%20after%20the%20el%2C%20set%20visibility%3Anone%20on%20the%0A%20%20%20%20%20%20%20%20%2F%2F%20el%2C%20and%20position%20the%20error%20to%20be%20on%20top%20of%20the%20el%2E%0A%20%20%20%20%20%20%20%20%2F%2F%20Mark%20it%20with%20a%20unique%20ID%20and%20CSS%20class%20so%20we%20can%20remove%20it%20later%2E%0A%20%20%20%20%20%20%20%20%24el%2Ecss%28%22visibility%22%2C%20%22hidden%22%29%3B%0A%20%20%20%20%20%20%20%20if%20%28err%2Emessage%20%21%3D%3D%20%22%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20errorDiv%20%3D%20%24%28%22%3Cdiv%3E%22%29%2EaddClass%28errClass%29%2Ecss%28%22position%22%2C%20%22absolute%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Ecss%28%22top%22%2C%20el%2EoffsetTop%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Ecss%28%22left%22%2C%20el%2EoffsetLeft%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20setting%20width%20can%20push%20out%20the%20page%20size%2C%20forcing%20otherwise%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20unnecessary%20scrollbars%20to%20appear%20and%20making%20it%20impossible%20for%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20the%20element%20to%20shrink%3B%20so%20use%20max%2Dwidth%20instead%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Ecss%28%22maxWidth%22%2C%20el%2EoffsetWidth%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Ecss%28%22height%22%2C%20el%2EoffsetHeight%29%3B%0A%20%20%20%20%20%20%20%20%20%20errorDiv%2Etext%28err%2Emessage%29%3B%0A%20%20%20%20%20%20%20%20%20%20%24el%2Eafter%28errorDiv%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20Really%20dumb%20way%20to%20keep%20the%20size%2Fposition%20of%20the%20error%20in%20sync%20with%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20the%20parent%20element%20as%20the%20window%20is%20resized%20or%20whatever%2E%0A%20%20%20%20%20%20%20%20%20%20var%20intId%20%3D%20setInterval%28function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21errorDiv%5B0%5D%2EparentElement%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20clearInterval%28intId%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20errorDiv%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Ecss%28%22top%22%2C%20el%2EoffsetTop%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Ecss%28%22left%22%2C%20el%2EoffsetLeft%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Ecss%28%22maxWidth%22%2C%20el%2EoffsetWidth%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Ecss%28%22height%22%2C%20el%2EoffsetHeight%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%2C%20500%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20clearError%3A%20function%28el%29%20%7B%0A%20%20%20%20%20%20var%20%24el%20%3D%20%24%28el%29%3B%0A%20%20%20%20%20%20var%20display%20%3D%20%24el%2Edata%28%22restore%2Ddisplay%2Dmode%22%29%3B%0A%20%20%20%20%20%20%24el%2Edata%28%22restore%2Ddisplay%2Dmode%22%2C%20null%29%3B%0A%0A%20%20%20%20%20%20if%20%28display%20%3D%3D%3D%20%22inline%22%20%7C%7C%20display%20%3D%3D%3D%20%22inline%2Dblock%22%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28display%29%0A%20%20%20%20%20%20%20%20%20%20%24el%2Ecss%28%22display%22%2C%20display%29%3B%0A%20%20%20%20%20%20%20%20%24%28el%2EnextSibling%29%2Efilter%28%22%2Ehtmlwidgets%2Derror%22%29%2Eremove%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28display%20%3D%3D%3D%20%22block%22%29%7B%0A%20%20%20%20%20%20%20%20%24el%2Ecss%28%22visibility%22%2C%20%22inherit%22%29%3B%0A%20%20%20%20%20%20%20%20%24%28el%2EnextSibling%29%2Efilter%28%22%2Ehtmlwidgets%2Derror%22%29%2Eremove%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20sizing%3A%20%7B%7D%0A%20%20%7D%3B%0A%0A%20%20%2F%2F%20Called%20by%20widget%20bindings%20to%20register%20a%20new%20type%20of%20widget%2E%20The%20definition%0A%20%20%2F%2F%20object%20can%20contain%20the%20following%20properties%3A%0A%20%20%2F%2F%20%2D%20name%20%28required%29%20%2D%20A%20string%20indicating%20the%20binding%20name%2C%20which%20will%20be%0A%20%20%2F%2F%20%20%20used%20by%20default%20as%20the%20CSS%20classname%20to%20look%20for%2E%0A%20%20%2F%2F%20%2D%20initialize%20%28optional%29%20%2D%20A%20function%28el%29%20that%20will%20be%20called%20once%20per%0A%20%20%2F%2F%20%20%20widget%20element%3B%20if%20a%20value%20is%20returned%2C%20it%20will%20be%20passed%20as%20the%20third%0A%20%20%2F%2F%20%20%20value%20to%20renderValue%2E%0A%20%20%2F%2F%20%2D%20renderValue%20%28required%29%20%2D%20A%20function%28el%2C%20data%2C%20initValue%29%20that%20will%20be%0A%20%20%2F%2F%20%20%20called%20with%20data%2E%20Static%20contexts%20will%20cause%20this%20to%20be%20called%20once%20per%0A%20%20%2F%2F%20%20%20element%3B%20Shiny%20apps%20will%20cause%20this%20to%20be%20called%20multiple%20times%20per%0A%20%20%2F%2F%20%20%20element%2C%20as%20the%20data%20changes%2E%0A%20%20window%2EHTMLWidgets%2Ewidget%20%3D%20function%28definition%29%20%7B%0A%20%20%20%20if%20%28%21definition%2Ename%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22Widget%20must%20have%20a%20name%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28%21definition%2Etype%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22Widget%20must%20have%20a%20type%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20Currently%20we%20only%20support%20output%20widgets%0A%20%20%20%20if%20%28definition%2Etype%20%21%3D%3D%20%22output%22%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22Unrecognized%20widget%20type%20%27%22%20%2B%20definition%2Etype%20%2B%20%22%27%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20TODO%3A%20Verify%20that%20%2Ename%20is%20a%20valid%20CSS%20classname%0A%0A%20%20%20%20%2F%2F%20Support%20new%2Dstyle%20instance%2Dbound%20definitions%2E%20Old%2Dstyle%20class%2Dbound%0A%20%20%20%20%2F%2F%20definitions%20have%20one%20widget%20%22object%22%20per%20widget%20per%20type%2Fclass%20of%0A%20%20%20%20%2F%2F%20widget%3B%20the%20renderValue%20and%20resize%20methods%20on%20such%20widget%20objects%0A%20%20%20%20%2F%2F%20take%20el%20and%20instance%20arguments%2C%20because%20the%20widget%20object%20can%27t%0A%20%20%20%20%2F%2F%20store%20them%2E%20New%2Dstyle%20instance%2Dbound%20definitions%20have%20one%20widget%0A%20%20%20%20%2F%2F%20object%20per%20widget%20instance%3B%20the%20definition%20that%27s%20passed%20in%20doesn%27t%0A%20%20%20%20%2F%2F%20provide%20renderValue%20or%20resize%20methods%20at%20all%2C%20just%20the%20single%20method%0A%20%20%20%20%2F%2F%20%20%20factory%28el%2C%20width%2C%20height%29%0A%20%20%20%20%2F%2F%20which%20returns%20an%20object%20that%20has%20renderValue%28x%29%20and%20resize%28w%2C%20h%29%2E%0A%20%20%20%20%2F%2F%20This%20enables%20a%20far%20more%20natural%20programming%20style%20for%20the%20widget%0A%20%20%20%20%2F%2F%20author%2C%20who%20can%20store%20per%2Dinstance%20state%20using%20either%20OO%2Dstyle%0A%20%20%20%20%2F%2F%20instance%20fields%20or%20functional%2Dstyle%20closure%20variables%20%28I%20guess%20this%0A%20%20%20%20%2F%2F%20is%20in%20contrast%20to%20what%20can%20only%20be%20called%20C%2Dstyle%20pseudo%2DOO%20which%20is%0A%20%20%20%20%2F%2F%20what%20we%20required%20before%29%2E%0A%20%20%20%20if%20%28definition%2Efactory%29%20%7B%0A%20%20%20%20%20%20definition%20%3D%20createLegacyDefinitionAdapter%28definition%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28%21definition%2ErenderValue%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22Widget%20must%20have%20a%20renderValue%20function%22%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20For%20static%20rendering%20%28non%2DShiny%29%2C%20use%20a%20simple%20widget%20registration%0A%20%20%20%20%2F%2F%20scheme%2E%20We%20also%20use%20this%20scheme%20for%20Shiny%20apps%2Fdocuments%20that%20also%0A%20%20%20%20%2F%2F%20contain%20static%20widgets%2E%0A%20%20%20%20window%2EHTMLWidgets%2Ewidgets%20%3D%20window%2EHTMLWidgets%2Ewidgets%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%2F%2F%20Merge%20defaults%20into%20the%20definition%3B%20don%27t%20mutate%20the%20original%20definition%2E%0A%20%20%20%20var%20staticBinding%20%3D%20extend%28%7B%7D%2C%20defaults%2C%20definition%29%3B%0A%20%20%20%20overrideMethod%28staticBinding%2C%20%22find%22%2C%20function%28superfunc%29%20%7B%0A%20%20%20%20%20%20return%20function%28scope%29%20%7B%0A%20%20%20%20%20%20%20%20var%20results%20%3D%20superfunc%28scope%29%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20Filter%20out%20Shiny%20outputs%2C%20we%20only%20want%20the%20static%20kind%0A%20%20%20%20%20%20%20%20return%20filterByClass%28results%2C%20%22html%2Dwidget%2Doutput%22%2C%20false%29%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20window%2EHTMLWidgets%2Ewidgets%2Epush%28staticBinding%29%3B%0A%0A%20%20%20%20if%20%28shinyMode%29%20%7B%0A%20%20%20%20%20%20%2F%2F%20Shiny%20is%20running%2E%20Register%20the%20definition%20with%20an%20output%20binding%2E%0A%20%20%20%20%20%20%2F%2F%20The%20definition%20itself%20will%20not%20be%20the%20output%20binding%2C%20instead%0A%20%20%20%20%20%20%2F%2F%20we%20will%20make%20an%20output%20binding%20object%20that%20delegates%20to%20the%0A%20%20%20%20%20%20%2F%2F%20definition%2E%20This%20is%20because%20we%20foolishly%20used%20the%20same%20method%0A%20%20%20%20%20%20%2F%2F%20name%20%28renderValue%29%20for%20htmlwidgets%20definition%20and%20Shiny%20bindings%0A%20%20%20%20%20%20%2F%2F%20but%20they%20actually%20have%20quite%20different%20semantics%20%28the%20Shiny%0A%20%20%20%20%20%20%2F%2F%20bindings%20receive%20data%20that%20includes%20lots%20of%20metadata%20that%20it%0A%20%20%20%20%20%20%2F%2F%20strips%20off%20before%20calling%20htmlwidgets%20renderValue%29%2E%20We%20can%27t%0A%20%20%20%20%20%20%2F%2F%20just%20ignore%20the%20difference%20because%20in%20some%20widgets%20it%27s%20helpful%0A%20%20%20%20%20%20%2F%2F%20to%20call%20this%2ErenderValue%28%29%20from%20inside%20of%20resize%28%29%2C%20and%20if%0A%20%20%20%20%20%20%2F%2F%20we%27re%20not%20delegating%2C%20then%20that%20call%20will%20go%20to%20the%20Shiny%0A%20%20%20%20%20%20%2F%2F%20version%20instead%20of%20the%20htmlwidgets%20version%2E%0A%0A%20%20%20%20%20%20%2F%2F%20Merge%20defaults%20with%20definition%2C%20without%20mutating%20either%2E%0A%20%20%20%20%20%20var%20bindingDef%20%3D%20extend%28%7B%7D%2C%20defaults%2C%20definition%29%3B%0A%0A%20%20%20%20%20%20%2F%2F%20This%20object%20will%20be%20our%20actual%20Shiny%20binding%2E%0A%20%20%20%20%20%20var%20shinyBinding%20%3D%20new%20Shiny%2EOutputBinding%28%29%3B%0A%0A%20%20%20%20%20%20%2F%2F%20With%20a%20few%20exceptions%2C%20we%27ll%20want%20to%20simply%20use%20the%20bindingDef%27s%0A%20%20%20%20%20%20%2F%2F%20version%20of%20methods%20if%20they%20are%20available%2C%20otherwise%20fall%20back%20to%0A%20%20%20%20%20%20%2F%2F%20Shiny%27s%20defaults%2E%20NOTE%3A%20If%20Shiny%27s%20output%20bindings%20gain%20additional%0A%20%20%20%20%20%20%2F%2F%20methods%20in%20the%20future%2C%20and%20we%20want%20them%20to%20be%20overrideable%20by%0A%20%20%20%20%20%20%2F%2F%20HTMLWidget%20binding%20definitions%2C%20then%20we%27ll%20need%20to%20add%20them%20to%20this%0A%20%20%20%20%20%20%2F%2F%20list%2E%0A%20%20%20%20%20%20delegateMethod%28shinyBinding%2C%20bindingDef%2C%20%22getId%22%29%3B%0A%20%20%20%20%20%20delegateMethod%28shinyBinding%2C%20bindingDef%2C%20%22onValueChange%22%29%3B%0A%20%20%20%20%20%20delegateMethod%28shinyBinding%2C%20bindingDef%2C%20%22onValueError%22%29%3B%0A%20%20%20%20%20%20delegateMethod%28shinyBinding%2C%20bindingDef%2C%20%22renderError%22%29%3B%0A%20%20%20%20%20%20delegateMethod%28shinyBinding%2C%20bindingDef%2C%20%22clearError%22%29%3B%0A%20%20%20%20%20%20delegateMethod%28shinyBinding%2C%20bindingDef%2C%20%22showProgress%22%29%3B%0A%0A%20%20%20%20%20%20%2F%2F%20The%20find%2C%20renderValue%2C%20and%20resize%20are%20handled%20differently%2C%20because%20we%0A%20%20%20%20%20%20%2F%2F%20want%20to%20actually%20decorate%20the%20behavior%20of%20the%20bindingDef%20methods%2E%0A%0A%20%20%20%20%20%20shinyBinding%2Efind%20%3D%20function%28scope%29%20%7B%0A%20%20%20%20%20%20%20%20var%20results%20%3D%20bindingDef%2Efind%28scope%29%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Only%20return%20elements%20that%20are%20Shiny%20outputs%2C%20not%20static%20ones%0A%20%20%20%20%20%20%20%20var%20dynamicResults%20%3D%20results%2Efilter%28%22%2Ehtml%2Dwidget%2Doutput%22%29%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20It%27s%20possible%20that%20whatever%20caused%20Shiny%20to%20think%20there%20might%20be%0A%20%20%20%20%20%20%20%20%2F%2F%20new%20dynamic%20outputs%2C%20also%20caused%20there%20to%20be%20new%20static%20outputs%2E%0A%20%20%20%20%20%20%20%20%2F%2F%20Since%20there%20might%20be%20lots%20of%20different%20htmlwidgets%20bindings%2C%20we%0A%20%20%20%20%20%20%20%20%2F%2F%20schedule%20execution%20for%20later%2D%2Dno%20need%20to%20staticRender%20multiple%0A%20%20%20%20%20%20%20%20%2F%2F%20times%2E%0A%20%20%20%20%20%20%20%20if%20%28results%2Elength%20%21%3D%3D%20dynamicResults%2Elength%29%0A%20%20%20%20%20%20%20%20%20%20scheduleStaticRender%28%29%3B%0A%0A%20%20%20%20%20%20%20%20return%20dynamicResults%3B%0A%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Wrap%20renderValue%20to%20handle%20initialization%2C%20which%20unfortunately%20isn%27t%0A%20%20%20%20%20%20%2F%2F%20supported%20natively%20by%20Shiny%20at%20the%20time%20of%20this%20writing%2E%0A%0A%20%20%20%20%20%20shinyBinding%2ErenderValue%20%3D%20function%28el%2C%20data%29%20%7B%0A%20%20%20%20%20%20%20%20Shiny%2ErenderDependencies%28data%2Edeps%29%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20Resolve%20strings%20marked%20as%20javascript%20literals%20to%20objects%0A%20%20%20%20%20%20%20%20if%20%28%21%28data%2Eevals%20instanceof%20Array%29%29%20data%2Eevals%20%3D%20%5Bdata%2Eevals%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%200%3B%20data%2Eevals%20%26%26%20i%20%3C%20data%2Eevals%2Elength%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20window%2EHTMLWidgets%2EevaluateStringMember%28data%2Ex%2C%20data%2Eevals%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28%21bindingDef%2ErenderOnNullValue%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28data%2Ex%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20el%2Estyle%2Evisibility%20%3D%20%22hidden%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20el%2Estyle%2Evisibility%20%3D%20%22inherit%22%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28%21elementData%28el%2C%20%22initialized%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20initSizing%28el%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20elementData%28el%2C%20%22initialized%22%2C%20true%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28bindingDef%2Einitialize%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20rect%20%3D%20el%2EgetBoundingClientRect%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20result%20%3D%20bindingDef%2Einitialize%28el%2C%20rect%2Ewidth%2C%20rect%2Eheight%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20elementData%28el%2C%20%22init%5Fresult%22%2C%20result%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20bindingDef%2ErenderValue%28el%2C%20data%2Ex%2C%20elementData%28el%2C%20%22init%5Fresult%22%29%29%3B%0A%20%20%20%20%20%20%20%20evalAndRun%28data%2EjsHooks%2Erender%2C%20elementData%28el%2C%20%22init%5Fresult%22%29%2C%20%5Bel%2C%20data%2Ex%5D%29%3B%0A%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Only%20override%20resize%20if%20bindingDef%20implements%20it%0A%20%20%20%20%20%20if%20%28bindingDef%2Eresize%29%20%7B%0A%20%20%20%20%20%20%20%20shinyBinding%2Eresize%20%3D%20function%28el%2C%20width%2C%20height%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20Shiny%20can%20call%20resize%20before%20initialize%2FrenderValue%20have%20been%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20called%2C%20which%20doesn%27t%20make%20sense%20for%20widgets%2E%0A%20%20%20%20%20%20%20%20%20%20if%20%28elementData%28el%2C%20%22initialized%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20bindingDef%2Eresize%28el%2C%20width%2C%20height%2C%20elementData%28el%2C%20%22init%5Fresult%22%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20Shiny%2EoutputBindings%2Eregister%28shinyBinding%2C%20bindingDef%2Ename%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20var%20scheduleStaticRenderTimerId%20%3D%20null%3B%0A%20%20function%20scheduleStaticRender%28%29%20%7B%0A%20%20%20%20if%20%28%21scheduleStaticRenderTimerId%29%20%7B%0A%20%20%20%20%20%20scheduleStaticRenderTimerId%20%3D%20setTimeout%28function%28%29%20%7B%0A%20%20%20%20%20%20%20%20scheduleStaticRenderTimerId%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20window%2EHTMLWidgets%2EstaticRender%28%29%3B%0A%20%20%20%20%20%20%7D%2C%201%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20Render%20static%20widgets%20after%20the%20document%20finishes%20loading%0A%20%20%2F%2F%20Statically%20render%20all%20elements%20that%20are%20of%20this%20widget%27s%20class%0A%20%20window%2EHTMLWidgets%2EstaticRender%20%3D%20function%28%29%20%7B%0A%20%20%20%20var%20bindings%20%3D%20window%2EHTMLWidgets%2Ewidgets%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20forEach%28bindings%2C%20function%28binding%29%20%7B%0A%20%20%20%20%20%20var%20matches%20%3D%20binding%2Efind%28document%2EdocumentElement%29%3B%0A%20%20%20%20%20%20forEach%28matches%2C%20function%28el%29%20%7B%0A%20%20%20%20%20%20%20%20var%20sizeObj%20%3D%20initSizing%28el%2C%20binding%29%3B%0A%0A%20%20%20%20%20%20%20%20var%20getSize%20%3D%20function%28el%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28sizeObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%7Bw%3A%20sizeObj%2EgetWidth%28%29%2C%20h%3A%20sizeObj%2EgetHeight%28%29%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20rect%20%3D%20el%2EgetBoundingClientRect%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%7Bw%3A%20rect%2Ewidth%2C%20h%3A%20rect%2Eheight%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20if%20%28hasClass%28el%2C%20%22html%2Dwidget%2Dstatic%2Dbound%22%29%29%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20el%2EclassName%20%3D%20el%2EclassName%20%2B%20%22%20html%2Dwidget%2Dstatic%2Dbound%22%3B%0A%0A%20%20%20%20%20%20%20%20var%20initResult%3B%0A%20%20%20%20%20%20%20%20if%20%28binding%2Einitialize%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20size%20%3D%20getSize%28el%29%3B%0A%20%20%20%20%20%20%20%20%20%20initResult%20%3D%20binding%2Einitialize%28el%2C%20size%2Ew%2C%20size%2Eh%29%3B%0A%20%20%20%20%20%20%20%20%20%20elementData%28el%2C%20%22init%5Fresult%22%2C%20initResult%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20%28binding%2Eresize%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20lastSize%20%3D%20getSize%28el%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20resizeHandler%20%3D%20function%28e%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20size%20%3D%20getSize%28el%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28size%2Ew%20%3D%3D%3D%200%20%26%26%20size%2Eh%20%3D%3D%3D%200%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28size%2Ew%20%3D%3D%3D%20lastSize%2Ew%20%26%26%20size%2Eh%20%3D%3D%3D%20lastSize%2Eh%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20lastSize%20%3D%20size%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20binding%2Eresize%28el%2C%20size%2Ew%2C%20size%2Eh%2C%20initResult%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20on%28window%2C%20%22resize%22%2C%20resizeHandler%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20This%20is%20needed%20for%20cases%20where%20we%27re%20running%20in%20a%20Shiny%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20app%2C%20but%20the%20widget%20itself%20is%20not%20a%20Shiny%20output%2C%20but%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20rather%20a%20simple%20static%20widget%2E%20One%20example%20of%20this%20is%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20an%20rmarkdown%20document%20that%20has%20runtime%3Ashiny%20and%20widget%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20that%20isn%27t%20in%20a%20render%20function%2E%20Shiny%20only%20knows%20to%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20call%20resize%20handlers%20for%20Shiny%20outputs%2C%20not%20for%20static%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20widgets%2C%20so%20we%20do%20it%20ourselves%2E%0A%20%20%20%20%20%20%20%20%20%20if%20%28window%2EjQuery%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20window%2EjQuery%28document%29%2Eon%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22shown%2Ehtmlwidgets%20shown%2Ebs%2Etab%2Ehtmlwidgets%20shown%2Ebs%2Ecollapse%2Ehtmlwidgets%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20resizeHandler%0A%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20window%2EjQuery%28document%29%2Eon%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22hidden%2Ehtmlwidgets%20hidden%2Ebs%2Etab%2Ehtmlwidgets%20hidden%2Ebs%2Ecollapse%2Ehtmlwidgets%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20resizeHandler%0A%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20This%20is%20needed%20for%20the%20specific%20case%20of%20ioslides%2C%20which%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20flips%20slides%20between%20display%3Anone%20and%20display%3Ablock%2E%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20Ideally%20we%20would%20not%20have%20to%20have%20ioslide%2Dspecific%20code%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20here%2C%20but%20rather%20have%20ioslides%20raise%20a%20generic%20event%2C%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20but%20the%20rmarkdown%20package%20just%20went%20to%20CRAN%20so%20the%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20window%20to%20getting%20that%20fixed%20may%20be%20long%2E%0A%20%20%20%20%20%20%20%20%20%20if%20%28window%2EaddEventListener%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20It%27s%20OK%20to%20limit%20this%20to%20window%2EaddEventListener%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20browsers%20because%20ioslides%20itself%20only%20supports%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20such%20browsers%2E%0A%20%20%20%20%20%20%20%20%20%20%20%20on%28document%2C%20%22slideenter%22%2C%20resizeHandler%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20on%28document%2C%20%22slideleave%22%2C%20resizeHandler%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20scriptData%20%3D%20document%2EquerySelector%28%22script%5Bdata%2Dfor%3D%27%22%20%2B%20el%2Eid%20%2B%20%22%27%5D%5Btype%3D%27application%2Fjson%27%5D%22%29%3B%0A%20%20%20%20%20%20%20%20if%20%28scriptData%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20data%20%3D%20JSON%2Eparse%28scriptData%2EtextContent%20%7C%7C%20scriptData%2Etext%29%3B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20Resolve%20strings%20marked%20as%20javascript%20literals%20to%20objects%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21%28data%2Eevals%20instanceof%20Array%29%29%20data%2Eevals%20%3D%20%5Bdata%2Eevals%5D%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28var%20k%20%3D%200%3B%20data%2Eevals%20%26%26%20k%20%3C%20data%2Eevals%2Elength%3B%20k%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20window%2EHTMLWidgets%2EevaluateStringMember%28data%2Ex%2C%20data%2Eevals%5Bk%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20binding%2ErenderValue%28el%2C%20data%2Ex%2C%20initResult%29%3B%0A%20%20%20%20%20%20%20%20%20%20evalAndRun%28data%2EjsHooks%2Erender%2C%20initResult%2C%20%5Bel%2C%20data%2Ex%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20invokePostRenderHandlers%28%29%3B%0A%20%20%7D%0A%0A%0A%20%20function%20has%5FjQuery3%28%29%20%7B%0A%20%20%20%20if%20%28%21window%2EjQuery%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20var%20%24version%20%3D%20window%2EjQuery%2Efn%2Ejquery%3B%0A%20%20%20%20var%20%24major%5Fversion%20%3D%20parseInt%28%24version%2Esplit%28%22%2E%22%29%5B0%5D%29%3B%0A%20%20%20%20return%20%24major%5Fversion%20%3E%3D%203%3B%0A%20%20%7D%0A%0A%20%20%2F%2A%0A%20%20%2F%20Shiny%201%2E4%20bumped%20jQuery%20from%201%2Ex%20to%203%2Ex%20which%20means%20jQuery%27s%0A%20%20%2F%20on%2Dready%20handler%20%28i%2Ee%2E%2C%20%24%28fn%29%29%20is%20now%20asyncronous%20%28i%2Ee%2E%2C%20it%20now%0A%20%20%2F%20really%20means%20%24%28setTimeout%28fn%29%29%2E%0A%20%20%2F%20https%3A%2F%2Fjquery%2Ecom%2Fupgrade%2Dguide%2F3%2E0%2F%23breaking%2Dchange%2Ddocument%2Dready%2Dhandlers%2Dare%2Dnow%2Dasynchronous%0A%20%20%2F%0A%20%20%2F%20Since%20Shiny%20uses%20%24%28%29%20to%20schedule%20initShiny%2C%20shiny%3E%3D1%2E4%20calls%20initShiny%0A%20%20%2F%20one%20tick%20later%20than%20it%20did%20before%2C%20which%20means%20staticRender%28%29%20is%0A%20%20%2F%20called%20renderValue%28%29%20earlier%20than%20%28advanced%29%20widget%20authors%20might%20be%20expecting%2E%0A%20%20%2F%20https%3A%2F%2Fgithub%2Ecom%2Frstudio%2Fshiny%2Fissues%2F2630%0A%20%20%2F%0A%20%20%2F%20For%20a%20concrete%20example%2C%20leaflet%20has%20some%20methods%20%28e%2Eg%2E%2C%20updateBounds%29%0A%20%20%2F%20which%20reference%20Shiny%20methods%20registered%20in%20initShiny%20%28e%2Eg%2E%2C%20setInputValue%29%2E%0A%20%20%2F%20Since%20leaflet%20is%20privy%20to%20this%20life%2Dcycle%2C%20it%20knows%20to%20use%20setTimeout%28%29%20to%0A%20%20%2F%20delay%20execution%20of%20those%20methods%20%28until%20Shiny%20methods%20are%20ready%29%0A%20%20%2F%20https%3A%2F%2Fgithub%2Ecom%2Frstudio%2Fleaflet%2Fblob%2F18ec981%2Fjavascript%2Fsrc%2Findex%2Ejs%23L266%2DL268%0A%20%20%2F%0A%20%20%2F%20Ideally%20widget%20authors%20wouldn%27t%20need%20to%20use%20this%20setTimeout%28%29%20hack%20that%0A%20%20%2F%20leaflet%20uses%20to%20call%20Shiny%20methods%20on%20a%20staticRender%28%29%2E%20In%20the%20long%20run%2C%0A%20%20%2F%20the%20logic%20initShiny%20should%20be%20broken%20up%20so%20that%20method%20registration%20happens%0A%20%20%2F%20right%20away%2C%20but%20binding%20happens%20later%2E%0A%20%20%2A%2F%0A%20%20function%20maybeStaticRenderLater%28%29%20%7B%0A%20%20%20%20if%20%28shinyMode%20%26%26%20has%5FjQuery3%28%29%29%20%7B%0A%20%20%20%20%20%20window%2EjQuery%28window%2EHTMLWidgets%2EstaticRender%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20window%2EHTMLWidgets%2EstaticRender%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20if%20%28document%2EaddEventListener%29%20%7B%0A%20%20%20%20document%2EaddEventListener%28%22DOMContentLoaded%22%2C%20function%28%29%20%7B%0A%20%20%20%20%20%20document%2EremoveEventListener%28%22DOMContentLoaded%22%2C%20arguments%2Ecallee%2C%20false%29%3B%0A%20%20%20%20%20%20maybeStaticRenderLater%28%29%3B%0A%20%20%20%20%7D%2C%20false%29%3B%0A%20%20%7D%20else%20if%20%28document%2EattachEvent%29%20%7B%0A%20%20%20%20document%2EattachEvent%28%22onreadystatechange%22%2C%20function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28document%2EreadyState%20%3D%3D%3D%20%22complete%22%29%20%7B%0A%20%20%20%20%20%20%20%20document%2EdetachEvent%28%22onreadystatechange%22%2C%20arguments%2Ecallee%29%3B%0A%20%20%20%20%20%20%20%20maybeStaticRenderLater%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%0A%0A%20%20window%2EHTMLWidgets%2EgetAttachmentUrl%20%3D%20function%28depname%2C%20key%29%20%7B%0A%20%20%20%20%2F%2F%20If%20no%20key%2C%20default%20to%20the%20first%20item%0A%20%20%20%20if%20%28typeof%28key%29%20%3D%3D%3D%20%22undefined%22%29%0A%20%20%20%20%20%20key%20%3D%201%3B%0A%0A%20%20%20%20var%20link%20%3D%20document%2EgetElementById%28depname%20%2B%20%22%2D%22%20%2B%20key%20%2B%20%22%2Dattachment%22%29%3B%0A%20%20%20%20if%20%28%21link%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22Attachment%20%22%20%2B%20depname%20%2B%20%22%2F%22%20%2B%20key%20%2B%20%22%20not%20found%20in%20document%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20link%2EgetAttribute%28%22href%22%29%3B%0A%20%20%7D%3B%0A%0A%20%20window%2EHTMLWidgets%2EdataframeToD3%20%3D%20function%28df%29%20%7B%0A%20%20%20%20var%20names%20%3D%20%5B%5D%3B%0A%20%20%20%20var%20length%3B%0A%20%20%20%20for%20%28var%20name%20in%20df%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28df%2EhasOwnProperty%28name%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20names%2Epush%28name%29%3B%0A%20%20%20%20%20%20%20%20if%20%28typeof%28df%5Bname%5D%29%20%21%3D%3D%20%22object%22%20%7C%7C%20typeof%28df%5Bname%5D%2Elength%29%20%3D%3D%3D%20%22undefined%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22All%20fields%20must%20be%20arrays%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28typeof%28length%29%20%21%3D%3D%20%22undefined%22%20%26%26%20length%20%21%3D%3D%20df%5Bname%5D%2Elength%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22All%20fields%20must%20be%20arrays%20of%20the%20same%20length%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20length%20%3D%20df%5Bname%5D%2Elength%3B%0A%20%20%20%20%7D%0A%20%20%20%20var%20results%20%3D%20%5B%5D%3B%0A%20%20%20%20var%20item%3B%0A%20%20%20%20for%20%28var%20row%20%3D%200%3B%20row%20%3C%20length%3B%20row%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20item%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20for%20%28var%20col%20%3D%200%3B%20col%20%3C%20names%2Elength%3B%20col%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20item%5Bnames%5Bcol%5D%5D%20%3D%20df%5Bnames%5Bcol%5D%5D%5Brow%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20results%2Epush%28item%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20results%3B%0A%20%20%7D%3B%0A%0A%20%20window%2EHTMLWidgets%2EtransposeArray2D%20%3D%20function%28array%29%20%7B%0A%20%20%20%20%20%20if%20%28array%2Elength%20%3D%3D%3D%200%29%20return%20array%3B%0A%20%20%20%20%20%20var%20newArray%20%3D%20array%5B0%5D%2Emap%28function%28col%2C%20i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20array%2Emap%28function%28row%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20row%5Bi%5D%0A%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20return%20newArray%3B%0A%20%20%7D%3B%0A%20%20%2F%2F%20Split%20value%20at%20splitChar%2C%20but%20allow%20splitChar%20to%20be%20escaped%0A%20%20%2F%2F%20using%20escapeChar%2E%20Any%20other%20characters%20escaped%20by%20escapeChar%0A%20%20%2F%2F%20will%20be%20included%20as%20usual%20%28including%20escapeChar%20itself%29%2E%0A%20%20function%20splitWithEscape%28value%2C%20splitChar%2C%20escapeChar%29%20%7B%0A%20%20%20%20var%20results%20%3D%20%5B%5D%3B%0A%20%20%20%20var%20escapeMode%20%3D%20false%3B%0A%20%20%20%20var%20currentResult%20%3D%20%22%22%3B%0A%20%20%20%20for%20%28var%20pos%20%3D%200%3B%20pos%20%3C%20value%2Elength%3B%20pos%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28%21escapeMode%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28value%5Bpos%5D%20%3D%3D%3D%20splitChar%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20results%2Epush%28currentResult%29%3B%0A%20%20%20%20%20%20%20%20%20%20currentResult%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28value%5Bpos%5D%20%3D%3D%3D%20escapeChar%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20escapeMode%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20currentResult%20%2B%3D%20value%5Bpos%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20currentResult%20%2B%3D%20value%5Bpos%5D%3B%0A%20%20%20%20%20%20%20%20escapeMode%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28currentResult%20%21%3D%3D%20%22%22%29%20%7B%0A%20%20%20%20%20%20results%2Epush%28currentResult%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20results%3B%0A%20%20%7D%0A%20%20%2F%2F%20Function%20authored%20by%20Yihui%2FJJ%20Allaire%0A%20%20window%2EHTMLWidgets%2EevaluateStringMember%20%3D%20function%28o%2C%20member%29%20%7B%0A%20%20%20%20var%20parts%20%3D%20splitWithEscape%28member%2C%20%27%2E%27%2C%20%27%5C%5C%27%29%3B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20l%20%3D%20parts%2Elength%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20var%20part%20%3D%20parts%5Bi%5D%3B%0A%20%20%20%20%20%20%2F%2F%20part%20may%20be%20a%20character%20or%20%27numeric%27%20member%20name%0A%20%20%20%20%20%20if%20%28o%20%21%3D%3D%20null%20%26%26%20typeof%20o%20%3D%3D%3D%20%22object%22%20%26%26%20part%20in%20o%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28i%20%3D%3D%20%28l%20%2D%201%29%29%20%7B%20%2F%2F%20if%20we%20are%20at%20the%20end%20of%20the%20line%20then%20evalulate%0A%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20o%5Bpart%5D%20%3D%3D%3D%20%22string%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20o%5Bpart%5D%20%3D%20tryEval%28o%5Bpart%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%20%2F%2F%20otherwise%20continue%20to%20next%20embedded%20object%0A%20%20%20%20%20%20%20%20%20%20o%20%3D%20o%5Bpart%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20%2F%2F%20Retrieve%20the%20HTMLWidget%20instance%20%28i%2Ee%2E%20the%20return%20value%20of%20an%0A%20%20%2F%2F%20HTMLWidget%20binding%27s%20initialize%28%29%20or%20factory%28%29%20function%29%0A%20%20%2F%2F%20associated%20with%20an%20element%2C%20or%20null%20if%20none%2E%0A%20%20window%2EHTMLWidgets%2EgetInstance%20%3D%20function%28el%29%20%7B%0A%20%20%20%20return%20elementData%28el%2C%20%22init%5Fresult%22%29%3B%0A%20%20%7D%3B%0A%0A%20%20%2F%2F%20Finds%20the%20first%20element%20in%20the%20scope%20that%20matches%20the%20selector%2C%0A%20%20%2F%2F%20and%20returns%20the%20HTMLWidget%20instance%20%28i%2Ee%2E%20the%20return%20value%20of%0A%20%20%2F%2F%20an%20HTMLWidget%20binding%27s%20initialize%28%29%20or%20factory%28%29%20function%29%0A%20%20%2F%2F%20associated%20with%20that%20element%2C%20if%20any%2E%20If%20no%20element%20matches%20the%0A%20%20%2F%2F%20selector%2C%20or%20the%20first%20matching%20element%20has%20no%20HTMLWidget%0A%20%20%2F%2F%20instance%20associated%20with%20it%2C%20then%20null%20is%20returned%2E%0A%20%20%2F%2F%0A%20%20%2F%2F%20The%20scope%20argument%20is%20optional%2C%20and%20defaults%20to%20window%2Edocument%2E%0A%20%20window%2EHTMLWidgets%2Efind%20%3D%20function%28scope%2C%20selector%29%20%7B%0A%20%20%20%20if%20%28arguments%2Elength%20%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20selector%20%3D%20scope%3B%0A%20%20%20%20%20%20scope%20%3D%20document%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20el%20%3D%20scope%2EquerySelector%28selector%29%3B%0A%20%20%20%20if%20%28el%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20window%2EHTMLWidgets%2EgetInstance%28el%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20%2F%2F%20Finds%20all%20elements%20in%20the%20scope%20that%20match%20the%20selector%2C%20and%0A%20%20%2F%2F%20returns%20the%20HTMLWidget%20instances%20%28i%2Ee%2E%20the%20return%20values%20of%0A%20%20%2F%2F%20an%20HTMLWidget%20binding%27s%20initialize%28%29%20or%20factory%28%29%20function%29%0A%20%20%2F%2F%20associated%20with%20the%20elements%2C%20in%20an%20array%2E%20If%20elements%20that%0A%20%20%2F%2F%20match%20the%20selector%20don%27t%20have%20an%20associated%20HTMLWidget%0A%20%20%2F%2F%20instance%2C%20the%20returned%20array%20will%20contain%20nulls%2E%0A%20%20%2F%2F%0A%20%20%2F%2F%20The%20scope%20argument%20is%20optional%2C%20and%20defaults%20to%20window%2Edocument%2E%0A%20%20window%2EHTMLWidgets%2EfindAll%20%3D%20function%28scope%2C%20selector%29%20%7B%0A%20%20%20%20if%20%28arguments%2Elength%20%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20selector%20%3D%20scope%3B%0A%20%20%20%20%20%20scope%20%3D%20document%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20nodes%20%3D%20scope%2EquerySelectorAll%28selector%29%3B%0A%20%20%20%20var%20results%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20nodes%2Elength%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20results%2Epush%28window%2EHTMLWidgets%2EgetInstance%28nodes%5Bi%5D%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20results%3B%0A%20%20%7D%3B%0A%0A%20%20var%20postRenderHandlers%20%3D%20%5B%5D%3B%0A%20%20function%20invokePostRenderHandlers%28%29%20%7B%0A%20%20%20%20while%20%28postRenderHandlers%2Elength%29%20%7B%0A%20%20%20%20%20%20var%20handler%20%3D%20postRenderHandlers%2Eshift%28%29%3B%0A%20%20%20%20%20%20if%20%28handler%29%20%7B%0A%20%20%20%20%20%20%20%20handler%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20Register%20the%20given%20callback%20function%20to%20be%20invoked%20after%20the%0A%20%20%2F%2F%20next%20time%20static%20widgets%20are%20rendered%2E%0A%20%20window%2EHTMLWidgets%2EaddPostRenderHandler%20%3D%20function%28callback%29%20%7B%0A%20%20%20%20postRenderHandlers%2Epush%28callback%29%3B%0A%20%20%7D%3B%0A%0A%20%20%2F%2F%20Takes%20a%20new%2Dstyle%20instance%2Dbound%20definition%2C%20and%20returns%20an%0A%20%20%2F%2F%20old%2Dstyle%20class%2Dbound%20definition%2E%20This%20saves%20us%20from%20having%0A%20%20%2F%2F%20to%20rewrite%20all%20the%20logic%20in%20this%20file%20to%20accomodate%20both%0A%20%20%2F%2F%20types%20of%20definitions%2E%0A%20%20function%20createLegacyDefinitionAdapter%28defn%29%20%7B%0A%20%20%20%20var%20result%20%3D%20%7B%0A%20%20%20%20%20%20name%3A%20defn%2Ename%2C%0A%20%20%20%20%20%20type%3A%20defn%2Etype%2C%0A%20%20%20%20%20%20initialize%3A%20function%28el%2C%20width%2C%20height%29%20%7B%0A%20%20%20%20%20%20%20%20return%20defn%2Efactory%28el%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20renderValue%3A%20function%28el%2C%20x%2C%20instance%29%20%7B%0A%20%20%20%20%20%20%20%20return%20instance%2ErenderValue%28x%29%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20resize%3A%20function%28el%2C%20width%2C%20height%2C%20instance%29%20%7B%0A%20%20%20%20%20%20%20%20return%20instance%2Eresize%28width%2C%20height%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20if%20%28defn%2Efind%29%0A%20%20%20%20%20%20result%2Efind%20%3D%20defn%2Efind%3B%0A%20%20%20%20if%20%28defn%2ErenderError%29%0A%20%20%20%20%20%20result%2ErenderError%20%3D%20defn%2ErenderError%3B%0A%20%20%20%20if%20%28defn%2EclearError%29%0A%20%20%20%20%20%20result%2EclearError%20%3D%20defn%2EclearError%3B%0A%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%7D%29%28%29%3B%0A"></script>
<script src="data:application/x-javascript,%2F%2F%20https%3A%2F%2Fd3js%2Eorg%20Version%205%2E1%2E0%2E%20Copyright%202018%20Mike%20Bostock%2E%0A%28function%20%28global%2C%20factory%29%20%7B%0A%09typeof%20exports%20%3D%3D%3D%20%27object%27%20%26%26%20typeof%20module%20%21%3D%3D%20%27undefined%27%20%3F%20factory%28exports%29%20%3A%0A%09typeof%20define%20%3D%3D%3D%20%27function%27%20%26%26%20define%2Eamd%20%3F%20define%28%5B%27exports%27%5D%2C%20factory%29%20%3A%0A%09%28factory%28%28global%2Ed3%20%3D%20global%2Ed3%20%7C%7C%20%7B%7D%29%29%29%3B%0A%7D%28this%2C%20%28function%20%28exports%29%20%7B%20%27use%20strict%27%3B%0A%0Avar%20version%20%3D%20%225%2E1%2E0%22%3B%0A%0Afunction%20ascending%28a%2C%20b%29%20%7B%0A%20%20return%20a%20%3C%20b%20%3F%20%2D1%20%3A%20a%20%3E%20b%20%3F%201%20%3A%20a%20%3E%3D%20b%20%3F%200%20%3A%20NaN%3B%0A%7D%0A%0Afunction%20bisector%28compare%29%20%7B%0A%20%20if%20%28compare%2Elength%20%3D%3D%3D%201%29%20compare%20%3D%20ascendingComparator%28compare%29%3B%0A%20%20return%20%7B%0A%20%20%20%20left%3A%20function%28a%2C%20x%2C%20lo%2C%20hi%29%20%7B%0A%20%20%20%20%20%20if%20%28lo%20%3D%3D%20null%29%20lo%20%3D%200%3B%0A%20%20%20%20%20%20if%20%28hi%20%3D%3D%20null%29%20hi%20%3D%20a%2Elength%3B%0A%20%20%20%20%20%20while%20%28lo%20%3C%20hi%29%20%7B%0A%20%20%20%20%20%20%20%20var%20mid%20%3D%20lo%20%2B%20hi%20%3E%3E%3E%201%3B%0A%20%20%20%20%20%20%20%20if%20%28compare%28a%5Bmid%5D%2C%20x%29%20%3C%200%29%20lo%20%3D%20mid%20%2B%201%3B%0A%20%20%20%20%20%20%20%20else%20hi%20%3D%20mid%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20lo%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20right%3A%20function%28a%2C%20x%2C%20lo%2C%20hi%29%20%7B%0A%20%20%20%20%20%20if%20%28lo%20%3D%3D%20null%29%20lo%20%3D%200%3B%0A%20%20%20%20%20%20if%20%28hi%20%3D%3D%20null%29%20hi%20%3D%20a%2Elength%3B%0A%20%20%20%20%20%20while%20%28lo%20%3C%20hi%29%20%7B%0A%20%20%20%20%20%20%20%20var%20mid%20%3D%20lo%20%2B%20hi%20%3E%3E%3E%201%3B%0A%20%20%20%20%20%20%20%20if%20%28compare%28a%5Bmid%5D%2C%20x%29%20%3E%200%29%20hi%20%3D%20mid%3B%0A%20%20%20%20%20%20%20%20else%20lo%20%3D%20mid%20%2B%201%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20lo%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20ascendingComparator%28f%29%20%7B%0A%20%20return%20function%28d%2C%20x%29%20%7B%0A%20%20%20%20return%20ascending%28f%28d%29%2C%20x%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Avar%20ascendingBisect%20%3D%20bisector%28ascending%29%3B%0Avar%20bisectRight%20%3D%20ascendingBisect%2Eright%3B%0Avar%20bisectLeft%20%3D%20ascendingBisect%2Eleft%3B%0A%0Afunction%20pairs%28array%2C%20f%29%20%7B%0A%20%20if%20%28f%20%3D%3D%20null%29%20f%20%3D%20pair%3B%0A%20%20var%20i%20%3D%200%2C%20n%20%3D%20array%2Elength%20%2D%201%2C%20p%20%3D%20array%5B0%5D%2C%20pairs%20%3D%20new%20Array%28n%20%3C%200%20%3F%200%20%3A%20n%29%3B%0A%20%20while%20%28i%20%3C%20n%29%20pairs%5Bi%5D%20%3D%20f%28p%2C%20p%20%3D%20array%5B%2B%2Bi%5D%29%3B%0A%20%20return%20pairs%3B%0A%7D%0A%0Afunction%20pair%28a%2C%20b%29%20%7B%0A%20%20return%20%5Ba%2C%20b%5D%3B%0A%7D%0A%0Afunction%20cross%28values0%2C%20values1%2C%20reduce%29%20%7B%0A%20%20var%20n0%20%3D%20values0%2Elength%2C%0A%20%20%20%20%20%20n1%20%3D%20values1%2Elength%2C%0A%20%20%20%20%20%20values%20%3D%20new%20Array%28n0%20%2A%20n1%29%2C%0A%20%20%20%20%20%20i0%2C%0A%20%20%20%20%20%20i1%2C%0A%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20value0%3B%0A%0A%20%20if%20%28reduce%20%3D%3D%20null%29%20reduce%20%3D%20pair%3B%0A%0A%20%20for%20%28i0%20%3D%20i%20%3D%200%3B%20i0%20%3C%20n0%3B%20%2B%2Bi0%29%20%7B%0A%20%20%20%20for%20%28value0%20%3D%20values0%5Bi0%5D%2C%20i1%20%3D%200%3B%20i1%20%3C%20n1%3B%20%2B%2Bi1%2C%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20values%5Bi%5D%20%3D%20reduce%28value0%2C%20values1%5Bi1%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20values%3B%0A%7D%0A%0Afunction%20descending%28a%2C%20b%29%20%7B%0A%20%20return%20b%20%3C%20a%20%3F%20%2D1%20%3A%20b%20%3E%20a%20%3F%201%20%3A%20b%20%3E%3D%20a%20%3F%200%20%3A%20NaN%3B%0A%7D%0A%0Afunction%20number%28x%29%20%7B%0A%20%20return%20x%20%3D%3D%3D%20null%20%3F%20NaN%20%3A%20%2Bx%3B%0A%7D%0A%0Afunction%20variance%28values%2C%20valueof%29%20%7B%0A%20%20var%20n%20%3D%20values%2Elength%2C%0A%20%20%20%20%20%20m%20%3D%200%2C%0A%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20mean%20%3D%200%2C%0A%20%20%20%20%20%20value%2C%0A%20%20%20%20%20%20delta%2C%0A%20%20%20%20%20%20sum%20%3D%200%3B%0A%0A%20%20if%20%28valueof%20%3D%3D%20null%29%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20if%20%28%21isNaN%28value%20%3D%20number%28values%5Bi%5D%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20delta%20%3D%20value%20%2D%20mean%3B%0A%20%20%20%20%20%20%20%20mean%20%2B%3D%20delta%20%2F%20%2B%2Bm%3B%0A%20%20%20%20%20%20%20%20sum%20%2B%3D%20delta%20%2A%20%28value%20%2D%20mean%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20else%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20if%20%28%21isNaN%28value%20%3D%20number%28valueof%28values%5Bi%5D%2C%20i%2C%20values%29%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20delta%20%3D%20value%20%2D%20mean%3B%0A%20%20%20%20%20%20%20%20mean%20%2B%3D%20delta%20%2F%20%2B%2Bm%3B%0A%20%20%20%20%20%20%20%20sum%20%2B%3D%20delta%20%2A%20%28value%20%2D%20mean%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20if%20%28m%20%3E%201%29%20return%20sum%20%2F%20%28m%20%2D%201%29%3B%0A%7D%0A%0Afunction%20deviation%28array%2C%20f%29%20%7B%0A%20%20var%20v%20%3D%20variance%28array%2C%20f%29%3B%0A%20%20return%20v%20%3F%20Math%2Esqrt%28v%29%20%3A%20v%3B%0A%7D%0A%0Afunction%20extent%28values%2C%20valueof%29%20%7B%0A%20%20var%20n%20%3D%20values%2Elength%2C%0A%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20value%2C%0A%20%20%20%20%20%20min%2C%0A%20%20%20%20%20%20max%3B%0A%0A%20%20if%20%28valueof%20%3D%3D%20null%29%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%20%2F%2F%20Find%20the%20first%20comparable%20value%2E%0A%20%20%20%20%20%20if%20%28%28value%20%3D%20values%5Bi%5D%29%20%21%3D%20null%20%26%26%20value%20%3E%3D%20value%29%20%7B%0A%20%20%20%20%20%20%20%20min%20%3D%20max%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%20%2F%2F%20Compare%20the%20remaining%20values%2E%0A%20%20%20%20%20%20%20%20%20%20if%20%28%28value%20%3D%20values%5Bi%5D%29%20%21%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28min%20%3E%20value%29%20min%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28max%20%3C%20value%29%20max%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20else%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%20%2F%2F%20Find%20the%20first%20comparable%20value%2E%0A%20%20%20%20%20%20if%20%28%28value%20%3D%20valueof%28values%5Bi%5D%2C%20i%2C%20values%29%29%20%21%3D%20null%20%26%26%20value%20%3E%3D%20value%29%20%7B%0A%20%20%20%20%20%20%20%20min%20%3D%20max%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%20%2F%2F%20Compare%20the%20remaining%20values%2E%0A%20%20%20%20%20%20%20%20%20%20if%20%28%28value%20%3D%20valueof%28values%5Bi%5D%2C%20i%2C%20values%29%29%20%21%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28min%20%3E%20value%29%20min%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28max%20%3C%20value%29%20max%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20%5Bmin%2C%20max%5D%3B%0A%7D%0A%0Avar%20array%20%3D%20Array%2Eprototype%3B%0A%0Avar%20slice%20%3D%20array%2Eslice%3B%0Avar%20map%20%3D%20array%2Emap%3B%0A%0Afunction%20constant%28x%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20identity%28x%29%20%7B%0A%20%20return%20x%3B%0A%7D%0A%0Afunction%20sequence%28start%2C%20stop%2C%20step%29%20%7B%0A%20%20start%20%3D%20%2Bstart%2C%20stop%20%3D%20%2Bstop%2C%20step%20%3D%20%28n%20%3D%20arguments%2Elength%29%20%3C%202%20%3F%20%28stop%20%3D%20start%2C%20start%20%3D%200%2C%201%29%20%3A%20n%20%3C%203%20%3F%201%20%3A%20%2Bstep%3B%0A%0A%20%20var%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20n%20%3D%20Math%2Emax%280%2C%20Math%2Eceil%28%28stop%20%2D%20start%29%20%2F%20step%29%29%20%7C%200%2C%0A%20%20%20%20%20%20range%20%3D%20new%20Array%28n%29%3B%0A%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20range%5Bi%5D%20%3D%20start%20%2B%20i%20%2A%20step%3B%0A%20%20%7D%0A%0A%20%20return%20range%3B%0A%7D%0A%0Avar%20e10%20%3D%20Math%2Esqrt%2850%29%2C%0A%20%20%20%20e5%20%3D%20Math%2Esqrt%2810%29%2C%0A%20%20%20%20e2%20%3D%20Math%2Esqrt%282%29%3B%0A%0Afunction%20ticks%28start%2C%20stop%2C%20count%29%20%7B%0A%20%20var%20reverse%2C%0A%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20n%2C%0A%20%20%20%20%20%20ticks%2C%0A%20%20%20%20%20%20step%3B%0A%0A%20%20stop%20%3D%20%2Bstop%2C%20start%20%3D%20%2Bstart%2C%20count%20%3D%20%2Bcount%3B%0A%20%20if%20%28start%20%3D%3D%3D%20stop%20%26%26%20count%20%3E%200%29%20return%20%5Bstart%5D%3B%0A%20%20if%20%28reverse%20%3D%20stop%20%3C%20start%29%20n%20%3D%20start%2C%20start%20%3D%20stop%2C%20stop%20%3D%20n%3B%0A%20%20if%20%28%28step%20%3D%20tickIncrement%28start%2C%20stop%2C%20count%29%29%20%3D%3D%3D%200%20%7C%7C%20%21isFinite%28step%29%29%20return%20%5B%5D%3B%0A%0A%20%20if%20%28step%20%3E%200%29%20%7B%0A%20%20%20%20start%20%3D%20Math%2Eceil%28start%20%2F%20step%29%3B%0A%20%20%20%20stop%20%3D%20Math%2Efloor%28stop%20%2F%20step%29%3B%0A%20%20%20%20ticks%20%3D%20new%20Array%28n%20%3D%20Math%2Eceil%28stop%20%2D%20start%20%2B%201%29%29%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20ticks%5Bi%5D%20%3D%20%28start%20%2B%20i%29%20%2A%20step%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20start%20%3D%20Math%2Efloor%28start%20%2A%20step%29%3B%0A%20%20%20%20stop%20%3D%20Math%2Eceil%28stop%20%2A%20step%29%3B%0A%20%20%20%20ticks%20%3D%20new%20Array%28n%20%3D%20Math%2Eceil%28start%20%2D%20stop%20%2B%201%29%29%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20ticks%5Bi%5D%20%3D%20%28start%20%2D%20i%29%20%2F%20step%3B%0A%20%20%7D%0A%0A%20%20if%20%28reverse%29%20ticks%2Ereverse%28%29%3B%0A%0A%20%20return%20ticks%3B%0A%7D%0A%0Afunction%20tickIncrement%28start%2C%20stop%2C%20count%29%20%7B%0A%20%20var%20step%20%3D%20%28stop%20%2D%20start%29%20%2F%20Math%2Emax%280%2C%20count%29%2C%0A%20%20%20%20%20%20power%20%3D%20Math%2Efloor%28Math%2Elog%28step%29%20%2F%20Math%2ELN10%29%2C%0A%20%20%20%20%20%20error%20%3D%20step%20%2F%20Math%2Epow%2810%2C%20power%29%3B%0A%20%20return%20power%20%3E%3D%200%0A%20%20%20%20%20%20%3F%20%28error%20%3E%3D%20e10%20%3F%2010%20%3A%20error%20%3E%3D%20e5%20%3F%205%20%3A%20error%20%3E%3D%20e2%20%3F%202%20%3A%201%29%20%2A%20Math%2Epow%2810%2C%20power%29%0A%20%20%20%20%20%20%3A%20%2DMath%2Epow%2810%2C%20%2Dpower%29%20%2F%20%28error%20%3E%3D%20e10%20%3F%2010%20%3A%20error%20%3E%3D%20e5%20%3F%205%20%3A%20error%20%3E%3D%20e2%20%3F%202%20%3A%201%29%3B%0A%7D%0A%0Afunction%20tickStep%28start%2C%20stop%2C%20count%29%20%7B%0A%20%20var%20step0%20%3D%20Math%2Eabs%28stop%20%2D%20start%29%20%2F%20Math%2Emax%280%2C%20count%29%2C%0A%20%20%20%20%20%20step1%20%3D%20Math%2Epow%2810%2C%20Math%2Efloor%28Math%2Elog%28step0%29%20%2F%20Math%2ELN10%29%29%2C%0A%20%20%20%20%20%20error%20%3D%20step0%20%2F%20step1%3B%0A%20%20if%20%28error%20%3E%3D%20e10%29%20step1%20%2A%3D%2010%3B%0A%20%20else%20if%20%28error%20%3E%3D%20e5%29%20step1%20%2A%3D%205%3B%0A%20%20else%20if%20%28error%20%3E%3D%20e2%29%20step1%20%2A%3D%202%3B%0A%20%20return%20stop%20%3C%20start%20%3F%20%2Dstep1%20%3A%20step1%3B%0A%7D%0A%0Afunction%20thresholdSturges%28values%29%20%7B%0A%20%20return%20Math%2Eceil%28Math%2Elog%28values%2Elength%29%20%2F%20Math%2ELN2%29%20%2B%201%3B%0A%7D%0A%0Afunction%20histogram%28%29%20%7B%0A%20%20var%20value%20%3D%20identity%2C%0A%20%20%20%20%20%20domain%20%3D%20extent%2C%0A%20%20%20%20%20%20threshold%20%3D%20thresholdSturges%3B%0A%0A%20%20function%20histogram%28data%29%20%7B%0A%20%20%20%20var%20i%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20data%2Elength%2C%0A%20%20%20%20%20%20%20%20x%2C%0A%20%20%20%20%20%20%20%20values%20%3D%20new%20Array%28n%29%3B%0A%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20values%5Bi%5D%20%3D%20value%28data%5Bi%5D%2C%20i%2C%20data%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20xz%20%3D%20domain%28values%29%2C%0A%20%20%20%20%20%20%20%20x0%20%3D%20xz%5B0%5D%2C%0A%20%20%20%20%20%20%20%20x1%20%3D%20xz%5B1%5D%2C%0A%20%20%20%20%20%20%20%20tz%20%3D%20threshold%28values%2C%20x0%2C%20x1%29%3B%0A%0A%20%20%20%20%2F%2F%20Convert%20number%20of%20thresholds%20into%20uniform%20thresholds%2E%0A%20%20%20%20if%20%28%21Array%2EisArray%28tz%29%29%20%7B%0A%20%20%20%20%20%20tz%20%3D%20tickStep%28x0%2C%20x1%2C%20tz%29%3B%0A%20%20%20%20%20%20tz%20%3D%20sequence%28Math%2Eceil%28x0%20%2F%20tz%29%20%2A%20tz%2C%20Math%2Efloor%28x1%20%2F%20tz%29%20%2A%20tz%2C%20tz%29%3B%20%2F%2F%20exclusive%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Remove%20any%20thresholds%20outside%20the%20domain%2E%0A%20%20%20%20var%20m%20%3D%20tz%2Elength%3B%0A%20%20%20%20while%20%28tz%5B0%5D%20%3C%3D%20x0%29%20tz%2Eshift%28%29%2C%20%2D%2Dm%3B%0A%20%20%20%20while%20%28tz%5Bm%20%2D%201%5D%20%3E%20x1%29%20tz%2Epop%28%29%2C%20%2D%2Dm%3B%0A%0A%20%20%20%20var%20bins%20%3D%20new%20Array%28m%20%2B%201%29%2C%0A%20%20%20%20%20%20%20%20bin%3B%0A%0A%20%20%20%20%2F%2F%20Initialize%20bins%2E%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%3D%20m%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20bin%20%3D%20bins%5Bi%5D%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20bin%2Ex0%20%3D%20i%20%3E%200%20%3F%20tz%5Bi%20%2D%201%5D%20%3A%20x0%3B%0A%20%20%20%20%20%20bin%2Ex1%20%3D%20i%20%3C%20m%20%3F%20tz%5Bi%5D%20%3A%20x1%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Assign%20data%20to%20bins%20by%20value%2C%20ignoring%20any%20outside%20the%20domain%2E%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20x%20%3D%20values%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28x0%20%3C%3D%20x%20%26%26%20x%20%3C%3D%20x1%29%20%7B%0A%20%20%20%20%20%20%20%20bins%5BbisectRight%28tz%2C%20x%2C%200%2C%20m%29%5D%2Epush%28data%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20bins%3B%0A%20%20%7D%0A%0A%20%20histogram%2Evalue%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28value%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%28%5F%29%2C%20histogram%29%20%3A%20value%3B%0A%20%20%7D%3B%0A%0A%20%20histogram%2Edomain%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28domain%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%28%5B%5F%5B0%5D%2C%20%5F%5B1%5D%5D%29%2C%20histogram%29%20%3A%20domain%3B%0A%20%20%7D%3B%0A%0A%20%20histogram%2Ethresholds%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28threshold%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20Array%2EisArray%28%5F%29%20%3F%20constant%28slice%2Ecall%28%5F%29%29%20%3A%20constant%28%5F%29%2C%20histogram%29%20%3A%20threshold%3B%0A%20%20%7D%3B%0A%0A%20%20return%20histogram%3B%0A%7D%0A%0Afunction%20threshold%28values%2C%20p%2C%20valueof%29%20%7B%0A%20%20if%20%28valueof%20%3D%3D%20null%29%20valueof%20%3D%20number%3B%0A%20%20if%20%28%21%28n%20%3D%20values%2Elength%29%29%20return%3B%0A%20%20if%20%28%28p%20%3D%20%2Bp%29%20%3C%3D%200%20%7C%7C%20n%20%3C%202%29%20return%20%2Bvalueof%28values%5B0%5D%2C%200%2C%20values%29%3B%0A%20%20if%20%28p%20%3E%3D%201%29%20return%20%2Bvalueof%28values%5Bn%20%2D%201%5D%2C%20n%20%2D%201%2C%20values%29%3B%0A%20%20var%20n%2C%0A%20%20%20%20%20%20i%20%3D%20%28n%20%2D%201%29%20%2A%20p%2C%0A%20%20%20%20%20%20i0%20%3D%20Math%2Efloor%28i%29%2C%0A%20%20%20%20%20%20value0%20%3D%20%2Bvalueof%28values%5Bi0%5D%2C%20i0%2C%20values%29%2C%0A%20%20%20%20%20%20value1%20%3D%20%2Bvalueof%28values%5Bi0%20%2B%201%5D%2C%20i0%20%2B%201%2C%20values%29%3B%0A%20%20return%20value0%20%2B%20%28value1%20%2D%20value0%29%20%2A%20%28i%20%2D%20i0%29%3B%0A%7D%0A%0Afunction%20freedmanDiaconis%28values%2C%20min%2C%20max%29%20%7B%0A%20%20values%20%3D%20map%2Ecall%28values%2C%20number%29%2Esort%28ascending%29%3B%0A%20%20return%20Math%2Eceil%28%28max%20%2D%20min%29%20%2F%20%282%20%2A%20%28threshold%28values%2C%200%2E75%29%20%2D%20threshold%28values%2C%200%2E25%29%29%20%2A%20Math%2Epow%28values%2Elength%2C%20%2D1%20%2F%203%29%29%29%3B%0A%7D%0A%0Afunction%20scott%28values%2C%20min%2C%20max%29%20%7B%0A%20%20return%20Math%2Eceil%28%28max%20%2D%20min%29%20%2F%20%283%2E5%20%2A%20deviation%28values%29%20%2A%20Math%2Epow%28values%2Elength%2C%20%2D1%20%2F%203%29%29%29%3B%0A%7D%0A%0Afunction%20max%28values%2C%20valueof%29%20%7B%0A%20%20var%20n%20%3D%20values%2Elength%2C%0A%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20value%2C%0A%20%20%20%20%20%20max%3B%0A%0A%20%20if%20%28valueof%20%3D%3D%20null%29%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%20%2F%2F%20Find%20the%20first%20comparable%20value%2E%0A%20%20%20%20%20%20if%20%28%28value%20%3D%20values%5Bi%5D%29%20%21%3D%20null%20%26%26%20value%20%3E%3D%20value%29%20%7B%0A%20%20%20%20%20%20%20%20max%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%20%2F%2F%20Compare%20the%20remaining%20values%2E%0A%20%20%20%20%20%20%20%20%20%20if%20%28%28value%20%3D%20values%5Bi%5D%29%20%21%3D%20null%20%26%26%20value%20%3E%20max%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20max%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20else%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%20%2F%2F%20Find%20the%20first%20comparable%20value%2E%0A%20%20%20%20%20%20if%20%28%28value%20%3D%20valueof%28values%5Bi%5D%2C%20i%2C%20values%29%29%20%21%3D%20null%20%26%26%20value%20%3E%3D%20value%29%20%7B%0A%20%20%20%20%20%20%20%20max%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%20%2F%2F%20Compare%20the%20remaining%20values%2E%0A%20%20%20%20%20%20%20%20%20%20if%20%28%28value%20%3D%20valueof%28values%5Bi%5D%2C%20i%2C%20values%29%29%20%21%3D%20null%20%26%26%20value%20%3E%20max%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20max%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20max%3B%0A%7D%0A%0Afunction%20mean%28values%2C%20valueof%29%20%7B%0A%20%20var%20n%20%3D%20values%2Elength%2C%0A%20%20%20%20%20%20m%20%3D%20n%2C%0A%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20value%2C%0A%20%20%20%20%20%20sum%20%3D%200%3B%0A%0A%20%20if%20%28valueof%20%3D%3D%20null%29%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20if%20%28%21isNaN%28value%20%3D%20number%28values%5Bi%5D%29%29%29%20sum%20%2B%3D%20value%3B%0A%20%20%20%20%20%20else%20%2D%2Dm%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20else%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20if%20%28%21isNaN%28value%20%3D%20number%28valueof%28values%5Bi%5D%2C%20i%2C%20values%29%29%29%29%20sum%20%2B%3D%20value%3B%0A%20%20%20%20%20%20else%20%2D%2Dm%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20if%20%28m%29%20return%20sum%20%2F%20m%3B%0A%7D%0A%0Afunction%20median%28values%2C%20valueof%29%20%7B%0A%20%20var%20n%20%3D%20values%2Elength%2C%0A%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20value%2C%0A%20%20%20%20%20%20numbers%20%3D%20%5B%5D%3B%0A%0A%20%20if%20%28valueof%20%3D%3D%20null%29%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20if%20%28%21isNaN%28value%20%3D%20number%28values%5Bi%5D%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20numbers%2Epush%28value%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20else%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20if%20%28%21isNaN%28value%20%3D%20number%28valueof%28values%5Bi%5D%2C%20i%2C%20values%29%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20numbers%2Epush%28value%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20threshold%28numbers%2Esort%28ascending%29%2C%200%2E5%29%3B%0A%7D%0A%0Afunction%20merge%28arrays%29%20%7B%0A%20%20var%20n%20%3D%20arrays%2Elength%2C%0A%20%20%20%20%20%20m%2C%0A%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20j%20%3D%200%2C%0A%20%20%20%20%20%20merged%2C%0A%20%20%20%20%20%20array%3B%0A%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20j%20%2B%3D%20arrays%5Bi%5D%2Elength%3B%0A%20%20merged%20%3D%20new%20Array%28j%29%3B%0A%0A%20%20while%20%28%2D%2Dn%20%3E%3D%200%29%20%7B%0A%20%20%20%20array%20%3D%20arrays%5Bn%5D%3B%0A%20%20%20%20m%20%3D%20array%2Elength%3B%0A%20%20%20%20while%20%28%2D%2Dm%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20merged%5B%2D%2Dj%5D%20%3D%20array%5Bm%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20merged%3B%0A%7D%0A%0Afunction%20min%28values%2C%20valueof%29%20%7B%0A%20%20var%20n%20%3D%20values%2Elength%2C%0A%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20value%2C%0A%20%20%20%20%20%20min%3B%0A%0A%20%20if%20%28valueof%20%3D%3D%20null%29%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%20%2F%2F%20Find%20the%20first%20comparable%20value%2E%0A%20%20%20%20%20%20if%20%28%28value%20%3D%20values%5Bi%5D%29%20%21%3D%20null%20%26%26%20value%20%3E%3D%20value%29%20%7B%0A%20%20%20%20%20%20%20%20min%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%20%2F%2F%20Compare%20the%20remaining%20values%2E%0A%20%20%20%20%20%20%20%20%20%20if%20%28%28value%20%3D%20values%5Bi%5D%29%20%21%3D%20null%20%26%26%20min%20%3E%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20min%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20else%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%20%2F%2F%20Find%20the%20first%20comparable%20value%2E%0A%20%20%20%20%20%20if%20%28%28value%20%3D%20valueof%28values%5Bi%5D%2C%20i%2C%20values%29%29%20%21%3D%20null%20%26%26%20value%20%3E%3D%20value%29%20%7B%0A%20%20%20%20%20%20%20%20min%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%20%2F%2F%20Compare%20the%20remaining%20values%2E%0A%20%20%20%20%20%20%20%20%20%20if%20%28%28value%20%3D%20valueof%28values%5Bi%5D%2C%20i%2C%20values%29%29%20%21%3D%20null%20%26%26%20min%20%3E%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20min%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20min%3B%0A%7D%0A%0Afunction%20permute%28array%2C%20indexes%29%20%7B%0A%20%20var%20i%20%3D%20indexes%2Elength%2C%20permutes%20%3D%20new%20Array%28i%29%3B%0A%20%20while%20%28i%2D%2D%29%20permutes%5Bi%5D%20%3D%20array%5Bindexes%5Bi%5D%5D%3B%0A%20%20return%20permutes%3B%0A%7D%0A%0Afunction%20scan%28values%2C%20compare%29%20%7B%0A%20%20if%20%28%21%28n%20%3D%20values%2Elength%29%29%20return%3B%0A%20%20var%20n%2C%0A%20%20%20%20%20%20i%20%3D%200%2C%0A%20%20%20%20%20%20j%20%3D%200%2C%0A%20%20%20%20%20%20xi%2C%0A%20%20%20%20%20%20xj%20%3D%20values%5Bj%5D%3B%0A%0A%20%20if%20%28compare%20%3D%3D%20null%29%20compare%20%3D%20ascending%3B%0A%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20if%20%28compare%28xi%20%3D%20values%5Bi%5D%2C%20xj%29%20%3C%200%20%7C%7C%20compare%28xj%2C%20xj%29%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20xj%20%3D%20xi%2C%20j%20%3D%20i%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20if%20%28compare%28xj%2C%20xj%29%20%3D%3D%3D%200%29%20return%20j%3B%0A%7D%0A%0Afunction%20shuffle%28array%2C%20i0%2C%20i1%29%20%7B%0A%20%20var%20m%20%3D%20%28i1%20%3D%3D%20null%20%3F%20array%2Elength%20%3A%20i1%29%20%2D%20%28i0%20%3D%20i0%20%3D%3D%20null%20%3F%200%20%3A%20%2Bi0%29%2C%0A%20%20%20%20%20%20t%2C%0A%20%20%20%20%20%20i%3B%0A%0A%20%20while%20%28m%29%20%7B%0A%20%20%20%20i%20%3D%20Math%2Erandom%28%29%20%2A%20m%2D%2D%20%7C%200%3B%0A%20%20%20%20t%20%3D%20array%5Bm%20%2B%20i0%5D%3B%0A%20%20%20%20array%5Bm%20%2B%20i0%5D%20%3D%20array%5Bi%20%2B%20i0%5D%3B%0A%20%20%20%20array%5Bi%20%2B%20i0%5D%20%3D%20t%3B%0A%20%20%7D%0A%0A%20%20return%20array%3B%0A%7D%0A%0Afunction%20sum%28values%2C%20valueof%29%20%7B%0A%20%20var%20n%20%3D%20values%2Elength%2C%0A%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20value%2C%0A%20%20%20%20%20%20sum%20%3D%200%3B%0A%0A%20%20if%20%28valueof%20%3D%3D%20null%29%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20if%20%28value%20%3D%20%2Bvalues%5Bi%5D%29%20sum%20%2B%3D%20value%3B%20%2F%2F%20Note%3A%20zero%20and%20null%20are%20equivalent%2E%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20else%20%7B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20if%20%28value%20%3D%20%2Bvalueof%28values%5Bi%5D%2C%20i%2C%20values%29%29%20sum%20%2B%3D%20value%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20sum%3B%0A%7D%0A%0Afunction%20transpose%28matrix%29%20%7B%0A%20%20if%20%28%21%28n%20%3D%20matrix%2Elength%29%29%20return%20%5B%5D%3B%0A%20%20for%20%28var%20i%20%3D%20%2D1%2C%20m%20%3D%20min%28matrix%2C%20length%29%2C%20transpose%20%3D%20new%20Array%28m%29%3B%20%2B%2Bi%20%3C%20m%3B%29%20%7B%0A%20%20%20%20for%20%28var%20j%20%3D%20%2D1%2C%20n%2C%20row%20%3D%20transpose%5Bi%5D%20%3D%20new%20Array%28n%29%3B%20%2B%2Bj%20%3C%20n%3B%29%20%7B%0A%20%20%20%20%20%20row%5Bj%5D%20%3D%20matrix%5Bj%5D%5Bi%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20transpose%3B%0A%7D%0A%0Afunction%20length%28d%29%20%7B%0A%20%20return%20d%2Elength%3B%0A%7D%0A%0Afunction%20zip%28%29%20%7B%0A%20%20return%20transpose%28arguments%29%3B%0A%7D%0A%0Avar%20slice%241%20%3D%20Array%2Eprototype%2Eslice%3B%0A%0Afunction%20identity%241%28x%29%20%7B%0A%20%20return%20x%3B%0A%7D%0A%0Avar%20top%20%3D%201%2C%0A%20%20%20%20right%20%3D%202%2C%0A%20%20%20%20bottom%20%3D%203%2C%0A%20%20%20%20left%20%3D%204%2C%0A%20%20%20%20epsilon%20%3D%201e%2D6%3B%0A%0Afunction%20translateX%28x%29%20%7B%0A%20%20return%20%22translate%28%22%20%2B%20%28x%20%2B%200%2E5%29%20%2B%20%22%2C0%29%22%3B%0A%7D%0A%0Afunction%20translateY%28y%29%20%7B%0A%20%20return%20%22translate%280%2C%22%20%2B%20%28y%20%2B%200%2E5%29%20%2B%20%22%29%22%3B%0A%7D%0A%0Afunction%20number%241%28scale%29%20%7B%0A%20%20return%20function%28d%29%20%7B%0A%20%20%20%20return%20%2Bscale%28d%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20center%28scale%29%20%7B%0A%20%20var%20offset%20%3D%20Math%2Emax%280%2C%20scale%2Ebandwidth%28%29%20%2D%201%29%20%2F%202%3B%20%2F%2F%20Adjust%20for%200%2E5px%20offset%2E%0A%20%20if%20%28scale%2Eround%28%29%29%20offset%20%3D%20Math%2Eround%28offset%29%3B%0A%20%20return%20function%28d%29%20%7B%0A%20%20%20%20return%20%2Bscale%28d%29%20%2B%20offset%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20entering%28%29%20%7B%0A%20%20return%20%21this%2E%5F%5Faxis%3B%0A%7D%0A%0Afunction%20axis%28orient%2C%20scale%29%20%7B%0A%20%20var%20tickArguments%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20tickValues%20%3D%20null%2C%0A%20%20%20%20%20%20tickFormat%20%3D%20null%2C%0A%20%20%20%20%20%20tickSizeInner%20%3D%206%2C%0A%20%20%20%20%20%20tickSizeOuter%20%3D%206%2C%0A%20%20%20%20%20%20tickPadding%20%3D%203%2C%0A%20%20%20%20%20%20k%20%3D%20orient%20%3D%3D%3D%20top%20%7C%7C%20orient%20%3D%3D%3D%20left%20%3F%20%2D1%20%3A%201%2C%0A%20%20%20%20%20%20x%20%3D%20orient%20%3D%3D%3D%20left%20%7C%7C%20orient%20%3D%3D%3D%20right%20%3F%20%22x%22%20%3A%20%22y%22%2C%0A%20%20%20%20%20%20transform%20%3D%20orient%20%3D%3D%3D%20top%20%7C%7C%20orient%20%3D%3D%3D%20bottom%20%3F%20translateX%20%3A%20translateY%3B%0A%0A%20%20function%20axis%28context%29%20%7B%0A%20%20%20%20var%20values%20%3D%20tickValues%20%3D%3D%20null%20%3F%20%28scale%2Eticks%20%3F%20scale%2Eticks%2Eapply%28scale%2C%20tickArguments%29%20%3A%20scale%2Edomain%28%29%29%20%3A%20tickValues%2C%0A%20%20%20%20%20%20%20%20format%20%3D%20tickFormat%20%3D%3D%20null%20%3F%20%28scale%2EtickFormat%20%3F%20scale%2EtickFormat%2Eapply%28scale%2C%20tickArguments%29%20%3A%20identity%241%29%20%3A%20tickFormat%2C%0A%20%20%20%20%20%20%20%20spacing%20%3D%20Math%2Emax%28tickSizeInner%2C%200%29%20%2B%20tickPadding%2C%0A%20%20%20%20%20%20%20%20range%20%3D%20scale%2Erange%28%29%2C%0A%20%20%20%20%20%20%20%20range0%20%3D%20%2Brange%5B0%5D%20%2B%200%2E5%2C%0A%20%20%20%20%20%20%20%20range1%20%3D%20%2Brange%5Brange%2Elength%20%2D%201%5D%20%2B%200%2E5%2C%0A%20%20%20%20%20%20%20%20position%20%3D%20%28scale%2Ebandwidth%20%3F%20center%20%3A%20number%241%29%28scale%2Ecopy%28%29%29%2C%0A%20%20%20%20%20%20%20%20selection%20%3D%20context%2Eselection%20%3F%20context%2Eselection%28%29%20%3A%20context%2C%0A%20%20%20%20%20%20%20%20path%20%3D%20selection%2EselectAll%28%22%2Edomain%22%29%2Edata%28%5Bnull%5D%29%2C%0A%20%20%20%20%20%20%20%20tick%20%3D%20selection%2EselectAll%28%22%2Etick%22%29%2Edata%28values%2C%20scale%29%2Eorder%28%29%2C%0A%20%20%20%20%20%20%20%20tickExit%20%3D%20tick%2Eexit%28%29%2C%0A%20%20%20%20%20%20%20%20tickEnter%20%3D%20tick%2Eenter%28%29%2Eappend%28%22g%22%29%2Eattr%28%22class%22%2C%20%22tick%22%29%2C%0A%20%20%20%20%20%20%20%20line%20%3D%20tick%2Eselect%28%22line%22%29%2C%0A%20%20%20%20%20%20%20%20text%20%3D%20tick%2Eselect%28%22text%22%29%3B%0A%0A%20%20%20%20path%20%3D%20path%2Emerge%28path%2Eenter%28%29%2Einsert%28%22path%22%2C%20%22%2Etick%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%20%22domain%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%22%2C%20%22%23000%22%29%29%3B%0A%0A%20%20%20%20tick%20%3D%20tick%2Emerge%28tickEnter%29%3B%0A%0A%20%20%20%20line%20%3D%20line%2Emerge%28tickEnter%2Eappend%28%22line%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%22%2C%20%22%23000%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28x%20%2B%20%222%22%2C%20k%20%2A%20tickSizeInner%29%29%3B%0A%0A%20%20%20%20text%20%3D%20text%2Emerge%28tickEnter%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22%23000%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28x%2C%20k%20%2A%20spacing%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22dy%22%2C%20orient%20%3D%3D%3D%20top%20%3F%20%220em%22%20%3A%20orient%20%3D%3D%3D%20bottom%20%3F%20%220%2E71em%22%20%3A%20%220%2E32em%22%29%29%3B%0A%0A%20%20%20%20if%20%28context%20%21%3D%3D%20selection%29%20%7B%0A%20%20%20%20%20%20path%20%3D%20path%2Etransition%28context%29%3B%0A%20%20%20%20%20%20tick%20%3D%20tick%2Etransition%28context%29%3B%0A%20%20%20%20%20%20line%20%3D%20line%2Etransition%28context%29%3B%0A%20%20%20%20%20%20text%20%3D%20text%2Etransition%28context%29%3B%0A%0A%20%20%20%20%20%20tickExit%20%3D%20tickExit%2Etransition%28context%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22opacity%22%2C%20epsilon%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%29%20%7B%20return%20isFinite%28d%20%3D%20position%28d%29%29%20%3F%20transform%28d%29%20%3A%20this%2EgetAttribute%28%22transform%22%29%3B%20%7D%29%3B%0A%0A%20%20%20%20%20%20tickEnter%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22opacity%22%2C%20epsilon%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%29%20%7B%20var%20p%20%3D%20this%2EparentNode%2E%5F%5Faxis%3B%20return%20transform%28p%20%26%26%20isFinite%28p%20%3D%20p%28d%29%29%20%3F%20p%20%3A%20position%28d%29%29%3B%20%7D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20tickExit%2Eremove%28%29%3B%0A%0A%20%20%20%20path%0A%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20orient%20%3D%3D%3D%20left%20%7C%7C%20orient%20%3D%3D%20right%0A%20%20%20%20%20%20%20%20%20%20%20%20%3F%20%22M%22%20%2B%20k%20%2A%20tickSizeOuter%20%2B%20%22%2C%22%20%2B%20range0%20%2B%20%22H0%2E5V%22%20%2B%20range1%20%2B%20%22H%22%20%2B%20k%20%2A%20tickSizeOuter%0A%20%20%20%20%20%20%20%20%20%20%20%20%3A%20%22M%22%20%2B%20range0%20%2B%20%22%2C%22%20%2B%20k%20%2A%20tickSizeOuter%20%2B%20%22V0%2E5H%22%20%2B%20range1%20%2B%20%22V%22%20%2B%20k%20%2A%20tickSizeOuter%29%3B%0A%0A%20%20%20%20tick%0A%20%20%20%20%20%20%20%20%2Eattr%28%22opacity%22%2C%201%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%29%20%7B%20return%20transform%28position%28d%29%29%3B%20%7D%29%3B%0A%0A%20%20%20%20line%0A%20%20%20%20%20%20%20%20%2Eattr%28x%20%2B%20%222%22%2C%20k%20%2A%20tickSizeInner%29%3B%0A%0A%20%20%20%20text%0A%20%20%20%20%20%20%20%20%2Eattr%28x%2C%20k%20%2A%20spacing%29%0A%20%20%20%20%20%20%20%20%2Etext%28format%29%3B%0A%0A%20%20%20%20selection%2Efilter%28entering%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22none%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%2010%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22text%2Danchor%22%2C%20orient%20%3D%3D%3D%20right%20%3F%20%22start%22%20%3A%20orient%20%3D%3D%3D%20left%20%3F%20%22end%22%20%3A%20%22middle%22%29%3B%0A%0A%20%20%20%20selection%0A%20%20%20%20%20%20%20%20%2Eeach%28function%28%29%20%7B%20this%2E%5F%5Faxis%20%3D%20position%3B%20%7D%29%3B%0A%20%20%7D%0A%0A%20%20axis%2Escale%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28scale%20%3D%20%5F%2C%20axis%29%20%3A%20scale%3B%0A%20%20%7D%3B%0A%0A%20%20axis%2Eticks%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20tickArguments%20%3D%20slice%241%2Ecall%28arguments%29%2C%20axis%3B%0A%20%20%7D%3B%0A%0A%20%20axis%2EtickArguments%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28tickArguments%20%3D%20%5F%20%3D%3D%20null%20%3F%20%5B%5D%20%3A%20slice%241%2Ecall%28%5F%29%2C%20axis%29%20%3A%20tickArguments%2Eslice%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20axis%2EtickValues%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28tickValues%20%3D%20%5F%20%3D%3D%20null%20%3F%20null%20%3A%20slice%241%2Ecall%28%5F%29%2C%20axis%29%20%3A%20tickValues%20%26%26%20tickValues%2Eslice%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20axis%2EtickFormat%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28tickFormat%20%3D%20%5F%2C%20axis%29%20%3A%20tickFormat%3B%0A%20%20%7D%3B%0A%0A%20%20axis%2EtickSize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28tickSizeInner%20%3D%20tickSizeOuter%20%3D%20%2B%5F%2C%20axis%29%20%3A%20tickSizeInner%3B%0A%20%20%7D%3B%0A%0A%20%20axis%2EtickSizeInner%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28tickSizeInner%20%3D%20%2B%5F%2C%20axis%29%20%3A%20tickSizeInner%3B%0A%20%20%7D%3B%0A%0A%20%20axis%2EtickSizeOuter%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28tickSizeOuter%20%3D%20%2B%5F%2C%20axis%29%20%3A%20tickSizeOuter%3B%0A%20%20%7D%3B%0A%0A%20%20axis%2EtickPadding%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28tickPadding%20%3D%20%2B%5F%2C%20axis%29%20%3A%20tickPadding%3B%0A%20%20%7D%3B%0A%0A%20%20return%20axis%3B%0A%7D%0A%0Afunction%20axisTop%28scale%29%20%7B%0A%20%20return%20axis%28top%2C%20scale%29%3B%0A%7D%0A%0Afunction%20axisRight%28scale%29%20%7B%0A%20%20return%20axis%28right%2C%20scale%29%3B%0A%7D%0A%0Afunction%20axisBottom%28scale%29%20%7B%0A%20%20return%20axis%28bottom%2C%20scale%29%3B%0A%7D%0A%0Afunction%20axisLeft%28scale%29%20%7B%0A%20%20return%20axis%28left%2C%20scale%29%3B%0A%7D%0A%0Avar%20noop%20%3D%20%7Bvalue%3A%20function%28%29%20%7B%7D%7D%3B%0A%0Afunction%20dispatch%28%29%20%7B%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20arguments%2Elength%2C%20%5F%20%3D%20%7B%7D%2C%20t%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28%21%28t%20%3D%20arguments%5Bi%5D%20%2B%20%22%22%29%20%7C%7C%20%28t%20in%20%5F%29%29%20throw%20new%20Error%28%22illegal%20type%3A%20%22%20%2B%20t%29%3B%0A%20%20%20%20%5F%5Bt%5D%20%3D%20%5B%5D%3B%0A%20%20%7D%0A%20%20return%20new%20Dispatch%28%5F%29%3B%0A%7D%0A%0Afunction%20Dispatch%28%5F%29%20%7B%0A%20%20this%2E%5F%20%3D%20%5F%3B%0A%7D%0A%0Afunction%20parseTypenames%28typenames%2C%20types%29%20%7B%0A%20%20return%20typenames%2Etrim%28%29%2Esplit%28%2F%5E%7C%5Cs%2B%2F%29%2Emap%28function%28t%29%20%7B%0A%20%20%20%20var%20name%20%3D%20%22%22%2C%20i%20%3D%20t%2EindexOf%28%22%2E%22%29%3B%0A%20%20%20%20if%20%28i%20%3E%3D%200%29%20name%20%3D%20t%2Eslice%28i%20%2B%201%29%2C%20t%20%3D%20t%2Eslice%280%2C%20i%29%3B%0A%20%20%20%20if%20%28t%20%26%26%20%21types%2EhasOwnProperty%28t%29%29%20throw%20new%20Error%28%22unknown%20type%3A%20%22%20%2B%20t%29%3B%0A%20%20%20%20return%20%7Btype%3A%20t%2C%20name%3A%20name%7D%3B%0A%20%20%7D%29%3B%0A%7D%0A%0ADispatch%2Eprototype%20%3D%20dispatch%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20Dispatch%2C%0A%20%20on%3A%20function%28typename%2C%20callback%29%20%7B%0A%20%20%20%20var%20%5F%20%3D%20this%2E%5F%2C%0A%20%20%20%20%20%20%20%20T%20%3D%20parseTypenames%28typename%20%2B%20%22%22%2C%20%5F%29%2C%0A%20%20%20%20%20%20%20%20t%2C%0A%20%20%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20T%2Elength%3B%0A%0A%20%20%20%20%2F%2F%20If%20no%20callback%20was%20specified%2C%20return%20the%20callback%20of%20the%20given%20type%20and%20name%2E%0A%20%20%20%20if%20%28arguments%2Elength%20%3C%202%29%20%7B%0A%20%20%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20if%20%28%28t%20%3D%20%28typename%20%3D%20T%5Bi%5D%29%2Etype%29%20%26%26%20%28t%20%3D%20get%28%5F%5Bt%5D%2C%20typename%2Ename%29%29%29%20return%20t%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20If%20a%20type%20was%20specified%2C%20set%20the%20callback%20for%20the%20given%20type%20and%20name%2E%0A%20%20%20%20%2F%2F%20Otherwise%2C%20if%20a%20null%20callback%20was%20specified%2C%20remove%20callbacks%20of%20the%20given%20name%2E%0A%20%20%20%20if%20%28callback%20%21%3D%20null%20%26%26%20typeof%20callback%20%21%3D%3D%20%22function%22%29%20throw%20new%20Error%28%22invalid%20callback%3A%20%22%20%2B%20callback%29%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20if%20%28t%20%3D%20%28typename%20%3D%20T%5Bi%5D%29%2Etype%29%20%5F%5Bt%5D%20%3D%20set%28%5F%5Bt%5D%2C%20typename%2Ename%2C%20callback%29%3B%0A%20%20%20%20%20%20else%20if%20%28callback%20%3D%3D%20null%29%20for%20%28t%20in%20%5F%29%20%5F%5Bt%5D%20%3D%20set%28%5F%5Bt%5D%2C%20typename%2Ename%2C%20null%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20this%3B%0A%20%20%7D%2C%0A%20%20copy%3A%20function%28%29%20%7B%0A%20%20%20%20var%20copy%20%3D%20%7B%7D%2C%20%5F%20%3D%20this%2E%5F%3B%0A%20%20%20%20for%20%28var%20t%20in%20%5F%29%20copy%5Bt%5D%20%3D%20%5F%5Bt%5D%2Eslice%28%29%3B%0A%20%20%20%20return%20new%20Dispatch%28copy%29%3B%0A%20%20%7D%2C%0A%20%20call%3A%20function%28type%2C%20that%29%20%7B%0A%20%20%20%20if%20%28%28n%20%3D%20arguments%2Elength%20%2D%202%29%20%3E%200%29%20for%20%28var%20args%20%3D%20new%20Array%28n%29%2C%20i%20%3D%200%2C%20n%2C%20t%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20args%5Bi%5D%20%3D%20arguments%5Bi%20%2B%202%5D%3B%0A%20%20%20%20if%20%28%21this%2E%5F%2EhasOwnProperty%28type%29%29%20throw%20new%20Error%28%22unknown%20type%3A%20%22%20%2B%20type%29%3B%0A%20%20%20%20for%20%28t%20%3D%20this%2E%5F%5Btype%5D%2C%20i%20%3D%200%2C%20n%20%3D%20t%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20t%5Bi%5D%2Evalue%2Eapply%28that%2C%20args%29%3B%0A%20%20%7D%2C%0A%20%20apply%3A%20function%28type%2C%20that%2C%20args%29%20%7B%0A%20%20%20%20if%20%28%21this%2E%5F%2EhasOwnProperty%28type%29%29%20throw%20new%20Error%28%22unknown%20type%3A%20%22%20%2B%20type%29%3B%0A%20%20%20%20for%20%28var%20t%20%3D%20this%2E%5F%5Btype%5D%2C%20i%20%3D%200%2C%20n%20%3D%20t%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20t%5Bi%5D%2Evalue%2Eapply%28that%2C%20args%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20get%28type%2C%20name%29%20%7B%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20type%2Elength%2C%20c%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28%28c%20%3D%20type%5Bi%5D%29%2Ename%20%3D%3D%3D%20name%29%20%7B%0A%20%20%20%20%20%20return%20c%2Evalue%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Afunction%20set%28type%2C%20name%2C%20callback%29%20%7B%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20type%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28type%5Bi%5D%2Ename%20%3D%3D%3D%20name%29%20%7B%0A%20%20%20%20%20%20type%5Bi%5D%20%3D%20noop%2C%20type%20%3D%20type%2Eslice%280%2C%20i%29%2Econcat%28type%2Eslice%28i%20%2B%201%29%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20if%20%28callback%20%21%3D%20null%29%20type%2Epush%28%7Bname%3A%20name%2C%20value%3A%20callback%7D%29%3B%0A%20%20return%20type%3B%0A%7D%0A%0Avar%20xhtml%20%3D%20%22http%3A%2F%2Fwww%2Ew3%2Eorg%2F1999%2Fxhtml%22%3B%0A%0Avar%20namespaces%20%3D%20%7B%0A%20%20svg%3A%20%22http%3A%2F%2Fwww%2Ew3%2Eorg%2F2000%2Fsvg%22%2C%0A%20%20xhtml%3A%20xhtml%2C%0A%20%20xlink%3A%20%22http%3A%2F%2Fwww%2Ew3%2Eorg%2F1999%2Fxlink%22%2C%0A%20%20xml%3A%20%22http%3A%2F%2Fwww%2Ew3%2Eorg%2FXML%2F1998%2Fnamespace%22%2C%0A%20%20xmlns%3A%20%22http%3A%2F%2Fwww%2Ew3%2Eorg%2F2000%2Fxmlns%2F%22%0A%7D%3B%0A%0Afunction%20namespace%28name%29%20%7B%0A%20%20var%20prefix%20%3D%20name%20%2B%3D%20%22%22%2C%20i%20%3D%20prefix%2EindexOf%28%22%3A%22%29%3B%0A%20%20if%20%28i%20%3E%3D%200%20%26%26%20%28prefix%20%3D%20name%2Eslice%280%2C%20i%29%29%20%21%3D%3D%20%22xmlns%22%29%20name%20%3D%20name%2Eslice%28i%20%2B%201%29%3B%0A%20%20return%20namespaces%2EhasOwnProperty%28prefix%29%20%3F%20%7Bspace%3A%20namespaces%5Bprefix%5D%2C%20local%3A%20name%7D%20%3A%20name%3B%0A%7D%0A%0Afunction%20creatorInherit%28name%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20document%20%3D%20this%2EownerDocument%2C%0A%20%20%20%20%20%20%20%20uri%20%3D%20this%2EnamespaceURI%3B%0A%20%20%20%20return%20uri%20%3D%3D%3D%20xhtml%20%26%26%20document%2EdocumentElement%2EnamespaceURI%20%3D%3D%3D%20xhtml%0A%20%20%20%20%20%20%20%20%3F%20document%2EcreateElement%28name%29%0A%20%20%20%20%20%20%20%20%3A%20document%2EcreateElementNS%28uri%2C%20name%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20creatorFixed%28fullname%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20this%2EownerDocument%2EcreateElementNS%28fullname%2Espace%2C%20fullname%2Elocal%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20creator%28name%29%20%7B%0A%20%20var%20fullname%20%3D%20namespace%28name%29%3B%0A%20%20return%20%28fullname%2Elocal%0A%20%20%20%20%20%20%3F%20creatorFixed%0A%20%20%20%20%20%20%3A%20creatorInherit%29%28fullname%29%3B%0A%7D%0A%0Afunction%20none%28%29%20%7B%7D%0A%0Afunction%20selector%28selector%29%20%7B%0A%20%20return%20selector%20%3D%3D%20null%20%3F%20none%20%3A%20function%28%29%20%7B%0A%20%20%20%20return%20this%2EquerySelector%28selector%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20selection%5Fselect%28select%29%20%7B%0A%20%20if%20%28typeof%20select%20%21%3D%3D%20%22function%22%29%20select%20%3D%20selector%28select%29%3B%0A%0A%20%20for%20%28var%20groups%20%3D%20this%2E%5Fgroups%2C%20m%20%3D%20groups%2Elength%2C%20subgroups%20%3D%20new%20Array%28m%29%2C%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20group%20%3D%20groups%5Bj%5D%2C%20n%20%3D%20group%2Elength%2C%20subgroup%20%3D%20subgroups%5Bj%5D%20%3D%20new%20Array%28n%29%2C%20node%2C%20subnode%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28%28node%20%3D%20group%5Bi%5D%29%20%26%26%20%28subnode%20%3D%20select%2Ecall%28node%2C%20node%2E%5F%5Fdata%5F%5F%2C%20i%2C%20group%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%22%5F%5Fdata%5F%5F%22%20in%20node%29%20subnode%2E%5F%5Fdata%5F%5F%20%3D%20node%2E%5F%5Fdata%5F%5F%3B%0A%20%20%20%20%20%20%20%20subgroup%5Bi%5D%20%3D%20subnode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20new%20Selection%28subgroups%2C%20this%2E%5Fparents%29%3B%0A%7D%0A%0Afunction%20empty%28%29%20%7B%0A%20%20return%20%5B%5D%3B%0A%7D%0A%0Afunction%20selectorAll%28selector%29%20%7B%0A%20%20return%20selector%20%3D%3D%20null%20%3F%20empty%20%3A%20function%28%29%20%7B%0A%20%20%20%20return%20this%2EquerySelectorAll%28selector%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20selection%5FselectAll%28select%29%20%7B%0A%20%20if%20%28typeof%20select%20%21%3D%3D%20%22function%22%29%20select%20%3D%20selectorAll%28select%29%3B%0A%0A%20%20for%20%28var%20groups%20%3D%20this%2E%5Fgroups%2C%20m%20%3D%20groups%2Elength%2C%20subgroups%20%3D%20%5B%5D%2C%20parents%20%3D%20%5B%5D%2C%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20group%20%3D%20groups%5Bj%5D%2C%20n%20%3D%20group%2Elength%2C%20node%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28node%20%3D%20group%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20subgroups%2Epush%28select%2Ecall%28node%2C%20node%2E%5F%5Fdata%5F%5F%2C%20i%2C%20group%29%29%3B%0A%20%20%20%20%20%20%20%20parents%2Epush%28node%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20new%20Selection%28subgroups%2C%20parents%29%3B%0A%7D%0A%0Avar%20matcher%20%3D%20function%28selector%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20this%2Ematches%28selector%29%3B%0A%20%20%7D%3B%0A%7D%3B%0A%0Aif%20%28typeof%20document%20%21%3D%3D%20%22undefined%22%29%20%7B%0A%20%20var%20element%20%3D%20document%2EdocumentElement%3B%0A%20%20if%20%28%21element%2Ematches%29%20%7B%0A%20%20%20%20var%20vendorMatches%20%3D%20element%2EwebkitMatchesSelector%0A%20%20%20%20%20%20%20%20%7C%7C%20element%2EmsMatchesSelector%0A%20%20%20%20%20%20%20%20%7C%7C%20element%2EmozMatchesSelector%0A%20%20%20%20%20%20%20%20%7C%7C%20element%2EoMatchesSelector%3B%0A%20%20%20%20matcher%20%3D%20function%28selector%29%20%7B%0A%20%20%20%20%20%20return%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20return%20vendorMatches%2Ecall%28this%2C%20selector%29%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%0A%0Avar%20matcher%241%20%3D%20matcher%3B%0A%0Afunction%20selection%5Ffilter%28match%29%20%7B%0A%20%20if%20%28typeof%20match%20%21%3D%3D%20%22function%22%29%20match%20%3D%20matcher%241%28match%29%3B%0A%0A%20%20for%20%28var%20groups%20%3D%20this%2E%5Fgroups%2C%20m%20%3D%20groups%2Elength%2C%20subgroups%20%3D%20new%20Array%28m%29%2C%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20group%20%3D%20groups%5Bj%5D%2C%20n%20%3D%20group%2Elength%2C%20subgroup%20%3D%20subgroups%5Bj%5D%20%3D%20%5B%5D%2C%20node%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28%28node%20%3D%20group%5Bi%5D%29%20%26%26%20match%2Ecall%28node%2C%20node%2E%5F%5Fdata%5F%5F%2C%20i%2C%20group%29%29%20%7B%0A%20%20%20%20%20%20%20%20subgroup%2Epush%28node%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20new%20Selection%28subgroups%2C%20this%2E%5Fparents%29%3B%0A%7D%0A%0Afunction%20sparse%28update%29%20%7B%0A%20%20return%20new%20Array%28update%2Elength%29%3B%0A%7D%0A%0Afunction%20selection%5Fenter%28%29%20%7B%0A%20%20return%20new%20Selection%28this%2E%5Fenter%20%7C%7C%20this%2E%5Fgroups%2Emap%28sparse%29%2C%20this%2E%5Fparents%29%3B%0A%7D%0A%0Afunction%20EnterNode%28parent%2C%20datum%29%20%7B%0A%20%20this%2EownerDocument%20%3D%20parent%2EownerDocument%3B%0A%20%20this%2EnamespaceURI%20%3D%20parent%2EnamespaceURI%3B%0A%20%20this%2E%5Fnext%20%3D%20null%3B%0A%20%20this%2E%5Fparent%20%3D%20parent%3B%0A%20%20this%2E%5F%5Fdata%5F%5F%20%3D%20datum%3B%0A%7D%0A%0AEnterNode%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20EnterNode%2C%0A%20%20appendChild%3A%20function%28child%29%20%7B%20return%20this%2E%5Fparent%2EinsertBefore%28child%2C%20this%2E%5Fnext%29%3B%20%7D%2C%0A%20%20insertBefore%3A%20function%28child%2C%20next%29%20%7B%20return%20this%2E%5Fparent%2EinsertBefore%28child%2C%20next%29%3B%20%7D%2C%0A%20%20querySelector%3A%20function%28selector%29%20%7B%20return%20this%2E%5Fparent%2EquerySelector%28selector%29%3B%20%7D%2C%0A%20%20querySelectorAll%3A%20function%28selector%29%20%7B%20return%20this%2E%5Fparent%2EquerySelectorAll%28selector%29%3B%20%7D%0A%7D%3B%0A%0Afunction%20constant%241%28x%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Avar%20keyPrefix%20%3D%20%22%24%22%3B%20%2F%2F%20Protect%20against%20keys%20like%20%E2%80%9C%5F%5Fproto%5F%5F%E2%80%9D%2E%0A%0Afunction%20bindIndex%28parent%2C%20group%2C%20enter%2C%20update%2C%20exit%2C%20data%29%20%7B%0A%20%20var%20i%20%3D%200%2C%0A%20%20%20%20%20%20node%2C%0A%20%20%20%20%20%20groupLength%20%3D%20group%2Elength%2C%0A%20%20%20%20%20%20dataLength%20%3D%20data%2Elength%3B%0A%0A%20%20%2F%2F%20Put%20any%20non%2Dnull%20nodes%20that%20fit%20into%20update%2E%0A%20%20%2F%2F%20Put%20any%20null%20nodes%20into%20enter%2E%0A%20%20%2F%2F%20Put%20any%20remaining%20data%20into%20enter%2E%0A%20%20for%20%28%3B%20i%20%3C%20dataLength%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28node%20%3D%20group%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20node%2E%5F%5Fdata%5F%5F%20%3D%20data%5Bi%5D%3B%0A%20%20%20%20%20%20update%5Bi%5D%20%3D%20node%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20enter%5Bi%5D%20%3D%20new%20EnterNode%28parent%2C%20data%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20Put%20any%20non%2Dnull%20nodes%20that%20don%E2%80%99t%20fit%20into%20exit%2E%0A%20%20for%20%28%3B%20i%20%3C%20groupLength%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28node%20%3D%20group%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20exit%5Bi%5D%20%3D%20node%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Afunction%20bindKey%28parent%2C%20group%2C%20enter%2C%20update%2C%20exit%2C%20data%2C%20key%29%20%7B%0A%20%20var%20i%2C%0A%20%20%20%20%20%20node%2C%0A%20%20%20%20%20%20nodeByKeyValue%20%3D%20%7B%7D%2C%0A%20%20%20%20%20%20groupLength%20%3D%20group%2Elength%2C%0A%20%20%20%20%20%20dataLength%20%3D%20data%2Elength%2C%0A%20%20%20%20%20%20keyValues%20%3D%20new%20Array%28groupLength%29%2C%0A%20%20%20%20%20%20keyValue%3B%0A%0A%20%20%2F%2F%20Compute%20the%20key%20for%20each%20node%2E%0A%20%20%2F%2F%20If%20multiple%20nodes%20have%20the%20same%20key%2C%20the%20duplicates%20are%20added%20to%20exit%2E%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20groupLength%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28node%20%3D%20group%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20keyValues%5Bi%5D%20%3D%20keyValue%20%3D%20keyPrefix%20%2B%20key%2Ecall%28node%2C%20node%2E%5F%5Fdata%5F%5F%2C%20i%2C%20group%29%3B%0A%20%20%20%20%20%20if%20%28keyValue%20in%20nodeByKeyValue%29%20%7B%0A%20%20%20%20%20%20%20%20exit%5Bi%5D%20%3D%20node%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20nodeByKeyValue%5BkeyValue%5D%20%3D%20node%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20Compute%20the%20key%20for%20each%20datum%2E%0A%20%20%2F%2F%20If%20there%20a%20node%20associated%20with%20this%20key%2C%20join%20and%20add%20it%20to%20update%2E%0A%20%20%2F%2F%20If%20there%20is%20not%20%28or%20the%20key%20is%20a%20duplicate%29%2C%20add%20it%20to%20enter%2E%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20dataLength%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20keyValue%20%3D%20keyPrefix%20%2B%20key%2Ecall%28parent%2C%20data%5Bi%5D%2C%20i%2C%20data%29%3B%0A%20%20%20%20if%20%28node%20%3D%20nodeByKeyValue%5BkeyValue%5D%29%20%7B%0A%20%20%20%20%20%20update%5Bi%5D%20%3D%20node%3B%0A%20%20%20%20%20%20node%2E%5F%5Fdata%5F%5F%20%3D%20data%5Bi%5D%3B%0A%20%20%20%20%20%20nodeByKeyValue%5BkeyValue%5D%20%3D%20null%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20enter%5Bi%5D%20%3D%20new%20EnterNode%28parent%2C%20data%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20Add%20any%20remaining%20nodes%20that%20were%20not%20bound%20to%20data%20to%20exit%2E%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20groupLength%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28%28node%20%3D%20group%5Bi%5D%29%20%26%26%20%28nodeByKeyValue%5BkeyValues%5Bi%5D%5D%20%3D%3D%3D%20node%29%29%20%7B%0A%20%20%20%20%20%20exit%5Bi%5D%20%3D%20node%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Afunction%20selection%5Fdata%28value%2C%20key%29%20%7B%0A%20%20if%20%28%21value%29%20%7B%0A%20%20%20%20data%20%3D%20new%20Array%28this%2Esize%28%29%29%2C%20j%20%3D%20%2D1%3B%0A%20%20%20%20this%2Eeach%28function%28d%29%20%7B%20data%5B%2B%2Bj%5D%20%3D%20d%3B%20%7D%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%0A%20%20var%20bind%20%3D%20key%20%3F%20bindKey%20%3A%20bindIndex%2C%0A%20%20%20%20%20%20parents%20%3D%20this%2E%5Fparents%2C%0A%20%20%20%20%20%20groups%20%3D%20this%2E%5Fgroups%3B%0A%0A%20%20if%20%28typeof%20value%20%21%3D%3D%20%22function%22%29%20value%20%3D%20constant%241%28value%29%3B%0A%0A%20%20for%20%28var%20m%20%3D%20groups%2Elength%2C%20update%20%3D%20new%20Array%28m%29%2C%20enter%20%3D%20new%20Array%28m%29%2C%20exit%20%3D%20new%20Array%28m%29%2C%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20var%20parent%20%3D%20parents%5Bj%5D%2C%0A%20%20%20%20%20%20%20%20group%20%3D%20groups%5Bj%5D%2C%0A%20%20%20%20%20%20%20%20groupLength%20%3D%20group%2Elength%2C%0A%20%20%20%20%20%20%20%20data%20%3D%20value%2Ecall%28parent%2C%20parent%20%26%26%20parent%2E%5F%5Fdata%5F%5F%2C%20j%2C%20parents%29%2C%0A%20%20%20%20%20%20%20%20dataLength%20%3D%20data%2Elength%2C%0A%20%20%20%20%20%20%20%20enterGroup%20%3D%20enter%5Bj%5D%20%3D%20new%20Array%28dataLength%29%2C%0A%20%20%20%20%20%20%20%20updateGroup%20%3D%20update%5Bj%5D%20%3D%20new%20Array%28dataLength%29%2C%0A%20%20%20%20%20%20%20%20exitGroup%20%3D%20exit%5Bj%5D%20%3D%20new%20Array%28groupLength%29%3B%0A%0A%20%20%20%20bind%28parent%2C%20group%2C%20enterGroup%2C%20updateGroup%2C%20exitGroup%2C%20data%2C%20key%29%3B%0A%0A%20%20%20%20%2F%2F%20Now%20connect%20the%20enter%20nodes%20to%20their%20following%20update%20node%2C%20such%20that%0A%20%20%20%20%2F%2F%20appendChild%20can%20insert%20the%20materialized%20enter%20node%20before%20this%20node%2C%0A%20%20%20%20%2F%2F%20rather%20than%20at%20the%20end%20of%20the%20parent%20node%2E%0A%20%20%20%20for%20%28var%20i0%20%3D%200%2C%20i1%20%3D%200%2C%20previous%2C%20next%3B%20i0%20%3C%20dataLength%3B%20%2B%2Bi0%29%20%7B%0A%20%20%20%20%20%20if%20%28previous%20%3D%20enterGroup%5Bi0%5D%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28i0%20%3E%3D%20i1%29%20i1%20%3D%20i0%20%2B%201%3B%0A%20%20%20%20%20%20%20%20while%20%28%21%28next%20%3D%20updateGroup%5Bi1%5D%29%20%26%26%20%2B%2Bi1%20%3C%20dataLength%29%3B%0A%20%20%20%20%20%20%20%20previous%2E%5Fnext%20%3D%20next%20%7C%7C%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20update%20%3D%20new%20Selection%28update%2C%20parents%29%3B%0A%20%20update%2E%5Fenter%20%3D%20enter%3B%0A%20%20update%2E%5Fexit%20%3D%20exit%3B%0A%20%20return%20update%3B%0A%7D%0A%0Afunction%20selection%5Fexit%28%29%20%7B%0A%20%20return%20new%20Selection%28this%2E%5Fexit%20%7C%7C%20this%2E%5Fgroups%2Emap%28sparse%29%2C%20this%2E%5Fparents%29%3B%0A%7D%0A%0Afunction%20selection%5Fmerge%28selection%24%241%29%20%7B%0A%0A%20%20for%20%28var%20groups0%20%3D%20this%2E%5Fgroups%2C%20groups1%20%3D%20selection%24%241%2E%5Fgroups%2C%20m0%20%3D%20groups0%2Elength%2C%20m1%20%3D%20groups1%2Elength%2C%20m%20%3D%20Math%2Emin%28m0%2C%20m1%29%2C%20merges%20%3D%20new%20Array%28m0%29%2C%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20group0%20%3D%20groups0%5Bj%5D%2C%20group1%20%3D%20groups1%5Bj%5D%2C%20n%20%3D%20group0%2Elength%2C%20merge%20%3D%20merges%5Bj%5D%20%3D%20new%20Array%28n%29%2C%20node%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28node%20%3D%20group0%5Bi%5D%20%7C%7C%20group1%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20merge%5Bi%5D%20%3D%20node%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20for%20%28%3B%20j%20%3C%20m0%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20merges%5Bj%5D%20%3D%20groups0%5Bj%5D%3B%0A%20%20%7D%0A%0A%20%20return%20new%20Selection%28merges%2C%20this%2E%5Fparents%29%3B%0A%7D%0A%0Afunction%20selection%5Forder%28%29%20%7B%0A%0A%20%20for%20%28var%20groups%20%3D%20this%2E%5Fgroups%2C%20j%20%3D%20%2D1%2C%20m%20%3D%20groups%2Elength%3B%20%2B%2Bj%20%3C%20m%3B%29%20%7B%0A%20%20%20%20for%20%28var%20group%20%3D%20groups%5Bj%5D%2C%20i%20%3D%20group%2Elength%20%2D%201%2C%20next%20%3D%20group%5Bi%5D%2C%20node%3B%20%2D%2Di%20%3E%3D%200%3B%29%20%7B%0A%20%20%20%20%20%20if%20%28node%20%3D%20group%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28next%20%26%26%20next%20%21%3D%3D%20node%2EnextSibling%29%20next%2EparentNode%2EinsertBefore%28node%2C%20next%29%3B%0A%20%20%20%20%20%20%20%20next%20%3D%20node%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20this%3B%0A%7D%0A%0Afunction%20selection%5Fsort%28compare%29%20%7B%0A%20%20if%20%28%21compare%29%20compare%20%3D%20ascending%241%3B%0A%0A%20%20function%20compareNode%28a%2C%20b%29%20%7B%0A%20%20%20%20return%20a%20%26%26%20b%20%3F%20compare%28a%2E%5F%5Fdata%5F%5F%2C%20b%2E%5F%5Fdata%5F%5F%29%20%3A%20%21a%20%2D%20%21b%3B%0A%20%20%7D%0A%0A%20%20for%20%28var%20groups%20%3D%20this%2E%5Fgroups%2C%20m%20%3D%20groups%2Elength%2C%20sortgroups%20%3D%20new%20Array%28m%29%2C%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20group%20%3D%20groups%5Bj%5D%2C%20n%20%3D%20group%2Elength%2C%20sortgroup%20%3D%20sortgroups%5Bj%5D%20%3D%20new%20Array%28n%29%2C%20node%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28node%20%3D%20group%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20sortgroup%5Bi%5D%20%3D%20node%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20sortgroup%2Esort%28compareNode%29%3B%0A%20%20%7D%0A%0A%20%20return%20new%20Selection%28sortgroups%2C%20this%2E%5Fparents%29%2Eorder%28%29%3B%0A%7D%0A%0Afunction%20ascending%241%28a%2C%20b%29%20%7B%0A%20%20return%20a%20%3C%20b%20%3F%20%2D1%20%3A%20a%20%3E%20b%20%3F%201%20%3A%20a%20%3E%3D%20b%20%3F%200%20%3A%20NaN%3B%0A%7D%0A%0Afunction%20selection%5Fcall%28%29%20%7B%0A%20%20var%20callback%20%3D%20arguments%5B0%5D%3B%0A%20%20arguments%5B0%5D%20%3D%20this%3B%0A%20%20callback%2Eapply%28null%2C%20arguments%29%3B%0A%20%20return%20this%3B%0A%7D%0A%0Afunction%20selection%5Fnodes%28%29%20%7B%0A%20%20var%20nodes%20%3D%20new%20Array%28this%2Esize%28%29%29%2C%20i%20%3D%20%2D1%3B%0A%20%20this%2Eeach%28function%28%29%20%7B%20nodes%5B%2B%2Bi%5D%20%3D%20this%3B%20%7D%29%3B%0A%20%20return%20nodes%3B%0A%7D%0A%0Afunction%20selection%5Fnode%28%29%20%7B%0A%0A%20%20for%20%28var%20groups%20%3D%20this%2E%5Fgroups%2C%20j%20%3D%200%2C%20m%20%3D%20groups%2Elength%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20group%20%3D%20groups%5Bj%5D%2C%20i%20%3D%200%2C%20n%20%3D%20group%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20var%20node%20%3D%20group%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28node%29%20return%20node%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20null%3B%0A%7D%0A%0Afunction%20selection%5Fsize%28%29%20%7B%0A%20%20var%20size%20%3D%200%3B%0A%20%20this%2Eeach%28function%28%29%20%7B%20%2B%2Bsize%3B%20%7D%29%3B%0A%20%20return%20size%3B%0A%7D%0A%0Afunction%20selection%5Fempty%28%29%20%7B%0A%20%20return%20%21this%2Enode%28%29%3B%0A%7D%0A%0Afunction%20selection%5Feach%28callback%29%20%7B%0A%0A%20%20for%20%28var%20groups%20%3D%20this%2E%5Fgroups%2C%20j%20%3D%200%2C%20m%20%3D%20groups%2Elength%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20group%20%3D%20groups%5Bj%5D%2C%20i%20%3D%200%2C%20n%20%3D%20group%2Elength%2C%20node%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28node%20%3D%20group%5Bi%5D%29%20callback%2Ecall%28node%2C%20node%2E%5F%5Fdata%5F%5F%2C%20i%2C%20group%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20this%3B%0A%7D%0A%0Afunction%20attrRemove%28name%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20this%2EremoveAttribute%28name%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20attrRemoveNS%28fullname%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20this%2EremoveAttributeNS%28fullname%2Espace%2C%20fullname%2Elocal%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20attrConstant%28name%2C%20value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20this%2EsetAttribute%28name%2C%20value%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20attrConstantNS%28fullname%2C%20value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20this%2EsetAttributeNS%28fullname%2Espace%2C%20fullname%2Elocal%2C%20value%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20attrFunction%28name%2C%20value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20v%20%3D%20value%2Eapply%28this%2C%20arguments%29%3B%0A%20%20%20%20if%20%28v%20%3D%3D%20null%29%20this%2EremoveAttribute%28name%29%3B%0A%20%20%20%20else%20this%2EsetAttribute%28name%2C%20v%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20attrFunctionNS%28fullname%2C%20value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20v%20%3D%20value%2Eapply%28this%2C%20arguments%29%3B%0A%20%20%20%20if%20%28v%20%3D%3D%20null%29%20this%2EremoveAttributeNS%28fullname%2Espace%2C%20fullname%2Elocal%29%3B%0A%20%20%20%20else%20this%2EsetAttributeNS%28fullname%2Espace%2C%20fullname%2Elocal%2C%20v%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20selection%5Fattr%28name%2C%20value%29%20%7B%0A%20%20var%20fullname%20%3D%20namespace%28name%29%3B%0A%0A%20%20if%20%28arguments%2Elength%20%3C%202%29%20%7B%0A%20%20%20%20var%20node%20%3D%20this%2Enode%28%29%3B%0A%20%20%20%20return%20fullname%2Elocal%0A%20%20%20%20%20%20%20%20%3F%20node%2EgetAttributeNS%28fullname%2Espace%2C%20fullname%2Elocal%29%0A%20%20%20%20%20%20%20%20%3A%20node%2EgetAttribute%28fullname%29%3B%0A%20%20%7D%0A%0A%20%20return%20this%2Eeach%28%28value%20%3D%3D%20null%0A%20%20%20%20%20%20%3F%20%28fullname%2Elocal%20%3F%20attrRemoveNS%20%3A%20attrRemove%29%20%3A%20%28typeof%20value%20%3D%3D%3D%20%22function%22%0A%20%20%20%20%20%20%3F%20%28fullname%2Elocal%20%3F%20attrFunctionNS%20%3A%20attrFunction%29%0A%20%20%20%20%20%20%3A%20%28fullname%2Elocal%20%3F%20attrConstantNS%20%3A%20attrConstant%29%29%29%28fullname%2C%20value%29%29%3B%0A%7D%0A%0Afunction%20defaultView%28node%29%20%7B%0A%20%20return%20%28node%2EownerDocument%20%26%26%20node%2EownerDocument%2EdefaultView%29%20%2F%2F%20node%20is%20a%20Node%0A%20%20%20%20%20%20%7C%7C%20%28node%2Edocument%20%26%26%20node%29%20%2F%2F%20node%20is%20a%20Window%0A%20%20%20%20%20%20%7C%7C%20node%2EdefaultView%3B%20%2F%2F%20node%20is%20a%20Document%0A%7D%0A%0Afunction%20styleRemove%28name%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20this%2Estyle%2EremoveProperty%28name%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20styleConstant%28name%2C%20value%2C%20priority%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20this%2Estyle%2EsetProperty%28name%2C%20value%2C%20priority%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20styleFunction%28name%2C%20value%2C%20priority%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20v%20%3D%20value%2Eapply%28this%2C%20arguments%29%3B%0A%20%20%20%20if%20%28v%20%3D%3D%20null%29%20this%2Estyle%2EremoveProperty%28name%29%3B%0A%20%20%20%20else%20this%2Estyle%2EsetProperty%28name%2C%20v%2C%20priority%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20selection%5Fstyle%28name%2C%20value%2C%20priority%29%20%7B%0A%20%20return%20arguments%2Elength%20%3E%201%0A%20%20%20%20%20%20%3F%20this%2Eeach%28%28value%20%3D%3D%20null%0A%20%20%20%20%20%20%20%20%20%20%20%20%3F%20styleRemove%20%3A%20typeof%20value%20%3D%3D%3D%20%22function%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%3F%20styleFunction%0A%20%20%20%20%20%20%20%20%20%20%20%20%3A%20styleConstant%29%28name%2C%20value%2C%20priority%20%3D%3D%20null%20%3F%20%22%22%20%3A%20priority%29%29%0A%20%20%20%20%20%20%3A%20styleValue%28this%2Enode%28%29%2C%20name%29%3B%0A%7D%0A%0Afunction%20styleValue%28node%2C%20name%29%20%7B%0A%20%20return%20node%2Estyle%2EgetPropertyValue%28name%29%0A%20%20%20%20%20%20%7C%7C%20defaultView%28node%29%2EgetComputedStyle%28node%2C%20null%29%2EgetPropertyValue%28name%29%3B%0A%7D%0A%0Afunction%20propertyRemove%28name%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20delete%20this%5Bname%5D%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20propertyConstant%28name%2C%20value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20this%5Bname%5D%20%3D%20value%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20propertyFunction%28name%2C%20value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20v%20%3D%20value%2Eapply%28this%2C%20arguments%29%3B%0A%20%20%20%20if%20%28v%20%3D%3D%20null%29%20delete%20this%5Bname%5D%3B%0A%20%20%20%20else%20this%5Bname%5D%20%3D%20v%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20selection%5Fproperty%28name%2C%20value%29%20%7B%0A%20%20return%20arguments%2Elength%20%3E%201%0A%20%20%20%20%20%20%3F%20this%2Eeach%28%28value%20%3D%3D%20null%0A%20%20%20%20%20%20%20%20%20%20%3F%20propertyRemove%20%3A%20typeof%20value%20%3D%3D%3D%20%22function%22%0A%20%20%20%20%20%20%20%20%20%20%3F%20propertyFunction%0A%20%20%20%20%20%20%20%20%20%20%3A%20propertyConstant%29%28name%2C%20value%29%29%0A%20%20%20%20%20%20%3A%20this%2Enode%28%29%5Bname%5D%3B%0A%7D%0A%0Afunction%20classArray%28string%29%20%7B%0A%20%20return%20string%2Etrim%28%29%2Esplit%28%2F%5E%7C%5Cs%2B%2F%29%3B%0A%7D%0A%0Afunction%20classList%28node%29%20%7B%0A%20%20return%20node%2EclassList%20%7C%7C%20new%20ClassList%28node%29%3B%0A%7D%0A%0Afunction%20ClassList%28node%29%20%7B%0A%20%20this%2E%5Fnode%20%3D%20node%3B%0A%20%20this%2E%5Fnames%20%3D%20classArray%28node%2EgetAttribute%28%22class%22%29%20%7C%7C%20%22%22%29%3B%0A%7D%0A%0AClassList%2Eprototype%20%3D%20%7B%0A%20%20add%3A%20function%28name%29%20%7B%0A%20%20%20%20var%20i%20%3D%20this%2E%5Fnames%2EindexOf%28name%29%3B%0A%20%20%20%20if%20%28i%20%3C%200%29%20%7B%0A%20%20%20%20%20%20this%2E%5Fnames%2Epush%28name%29%3B%0A%20%20%20%20%20%20this%2E%5Fnode%2EsetAttribute%28%22class%22%2C%20this%2E%5Fnames%2Ejoin%28%22%20%22%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20remove%3A%20function%28name%29%20%7B%0A%20%20%20%20var%20i%20%3D%20this%2E%5Fnames%2EindexOf%28name%29%3B%0A%20%20%20%20if%20%28i%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20this%2E%5Fnames%2Esplice%28i%2C%201%29%3B%0A%20%20%20%20%20%20this%2E%5Fnode%2EsetAttribute%28%22class%22%2C%20this%2E%5Fnames%2Ejoin%28%22%20%22%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20contains%3A%20function%28name%29%20%7B%0A%20%20%20%20return%20this%2E%5Fnames%2EindexOf%28name%29%20%3E%3D%200%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20classedAdd%28node%2C%20names%29%20%7B%0A%20%20var%20list%20%3D%20classList%28node%29%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20names%2Elength%3B%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20list%2Eadd%28names%5Bi%5D%29%3B%0A%7D%0A%0Afunction%20classedRemove%28node%2C%20names%29%20%7B%0A%20%20var%20list%20%3D%20classList%28node%29%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20names%2Elength%3B%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20list%2Eremove%28names%5Bi%5D%29%3B%0A%7D%0A%0Afunction%20classedTrue%28names%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20classedAdd%28this%2C%20names%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20classedFalse%28names%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20classedRemove%28this%2C%20names%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20classedFunction%28names%2C%20value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20%28value%2Eapply%28this%2C%20arguments%29%20%3F%20classedAdd%20%3A%20classedRemove%29%28this%2C%20names%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20selection%5Fclassed%28name%2C%20value%29%20%7B%0A%20%20var%20names%20%3D%20classArray%28name%20%2B%20%22%22%29%3B%0A%0A%20%20if%20%28arguments%2Elength%20%3C%202%29%20%7B%0A%20%20%20%20var%20list%20%3D%20classList%28this%2Enode%28%29%29%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20names%2Elength%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20if%20%28%21list%2Econtains%28names%5Bi%5D%29%29%20return%20false%3B%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%0A%20%20return%20this%2Eeach%28%28typeof%20value%20%3D%3D%3D%20%22function%22%0A%20%20%20%20%20%20%3F%20classedFunction%20%3A%20value%0A%20%20%20%20%20%20%3F%20classedTrue%0A%20%20%20%20%20%20%3A%20classedFalse%29%28names%2C%20value%29%29%3B%0A%7D%0A%0Afunction%20textRemove%28%29%20%7B%0A%20%20this%2EtextContent%20%3D%20%22%22%3B%0A%7D%0A%0Afunction%20textConstant%28value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20this%2EtextContent%20%3D%20value%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20textFunction%28value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20v%20%3D%20value%2Eapply%28this%2C%20arguments%29%3B%0A%20%20%20%20this%2EtextContent%20%3D%20v%20%3D%3D%20null%20%3F%20%22%22%20%3A%20v%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20selection%5Ftext%28value%29%20%7B%0A%20%20return%20arguments%2Elength%0A%20%20%20%20%20%20%3F%20this%2Eeach%28value%20%3D%3D%20null%0A%20%20%20%20%20%20%20%20%20%20%3F%20textRemove%20%3A%20%28typeof%20value%20%3D%3D%3D%20%22function%22%0A%20%20%20%20%20%20%20%20%20%20%3F%20textFunction%0A%20%20%20%20%20%20%20%20%20%20%3A%20textConstant%29%28value%29%29%0A%20%20%20%20%20%20%3A%20this%2Enode%28%29%2EtextContent%3B%0A%7D%0A%0Afunction%20htmlRemove%28%29%20%7B%0A%20%20this%2EinnerHTML%20%3D%20%22%22%3B%0A%7D%0A%0Afunction%20htmlConstant%28value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20this%2EinnerHTML%20%3D%20value%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20htmlFunction%28value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20v%20%3D%20value%2Eapply%28this%2C%20arguments%29%3B%0A%20%20%20%20this%2EinnerHTML%20%3D%20v%20%3D%3D%20null%20%3F%20%22%22%20%3A%20v%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20selection%5Fhtml%28value%29%20%7B%0A%20%20return%20arguments%2Elength%0A%20%20%20%20%20%20%3F%20this%2Eeach%28value%20%3D%3D%20null%0A%20%20%20%20%20%20%20%20%20%20%3F%20htmlRemove%20%3A%20%28typeof%20value%20%3D%3D%3D%20%22function%22%0A%20%20%20%20%20%20%20%20%20%20%3F%20htmlFunction%0A%20%20%20%20%20%20%20%20%20%20%3A%20htmlConstant%29%28value%29%29%0A%20%20%20%20%20%20%3A%20this%2Enode%28%29%2EinnerHTML%3B%0A%7D%0A%0Afunction%20raise%28%29%20%7B%0A%20%20if%20%28this%2EnextSibling%29%20this%2EparentNode%2EappendChild%28this%29%3B%0A%7D%0A%0Afunction%20selection%5Fraise%28%29%20%7B%0A%20%20return%20this%2Eeach%28raise%29%3B%0A%7D%0A%0Afunction%20lower%28%29%20%7B%0A%20%20if%20%28this%2EpreviousSibling%29%20this%2EparentNode%2EinsertBefore%28this%2C%20this%2EparentNode%2EfirstChild%29%3B%0A%7D%0A%0Afunction%20selection%5Flower%28%29%20%7B%0A%20%20return%20this%2Eeach%28lower%29%3B%0A%7D%0A%0Afunction%20selection%5Fappend%28name%29%20%7B%0A%20%20var%20create%20%3D%20typeof%20name%20%3D%3D%3D%20%22function%22%20%3F%20name%20%3A%20creator%28name%29%3B%0A%20%20return%20this%2Eselect%28function%28%29%20%7B%0A%20%20%20%20return%20this%2EappendChild%28create%2Eapply%28this%2C%20arguments%29%29%3B%0A%20%20%7D%29%3B%0A%7D%0A%0Afunction%20constantNull%28%29%20%7B%0A%20%20return%20null%3B%0A%7D%0A%0Afunction%20selection%5Finsert%28name%2C%20before%29%20%7B%0A%20%20var%20create%20%3D%20typeof%20name%20%3D%3D%3D%20%22function%22%20%3F%20name%20%3A%20creator%28name%29%2C%0A%20%20%20%20%20%20select%20%3D%20before%20%3D%3D%20null%20%3F%20constantNull%20%3A%20typeof%20before%20%3D%3D%3D%20%22function%22%20%3F%20before%20%3A%20selector%28before%29%3B%0A%20%20return%20this%2Eselect%28function%28%29%20%7B%0A%20%20%20%20return%20this%2EinsertBefore%28create%2Eapply%28this%2C%20arguments%29%2C%20select%2Eapply%28this%2C%20arguments%29%20%7C%7C%20null%29%3B%0A%20%20%7D%29%3B%0A%7D%0A%0Afunction%20remove%28%29%20%7B%0A%20%20var%20parent%20%3D%20this%2EparentNode%3B%0A%20%20if%20%28parent%29%20parent%2EremoveChild%28this%29%3B%0A%7D%0A%0Afunction%20selection%5Fremove%28%29%20%7B%0A%20%20return%20this%2Eeach%28remove%29%3B%0A%7D%0A%0Afunction%20selection%5FcloneShallow%28%29%20%7B%0A%20%20return%20this%2EparentNode%2EinsertBefore%28this%2EcloneNode%28false%29%2C%20this%2EnextSibling%29%3B%0A%7D%0A%0Afunction%20selection%5FcloneDeep%28%29%20%7B%0A%20%20return%20this%2EparentNode%2EinsertBefore%28this%2EcloneNode%28true%29%2C%20this%2EnextSibling%29%3B%0A%7D%0A%0Afunction%20selection%5Fclone%28deep%29%20%7B%0A%20%20return%20this%2Eselect%28deep%20%3F%20selection%5FcloneDeep%20%3A%20selection%5FcloneShallow%29%3B%0A%7D%0A%0Afunction%20selection%5Fdatum%28value%29%20%7B%0A%20%20return%20arguments%2Elength%0A%20%20%20%20%20%20%3F%20this%2Eproperty%28%22%5F%5Fdata%5F%5F%22%2C%20value%29%0A%20%20%20%20%20%20%3A%20this%2Enode%28%29%2E%5F%5Fdata%5F%5F%3B%0A%7D%0A%0Avar%20filterEvents%20%3D%20%7B%7D%3B%0A%0Aexports%2Eevent%20%3D%20null%3B%0A%0Aif%20%28typeof%20document%20%21%3D%3D%20%22undefined%22%29%20%7B%0A%20%20var%20element%241%20%3D%20document%2EdocumentElement%3B%0A%20%20if%20%28%21%28%22onmouseenter%22%20in%20element%241%29%29%20%7B%0A%20%20%20%20filterEvents%20%3D%20%7Bmouseenter%3A%20%22mouseover%22%2C%20mouseleave%3A%20%22mouseout%22%7D%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20filterContextListener%28listener%2C%20index%2C%20group%29%20%7B%0A%20%20listener%20%3D%20contextListener%28listener%2C%20index%2C%20group%29%3B%0A%20%20return%20function%28event%29%20%7B%0A%20%20%20%20var%20related%20%3D%20event%2ErelatedTarget%3B%0A%20%20%20%20if%20%28%21related%20%7C%7C%20%28related%20%21%3D%3D%20this%20%26%26%20%21%28related%2EcompareDocumentPosition%28this%29%20%26%208%29%29%29%20%7B%0A%20%20%20%20%20%20listener%2Ecall%28this%2C%20event%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20contextListener%28listener%2C%20index%2C%20group%29%20%7B%0A%20%20return%20function%28event1%29%20%7B%0A%20%20%20%20var%20event0%20%3D%20exports%2Eevent%3B%20%2F%2F%20Events%20can%20be%20reentrant%20%28e%2Eg%2E%2C%20focus%29%2E%0A%20%20%20%20exports%2Eevent%20%3D%20event1%3B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20listener%2Ecall%28this%2C%20this%2E%5F%5Fdata%5F%5F%2C%20index%2C%20group%29%3B%0A%20%20%20%20%7D%20finally%20%7B%0A%20%20%20%20%20%20exports%2Eevent%20%3D%20event0%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20parseTypenames%241%28typenames%29%20%7B%0A%20%20return%20typenames%2Etrim%28%29%2Esplit%28%2F%5E%7C%5Cs%2B%2F%29%2Emap%28function%28t%29%20%7B%0A%20%20%20%20var%20name%20%3D%20%22%22%2C%20i%20%3D%20t%2EindexOf%28%22%2E%22%29%3B%0A%20%20%20%20if%20%28i%20%3E%3D%200%29%20name%20%3D%20t%2Eslice%28i%20%2B%201%29%2C%20t%20%3D%20t%2Eslice%280%2C%20i%29%3B%0A%20%20%20%20return%20%7Btype%3A%20t%2C%20name%3A%20name%7D%3B%0A%20%20%7D%29%3B%0A%7D%0A%0Afunction%20onRemove%28typename%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20on%20%3D%20this%2E%5F%5Fon%3B%0A%20%20%20%20if%20%28%21on%29%20return%3B%0A%20%20%20%20for%20%28var%20j%20%3D%200%2C%20i%20%3D%20%2D1%2C%20m%20%3D%20on%2Elength%2C%20o%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20if%20%28o%20%3D%20on%5Bj%5D%2C%20%28%21typename%2Etype%20%7C%7C%20o%2Etype%20%3D%3D%3D%20typename%2Etype%29%20%26%26%20o%2Ename%20%3D%3D%3D%20typename%2Ename%29%20%7B%0A%20%20%20%20%20%20%20%20this%2EremoveEventListener%28o%2Etype%2C%20o%2Elistener%2C%20o%2Ecapture%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20on%5B%2B%2Bi%5D%20%3D%20o%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28%2B%2Bi%29%20on%2Elength%20%3D%20i%3B%0A%20%20%20%20else%20delete%20this%2E%5F%5Fon%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20onAdd%28typename%2C%20value%2C%20capture%29%20%7B%0A%20%20var%20wrap%20%3D%20filterEvents%2EhasOwnProperty%28typename%2Etype%29%20%3F%20filterContextListener%20%3A%20contextListener%3B%0A%20%20return%20function%28d%2C%20i%2C%20group%29%20%7B%0A%20%20%20%20var%20on%20%3D%20this%2E%5F%5Fon%2C%20o%2C%20listener%20%3D%20wrap%28value%2C%20i%2C%20group%29%3B%0A%20%20%20%20if%20%28on%29%20for%20%28var%20j%20%3D%200%2C%20m%20%3D%20on%2Elength%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20if%20%28%28o%20%3D%20on%5Bj%5D%29%2Etype%20%3D%3D%3D%20typename%2Etype%20%26%26%20o%2Ename%20%3D%3D%3D%20typename%2Ename%29%20%7B%0A%20%20%20%20%20%20%20%20this%2EremoveEventListener%28o%2Etype%2C%20o%2Elistener%2C%20o%2Ecapture%29%3B%0A%20%20%20%20%20%20%20%20this%2EaddEventListener%28o%2Etype%2C%20o%2Elistener%20%3D%20listener%2C%20o%2Ecapture%20%3D%20capture%29%3B%0A%20%20%20%20%20%20%20%20o%2Evalue%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this%2EaddEventListener%28typename%2Etype%2C%20listener%2C%20capture%29%3B%0A%20%20%20%20o%20%3D%20%7Btype%3A%20typename%2Etype%2C%20name%3A%20typename%2Ename%2C%20value%3A%20value%2C%20listener%3A%20listener%2C%20capture%3A%20capture%7D%3B%0A%20%20%20%20if%20%28%21on%29%20this%2E%5F%5Fon%20%3D%20%5Bo%5D%3B%0A%20%20%20%20else%20on%2Epush%28o%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20selection%5Fon%28typename%2C%20value%2C%20capture%29%20%7B%0A%20%20var%20typenames%20%3D%20parseTypenames%241%28typename%20%2B%20%22%22%29%2C%20i%2C%20n%20%3D%20typenames%2Elength%2C%20t%3B%0A%0A%20%20if%20%28arguments%2Elength%20%3C%202%29%20%7B%0A%20%20%20%20var%20on%20%3D%20this%2Enode%28%29%2E%5F%5Fon%3B%0A%20%20%20%20if%20%28on%29%20for%20%28var%20j%20%3D%200%2C%20m%20%3D%20on%2Elength%2C%20o%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20for%20%28i%20%3D%200%2C%20o%20%3D%20on%5Bj%5D%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%28t%20%3D%20typenames%5Bi%5D%29%2Etype%20%3D%3D%3D%20o%2Etype%20%26%26%20t%2Ename%20%3D%3D%3D%20o%2Ename%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20o%2Evalue%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%3B%0A%20%20%7D%0A%0A%20%20on%20%3D%20value%20%3F%20onAdd%20%3A%20onRemove%3B%0A%20%20if%20%28capture%20%3D%3D%20null%29%20capture%20%3D%20false%3B%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20this%2Eeach%28on%28typenames%5Bi%5D%2C%20value%2C%20capture%29%29%3B%0A%20%20return%20this%3B%0A%7D%0A%0Afunction%20customEvent%28event1%2C%20listener%2C%20that%2C%20args%29%20%7B%0A%20%20var%20event0%20%3D%20exports%2Eevent%3B%0A%20%20event1%2EsourceEvent%20%3D%20exports%2Eevent%3B%0A%20%20exports%2Eevent%20%3D%20event1%3B%0A%20%20try%20%7B%0A%20%20%20%20return%20listener%2Eapply%28that%2C%20args%29%3B%0A%20%20%7D%20finally%20%7B%0A%20%20%20%20exports%2Eevent%20%3D%20event0%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20dispatchEvent%28node%2C%20type%2C%20params%29%20%7B%0A%20%20var%20window%20%3D%20defaultView%28node%29%2C%0A%20%20%20%20%20%20event%20%3D%20window%2ECustomEvent%3B%0A%0A%20%20if%20%28typeof%20event%20%3D%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20event%20%3D%20new%20event%28type%2C%20params%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20event%20%3D%20window%2Edocument%2EcreateEvent%28%22Event%22%29%3B%0A%20%20%20%20if%20%28params%29%20event%2EinitEvent%28type%2C%20params%2Ebubbles%2C%20params%2Ecancelable%29%2C%20event%2Edetail%20%3D%20params%2Edetail%3B%0A%20%20%20%20else%20event%2EinitEvent%28type%2C%20false%2C%20false%29%3B%0A%20%20%7D%0A%0A%20%20node%2EdispatchEvent%28event%29%3B%0A%7D%0A%0Afunction%20dispatchConstant%28type%2C%20params%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20dispatchEvent%28this%2C%20type%2C%20params%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20dispatchFunction%28type%2C%20params%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20dispatchEvent%28this%2C%20type%2C%20params%2Eapply%28this%2C%20arguments%29%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20selection%5Fdispatch%28type%2C%20params%29%20%7B%0A%20%20return%20this%2Eeach%28%28typeof%20params%20%3D%3D%3D%20%22function%22%0A%20%20%20%20%20%20%3F%20dispatchFunction%0A%20%20%20%20%20%20%3A%20dispatchConstant%29%28type%2C%20params%29%29%3B%0A%7D%0A%0Avar%20root%20%3D%20%5Bnull%5D%3B%0A%0Afunction%20Selection%28groups%2C%20parents%29%20%7B%0A%20%20this%2E%5Fgroups%20%3D%20groups%3B%0A%20%20this%2E%5Fparents%20%3D%20parents%3B%0A%7D%0A%0Afunction%20selection%28%29%20%7B%0A%20%20return%20new%20Selection%28%5B%5Bdocument%2EdocumentElement%5D%5D%2C%20root%29%3B%0A%7D%0A%0ASelection%2Eprototype%20%3D%20selection%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20Selection%2C%0A%20%20select%3A%20selection%5Fselect%2C%0A%20%20selectAll%3A%20selection%5FselectAll%2C%0A%20%20filter%3A%20selection%5Ffilter%2C%0A%20%20data%3A%20selection%5Fdata%2C%0A%20%20enter%3A%20selection%5Fenter%2C%0A%20%20exit%3A%20selection%5Fexit%2C%0A%20%20merge%3A%20selection%5Fmerge%2C%0A%20%20order%3A%20selection%5Forder%2C%0A%20%20sort%3A%20selection%5Fsort%2C%0A%20%20call%3A%20selection%5Fcall%2C%0A%20%20nodes%3A%20selection%5Fnodes%2C%0A%20%20node%3A%20selection%5Fnode%2C%0A%20%20size%3A%20selection%5Fsize%2C%0A%20%20empty%3A%20selection%5Fempty%2C%0A%20%20each%3A%20selection%5Feach%2C%0A%20%20attr%3A%20selection%5Fattr%2C%0A%20%20style%3A%20selection%5Fstyle%2C%0A%20%20property%3A%20selection%5Fproperty%2C%0A%20%20classed%3A%20selection%5Fclassed%2C%0A%20%20text%3A%20selection%5Ftext%2C%0A%20%20html%3A%20selection%5Fhtml%2C%0A%20%20raise%3A%20selection%5Fraise%2C%0A%20%20lower%3A%20selection%5Flower%2C%0A%20%20append%3A%20selection%5Fappend%2C%0A%20%20insert%3A%20selection%5Finsert%2C%0A%20%20remove%3A%20selection%5Fremove%2C%0A%20%20clone%3A%20selection%5Fclone%2C%0A%20%20datum%3A%20selection%5Fdatum%2C%0A%20%20on%3A%20selection%5Fon%2C%0A%20%20dispatch%3A%20selection%5Fdispatch%0A%7D%3B%0A%0Afunction%20select%28selector%29%20%7B%0A%20%20return%20typeof%20selector%20%3D%3D%3D%20%22string%22%0A%20%20%20%20%20%20%3F%20new%20Selection%28%5B%5Bdocument%2EquerySelector%28selector%29%5D%5D%2C%20%5Bdocument%2EdocumentElement%5D%29%0A%20%20%20%20%20%20%3A%20new%20Selection%28%5B%5Bselector%5D%5D%2C%20root%29%3B%0A%7D%0A%0Afunction%20create%28name%29%20%7B%0A%20%20return%20select%28creator%28name%29%2Ecall%28document%2EdocumentElement%29%29%3B%0A%7D%0A%0Avar%20nextId%20%3D%200%3B%0A%0Afunction%20local%28%29%20%7B%0A%20%20return%20new%20Local%3B%0A%7D%0A%0Afunction%20Local%28%29%20%7B%0A%20%20this%2E%5F%20%3D%20%22%40%22%20%2B%20%28%2B%2BnextId%29%2EtoString%2836%29%3B%0A%7D%0A%0ALocal%2Eprototype%20%3D%20local%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20Local%2C%0A%20%20get%3A%20function%28node%29%20%7B%0A%20%20%20%20var%20id%20%3D%20this%2E%5F%3B%0A%20%20%20%20while%20%28%21%28id%20in%20node%29%29%20if%20%28%21%28node%20%3D%20node%2EparentNode%29%29%20return%3B%0A%20%20%20%20return%20node%5Bid%5D%3B%0A%20%20%7D%2C%0A%20%20set%3A%20function%28node%2C%20value%29%20%7B%0A%20%20%20%20return%20node%5Bthis%2E%5F%5D%20%3D%20value%3B%0A%20%20%7D%2C%0A%20%20remove%3A%20function%28node%29%20%7B%0A%20%20%20%20return%20this%2E%5F%20in%20node%20%26%26%20delete%20node%5Bthis%2E%5F%5D%3B%0A%20%20%7D%2C%0A%20%20toString%3A%20function%28%29%20%7B%0A%20%20%20%20return%20this%2E%5F%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20sourceEvent%28%29%20%7B%0A%20%20var%20current%20%3D%20exports%2Eevent%2C%20source%3B%0A%20%20while%20%28source%20%3D%20current%2EsourceEvent%29%20current%20%3D%20source%3B%0A%20%20return%20current%3B%0A%7D%0A%0Afunction%20point%28node%2C%20event%29%20%7B%0A%20%20var%20svg%20%3D%20node%2EownerSVGElement%20%7C%7C%20node%3B%0A%0A%20%20if%20%28svg%2EcreateSVGPoint%29%20%7B%0A%20%20%20%20var%20point%20%3D%20svg%2EcreateSVGPoint%28%29%3B%0A%20%20%20%20point%2Ex%20%3D%20event%2EclientX%2C%20point%2Ey%20%3D%20event%2EclientY%3B%0A%20%20%20%20point%20%3D%20point%2EmatrixTransform%28node%2EgetScreenCTM%28%29%2Einverse%28%29%29%3B%0A%20%20%20%20return%20%5Bpoint%2Ex%2C%20point%2Ey%5D%3B%0A%20%20%7D%0A%0A%20%20var%20rect%20%3D%20node%2EgetBoundingClientRect%28%29%3B%0A%20%20return%20%5Bevent%2EclientX%20%2D%20rect%2Eleft%20%2D%20node%2EclientLeft%2C%20event%2EclientY%20%2D%20rect%2Etop%20%2D%20node%2EclientTop%5D%3B%0A%7D%0A%0Afunction%20mouse%28node%29%20%7B%0A%20%20var%20event%20%3D%20sourceEvent%28%29%3B%0A%20%20if%20%28event%2EchangedTouches%29%20event%20%3D%20event%2EchangedTouches%5B0%5D%3B%0A%20%20return%20point%28node%2C%20event%29%3B%0A%7D%0A%0Afunction%20selectAll%28selector%29%20%7B%0A%20%20return%20typeof%20selector%20%3D%3D%3D%20%22string%22%0A%20%20%20%20%20%20%3F%20new%20Selection%28%5Bdocument%2EquerySelectorAll%28selector%29%5D%2C%20%5Bdocument%2EdocumentElement%5D%29%0A%20%20%20%20%20%20%3A%20new%20Selection%28%5Bselector%20%3D%3D%20null%20%3F%20%5B%5D%20%3A%20selector%5D%2C%20root%29%3B%0A%7D%0A%0Afunction%20touch%28node%2C%20touches%2C%20identifier%29%20%7B%0A%20%20if%20%28arguments%2Elength%20%3C%203%29%20identifier%20%3D%20touches%2C%20touches%20%3D%20sourceEvent%28%29%2EchangedTouches%3B%0A%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20touches%20%3F%20touches%2Elength%20%3A%200%2C%20touch%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28%28touch%20%3D%20touches%5Bi%5D%29%2Eidentifier%20%3D%3D%3D%20identifier%29%20%7B%0A%20%20%20%20%20%20return%20point%28node%2C%20touch%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20null%3B%0A%7D%0A%0Afunction%20touches%28node%2C%20touches%29%20%7B%0A%20%20if%20%28touches%20%3D%3D%20null%29%20touches%20%3D%20sourceEvent%28%29%2Etouches%3B%0A%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20touches%20%3F%20touches%2Elength%20%3A%200%2C%20points%20%3D%20new%20Array%28n%29%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20points%5Bi%5D%20%3D%20point%28node%2C%20touches%5Bi%5D%29%3B%0A%20%20%7D%0A%0A%20%20return%20points%3B%0A%7D%0A%0Afunction%20nopropagation%28%29%20%7B%0A%20%20exports%2Eevent%2EstopImmediatePropagation%28%29%3B%0A%7D%0A%0Afunction%20noevent%28%29%20%7B%0A%20%20exports%2Eevent%2EpreventDefault%28%29%3B%0A%20%20exports%2Eevent%2EstopImmediatePropagation%28%29%3B%0A%7D%0A%0Afunction%20dragDisable%28view%29%20%7B%0A%20%20var%20root%20%3D%20view%2Edocument%2EdocumentElement%2C%0A%20%20%20%20%20%20selection%24%241%20%3D%20select%28view%29%2Eon%28%22dragstart%2Edrag%22%2C%20noevent%2C%20true%29%3B%0A%20%20if%20%28%22onselectstart%22%20in%20root%29%20%7B%0A%20%20%20%20selection%24%241%2Eon%28%22selectstart%2Edrag%22%2C%20noevent%2C%20true%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20root%2E%5F%5Fnoselect%20%3D%20root%2Estyle%2EMozUserSelect%3B%0A%20%20%20%20root%2Estyle%2EMozUserSelect%20%3D%20%22none%22%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20yesdrag%28view%2C%20noclick%29%20%7B%0A%20%20var%20root%20%3D%20view%2Edocument%2EdocumentElement%2C%0A%20%20%20%20%20%20selection%24%241%20%3D%20select%28view%29%2Eon%28%22dragstart%2Edrag%22%2C%20null%29%3B%0A%20%20if%20%28noclick%29%20%7B%0A%20%20%20%20selection%24%241%2Eon%28%22click%2Edrag%22%2C%20noevent%2C%20true%29%3B%0A%20%20%20%20setTimeout%28function%28%29%20%7B%20selection%24%241%2Eon%28%22click%2Edrag%22%2C%20null%29%3B%20%7D%2C%200%29%3B%0A%20%20%7D%0A%20%20if%20%28%22onselectstart%22%20in%20root%29%20%7B%0A%20%20%20%20selection%24%241%2Eon%28%22selectstart%2Edrag%22%2C%20null%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20root%2Estyle%2EMozUserSelect%20%3D%20root%2E%5F%5Fnoselect%3B%0A%20%20%20%20delete%20root%2E%5F%5Fnoselect%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20constant%242%28x%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20DragEvent%28target%2C%20type%2C%20subject%2C%20id%2C%20active%2C%20x%2C%20y%2C%20dx%2C%20dy%2C%20dispatch%29%20%7B%0A%20%20this%2Etarget%20%3D%20target%3B%0A%20%20this%2Etype%20%3D%20type%3B%0A%20%20this%2Esubject%20%3D%20subject%3B%0A%20%20this%2Eidentifier%20%3D%20id%3B%0A%20%20this%2Eactive%20%3D%20active%3B%0A%20%20this%2Ex%20%3D%20x%3B%0A%20%20this%2Ey%20%3D%20y%3B%0A%20%20this%2Edx%20%3D%20dx%3B%0A%20%20this%2Edy%20%3D%20dy%3B%0A%20%20this%2E%5F%20%3D%20dispatch%3B%0A%7D%0A%0ADragEvent%2Eprototype%2Eon%20%3D%20function%28%29%20%7B%0A%20%20var%20value%20%3D%20this%2E%5F%2Eon%2Eapply%28this%2E%5F%2C%20arguments%29%3B%0A%20%20return%20value%20%3D%3D%3D%20this%2E%5F%20%3F%20this%20%3A%20value%3B%0A%7D%3B%0A%0A%2F%2F%20Ignore%20right%2Dclick%2C%20since%20that%20should%20open%20the%20context%20menu%2E%0Afunction%20defaultFilter%28%29%20%7B%0A%20%20return%20%21exports%2Eevent%2Ebutton%3B%0A%7D%0A%0Afunction%20defaultContainer%28%29%20%7B%0A%20%20return%20this%2EparentNode%3B%0A%7D%0A%0Afunction%20defaultSubject%28d%29%20%7B%0A%20%20return%20d%20%3D%3D%20null%20%3F%20%7Bx%3A%20exports%2Eevent%2Ex%2C%20y%3A%20exports%2Eevent%2Ey%7D%20%3A%20d%3B%0A%7D%0A%0Afunction%20defaultTouchable%28%29%20%7B%0A%20%20return%20%22ontouchstart%22%20in%20this%3B%0A%7D%0A%0Afunction%20drag%28%29%20%7B%0A%20%20var%20filter%20%3D%20defaultFilter%2C%0A%20%20%20%20%20%20container%20%3D%20defaultContainer%2C%0A%20%20%20%20%20%20subject%20%3D%20defaultSubject%2C%0A%20%20%20%20%20%20touchable%20%3D%20defaultTouchable%2C%0A%20%20%20%20%20%20gestures%20%3D%20%7B%7D%2C%0A%20%20%20%20%20%20listeners%20%3D%20dispatch%28%22start%22%2C%20%22drag%22%2C%20%22end%22%29%2C%0A%20%20%20%20%20%20active%20%3D%200%2C%0A%20%20%20%20%20%20mousedownx%2C%0A%20%20%20%20%20%20mousedowny%2C%0A%20%20%20%20%20%20mousemoving%2C%0A%20%20%20%20%20%20touchending%2C%0A%20%20%20%20%20%20clickDistance2%20%3D%200%3B%0A%0A%20%20function%20drag%28selection%24%241%29%20%7B%0A%20%20%20%20selection%24%241%0A%20%20%20%20%20%20%20%20%2Eon%28%22mousedown%2Edrag%22%2C%20mousedowned%29%0A%20%20%20%20%20%20%2Efilter%28touchable%29%0A%20%20%20%20%20%20%20%20%2Eon%28%22touchstart%2Edrag%22%2C%20touchstarted%29%0A%20%20%20%20%20%20%20%20%2Eon%28%22touchmove%2Edrag%22%2C%20touchmoved%29%0A%20%20%20%20%20%20%20%20%2Eon%28%22touchend%2Edrag%20touchcancel%2Edrag%22%2C%20touchended%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22touch%2Daction%22%2C%20%22none%22%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22%2Dwebkit%2Dtap%2Dhighlight%2Dcolor%22%2C%20%22rgba%280%2C0%2C0%2C0%29%22%29%3B%0A%20%20%7D%0A%0A%20%20function%20mousedowned%28%29%20%7B%0A%20%20%20%20if%20%28touchending%20%7C%7C%20%21filter%2Eapply%28this%2C%20arguments%29%29%20return%3B%0A%20%20%20%20var%20gesture%20%3D%20beforestart%28%22mouse%22%2C%20container%2Eapply%28this%2C%20arguments%29%2C%20mouse%2C%20this%2C%20arguments%29%3B%0A%20%20%20%20if%20%28%21gesture%29%20return%3B%0A%20%20%20%20select%28exports%2Eevent%2Eview%29%2Eon%28%22mousemove%2Edrag%22%2C%20mousemoved%2C%20true%29%2Eon%28%22mouseup%2Edrag%22%2C%20mouseupped%2C%20true%29%3B%0A%20%20%20%20dragDisable%28exports%2Eevent%2Eview%29%3B%0A%20%20%20%20nopropagation%28%29%3B%0A%20%20%20%20mousemoving%20%3D%20false%3B%0A%20%20%20%20mousedownx%20%3D%20exports%2Eevent%2EclientX%3B%0A%20%20%20%20mousedowny%20%3D%20exports%2Eevent%2EclientY%3B%0A%20%20%20%20gesture%28%22start%22%29%3B%0A%20%20%7D%0A%0A%20%20function%20mousemoved%28%29%20%7B%0A%20%20%20%20noevent%28%29%3B%0A%20%20%20%20if%20%28%21mousemoving%29%20%7B%0A%20%20%20%20%20%20var%20dx%20%3D%20exports%2Eevent%2EclientX%20%2D%20mousedownx%2C%20dy%20%3D%20exports%2Eevent%2EclientY%20%2D%20mousedowny%3B%0A%20%20%20%20%20%20mousemoving%20%3D%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%20%3E%20clickDistance2%3B%0A%20%20%20%20%7D%0A%20%20%20%20gestures%2Emouse%28%22drag%22%29%3B%0A%20%20%7D%0A%0A%20%20function%20mouseupped%28%29%20%7B%0A%20%20%20%20select%28exports%2Eevent%2Eview%29%2Eon%28%22mousemove%2Edrag%20mouseup%2Edrag%22%2C%20null%29%3B%0A%20%20%20%20yesdrag%28exports%2Eevent%2Eview%2C%20mousemoving%29%3B%0A%20%20%20%20noevent%28%29%3B%0A%20%20%20%20gestures%2Emouse%28%22end%22%29%3B%0A%20%20%7D%0A%0A%20%20function%20touchstarted%28%29%20%7B%0A%20%20%20%20if%20%28%21filter%2Eapply%28this%2C%20arguments%29%29%20return%3B%0A%20%20%20%20var%20touches%24%241%20%3D%20exports%2Eevent%2EchangedTouches%2C%0A%20%20%20%20%20%20%20%20c%20%3D%20container%2Eapply%28this%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20touches%24%241%2Elength%2C%20i%2C%20gesture%3B%0A%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28gesture%20%3D%20beforestart%28touches%24%241%5Bi%5D%2Eidentifier%2C%20c%2C%20touch%2C%20this%2C%20arguments%29%29%20%7B%0A%20%20%20%20%20%20%20%20nopropagation%28%29%3B%0A%20%20%20%20%20%20%20%20gesture%28%22start%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20touchmoved%28%29%20%7B%0A%20%20%20%20var%20touches%24%241%20%3D%20exports%2Eevent%2EchangedTouches%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20touches%24%241%2Elength%2C%20i%2C%20gesture%3B%0A%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28gesture%20%3D%20gestures%5Btouches%24%241%5Bi%5D%2Eidentifier%5D%29%20%7B%0A%20%20%20%20%20%20%20%20noevent%28%29%3B%0A%20%20%20%20%20%20%20%20gesture%28%22drag%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20touchended%28%29%20%7B%0A%20%20%20%20var%20touches%24%241%20%3D%20exports%2Eevent%2EchangedTouches%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20touches%24%241%2Elength%2C%20i%2C%20gesture%3B%0A%0A%20%20%20%20if%20%28touchending%29%20clearTimeout%28touchending%29%3B%0A%20%20%20%20touchending%20%3D%20setTimeout%28function%28%29%20%7B%20touchending%20%3D%20null%3B%20%7D%2C%20500%29%3B%20%2F%2F%20Ghost%20clicks%20are%20delayed%21%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28gesture%20%3D%20gestures%5Btouches%24%241%5Bi%5D%2Eidentifier%5D%29%20%7B%0A%20%20%20%20%20%20%20%20nopropagation%28%29%3B%0A%20%20%20%20%20%20%20%20gesture%28%22end%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20beforestart%28id%2C%20container%2C%20point%24%241%2C%20that%2C%20args%29%20%7B%0A%20%20%20%20var%20p%20%3D%20point%24%241%28container%2C%20id%29%2C%20s%2C%20dx%2C%20dy%2C%0A%20%20%20%20%20%20%20%20sublisteners%20%3D%20listeners%2Ecopy%28%29%3B%0A%0A%20%20%20%20if%20%28%21customEvent%28new%20DragEvent%28drag%2C%20%22beforestart%22%2C%20s%2C%20id%2C%20active%2C%20p%5B0%5D%2C%20p%5B1%5D%2C%200%2C%200%2C%20sublisteners%29%2C%20function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28%28exports%2Eevent%2Esubject%20%3D%20s%20%3D%20subject%2Eapply%28that%2C%20args%29%29%20%3D%3D%20null%29%20return%20false%3B%0A%20%20%20%20%20%20dx%20%3D%20s%2Ex%20%2D%20p%5B0%5D%20%7C%7C%200%3B%0A%20%20%20%20%20%20dy%20%3D%20s%2Ey%20%2D%20p%5B1%5D%20%7C%7C%200%3B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%29%29%20return%3B%0A%0A%20%20%20%20return%20function%20gesture%28type%29%20%7B%0A%20%20%20%20%20%20var%20p0%20%3D%20p%2C%20n%3B%0A%20%20%20%20%20%20switch%20%28type%29%20%7B%0A%20%20%20%20%20%20%20%20case%20%22start%22%3A%20gestures%5Bid%5D%20%3D%20gesture%2C%20n%20%3D%20active%2B%2B%3B%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22end%22%3A%20delete%20gestures%5Bid%5D%2C%20%2D%2Dactive%3B%20%2F%2F%20nobreak%0A%20%20%20%20%20%20%20%20case%20%22drag%22%3A%20p%20%3D%20point%24%241%28container%2C%20id%29%2C%20n%20%3D%20active%3B%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20customEvent%28new%20DragEvent%28drag%2C%20type%2C%20s%2C%20id%2C%20n%2C%20p%5B0%5D%20%2B%20dx%2C%20p%5B1%5D%20%2B%20dy%2C%20p%5B0%5D%20%2D%20p0%5B0%5D%2C%20p%5B1%5D%20%2D%20p0%5B1%5D%2C%20sublisteners%29%2C%20sublisteners%2Eapply%2C%20sublisteners%2C%20%5Btype%2C%20that%2C%20args%5D%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20drag%2Efilter%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28filter%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%242%28%21%21%5F%29%2C%20drag%29%20%3A%20filter%3B%0A%20%20%7D%3B%0A%0A%20%20drag%2Econtainer%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28container%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%242%28%5F%29%2C%20drag%29%20%3A%20container%3B%0A%20%20%7D%3B%0A%0A%20%20drag%2Esubject%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28subject%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%242%28%5F%29%2C%20drag%29%20%3A%20subject%3B%0A%20%20%7D%3B%0A%0A%20%20drag%2Etouchable%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28touchable%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%242%28%21%21%5F%29%2C%20drag%29%20%3A%20touchable%3B%0A%20%20%7D%3B%0A%0A%20%20drag%2Eon%20%3D%20function%28%29%20%7B%0A%20%20%20%20var%20value%20%3D%20listeners%2Eon%2Eapply%28listeners%2C%20arguments%29%3B%0A%20%20%20%20return%20value%20%3D%3D%3D%20listeners%20%3F%20drag%20%3A%20value%3B%0A%20%20%7D%3B%0A%0A%20%20drag%2EclickDistance%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28clickDistance2%20%3D%20%28%5F%20%3D%20%2B%5F%29%20%2A%20%5F%2C%20drag%29%20%3A%20Math%2Esqrt%28clickDistance2%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20drag%3B%0A%7D%0A%0Afunction%20define%28constructor%2C%20factory%2C%20prototype%29%20%7B%0A%20%20constructor%2Eprototype%20%3D%20factory%2Eprototype%20%3D%20prototype%3B%0A%20%20prototype%2Econstructor%20%3D%20constructor%3B%0A%7D%0A%0Afunction%20extend%28parent%2C%20definition%29%20%7B%0A%20%20var%20prototype%20%3D%20Object%2Ecreate%28parent%2Eprototype%29%3B%0A%20%20for%20%28var%20key%20in%20definition%29%20prototype%5Bkey%5D%20%3D%20definition%5Bkey%5D%3B%0A%20%20return%20prototype%3B%0A%7D%0A%0Afunction%20Color%28%29%20%7B%7D%0A%0Avar%20darker%20%3D%200%2E7%3B%0Avar%20brighter%20%3D%201%20%2F%20darker%3B%0A%0Avar%20reI%20%3D%20%22%5C%5Cs%2A%28%5B%2B%2D%5D%3F%5C%5Cd%2B%29%5C%5Cs%2A%22%2C%0A%20%20%20%20reN%20%3D%20%22%5C%5Cs%2A%28%5B%2B%2D%5D%3F%5C%5Cd%2A%5C%5C%2E%3F%5C%5Cd%2B%28%3F%3A%5BeE%5D%5B%2B%2D%5D%3F%5C%5Cd%2B%29%3F%29%5C%5Cs%2A%22%2C%0A%20%20%20%20reP%20%3D%20%22%5C%5Cs%2A%28%5B%2B%2D%5D%3F%5C%5Cd%2A%5C%5C%2E%3F%5C%5Cd%2B%28%3F%3A%5BeE%5D%5B%2B%2D%5D%3F%5C%5Cd%2B%29%3F%29%25%5C%5Cs%2A%22%2C%0A%20%20%20%20reHex3%20%3D%20%2F%5E%23%28%5B0%2D9a%2Df%5D%7B3%7D%29%24%2F%2C%0A%20%20%20%20reHex6%20%3D%20%2F%5E%23%28%5B0%2D9a%2Df%5D%7B6%7D%29%24%2F%2C%0A%20%20%20%20reRgbInteger%20%3D%20new%20RegExp%28%22%5Ergb%5C%5C%28%22%20%2B%20%5BreI%2C%20reI%2C%20reI%5D%20%2B%20%22%5C%5C%29%24%22%29%2C%0A%20%20%20%20reRgbPercent%20%3D%20new%20RegExp%28%22%5Ergb%5C%5C%28%22%20%2B%20%5BreP%2C%20reP%2C%20reP%5D%20%2B%20%22%5C%5C%29%24%22%29%2C%0A%20%20%20%20reRgbaInteger%20%3D%20new%20RegExp%28%22%5Ergba%5C%5C%28%22%20%2B%20%5BreI%2C%20reI%2C%20reI%2C%20reN%5D%20%2B%20%22%5C%5C%29%24%22%29%2C%0A%20%20%20%20reRgbaPercent%20%3D%20new%20RegExp%28%22%5Ergba%5C%5C%28%22%20%2B%20%5BreP%2C%20reP%2C%20reP%2C%20reN%5D%20%2B%20%22%5C%5C%29%24%22%29%2C%0A%20%20%20%20reHslPercent%20%3D%20new%20RegExp%28%22%5Ehsl%5C%5C%28%22%20%2B%20%5BreN%2C%20reP%2C%20reP%5D%20%2B%20%22%5C%5C%29%24%22%29%2C%0A%20%20%20%20reHslaPercent%20%3D%20new%20RegExp%28%22%5Ehsla%5C%5C%28%22%20%2B%20%5BreN%2C%20reP%2C%20reP%2C%20reN%5D%20%2B%20%22%5C%5C%29%24%22%29%3B%0A%0Avar%20named%20%3D%20%7B%0A%20%20aliceblue%3A%200xf0f8ff%2C%0A%20%20antiquewhite%3A%200xfaebd7%2C%0A%20%20aqua%3A%200x00ffff%2C%0A%20%20aquamarine%3A%200x7fffd4%2C%0A%20%20azure%3A%200xf0ffff%2C%0A%20%20beige%3A%200xf5f5dc%2C%0A%20%20bisque%3A%200xffe4c4%2C%0A%20%20black%3A%200x000000%2C%0A%20%20blanchedalmond%3A%200xffebcd%2C%0A%20%20blue%3A%200x0000ff%2C%0A%20%20blueviolet%3A%200x8a2be2%2C%0A%20%20brown%3A%200xa52a2a%2C%0A%20%20burlywood%3A%200xdeb887%2C%0A%20%20cadetblue%3A%200x5f9ea0%2C%0A%20%20chartreuse%3A%200x7fff00%2C%0A%20%20chocolate%3A%200xd2691e%2C%0A%20%20coral%3A%200xff7f50%2C%0A%20%20cornflowerblue%3A%200x6495ed%2C%0A%20%20cornsilk%3A%200xfff8dc%2C%0A%20%20crimson%3A%200xdc143c%2C%0A%20%20cyan%3A%200x00ffff%2C%0A%20%20darkblue%3A%200x00008b%2C%0A%20%20darkcyan%3A%200x008b8b%2C%0A%20%20darkgoldenrod%3A%200xb8860b%2C%0A%20%20darkgray%3A%200xa9a9a9%2C%0A%20%20darkgreen%3A%200x006400%2C%0A%20%20darkgrey%3A%200xa9a9a9%2C%0A%20%20darkkhaki%3A%200xbdb76b%2C%0A%20%20darkmagenta%3A%200x8b008b%2C%0A%20%20darkolivegreen%3A%200x556b2f%2C%0A%20%20darkorange%3A%200xff8c00%2C%0A%20%20darkorchid%3A%200x9932cc%2C%0A%20%20darkred%3A%200x8b0000%2C%0A%20%20darksalmon%3A%200xe9967a%2C%0A%20%20darkseagreen%3A%200x8fbc8f%2C%0A%20%20darkslateblue%3A%200x483d8b%2C%0A%20%20darkslategray%3A%200x2f4f4f%2C%0A%20%20darkslategrey%3A%200x2f4f4f%2C%0A%20%20darkturquoise%3A%200x00ced1%2C%0A%20%20darkviolet%3A%200x9400d3%2C%0A%20%20deeppink%3A%200xff1493%2C%0A%20%20deepskyblue%3A%200x00bfff%2C%0A%20%20dimgray%3A%200x696969%2C%0A%20%20dimgrey%3A%200x696969%2C%0A%20%20dodgerblue%3A%200x1e90ff%2C%0A%20%20firebrick%3A%200xb22222%2C%0A%20%20floralwhite%3A%200xfffaf0%2C%0A%20%20forestgreen%3A%200x228b22%2C%0A%20%20fuchsia%3A%200xff00ff%2C%0A%20%20gainsboro%3A%200xdcdcdc%2C%0A%20%20ghostwhite%3A%200xf8f8ff%2C%0A%20%20gold%3A%200xffd700%2C%0A%20%20goldenrod%3A%200xdaa520%2C%0A%20%20gray%3A%200x808080%2C%0A%20%20green%3A%200x008000%2C%0A%20%20greenyellow%3A%200xadff2f%2C%0A%20%20grey%3A%200x808080%2C%0A%20%20honeydew%3A%200xf0fff0%2C%0A%20%20hotpink%3A%200xff69b4%2C%0A%20%20indianred%3A%200xcd5c5c%2C%0A%20%20indigo%3A%200x4b0082%2C%0A%20%20ivory%3A%200xfffff0%2C%0A%20%20khaki%3A%200xf0e68c%2C%0A%20%20lavender%3A%200xe6e6fa%2C%0A%20%20lavenderblush%3A%200xfff0f5%2C%0A%20%20lawngreen%3A%200x7cfc00%2C%0A%20%20lemonchiffon%3A%200xfffacd%2C%0A%20%20lightblue%3A%200xadd8e6%2C%0A%20%20lightcoral%3A%200xf08080%2C%0A%20%20lightcyan%3A%200xe0ffff%2C%0A%20%20lightgoldenrodyellow%3A%200xfafad2%2C%0A%20%20lightgray%3A%200xd3d3d3%2C%0A%20%20lightgreen%3A%200x90ee90%2C%0A%20%20lightgrey%3A%200xd3d3d3%2C%0A%20%20lightpink%3A%200xffb6c1%2C%0A%20%20lightsalmon%3A%200xffa07a%2C%0A%20%20lightseagreen%3A%200x20b2aa%2C%0A%20%20lightskyblue%3A%200x87cefa%2C%0A%20%20lightslategray%3A%200x778899%2C%0A%20%20lightslategrey%3A%200x778899%2C%0A%20%20lightsteelblue%3A%200xb0c4de%2C%0A%20%20lightyellow%3A%200xffffe0%2C%0A%20%20lime%3A%200x00ff00%2C%0A%20%20limegreen%3A%200x32cd32%2C%0A%20%20linen%3A%200xfaf0e6%2C%0A%20%20magenta%3A%200xff00ff%2C%0A%20%20maroon%3A%200x800000%2C%0A%20%20mediumaquamarine%3A%200x66cdaa%2C%0A%20%20mediumblue%3A%200x0000cd%2C%0A%20%20mediumorchid%3A%200xba55d3%2C%0A%20%20mediumpurple%3A%200x9370db%2C%0A%20%20mediumseagreen%3A%200x3cb371%2C%0A%20%20mediumslateblue%3A%200x7b68ee%2C%0A%20%20mediumspringgreen%3A%200x00fa9a%2C%0A%20%20mediumturquoise%3A%200x48d1cc%2C%0A%20%20mediumvioletred%3A%200xc71585%2C%0A%20%20midnightblue%3A%200x191970%2C%0A%20%20mintcream%3A%200xf5fffa%2C%0A%20%20mistyrose%3A%200xffe4e1%2C%0A%20%20moccasin%3A%200xffe4b5%2C%0A%20%20navajowhite%3A%200xffdead%2C%0A%20%20navy%3A%200x000080%2C%0A%20%20oldlace%3A%200xfdf5e6%2C%0A%20%20olive%3A%200x808000%2C%0A%20%20olivedrab%3A%200x6b8e23%2C%0A%20%20orange%3A%200xffa500%2C%0A%20%20orangered%3A%200xff4500%2C%0A%20%20orchid%3A%200xda70d6%2C%0A%20%20palegoldenrod%3A%200xeee8aa%2C%0A%20%20palegreen%3A%200x98fb98%2C%0A%20%20paleturquoise%3A%200xafeeee%2C%0A%20%20palevioletred%3A%200xdb7093%2C%0A%20%20papayawhip%3A%200xffefd5%2C%0A%20%20peachpuff%3A%200xffdab9%2C%0A%20%20peru%3A%200xcd853f%2C%0A%20%20pink%3A%200xffc0cb%2C%0A%20%20plum%3A%200xdda0dd%2C%0A%20%20powderblue%3A%200xb0e0e6%2C%0A%20%20purple%3A%200x800080%2C%0A%20%20rebeccapurple%3A%200x663399%2C%0A%20%20red%3A%200xff0000%2C%0A%20%20rosybrown%3A%200xbc8f8f%2C%0A%20%20royalblue%3A%200x4169e1%2C%0A%20%20saddlebrown%3A%200x8b4513%2C%0A%20%20salmon%3A%200xfa8072%2C%0A%20%20sandybrown%3A%200xf4a460%2C%0A%20%20seagreen%3A%200x2e8b57%2C%0A%20%20seashell%3A%200xfff5ee%2C%0A%20%20sienna%3A%200xa0522d%2C%0A%20%20silver%3A%200xc0c0c0%2C%0A%20%20skyblue%3A%200x87ceeb%2C%0A%20%20slateblue%3A%200x6a5acd%2C%0A%20%20slategray%3A%200x708090%2C%0A%20%20slategrey%3A%200x708090%2C%0A%20%20snow%3A%200xfffafa%2C%0A%20%20springgreen%3A%200x00ff7f%2C%0A%20%20steelblue%3A%200x4682b4%2C%0A%20%20tan%3A%200xd2b48c%2C%0A%20%20teal%3A%200x008080%2C%0A%20%20thistle%3A%200xd8bfd8%2C%0A%20%20tomato%3A%200xff6347%2C%0A%20%20turquoise%3A%200x40e0d0%2C%0A%20%20violet%3A%200xee82ee%2C%0A%20%20wheat%3A%200xf5deb3%2C%0A%20%20white%3A%200xffffff%2C%0A%20%20whitesmoke%3A%200xf5f5f5%2C%0A%20%20yellow%3A%200xffff00%2C%0A%20%20yellowgreen%3A%200x9acd32%0A%7D%3B%0A%0Adefine%28Color%2C%20color%2C%20%7B%0A%20%20displayable%3A%20function%28%29%20%7B%0A%20%20%20%20return%20this%2Ergb%28%29%2Edisplayable%28%29%3B%0A%20%20%7D%2C%0A%20%20toString%3A%20function%28%29%20%7B%0A%20%20%20%20return%20this%2Ergb%28%29%20%2B%20%22%22%3B%0A%20%20%7D%0A%7D%29%3B%0A%0Afunction%20color%28format%29%20%7B%0A%20%20var%20m%3B%0A%20%20format%20%3D%20%28format%20%2B%20%22%22%29%2Etrim%28%29%2EtoLowerCase%28%29%3B%0A%20%20return%20%28m%20%3D%20reHex3%2Eexec%28format%29%29%20%3F%20%28m%20%3D%20parseInt%28m%5B1%5D%2C%2016%29%2C%20new%20Rgb%28%28m%20%3E%3E%208%20%26%200xf%29%20%7C%20%28m%20%3E%3E%204%20%26%200x0f0%29%2C%20%28m%20%3E%3E%204%20%26%200xf%29%20%7C%20%28m%20%26%200xf0%29%2C%20%28%28m%20%26%200xf%29%20%3C%3C%204%29%20%7C%20%28m%20%26%200xf%29%2C%201%29%29%20%2F%2F%20%23f00%0A%20%20%20%20%20%20%3A%20%28m%20%3D%20reHex6%2Eexec%28format%29%29%20%3F%20rgbn%28parseInt%28m%5B1%5D%2C%2016%29%29%20%2F%2F%20%23ff0000%0A%20%20%20%20%20%20%3A%20%28m%20%3D%20reRgbInteger%2Eexec%28format%29%29%20%3F%20new%20Rgb%28m%5B1%5D%2C%20m%5B2%5D%2C%20m%5B3%5D%2C%201%29%20%2F%2F%20rgb%28255%2C%200%2C%200%29%0A%20%20%20%20%20%20%3A%20%28m%20%3D%20reRgbPercent%2Eexec%28format%29%29%20%3F%20new%20Rgb%28m%5B1%5D%20%2A%20255%20%2F%20100%2C%20m%5B2%5D%20%2A%20255%20%2F%20100%2C%20m%5B3%5D%20%2A%20255%20%2F%20100%2C%201%29%20%2F%2F%20rgb%28100%25%2C%200%25%2C%200%25%29%0A%20%20%20%20%20%20%3A%20%28m%20%3D%20reRgbaInteger%2Eexec%28format%29%29%20%3F%20rgba%28m%5B1%5D%2C%20m%5B2%5D%2C%20m%5B3%5D%2C%20m%5B4%5D%29%20%2F%2F%20rgba%28255%2C%200%2C%200%2C%201%29%0A%20%20%20%20%20%20%3A%20%28m%20%3D%20reRgbaPercent%2Eexec%28format%29%29%20%3F%20rgba%28m%5B1%5D%20%2A%20255%20%2F%20100%2C%20m%5B2%5D%20%2A%20255%20%2F%20100%2C%20m%5B3%5D%20%2A%20255%20%2F%20100%2C%20m%5B4%5D%29%20%2F%2F%20rgb%28100%25%2C%200%25%2C%200%25%2C%201%29%0A%20%20%20%20%20%20%3A%20%28m%20%3D%20reHslPercent%2Eexec%28format%29%29%20%3F%20hsla%28m%5B1%5D%2C%20m%5B2%5D%20%2F%20100%2C%20m%5B3%5D%20%2F%20100%2C%201%29%20%2F%2F%20hsl%28120%2C%2050%25%2C%2050%25%29%0A%20%20%20%20%20%20%3A%20%28m%20%3D%20reHslaPercent%2Eexec%28format%29%29%20%3F%20hsla%28m%5B1%5D%2C%20m%5B2%5D%20%2F%20100%2C%20m%5B3%5D%20%2F%20100%2C%20m%5B4%5D%29%20%2F%2F%20hsla%28120%2C%2050%25%2C%2050%25%2C%201%29%0A%20%20%20%20%20%20%3A%20named%2EhasOwnProperty%28format%29%20%3F%20rgbn%28named%5Bformat%5D%29%0A%20%20%20%20%20%20%3A%20format%20%3D%3D%3D%20%22transparent%22%20%3F%20new%20Rgb%28NaN%2C%20NaN%2C%20NaN%2C%200%29%0A%20%20%20%20%20%20%3A%20null%3B%0A%7D%0A%0Afunction%20rgbn%28n%29%20%7B%0A%20%20return%20new%20Rgb%28n%20%3E%3E%2016%20%26%200xff%2C%20n%20%3E%3E%208%20%26%200xff%2C%20n%20%26%200xff%2C%201%29%3B%0A%7D%0A%0Afunction%20rgba%28r%2C%20g%2C%20b%2C%20a%29%20%7B%0A%20%20if%20%28a%20%3C%3D%200%29%20r%20%3D%20g%20%3D%20b%20%3D%20NaN%3B%0A%20%20return%20new%20Rgb%28r%2C%20g%2C%20b%2C%20a%29%3B%0A%7D%0A%0Afunction%20rgbConvert%28o%29%20%7B%0A%20%20if%20%28%21%28o%20instanceof%20Color%29%29%20o%20%3D%20color%28o%29%3B%0A%20%20if%20%28%21o%29%20return%20new%20Rgb%3B%0A%20%20o%20%3D%20o%2Ergb%28%29%3B%0A%20%20return%20new%20Rgb%28o%2Er%2C%20o%2Eg%2C%20o%2Eb%2C%20o%2Eopacity%29%3B%0A%7D%0A%0Afunction%20rgb%28r%2C%20g%2C%20b%2C%20opacity%29%20%7B%0A%20%20return%20arguments%2Elength%20%3D%3D%3D%201%20%3F%20rgbConvert%28r%29%20%3A%20new%20Rgb%28r%2C%20g%2C%20b%2C%20opacity%20%3D%3D%20null%20%3F%201%20%3A%20opacity%29%3B%0A%7D%0A%0Afunction%20Rgb%28r%2C%20g%2C%20b%2C%20opacity%29%20%7B%0A%20%20this%2Er%20%3D%20%2Br%3B%0A%20%20this%2Eg%20%3D%20%2Bg%3B%0A%20%20this%2Eb%20%3D%20%2Bb%3B%0A%20%20this%2Eopacity%20%3D%20%2Bopacity%3B%0A%7D%0A%0Adefine%28Rgb%2C%20rgb%2C%20extend%28Color%2C%20%7B%0A%20%20brighter%3A%20function%28k%29%20%7B%0A%20%20%20%20k%20%3D%20k%20%3D%3D%20null%20%3F%20brighter%20%3A%20Math%2Epow%28brighter%2C%20k%29%3B%0A%20%20%20%20return%20new%20Rgb%28this%2Er%20%2A%20k%2C%20this%2Eg%20%2A%20k%2C%20this%2Eb%20%2A%20k%2C%20this%2Eopacity%29%3B%0A%20%20%7D%2C%0A%20%20darker%3A%20function%28k%29%20%7B%0A%20%20%20%20k%20%3D%20k%20%3D%3D%20null%20%3F%20darker%20%3A%20Math%2Epow%28darker%2C%20k%29%3B%0A%20%20%20%20return%20new%20Rgb%28this%2Er%20%2A%20k%2C%20this%2Eg%20%2A%20k%2C%20this%2Eb%20%2A%20k%2C%20this%2Eopacity%29%3B%0A%20%20%7D%2C%0A%20%20rgb%3A%20function%28%29%20%7B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%2C%0A%20%20displayable%3A%20function%28%29%20%7B%0A%20%20%20%20return%20%280%20%3C%3D%20this%2Er%20%26%26%20this%2Er%20%3C%3D%20255%29%0A%20%20%20%20%20%20%20%20%26%26%20%280%20%3C%3D%20this%2Eg%20%26%26%20this%2Eg%20%3C%3D%20255%29%0A%20%20%20%20%20%20%20%20%26%26%20%280%20%3C%3D%20this%2Eb%20%26%26%20this%2Eb%20%3C%3D%20255%29%0A%20%20%20%20%20%20%20%20%26%26%20%280%20%3C%3D%20this%2Eopacity%20%26%26%20this%2Eopacity%20%3C%3D%201%29%3B%0A%20%20%7D%2C%0A%20%20toString%3A%20function%28%29%20%7B%0A%20%20%20%20var%20a%20%3D%20this%2Eopacity%3B%20a%20%3D%20isNaN%28a%29%20%3F%201%20%3A%20Math%2Emax%280%2C%20Math%2Emin%281%2C%20a%29%29%3B%0A%20%20%20%20return%20%28a%20%3D%3D%3D%201%20%3F%20%22rgb%28%22%20%3A%20%22rgba%28%22%29%0A%20%20%20%20%20%20%20%20%2B%20Math%2Emax%280%2C%20Math%2Emin%28255%2C%20Math%2Eround%28this%2Er%29%20%7C%7C%200%29%29%20%2B%20%22%2C%20%22%0A%20%20%20%20%20%20%20%20%2B%20Math%2Emax%280%2C%20Math%2Emin%28255%2C%20Math%2Eround%28this%2Eg%29%20%7C%7C%200%29%29%20%2B%20%22%2C%20%22%0A%20%20%20%20%20%20%20%20%2B%20Math%2Emax%280%2C%20Math%2Emin%28255%2C%20Math%2Eround%28this%2Eb%29%20%7C%7C%200%29%29%0A%20%20%20%20%20%20%20%20%2B%20%28a%20%3D%3D%3D%201%20%3F%20%22%29%22%20%3A%20%22%2C%20%22%20%2B%20a%20%2B%20%22%29%22%29%3B%0A%20%20%7D%0A%7D%29%29%3B%0A%0Afunction%20hsla%28h%2C%20s%2C%20l%2C%20a%29%20%7B%0A%20%20if%20%28a%20%3C%3D%200%29%20h%20%3D%20s%20%3D%20l%20%3D%20NaN%3B%0A%20%20else%20if%20%28l%20%3C%3D%200%20%7C%7C%20l%20%3E%3D%201%29%20h%20%3D%20s%20%3D%20NaN%3B%0A%20%20else%20if%20%28s%20%3C%3D%200%29%20h%20%3D%20NaN%3B%0A%20%20return%20new%20Hsl%28h%2C%20s%2C%20l%2C%20a%29%3B%0A%7D%0A%0Afunction%20hslConvert%28o%29%20%7B%0A%20%20if%20%28o%20instanceof%20Hsl%29%20return%20new%20Hsl%28o%2Eh%2C%20o%2Es%2C%20o%2El%2C%20o%2Eopacity%29%3B%0A%20%20if%20%28%21%28o%20instanceof%20Color%29%29%20o%20%3D%20color%28o%29%3B%0A%20%20if%20%28%21o%29%20return%20new%20Hsl%3B%0A%20%20if%20%28o%20instanceof%20Hsl%29%20return%20o%3B%0A%20%20o%20%3D%20o%2Ergb%28%29%3B%0A%20%20var%20r%20%3D%20o%2Er%20%2F%20255%2C%0A%20%20%20%20%20%20g%20%3D%20o%2Eg%20%2F%20255%2C%0A%20%20%20%20%20%20b%20%3D%20o%2Eb%20%2F%20255%2C%0A%20%20%20%20%20%20min%20%3D%20Math%2Emin%28r%2C%20g%2C%20b%29%2C%0A%20%20%20%20%20%20max%20%3D%20Math%2Emax%28r%2C%20g%2C%20b%29%2C%0A%20%20%20%20%20%20h%20%3D%20NaN%2C%0A%20%20%20%20%20%20s%20%3D%20max%20%2D%20min%2C%0A%20%20%20%20%20%20l%20%3D%20%28max%20%2B%20min%29%20%2F%202%3B%0A%20%20if%20%28s%29%20%7B%0A%20%20%20%20if%20%28r%20%3D%3D%3D%20max%29%20h%20%3D%20%28g%20%2D%20b%29%20%2F%20s%20%2B%20%28g%20%3C%20b%29%20%2A%206%3B%0A%20%20%20%20else%20if%20%28g%20%3D%3D%3D%20max%29%20h%20%3D%20%28b%20%2D%20r%29%20%2F%20s%20%2B%202%3B%0A%20%20%20%20else%20h%20%3D%20%28r%20%2D%20g%29%20%2F%20s%20%2B%204%3B%0A%20%20%20%20s%20%2F%3D%20l%20%3C%200%2E5%20%3F%20max%20%2B%20min%20%3A%202%20%2D%20max%20%2D%20min%3B%0A%20%20%20%20h%20%2A%3D%2060%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20s%20%3D%20l%20%3E%200%20%26%26%20l%20%3C%201%20%3F%200%20%3A%20h%3B%0A%20%20%7D%0A%20%20return%20new%20Hsl%28h%2C%20s%2C%20l%2C%20o%2Eopacity%29%3B%0A%7D%0A%0Afunction%20hsl%28h%2C%20s%2C%20l%2C%20opacity%29%20%7B%0A%20%20return%20arguments%2Elength%20%3D%3D%3D%201%20%3F%20hslConvert%28h%29%20%3A%20new%20Hsl%28h%2C%20s%2C%20l%2C%20opacity%20%3D%3D%20null%20%3F%201%20%3A%20opacity%29%3B%0A%7D%0A%0Afunction%20Hsl%28h%2C%20s%2C%20l%2C%20opacity%29%20%7B%0A%20%20this%2Eh%20%3D%20%2Bh%3B%0A%20%20this%2Es%20%3D%20%2Bs%3B%0A%20%20this%2El%20%3D%20%2Bl%3B%0A%20%20this%2Eopacity%20%3D%20%2Bopacity%3B%0A%7D%0A%0Adefine%28Hsl%2C%20hsl%2C%20extend%28Color%2C%20%7B%0A%20%20brighter%3A%20function%28k%29%20%7B%0A%20%20%20%20k%20%3D%20k%20%3D%3D%20null%20%3F%20brighter%20%3A%20Math%2Epow%28brighter%2C%20k%29%3B%0A%20%20%20%20return%20new%20Hsl%28this%2Eh%2C%20this%2Es%2C%20this%2El%20%2A%20k%2C%20this%2Eopacity%29%3B%0A%20%20%7D%2C%0A%20%20darker%3A%20function%28k%29%20%7B%0A%20%20%20%20k%20%3D%20k%20%3D%3D%20null%20%3F%20darker%20%3A%20Math%2Epow%28darker%2C%20k%29%3B%0A%20%20%20%20return%20new%20Hsl%28this%2Eh%2C%20this%2Es%2C%20this%2El%20%2A%20k%2C%20this%2Eopacity%29%3B%0A%20%20%7D%2C%0A%20%20rgb%3A%20function%28%29%20%7B%0A%20%20%20%20var%20h%20%3D%20this%2Eh%20%25%20360%20%2B%20%28this%2Eh%20%3C%200%29%20%2A%20360%2C%0A%20%20%20%20%20%20%20%20s%20%3D%20isNaN%28h%29%20%7C%7C%20isNaN%28this%2Es%29%20%3F%200%20%3A%20this%2Es%2C%0A%20%20%20%20%20%20%20%20l%20%3D%20this%2El%2C%0A%20%20%20%20%20%20%20%20m2%20%3D%20l%20%2B%20%28l%20%3C%200%2E5%20%3F%20l%20%3A%201%20%2D%20l%29%20%2A%20s%2C%0A%20%20%20%20%20%20%20%20m1%20%3D%202%20%2A%20l%20%2D%20m2%3B%0A%20%20%20%20return%20new%20Rgb%28%0A%20%20%20%20%20%20hsl2rgb%28h%20%3E%3D%20240%20%3F%20h%20%2D%20240%20%3A%20h%20%2B%20120%2C%20m1%2C%20m2%29%2C%0A%20%20%20%20%20%20hsl2rgb%28h%2C%20m1%2C%20m2%29%2C%0A%20%20%20%20%20%20hsl2rgb%28h%20%3C%20120%20%3F%20h%20%2B%20240%20%3A%20h%20%2D%20120%2C%20m1%2C%20m2%29%2C%0A%20%20%20%20%20%20this%2Eopacity%0A%20%20%20%20%29%3B%0A%20%20%7D%2C%0A%20%20displayable%3A%20function%28%29%20%7B%0A%20%20%20%20return%20%280%20%3C%3D%20this%2Es%20%26%26%20this%2Es%20%3C%3D%201%20%7C%7C%20isNaN%28this%2Es%29%29%0A%20%20%20%20%20%20%20%20%26%26%20%280%20%3C%3D%20this%2El%20%26%26%20this%2El%20%3C%3D%201%29%0A%20%20%20%20%20%20%20%20%26%26%20%280%20%3C%3D%20this%2Eopacity%20%26%26%20this%2Eopacity%20%3C%3D%201%29%3B%0A%20%20%7D%0A%7D%29%29%3B%0A%0A%2F%2A%20From%20FvD%2013%2E37%2C%20CSS%20Color%20Module%20Level%203%20%2A%2F%0Afunction%20hsl2rgb%28h%2C%20m1%2C%20m2%29%20%7B%0A%20%20return%20%28h%20%3C%2060%20%3F%20m1%20%2B%20%28m2%20%2D%20m1%29%20%2A%20h%20%2F%2060%0A%20%20%20%20%20%20%3A%20h%20%3C%20180%20%3F%20m2%0A%20%20%20%20%20%20%3A%20h%20%3C%20240%20%3F%20m1%20%2B%20%28m2%20%2D%20m1%29%20%2A%20%28240%20%2D%20h%29%20%2F%2060%0A%20%20%20%20%20%20%3A%20m1%29%20%2A%20255%3B%0A%7D%0A%0Avar%20deg2rad%20%3D%20Math%2EPI%20%2F%20180%3B%0Avar%20rad2deg%20%3D%20180%20%2F%20Math%2EPI%3B%0A%0A%2F%2F%20https%3A%2F%2Fbeta%2Eobservablehq%2Ecom%2F%40mbostock%2Flab%2Dand%2Drgb%0Avar%20K%20%3D%2018%2C%0A%20%20%20%20Xn%20%3D%200%2E96422%2C%0A%20%20%20%20Yn%20%3D%201%2C%0A%20%20%20%20Zn%20%3D%200%2E82521%2C%0A%20%20%20%20t0%20%3D%204%20%2F%2029%2C%0A%20%20%20%20t1%20%3D%206%20%2F%2029%2C%0A%20%20%20%20t2%20%3D%203%20%2A%20t1%20%2A%20t1%2C%0A%20%20%20%20t3%20%3D%20t1%20%2A%20t1%20%2A%20t1%3B%0A%0Afunction%20labConvert%28o%29%20%7B%0A%20%20if%20%28o%20instanceof%20Lab%29%20return%20new%20Lab%28o%2El%2C%20o%2Ea%2C%20o%2Eb%2C%20o%2Eopacity%29%3B%0A%20%20if%20%28o%20instanceof%20Hcl%29%20%7B%0A%20%20%20%20if%20%28isNaN%28o%2Eh%29%29%20return%20new%20Lab%28o%2El%2C%200%2C%200%2C%20o%2Eopacity%29%3B%0A%20%20%20%20var%20h%20%3D%20o%2Eh%20%2A%20deg2rad%3B%0A%20%20%20%20return%20new%20Lab%28o%2El%2C%20Math%2Ecos%28h%29%20%2A%20o%2Ec%2C%20Math%2Esin%28h%29%20%2A%20o%2Ec%2C%20o%2Eopacity%29%3B%0A%20%20%7D%0A%20%20if%20%28%21%28o%20instanceof%20Rgb%29%29%20o%20%3D%20rgbConvert%28o%29%3B%0A%20%20var%20r%20%3D%20rgb2lrgb%28o%2Er%29%2C%0A%20%20%20%20%20%20g%20%3D%20rgb2lrgb%28o%2Eg%29%2C%0A%20%20%20%20%20%20b%20%3D%20rgb2lrgb%28o%2Eb%29%2C%0A%20%20%20%20%20%20y%20%3D%20xyz2lab%28%280%2E2225045%20%2A%20r%20%2B%200%2E7168786%20%2A%20g%20%2B%200%2E0606169%20%2A%20b%29%20%2F%20Yn%29%2C%20x%2C%20z%3B%0A%20%20if%20%28r%20%3D%3D%3D%20g%20%26%26%20g%20%3D%3D%3D%20b%29%20x%20%3D%20z%20%3D%20y%3B%20else%20%7B%0A%20%20%20%20x%20%3D%20xyz2lab%28%280%2E4360747%20%2A%20r%20%2B%200%2E3850649%20%2A%20g%20%2B%200%2E1430804%20%2A%20b%29%20%2F%20Xn%29%3B%0A%20%20%20%20z%20%3D%20xyz2lab%28%280%2E0139322%20%2A%20r%20%2B%200%2E0971045%20%2A%20g%20%2B%200%2E7141733%20%2A%20b%29%20%2F%20Zn%29%3B%0A%20%20%7D%0A%20%20return%20new%20Lab%28116%20%2A%20y%20%2D%2016%2C%20500%20%2A%20%28x%20%2D%20y%29%2C%20200%20%2A%20%28y%20%2D%20z%29%2C%20o%2Eopacity%29%3B%0A%7D%0A%0Afunction%20gray%28l%2C%20opacity%29%20%7B%0A%20%20return%20new%20Lab%28l%2C%200%2C%200%2C%20opacity%20%3D%3D%20null%20%3F%201%20%3A%20opacity%29%3B%0A%7D%0A%0Afunction%20lab%28l%2C%20a%2C%20b%2C%20opacity%29%20%7B%0A%20%20return%20arguments%2Elength%20%3D%3D%3D%201%20%3F%20labConvert%28l%29%20%3A%20new%20Lab%28l%2C%20a%2C%20b%2C%20opacity%20%3D%3D%20null%20%3F%201%20%3A%20opacity%29%3B%0A%7D%0A%0Afunction%20Lab%28l%2C%20a%2C%20b%2C%20opacity%29%20%7B%0A%20%20this%2El%20%3D%20%2Bl%3B%0A%20%20this%2Ea%20%3D%20%2Ba%3B%0A%20%20this%2Eb%20%3D%20%2Bb%3B%0A%20%20this%2Eopacity%20%3D%20%2Bopacity%3B%0A%7D%0A%0Adefine%28Lab%2C%20lab%2C%20extend%28Color%2C%20%7B%0A%20%20brighter%3A%20function%28k%29%20%7B%0A%20%20%20%20return%20new%20Lab%28this%2El%20%2B%20K%20%2A%20%28k%20%3D%3D%20null%20%3F%201%20%3A%20k%29%2C%20this%2Ea%2C%20this%2Eb%2C%20this%2Eopacity%29%3B%0A%20%20%7D%2C%0A%20%20darker%3A%20function%28k%29%20%7B%0A%20%20%20%20return%20new%20Lab%28this%2El%20%2D%20K%20%2A%20%28k%20%3D%3D%20null%20%3F%201%20%3A%20k%29%2C%20this%2Ea%2C%20this%2Eb%2C%20this%2Eopacity%29%3B%0A%20%20%7D%2C%0A%20%20rgb%3A%20function%28%29%20%7B%0A%20%20%20%20var%20y%20%3D%20%28this%2El%20%2B%2016%29%20%2F%20116%2C%0A%20%20%20%20%20%20%20%20x%20%3D%20isNaN%28this%2Ea%29%20%3F%20y%20%3A%20y%20%2B%20this%2Ea%20%2F%20500%2C%0A%20%20%20%20%20%20%20%20z%20%3D%20isNaN%28this%2Eb%29%20%3F%20y%20%3A%20y%20%2D%20this%2Eb%20%2F%20200%3B%0A%20%20%20%20x%20%3D%20Xn%20%2A%20lab2xyz%28x%29%3B%0A%20%20%20%20y%20%3D%20Yn%20%2A%20lab2xyz%28y%29%3B%0A%20%20%20%20z%20%3D%20Zn%20%2A%20lab2xyz%28z%29%3B%0A%20%20%20%20return%20new%20Rgb%28%0A%20%20%20%20%20%20lrgb2rgb%28%203%2E1338561%20%2A%20x%20%2D%201%2E6168667%20%2A%20y%20%2D%200%2E4906146%20%2A%20z%29%2C%0A%20%20%20%20%20%20lrgb2rgb%28%2D0%2E9787684%20%2A%20x%20%2B%201%2E9161415%20%2A%20y%20%2B%200%2E0334540%20%2A%20z%29%2C%0A%20%20%20%20%20%20lrgb2rgb%28%200%2E0719453%20%2A%20x%20%2D%200%2E2289914%20%2A%20y%20%2B%201%2E4052427%20%2A%20z%29%2C%0A%20%20%20%20%20%20this%2Eopacity%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%7D%29%29%3B%0A%0Afunction%20xyz2lab%28t%29%20%7B%0A%20%20return%20t%20%3E%20t3%20%3F%20Math%2Epow%28t%2C%201%20%2F%203%29%20%3A%20t%20%2F%20t2%20%2B%20t0%3B%0A%7D%0A%0Afunction%20lab2xyz%28t%29%20%7B%0A%20%20return%20t%20%3E%20t1%20%3F%20t%20%2A%20t%20%2A%20t%20%3A%20t2%20%2A%20%28t%20%2D%20t0%29%3B%0A%7D%0A%0Afunction%20lrgb2rgb%28x%29%20%7B%0A%20%20return%20255%20%2A%20%28x%20%3C%3D%200%2E0031308%20%3F%2012%2E92%20%2A%20x%20%3A%201%2E055%20%2A%20Math%2Epow%28x%2C%201%20%2F%202%2E4%29%20%2D%200%2E055%29%3B%0A%7D%0A%0Afunction%20rgb2lrgb%28x%29%20%7B%0A%20%20return%20%28x%20%2F%3D%20255%29%20%3C%3D%200%2E04045%20%3F%20x%20%2F%2012%2E92%20%3A%20Math%2Epow%28%28x%20%2B%200%2E055%29%20%2F%201%2E055%2C%202%2E4%29%3B%0A%7D%0A%0Afunction%20hclConvert%28o%29%20%7B%0A%20%20if%20%28o%20instanceof%20Hcl%29%20return%20new%20Hcl%28o%2Eh%2C%20o%2Ec%2C%20o%2El%2C%20o%2Eopacity%29%3B%0A%20%20if%20%28%21%28o%20instanceof%20Lab%29%29%20o%20%3D%20labConvert%28o%29%3B%0A%20%20if%20%28o%2Ea%20%3D%3D%3D%200%20%26%26%20o%2Eb%20%3D%3D%3D%200%29%20return%20new%20Hcl%28NaN%2C%200%2C%20o%2El%2C%20o%2Eopacity%29%3B%0A%20%20var%20h%20%3D%20Math%2Eatan2%28o%2Eb%2C%20o%2Ea%29%20%2A%20rad2deg%3B%0A%20%20return%20new%20Hcl%28h%20%3C%200%20%3F%20h%20%2B%20360%20%3A%20h%2C%20Math%2Esqrt%28o%2Ea%20%2A%20o%2Ea%20%2B%20o%2Eb%20%2A%20o%2Eb%29%2C%20o%2El%2C%20o%2Eopacity%29%3B%0A%7D%0A%0Afunction%20lch%28l%2C%20c%2C%20h%2C%20opacity%29%20%7B%0A%20%20return%20arguments%2Elength%20%3D%3D%3D%201%20%3F%20hclConvert%28l%29%20%3A%20new%20Hcl%28h%2C%20c%2C%20l%2C%20opacity%20%3D%3D%20null%20%3F%201%20%3A%20opacity%29%3B%0A%7D%0A%0Afunction%20hcl%28h%2C%20c%2C%20l%2C%20opacity%29%20%7B%0A%20%20return%20arguments%2Elength%20%3D%3D%3D%201%20%3F%20hclConvert%28h%29%20%3A%20new%20Hcl%28h%2C%20c%2C%20l%2C%20opacity%20%3D%3D%20null%20%3F%201%20%3A%20opacity%29%3B%0A%7D%0A%0Afunction%20Hcl%28h%2C%20c%2C%20l%2C%20opacity%29%20%7B%0A%20%20this%2Eh%20%3D%20%2Bh%3B%0A%20%20this%2Ec%20%3D%20%2Bc%3B%0A%20%20this%2El%20%3D%20%2Bl%3B%0A%20%20this%2Eopacity%20%3D%20%2Bopacity%3B%0A%7D%0A%0Adefine%28Hcl%2C%20hcl%2C%20extend%28Color%2C%20%7B%0A%20%20brighter%3A%20function%28k%29%20%7B%0A%20%20%20%20return%20new%20Hcl%28this%2Eh%2C%20this%2Ec%2C%20this%2El%20%2B%20K%20%2A%20%28k%20%3D%3D%20null%20%3F%201%20%3A%20k%29%2C%20this%2Eopacity%29%3B%0A%20%20%7D%2C%0A%20%20darker%3A%20function%28k%29%20%7B%0A%20%20%20%20return%20new%20Hcl%28this%2Eh%2C%20this%2Ec%2C%20this%2El%20%2D%20K%20%2A%20%28k%20%3D%3D%20null%20%3F%201%20%3A%20k%29%2C%20this%2Eopacity%29%3B%0A%20%20%7D%2C%0A%20%20rgb%3A%20function%28%29%20%7B%0A%20%20%20%20return%20labConvert%28this%29%2Ergb%28%29%3B%0A%20%20%7D%0A%7D%29%29%3B%0A%0Avar%20A%20%3D%20%2D0%2E14861%2C%0A%20%20%20%20B%20%3D%20%2B1%2E78277%2C%0A%20%20%20%20C%20%3D%20%2D0%2E29227%2C%0A%20%20%20%20D%20%3D%20%2D0%2E90649%2C%0A%20%20%20%20E%20%3D%20%2B1%2E97294%2C%0A%20%20%20%20ED%20%3D%20E%20%2A%20D%2C%0A%20%20%20%20EB%20%3D%20E%20%2A%20B%2C%0A%20%20%20%20BC%5FDA%20%3D%20B%20%2A%20C%20%2D%20D%20%2A%20A%3B%0A%0Afunction%20cubehelixConvert%28o%29%20%7B%0A%20%20if%20%28o%20instanceof%20Cubehelix%29%20return%20new%20Cubehelix%28o%2Eh%2C%20o%2Es%2C%20o%2El%2C%20o%2Eopacity%29%3B%0A%20%20if%20%28%21%28o%20instanceof%20Rgb%29%29%20o%20%3D%20rgbConvert%28o%29%3B%0A%20%20var%20r%20%3D%20o%2Er%20%2F%20255%2C%0A%20%20%20%20%20%20g%20%3D%20o%2Eg%20%2F%20255%2C%0A%20%20%20%20%20%20b%20%3D%20o%2Eb%20%2F%20255%2C%0A%20%20%20%20%20%20l%20%3D%20%28BC%5FDA%20%2A%20b%20%2B%20ED%20%2A%20r%20%2D%20EB%20%2A%20g%29%20%2F%20%28BC%5FDA%20%2B%20ED%20%2D%20EB%29%2C%0A%20%20%20%20%20%20bl%20%3D%20b%20%2D%20l%2C%0A%20%20%20%20%20%20k%20%3D%20%28E%20%2A%20%28g%20%2D%20l%29%20%2D%20C%20%2A%20bl%29%20%2F%20D%2C%0A%20%20%20%20%20%20s%20%3D%20Math%2Esqrt%28k%20%2A%20k%20%2B%20bl%20%2A%20bl%29%20%2F%20%28E%20%2A%20l%20%2A%20%281%20%2D%20l%29%29%2C%20%2F%2F%20NaN%20if%20l%3D0%20or%20l%3D1%0A%20%20%20%20%20%20h%20%3D%20s%20%3F%20Math%2Eatan2%28k%2C%20bl%29%20%2A%20rad2deg%20%2D%20120%20%3A%20NaN%3B%0A%20%20return%20new%20Cubehelix%28h%20%3C%200%20%3F%20h%20%2B%20360%20%3A%20h%2C%20s%2C%20l%2C%20o%2Eopacity%29%3B%0A%7D%0A%0Afunction%20cubehelix%28h%2C%20s%2C%20l%2C%20opacity%29%20%7B%0A%20%20return%20arguments%2Elength%20%3D%3D%3D%201%20%3F%20cubehelixConvert%28h%29%20%3A%20new%20Cubehelix%28h%2C%20s%2C%20l%2C%20opacity%20%3D%3D%20null%20%3F%201%20%3A%20opacity%29%3B%0A%7D%0A%0Afunction%20Cubehelix%28h%2C%20s%2C%20l%2C%20opacity%29%20%7B%0A%20%20this%2Eh%20%3D%20%2Bh%3B%0A%20%20this%2Es%20%3D%20%2Bs%3B%0A%20%20this%2El%20%3D%20%2Bl%3B%0A%20%20this%2Eopacity%20%3D%20%2Bopacity%3B%0A%7D%0A%0Adefine%28Cubehelix%2C%20cubehelix%2C%20extend%28Color%2C%20%7B%0A%20%20brighter%3A%20function%28k%29%20%7B%0A%20%20%20%20k%20%3D%20k%20%3D%3D%20null%20%3F%20brighter%20%3A%20Math%2Epow%28brighter%2C%20k%29%3B%0A%20%20%20%20return%20new%20Cubehelix%28this%2Eh%2C%20this%2Es%2C%20this%2El%20%2A%20k%2C%20this%2Eopacity%29%3B%0A%20%20%7D%2C%0A%20%20darker%3A%20function%28k%29%20%7B%0A%20%20%20%20k%20%3D%20k%20%3D%3D%20null%20%3F%20darker%20%3A%20Math%2Epow%28darker%2C%20k%29%3B%0A%20%20%20%20return%20new%20Cubehelix%28this%2Eh%2C%20this%2Es%2C%20this%2El%20%2A%20k%2C%20this%2Eopacity%29%3B%0A%20%20%7D%2C%0A%20%20rgb%3A%20function%28%29%20%7B%0A%20%20%20%20var%20h%20%3D%20isNaN%28this%2Eh%29%20%3F%200%20%3A%20%28this%2Eh%20%2B%20120%29%20%2A%20deg2rad%2C%0A%20%20%20%20%20%20%20%20l%20%3D%20%2Bthis%2El%2C%0A%20%20%20%20%20%20%20%20a%20%3D%20isNaN%28this%2Es%29%20%3F%200%20%3A%20this%2Es%20%2A%20l%20%2A%20%281%20%2D%20l%29%2C%0A%20%20%20%20%20%20%20%20cosh%20%3D%20Math%2Ecos%28h%29%2C%0A%20%20%20%20%20%20%20%20sinh%20%3D%20Math%2Esin%28h%29%3B%0A%20%20%20%20return%20new%20Rgb%28%0A%20%20%20%20%20%20255%20%2A%20%28l%20%2B%20a%20%2A%20%28A%20%2A%20cosh%20%2B%20B%20%2A%20sinh%29%29%2C%0A%20%20%20%20%20%20255%20%2A%20%28l%20%2B%20a%20%2A%20%28C%20%2A%20cosh%20%2B%20D%20%2A%20sinh%29%29%2C%0A%20%20%20%20%20%20255%20%2A%20%28l%20%2B%20a%20%2A%20%28E%20%2A%20cosh%29%29%2C%0A%20%20%20%20%20%20this%2Eopacity%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%7D%29%29%3B%0A%0Afunction%20basis%28t1%2C%20v0%2C%20v1%2C%20v2%2C%20v3%29%20%7B%0A%20%20var%20t2%20%3D%20t1%20%2A%20t1%2C%20t3%20%3D%20t2%20%2A%20t1%3B%0A%20%20return%20%28%281%20%2D%203%20%2A%20t1%20%2B%203%20%2A%20t2%20%2D%20t3%29%20%2A%20v0%0A%20%20%20%20%20%20%2B%20%284%20%2D%206%20%2A%20t2%20%2B%203%20%2A%20t3%29%20%2A%20v1%0A%20%20%20%20%20%20%2B%20%281%20%2B%203%20%2A%20t1%20%2B%203%20%2A%20t2%20%2D%203%20%2A%20t3%29%20%2A%20v2%0A%20%20%20%20%20%20%2B%20t3%20%2A%20v3%29%20%2F%206%3B%0A%7D%0A%0Afunction%20basis%241%28values%29%20%7B%0A%20%20var%20n%20%3D%20values%2Elength%20%2D%201%3B%0A%20%20return%20function%28t%29%20%7B%0A%20%20%20%20var%20i%20%3D%20t%20%3C%3D%200%20%3F%20%28t%20%3D%200%29%20%3A%20t%20%3E%3D%201%20%3F%20%28t%20%3D%201%2C%20n%20%2D%201%29%20%3A%20Math%2Efloor%28t%20%2A%20n%29%2C%0A%20%20%20%20%20%20%20%20v1%20%3D%20values%5Bi%5D%2C%0A%20%20%20%20%20%20%20%20v2%20%3D%20values%5Bi%20%2B%201%5D%2C%0A%20%20%20%20%20%20%20%20v0%20%3D%20i%20%3E%200%20%3F%20values%5Bi%20%2D%201%5D%20%3A%202%20%2A%20v1%20%2D%20v2%2C%0A%20%20%20%20%20%20%20%20v3%20%3D%20i%20%3C%20n%20%2D%201%20%3F%20values%5Bi%20%2B%202%5D%20%3A%202%20%2A%20v2%20%2D%20v1%3B%0A%20%20%20%20return%20basis%28%28t%20%2D%20i%20%2F%20n%29%20%2A%20n%2C%20v0%2C%20v1%2C%20v2%2C%20v3%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20basisClosed%28values%29%20%7B%0A%20%20var%20n%20%3D%20values%2Elength%3B%0A%20%20return%20function%28t%29%20%7B%0A%20%20%20%20var%20i%20%3D%20Math%2Efloor%28%28%28t%20%25%3D%201%29%20%3C%200%20%3F%20%2B%2Bt%20%3A%20t%29%20%2A%20n%29%2C%0A%20%20%20%20%20%20%20%20v0%20%3D%20values%5B%28i%20%2B%20n%20%2D%201%29%20%25%20n%5D%2C%0A%20%20%20%20%20%20%20%20v1%20%3D%20values%5Bi%20%25%20n%5D%2C%0A%20%20%20%20%20%20%20%20v2%20%3D%20values%5B%28i%20%2B%201%29%20%25%20n%5D%2C%0A%20%20%20%20%20%20%20%20v3%20%3D%20values%5B%28i%20%2B%202%29%20%25%20n%5D%3B%0A%20%20%20%20return%20basis%28%28t%20%2D%20i%20%2F%20n%29%20%2A%20n%2C%20v0%2C%20v1%2C%20v2%2C%20v3%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20constant%243%28x%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20linear%28a%2C%20d%29%20%7B%0A%20%20return%20function%28t%29%20%7B%0A%20%20%20%20return%20a%20%2B%20t%20%2A%20d%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20exponential%28a%2C%20b%2C%20y%29%20%7B%0A%20%20return%20a%20%3D%20Math%2Epow%28a%2C%20y%29%2C%20b%20%3D%20Math%2Epow%28b%2C%20y%29%20%2D%20a%2C%20y%20%3D%201%20%2F%20y%2C%20function%28t%29%20%7B%0A%20%20%20%20return%20Math%2Epow%28a%20%2B%20t%20%2A%20b%2C%20y%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20hue%28a%2C%20b%29%20%7B%0A%20%20var%20d%20%3D%20b%20%2D%20a%3B%0A%20%20return%20d%20%3F%20linear%28a%2C%20d%20%3E%20180%20%7C%7C%20d%20%3C%20%2D180%20%3F%20d%20%2D%20360%20%2A%20Math%2Eround%28d%20%2F%20360%29%20%3A%20d%29%20%3A%20constant%243%28isNaN%28a%29%20%3F%20b%20%3A%20a%29%3B%0A%7D%0A%0Afunction%20gamma%28y%29%20%7B%0A%20%20return%20%28y%20%3D%20%2By%29%20%3D%3D%3D%201%20%3F%20nogamma%20%3A%20function%28a%2C%20b%29%20%7B%0A%20%20%20%20return%20b%20%2D%20a%20%3F%20exponential%28a%2C%20b%2C%20y%29%20%3A%20constant%243%28isNaN%28a%29%20%3F%20b%20%3A%20a%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20nogamma%28a%2C%20b%29%20%7B%0A%20%20var%20d%20%3D%20b%20%2D%20a%3B%0A%20%20return%20d%20%3F%20linear%28a%2C%20d%29%20%3A%20constant%243%28isNaN%28a%29%20%3F%20b%20%3A%20a%29%3B%0A%7D%0A%0Avar%20interpolateRgb%20%3D%20%28function%20rgbGamma%28y%29%20%7B%0A%20%20var%20color%24%241%20%3D%20gamma%28y%29%3B%0A%0A%20%20function%20rgb%24%241%28start%2C%20end%29%20%7B%0A%20%20%20%20var%20r%20%3D%20color%24%241%28%28start%20%3D%20rgb%28start%29%29%2Er%2C%20%28end%20%3D%20rgb%28end%29%29%2Er%29%2C%0A%20%20%20%20%20%20%20%20g%20%3D%20color%24%241%28start%2Eg%2C%20end%2Eg%29%2C%0A%20%20%20%20%20%20%20%20b%20%3D%20color%24%241%28start%2Eb%2C%20end%2Eb%29%2C%0A%20%20%20%20%20%20%20%20opacity%20%3D%20nogamma%28start%2Eopacity%2C%20end%2Eopacity%29%3B%0A%20%20%20%20return%20function%28t%29%20%7B%0A%20%20%20%20%20%20start%2Er%20%3D%20r%28t%29%3B%0A%20%20%20%20%20%20start%2Eg%20%3D%20g%28t%29%3B%0A%20%20%20%20%20%20start%2Eb%20%3D%20b%28t%29%3B%0A%20%20%20%20%20%20start%2Eopacity%20%3D%20opacity%28t%29%3B%0A%20%20%20%20%20%20return%20start%20%2B%20%22%22%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20rgb%24%241%2Egamma%20%3D%20rgbGamma%3B%0A%0A%20%20return%20rgb%24%241%3B%0A%7D%29%281%29%3B%0A%0Afunction%20rgbSpline%28spline%29%20%7B%0A%20%20return%20function%28colors%29%20%7B%0A%20%20%20%20var%20n%20%3D%20colors%2Elength%2C%0A%20%20%20%20%20%20%20%20r%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20%20%20g%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20%20%20b%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20%20%20i%2C%20color%24%241%3B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20color%24%241%20%3D%20rgb%28colors%5Bi%5D%29%3B%0A%20%20%20%20%20%20r%5Bi%5D%20%3D%20color%24%241%2Er%20%7C%7C%200%3B%0A%20%20%20%20%20%20g%5Bi%5D%20%3D%20color%24%241%2Eg%20%7C%7C%200%3B%0A%20%20%20%20%20%20b%5Bi%5D%20%3D%20color%24%241%2Eb%20%7C%7C%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20r%20%3D%20spline%28r%29%3B%0A%20%20%20%20g%20%3D%20spline%28g%29%3B%0A%20%20%20%20b%20%3D%20spline%28b%29%3B%0A%20%20%20%20color%24%241%2Eopacity%20%3D%201%3B%0A%20%20%20%20return%20function%28t%29%20%7B%0A%20%20%20%20%20%20color%24%241%2Er%20%3D%20r%28t%29%3B%0A%20%20%20%20%20%20color%24%241%2Eg%20%3D%20g%28t%29%3B%0A%20%20%20%20%20%20color%24%241%2Eb%20%3D%20b%28t%29%3B%0A%20%20%20%20%20%20return%20color%24%241%20%2B%20%22%22%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%3B%0A%7D%0A%0Avar%20rgbBasis%20%3D%20rgbSpline%28basis%241%29%3B%0Avar%20rgbBasisClosed%20%3D%20rgbSpline%28basisClosed%29%3B%0A%0Afunction%20array%241%28a%2C%20b%29%20%7B%0A%20%20var%20nb%20%3D%20b%20%3F%20b%2Elength%20%3A%200%2C%0A%20%20%20%20%20%20na%20%3D%20a%20%3F%20Math%2Emin%28nb%2C%20a%2Elength%29%20%3A%200%2C%0A%20%20%20%20%20%20x%20%3D%20new%20Array%28na%29%2C%0A%20%20%20%20%20%20c%20%3D%20new%20Array%28nb%29%2C%0A%20%20%20%20%20%20i%3B%0A%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20na%3B%20%2B%2Bi%29%20x%5Bi%5D%20%3D%20interpolateValue%28a%5Bi%5D%2C%20b%5Bi%5D%29%3B%0A%20%20for%20%28%3B%20i%20%3C%20nb%3B%20%2B%2Bi%29%20c%5Bi%5D%20%3D%20b%5Bi%5D%3B%0A%0A%20%20return%20function%28t%29%20%7B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20na%3B%20%2B%2Bi%29%20c%5Bi%5D%20%3D%20x%5Bi%5D%28t%29%3B%0A%20%20%20%20return%20c%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20date%28a%2C%20b%29%20%7B%0A%20%20var%20d%20%3D%20new%20Date%3B%0A%20%20return%20a%20%3D%20%2Ba%2C%20b%20%2D%3D%20a%2C%20function%28t%29%20%7B%0A%20%20%20%20return%20d%2EsetTime%28a%20%2B%20b%20%2A%20t%29%2C%20d%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20reinterpolate%28a%2C%20b%29%20%7B%0A%20%20return%20a%20%3D%20%2Ba%2C%20b%20%2D%3D%20a%2C%20function%28t%29%20%7B%0A%20%20%20%20return%20a%20%2B%20b%20%2A%20t%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20object%28a%2C%20b%29%20%7B%0A%20%20var%20i%20%3D%20%7B%7D%2C%0A%20%20%20%20%20%20c%20%3D%20%7B%7D%2C%0A%20%20%20%20%20%20k%3B%0A%0A%20%20if%20%28a%20%3D%3D%3D%20null%20%7C%7C%20typeof%20a%20%21%3D%3D%20%22object%22%29%20a%20%3D%20%7B%7D%3B%0A%20%20if%20%28b%20%3D%3D%3D%20null%20%7C%7C%20typeof%20b%20%21%3D%3D%20%22object%22%29%20b%20%3D%20%7B%7D%3B%0A%0A%20%20for%20%28k%20in%20b%29%20%7B%0A%20%20%20%20if%20%28k%20in%20a%29%20%7B%0A%20%20%20%20%20%20i%5Bk%5D%20%3D%20interpolateValue%28a%5Bk%5D%2C%20b%5Bk%5D%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20c%5Bk%5D%20%3D%20b%5Bk%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20function%28t%29%20%7B%0A%20%20%20%20for%20%28k%20in%20i%29%20c%5Bk%5D%20%3D%20i%5Bk%5D%28t%29%3B%0A%20%20%20%20return%20c%3B%0A%20%20%7D%3B%0A%7D%0A%0Avar%20reA%20%3D%20%2F%5B%2D%2B%5D%3F%28%3F%3A%5Cd%2B%5C%2E%3F%5Cd%2A%7C%5C%2E%3F%5Cd%2B%29%28%3F%3A%5BeE%5D%5B%2D%2B%5D%3F%5Cd%2B%29%3F%2Fg%2C%0A%20%20%20%20reB%20%3D%20new%20RegExp%28reA%2Esource%2C%20%22g%22%29%3B%0A%0Afunction%20zero%28b%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20b%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20one%28b%29%20%7B%0A%20%20return%20function%28t%29%20%7B%0A%20%20%20%20return%20b%28t%29%20%2B%20%22%22%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20interpolateString%28a%2C%20b%29%20%7B%0A%20%20var%20bi%20%3D%20reA%2ElastIndex%20%3D%20reB%2ElastIndex%20%3D%200%2C%20%2F%2F%20scan%20index%20for%20next%20number%20in%20b%0A%20%20%20%20%20%20am%2C%20%2F%2F%20current%20match%20in%20a%0A%20%20%20%20%20%20bm%2C%20%2F%2F%20current%20match%20in%20b%0A%20%20%20%20%20%20bs%2C%20%2F%2F%20string%20preceding%20current%20number%20in%20b%2C%20if%20any%0A%20%20%20%20%20%20i%20%3D%20%2D1%2C%20%2F%2F%20index%20in%20s%0A%20%20%20%20%20%20s%20%3D%20%5B%5D%2C%20%2F%2F%20string%20constants%20and%20placeholders%0A%20%20%20%20%20%20q%20%3D%20%5B%5D%3B%20%2F%2F%20number%20interpolators%0A%0A%20%20%2F%2F%20Coerce%20inputs%20to%20strings%2E%0A%20%20a%20%3D%20a%20%2B%20%22%22%2C%20b%20%3D%20b%20%2B%20%22%22%3B%0A%0A%20%20%2F%2F%20Interpolate%20pairs%20of%20numbers%20in%20a%20%26%20b%2E%0A%20%20while%20%28%28am%20%3D%20reA%2Eexec%28a%29%29%0A%20%20%20%20%20%20%26%26%20%28bm%20%3D%20reB%2Eexec%28b%29%29%29%20%7B%0A%20%20%20%20if%20%28%28bs%20%3D%20bm%2Eindex%29%20%3E%20bi%29%20%7B%20%2F%2F%20a%20string%20precedes%20the%20next%20number%20in%20b%0A%20%20%20%20%20%20bs%20%3D%20b%2Eslice%28bi%2C%20bs%29%3B%0A%20%20%20%20%20%20if%20%28s%5Bi%5D%29%20s%5Bi%5D%20%2B%3D%20bs%3B%20%2F%2F%20coalesce%20with%20previous%20string%0A%20%20%20%20%20%20else%20s%5B%2B%2Bi%5D%20%3D%20bs%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28%28am%20%3D%20am%5B0%5D%29%20%3D%3D%3D%20%28bm%20%3D%20bm%5B0%5D%29%29%20%7B%20%2F%2F%20numbers%20in%20a%20%26%20b%20match%0A%20%20%20%20%20%20if%20%28s%5Bi%5D%29%20s%5Bi%5D%20%2B%3D%20bm%3B%20%2F%2F%20coalesce%20with%20previous%20string%0A%20%20%20%20%20%20else%20s%5B%2B%2Bi%5D%20%3D%20bm%3B%0A%20%20%20%20%7D%20else%20%7B%20%2F%2F%20interpolate%20non%2Dmatching%20numbers%0A%20%20%20%20%20%20s%5B%2B%2Bi%5D%20%3D%20null%3B%0A%20%20%20%20%20%20q%2Epush%28%7Bi%3A%20i%2C%20x%3A%20reinterpolate%28am%2C%20bm%29%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20bi%20%3D%20reB%2ElastIndex%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Add%20remains%20of%20b%2E%0A%20%20if%20%28bi%20%3C%20b%2Elength%29%20%7B%0A%20%20%20%20bs%20%3D%20b%2Eslice%28bi%29%3B%0A%20%20%20%20if%20%28s%5Bi%5D%29%20s%5Bi%5D%20%2B%3D%20bs%3B%20%2F%2F%20coalesce%20with%20previous%20string%0A%20%20%20%20else%20s%5B%2B%2Bi%5D%20%3D%20bs%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Special%20optimization%20for%20only%20a%20single%20match%2E%0A%20%20%2F%2F%20Otherwise%2C%20interpolate%20each%20of%20the%20numbers%20and%20rejoin%20the%20string%2E%0A%20%20return%20s%2Elength%20%3C%202%20%3F%20%28q%5B0%5D%0A%20%20%20%20%20%20%3F%20one%28q%5B0%5D%2Ex%29%0A%20%20%20%20%20%20%3A%20zero%28b%29%29%0A%20%20%20%20%20%20%3A%20%28b%20%3D%20q%2Elength%2C%20function%28t%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%200%2C%20o%3B%20i%20%3C%20b%3B%20%2B%2Bi%29%20s%5B%28o%20%3D%20q%5Bi%5D%29%2Ei%5D%20%3D%20o%2Ex%28t%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20s%2Ejoin%28%22%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%7D%0A%0Afunction%20interpolateValue%28a%2C%20b%29%20%7B%0A%20%20var%20t%20%3D%20typeof%20b%2C%20c%3B%0A%20%20return%20b%20%3D%3D%20null%20%7C%7C%20t%20%3D%3D%3D%20%22boolean%22%20%3F%20constant%243%28b%29%0A%20%20%20%20%20%20%3A%20%28t%20%3D%3D%3D%20%22number%22%20%3F%20reinterpolate%0A%20%20%20%20%20%20%3A%20t%20%3D%3D%3D%20%22string%22%20%3F%20%28%28c%20%3D%20color%28b%29%29%20%3F%20%28b%20%3D%20c%2C%20interpolateRgb%29%20%3A%20interpolateString%29%0A%20%20%20%20%20%20%3A%20b%20instanceof%20color%20%3F%20interpolateRgb%0A%20%20%20%20%20%20%3A%20b%20instanceof%20Date%20%3F%20date%0A%20%20%20%20%20%20%3A%20Array%2EisArray%28b%29%20%3F%20array%241%0A%20%20%20%20%20%20%3A%20typeof%20b%2EvalueOf%20%21%3D%3D%20%22function%22%20%26%26%20typeof%20b%2EtoString%20%21%3D%3D%20%22function%22%20%7C%7C%20isNaN%28b%29%20%3F%20object%0A%20%20%20%20%20%20%3A%20reinterpolate%29%28a%2C%20b%29%3B%0A%7D%0A%0Afunction%20interpolateRound%28a%2C%20b%29%20%7B%0A%20%20return%20a%20%3D%20%2Ba%2C%20b%20%2D%3D%20a%2C%20function%28t%29%20%7B%0A%20%20%20%20return%20Math%2Eround%28a%20%2B%20b%20%2A%20t%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Avar%20degrees%20%3D%20180%20%2F%20Math%2EPI%3B%0A%0Avar%20identity%242%20%3D%20%7B%0A%20%20translateX%3A%200%2C%0A%20%20translateY%3A%200%2C%0A%20%20rotate%3A%200%2C%0A%20%20skewX%3A%200%2C%0A%20%20scaleX%3A%201%2C%0A%20%20scaleY%3A%201%0A%7D%3B%0A%0Afunction%20decompose%28a%2C%20b%2C%20c%2C%20d%2C%20e%2C%20f%29%20%7B%0A%20%20var%20scaleX%2C%20scaleY%2C%20skewX%3B%0A%20%20if%20%28scaleX%20%3D%20Math%2Esqrt%28a%20%2A%20a%20%2B%20b%20%2A%20b%29%29%20a%20%2F%3D%20scaleX%2C%20b%20%2F%3D%20scaleX%3B%0A%20%20if%20%28skewX%20%3D%20a%20%2A%20c%20%2B%20b%20%2A%20d%29%20c%20%2D%3D%20a%20%2A%20skewX%2C%20d%20%2D%3D%20b%20%2A%20skewX%3B%0A%20%20if%20%28scaleY%20%3D%20Math%2Esqrt%28c%20%2A%20c%20%2B%20d%20%2A%20d%29%29%20c%20%2F%3D%20scaleY%2C%20d%20%2F%3D%20scaleY%2C%20skewX%20%2F%3D%20scaleY%3B%0A%20%20if%20%28a%20%2A%20d%20%3C%20b%20%2A%20c%29%20a%20%3D%20%2Da%2C%20b%20%3D%20%2Db%2C%20skewX%20%3D%20%2DskewX%2C%20scaleX%20%3D%20%2DscaleX%3B%0A%20%20return%20%7B%0A%20%20%20%20translateX%3A%20e%2C%0A%20%20%20%20translateY%3A%20f%2C%0A%20%20%20%20rotate%3A%20Math%2Eatan2%28b%2C%20a%29%20%2A%20degrees%2C%0A%20%20%20%20skewX%3A%20Math%2Eatan%28skewX%29%20%2A%20degrees%2C%0A%20%20%20%20scaleX%3A%20scaleX%2C%0A%20%20%20%20scaleY%3A%20scaleY%0A%20%20%7D%3B%0A%7D%0A%0Avar%20cssNode%2C%0A%20%20%20%20cssRoot%2C%0A%20%20%20%20cssView%2C%0A%20%20%20%20svgNode%3B%0A%0Afunction%20parseCss%28value%29%20%7B%0A%20%20if%20%28value%20%3D%3D%3D%20%22none%22%29%20return%20identity%242%3B%0A%20%20if%20%28%21cssNode%29%20cssNode%20%3D%20document%2EcreateElement%28%22DIV%22%29%2C%20cssRoot%20%3D%20document%2EdocumentElement%2C%20cssView%20%3D%20document%2EdefaultView%3B%0A%20%20cssNode%2Estyle%2Etransform%20%3D%20value%3B%0A%20%20value%20%3D%20cssView%2EgetComputedStyle%28cssRoot%2EappendChild%28cssNode%29%2C%20null%29%2EgetPropertyValue%28%22transform%22%29%3B%0A%20%20cssRoot%2EremoveChild%28cssNode%29%3B%0A%20%20value%20%3D%20value%2Eslice%287%2C%20%2D1%29%2Esplit%28%22%2C%22%29%3B%0A%20%20return%20decompose%28%2Bvalue%5B0%5D%2C%20%2Bvalue%5B1%5D%2C%20%2Bvalue%5B2%5D%2C%20%2Bvalue%5B3%5D%2C%20%2Bvalue%5B4%5D%2C%20%2Bvalue%5B5%5D%29%3B%0A%7D%0A%0Afunction%20parseSvg%28value%29%20%7B%0A%20%20if%20%28value%20%3D%3D%20null%29%20return%20identity%242%3B%0A%20%20if%20%28%21svgNode%29%20svgNode%20%3D%20document%2EcreateElementNS%28%22http%3A%2F%2Fwww%2Ew3%2Eorg%2F2000%2Fsvg%22%2C%20%22g%22%29%3B%0A%20%20svgNode%2EsetAttribute%28%22transform%22%2C%20value%29%3B%0A%20%20if%20%28%21%28value%20%3D%20svgNode%2Etransform%2EbaseVal%2Econsolidate%28%29%29%29%20return%20identity%242%3B%0A%20%20value%20%3D%20value%2Ematrix%3B%0A%20%20return%20decompose%28value%2Ea%2C%20value%2Eb%2C%20value%2Ec%2C%20value%2Ed%2C%20value%2Ee%2C%20value%2Ef%29%3B%0A%7D%0A%0Afunction%20interpolateTransform%28parse%2C%20pxComma%2C%20pxParen%2C%20degParen%29%20%7B%0A%0A%20%20function%20pop%28s%29%20%7B%0A%20%20%20%20return%20s%2Elength%20%3F%20s%2Epop%28%29%20%2B%20%22%20%22%20%3A%20%22%22%3B%0A%20%20%7D%0A%0A%20%20function%20translate%28xa%2C%20ya%2C%20xb%2C%20yb%2C%20s%2C%20q%29%20%7B%0A%20%20%20%20if%20%28xa%20%21%3D%3D%20xb%20%7C%7C%20ya%20%21%3D%3D%20yb%29%20%7B%0A%20%20%20%20%20%20var%20i%20%3D%20s%2Epush%28%22translate%28%22%2C%20null%2C%20pxComma%2C%20null%2C%20pxParen%29%3B%0A%20%20%20%20%20%20q%2Epush%28%7Bi%3A%20i%20%2D%204%2C%20x%3A%20reinterpolate%28xa%2C%20xb%29%7D%2C%20%7Bi%3A%20i%20%2D%202%2C%20x%3A%20reinterpolate%28ya%2C%20yb%29%7D%29%3B%0A%20%20%20%20%7D%20else%20if%20%28xb%20%7C%7C%20yb%29%20%7B%0A%20%20%20%20%20%20s%2Epush%28%22translate%28%22%20%2B%20xb%20%2B%20pxComma%20%2B%20yb%20%2B%20pxParen%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20rotate%28a%2C%20b%2C%20s%2C%20q%29%20%7B%0A%20%20%20%20if%20%28a%20%21%3D%3D%20b%29%20%7B%0A%20%20%20%20%20%20if%20%28a%20%2D%20b%20%3E%20180%29%20b%20%2B%3D%20360%3B%20else%20if%20%28b%20%2D%20a%20%3E%20180%29%20a%20%2B%3D%20360%3B%20%2F%2F%20shortest%20path%0A%20%20%20%20%20%20q%2Epush%28%7Bi%3A%20s%2Epush%28pop%28s%29%20%2B%20%22rotate%28%22%2C%20null%2C%20degParen%29%20%2D%202%2C%20x%3A%20reinterpolate%28a%2C%20b%29%7D%29%3B%0A%20%20%20%20%7D%20else%20if%20%28b%29%20%7B%0A%20%20%20%20%20%20s%2Epush%28pop%28s%29%20%2B%20%22rotate%28%22%20%2B%20b%20%2B%20degParen%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20skewX%28a%2C%20b%2C%20s%2C%20q%29%20%7B%0A%20%20%20%20if%20%28a%20%21%3D%3D%20b%29%20%7B%0A%20%20%20%20%20%20q%2Epush%28%7Bi%3A%20s%2Epush%28pop%28s%29%20%2B%20%22skewX%28%22%2C%20null%2C%20degParen%29%20%2D%202%2C%20x%3A%20reinterpolate%28a%2C%20b%29%7D%29%3B%0A%20%20%20%20%7D%20else%20if%20%28b%29%20%7B%0A%20%20%20%20%20%20s%2Epush%28pop%28s%29%20%2B%20%22skewX%28%22%20%2B%20b%20%2B%20degParen%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20scale%28xa%2C%20ya%2C%20xb%2C%20yb%2C%20s%2C%20q%29%20%7B%0A%20%20%20%20if%20%28xa%20%21%3D%3D%20xb%20%7C%7C%20ya%20%21%3D%3D%20yb%29%20%7B%0A%20%20%20%20%20%20var%20i%20%3D%20s%2Epush%28pop%28s%29%20%2B%20%22scale%28%22%2C%20null%2C%20%22%2C%22%2C%20null%2C%20%22%29%22%29%3B%0A%20%20%20%20%20%20q%2Epush%28%7Bi%3A%20i%20%2D%204%2C%20x%3A%20reinterpolate%28xa%2C%20xb%29%7D%2C%20%7Bi%3A%20i%20%2D%202%2C%20x%3A%20reinterpolate%28ya%2C%20yb%29%7D%29%3B%0A%20%20%20%20%7D%20else%20if%20%28xb%20%21%3D%3D%201%20%7C%7C%20yb%20%21%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20s%2Epush%28pop%28s%29%20%2B%20%22scale%28%22%20%2B%20xb%20%2B%20%22%2C%22%20%2B%20yb%20%2B%20%22%29%22%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20function%28a%2C%20b%29%20%7B%0A%20%20%20%20var%20s%20%3D%20%5B%5D%2C%20%2F%2F%20string%20constants%20and%20placeholders%0A%20%20%20%20%20%20%20%20q%20%3D%20%5B%5D%3B%20%2F%2F%20number%20interpolators%0A%20%20%20%20a%20%3D%20parse%28a%29%2C%20b%20%3D%20parse%28b%29%3B%0A%20%20%20%20translate%28a%2EtranslateX%2C%20a%2EtranslateY%2C%20b%2EtranslateX%2C%20b%2EtranslateY%2C%20s%2C%20q%29%3B%0A%20%20%20%20rotate%28a%2Erotate%2C%20b%2Erotate%2C%20s%2C%20q%29%3B%0A%20%20%20%20skewX%28a%2EskewX%2C%20b%2EskewX%2C%20s%2C%20q%29%3B%0A%20%20%20%20scale%28a%2EscaleX%2C%20a%2EscaleY%2C%20b%2EscaleX%2C%20b%2EscaleY%2C%20s%2C%20q%29%3B%0A%20%20%20%20a%20%3D%20b%20%3D%20null%3B%20%2F%2F%20gc%0A%20%20%20%20return%20function%28t%29%20%7B%0A%20%20%20%20%20%20var%20i%20%3D%20%2D1%2C%20n%20%3D%20q%2Elength%2C%20o%3B%0A%20%20%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20s%5B%28o%20%3D%20q%5Bi%5D%29%2Ei%5D%20%3D%20o%2Ex%28t%29%3B%0A%20%20%20%20%20%20return%20s%2Ejoin%28%22%22%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%3B%0A%7D%0A%0Avar%20interpolateTransformCss%20%3D%20interpolateTransform%28parseCss%2C%20%22px%2C%20%22%2C%20%22px%29%22%2C%20%22deg%29%22%29%3B%0Avar%20interpolateTransformSvg%20%3D%20interpolateTransform%28parseSvg%2C%20%22%2C%20%22%2C%20%22%29%22%2C%20%22%29%22%29%3B%0A%0Avar%20rho%20%3D%20Math%2ESQRT2%2C%0A%20%20%20%20rho2%20%3D%202%2C%0A%20%20%20%20rho4%20%3D%204%2C%0A%20%20%20%20epsilon2%20%3D%201e%2D12%3B%0A%0Afunction%20cosh%28x%29%20%7B%0A%20%20return%20%28%28x%20%3D%20Math%2Eexp%28x%29%29%20%2B%201%20%2F%20x%29%20%2F%202%3B%0A%7D%0A%0Afunction%20sinh%28x%29%20%7B%0A%20%20return%20%28%28x%20%3D%20Math%2Eexp%28x%29%29%20%2D%201%20%2F%20x%29%20%2F%202%3B%0A%7D%0A%0Afunction%20tanh%28x%29%20%7B%0A%20%20return%20%28%28x%20%3D%20Math%2Eexp%282%20%2A%20x%29%29%20%2D%201%29%20%2F%20%28x%20%2B%201%29%3B%0A%7D%0A%0A%2F%2F%20p0%20%3D%20%5Bux0%2C%20uy0%2C%20w0%5D%0A%2F%2F%20p1%20%3D%20%5Bux1%2C%20uy1%2C%20w1%5D%0Afunction%20interpolateZoom%28p0%2C%20p1%29%20%7B%0A%20%20var%20ux0%20%3D%20p0%5B0%5D%2C%20uy0%20%3D%20p0%5B1%5D%2C%20w0%20%3D%20p0%5B2%5D%2C%0A%20%20%20%20%20%20ux1%20%3D%20p1%5B0%5D%2C%20uy1%20%3D%20p1%5B1%5D%2C%20w1%20%3D%20p1%5B2%5D%2C%0A%20%20%20%20%20%20dx%20%3D%20ux1%20%2D%20ux0%2C%0A%20%20%20%20%20%20dy%20%3D%20uy1%20%2D%20uy0%2C%0A%20%20%20%20%20%20d2%20%3D%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%2C%0A%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20S%3B%0A%0A%20%20%2F%2F%20Special%20case%20for%20u0%20%E2%89%85%20u1%2E%0A%20%20if%20%28d2%20%3C%20epsilon2%29%20%7B%0A%20%20%20%20S%20%3D%20Math%2Elog%28w1%20%2F%20w0%29%20%2F%20rho%3B%0A%20%20%20%20i%20%3D%20function%28t%29%20%7B%0A%20%20%20%20%20%20return%20%5B%0A%20%20%20%20%20%20%20%20ux0%20%2B%20t%20%2A%20dx%2C%0A%20%20%20%20%20%20%20%20uy0%20%2B%20t%20%2A%20dy%2C%0A%20%20%20%20%20%20%20%20w0%20%2A%20Math%2Eexp%28rho%20%2A%20t%20%2A%20S%29%0A%20%20%20%20%20%20%5D%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20General%20case%2E%0A%20%20else%20%7B%0A%20%20%20%20var%20d1%20%3D%20Math%2Esqrt%28d2%29%2C%0A%20%20%20%20%20%20%20%20b0%20%3D%20%28w1%20%2A%20w1%20%2D%20w0%20%2A%20w0%20%2B%20rho4%20%2A%20d2%29%20%2F%20%282%20%2A%20w0%20%2A%20rho2%20%2A%20d1%29%2C%0A%20%20%20%20%20%20%20%20b1%20%3D%20%28w1%20%2A%20w1%20%2D%20w0%20%2A%20w0%20%2D%20rho4%20%2A%20d2%29%20%2F%20%282%20%2A%20w1%20%2A%20rho2%20%2A%20d1%29%2C%0A%20%20%20%20%20%20%20%20r0%20%3D%20Math%2Elog%28Math%2Esqrt%28b0%20%2A%20b0%20%2B%201%29%20%2D%20b0%29%2C%0A%20%20%20%20%20%20%20%20r1%20%3D%20Math%2Elog%28Math%2Esqrt%28b1%20%2A%20b1%20%2B%201%29%20%2D%20b1%29%3B%0A%20%20%20%20S%20%3D%20%28r1%20%2D%20r0%29%20%2F%20rho%3B%0A%20%20%20%20i%20%3D%20function%28t%29%20%7B%0A%20%20%20%20%20%20var%20s%20%3D%20t%20%2A%20S%2C%0A%20%20%20%20%20%20%20%20%20%20coshr0%20%3D%20cosh%28r0%29%2C%0A%20%20%20%20%20%20%20%20%20%20u%20%3D%20w0%20%2F%20%28rho2%20%2A%20d1%29%20%2A%20%28coshr0%20%2A%20tanh%28rho%20%2A%20s%20%2B%20r0%29%20%2D%20sinh%28r0%29%29%3B%0A%20%20%20%20%20%20return%20%5B%0A%20%20%20%20%20%20%20%20ux0%20%2B%20u%20%2A%20dx%2C%0A%20%20%20%20%20%20%20%20uy0%20%2B%20u%20%2A%20dy%2C%0A%20%20%20%20%20%20%20%20w0%20%2A%20coshr0%20%2F%20cosh%28rho%20%2A%20s%20%2B%20r0%29%0A%20%20%20%20%20%20%5D%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20i%2Eduration%20%3D%20S%20%2A%201000%3B%0A%0A%20%20return%20i%3B%0A%7D%0A%0Afunction%20hsl%241%28hue%24%241%29%20%7B%0A%20%20return%20function%28start%2C%20end%29%20%7B%0A%20%20%20%20var%20h%20%3D%20hue%24%241%28%28start%20%3D%20hsl%28start%29%29%2Eh%2C%20%28end%20%3D%20hsl%28end%29%29%2Eh%29%2C%0A%20%20%20%20%20%20%20%20s%20%3D%20nogamma%28start%2Es%2C%20end%2Es%29%2C%0A%20%20%20%20%20%20%20%20l%20%3D%20nogamma%28start%2El%2C%20end%2El%29%2C%0A%20%20%20%20%20%20%20%20opacity%20%3D%20nogamma%28start%2Eopacity%2C%20end%2Eopacity%29%3B%0A%20%20%20%20return%20function%28t%29%20%7B%0A%20%20%20%20%20%20start%2Eh%20%3D%20h%28t%29%3B%0A%20%20%20%20%20%20start%2Es%20%3D%20s%28t%29%3B%0A%20%20%20%20%20%20start%2El%20%3D%20l%28t%29%3B%0A%20%20%20%20%20%20start%2Eopacity%20%3D%20opacity%28t%29%3B%0A%20%20%20%20%20%20return%20start%20%2B%20%22%22%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%0A%0Avar%20hsl%242%20%3D%20hsl%241%28hue%29%3B%0Avar%20hslLong%20%3D%20hsl%241%28nogamma%29%3B%0A%0Afunction%20lab%241%28start%2C%20end%29%20%7B%0A%20%20var%20l%20%3D%20nogamma%28%28start%20%3D%20lab%28start%29%29%2El%2C%20%28end%20%3D%20lab%28end%29%29%2El%29%2C%0A%20%20%20%20%20%20a%20%3D%20nogamma%28start%2Ea%2C%20end%2Ea%29%2C%0A%20%20%20%20%20%20b%20%3D%20nogamma%28start%2Eb%2C%20end%2Eb%29%2C%0A%20%20%20%20%20%20opacity%20%3D%20nogamma%28start%2Eopacity%2C%20end%2Eopacity%29%3B%0A%20%20return%20function%28t%29%20%7B%0A%20%20%20%20start%2El%20%3D%20l%28t%29%3B%0A%20%20%20%20start%2Ea%20%3D%20a%28t%29%3B%0A%20%20%20%20start%2Eb%20%3D%20b%28t%29%3B%0A%20%20%20%20start%2Eopacity%20%3D%20opacity%28t%29%3B%0A%20%20%20%20return%20start%20%2B%20%22%22%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20hcl%241%28hue%24%241%29%20%7B%0A%20%20return%20function%28start%2C%20end%29%20%7B%0A%20%20%20%20var%20h%20%3D%20hue%24%241%28%28start%20%3D%20hcl%28start%29%29%2Eh%2C%20%28end%20%3D%20hcl%28end%29%29%2Eh%29%2C%0A%20%20%20%20%20%20%20%20c%20%3D%20nogamma%28start%2Ec%2C%20end%2Ec%29%2C%0A%20%20%20%20%20%20%20%20l%20%3D%20nogamma%28start%2El%2C%20end%2El%29%2C%0A%20%20%20%20%20%20%20%20opacity%20%3D%20nogamma%28start%2Eopacity%2C%20end%2Eopacity%29%3B%0A%20%20%20%20return%20function%28t%29%20%7B%0A%20%20%20%20%20%20start%2Eh%20%3D%20h%28t%29%3B%0A%20%20%20%20%20%20start%2Ec%20%3D%20c%28t%29%3B%0A%20%20%20%20%20%20start%2El%20%3D%20l%28t%29%3B%0A%20%20%20%20%20%20start%2Eopacity%20%3D%20opacity%28t%29%3B%0A%20%20%20%20%20%20return%20start%20%2B%20%22%22%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%0A%0Avar%20hcl%242%20%3D%20hcl%241%28hue%29%3B%0Avar%20hclLong%20%3D%20hcl%241%28nogamma%29%3B%0A%0Afunction%20cubehelix%241%28hue%24%241%29%20%7B%0A%20%20return%20%28function%20cubehelixGamma%28y%29%20%7B%0A%20%20%20%20y%20%3D%20%2By%3B%0A%0A%20%20%20%20function%20cubehelix%24%241%28start%2C%20end%29%20%7B%0A%20%20%20%20%20%20var%20h%20%3D%20hue%24%241%28%28start%20%3D%20cubehelix%28start%29%29%2Eh%2C%20%28end%20%3D%20cubehelix%28end%29%29%2Eh%29%2C%0A%20%20%20%20%20%20%20%20%20%20s%20%3D%20nogamma%28start%2Es%2C%20end%2Es%29%2C%0A%20%20%20%20%20%20%20%20%20%20l%20%3D%20nogamma%28start%2El%2C%20end%2El%29%2C%0A%20%20%20%20%20%20%20%20%20%20opacity%20%3D%20nogamma%28start%2Eopacity%2C%20end%2Eopacity%29%3B%0A%20%20%20%20%20%20return%20function%28t%29%20%7B%0A%20%20%20%20%20%20%20%20start%2Eh%20%3D%20h%28t%29%3B%0A%20%20%20%20%20%20%20%20start%2Es%20%3D%20s%28t%29%3B%0A%20%20%20%20%20%20%20%20start%2El%20%3D%20l%28Math%2Epow%28t%2C%20y%29%29%3B%0A%20%20%20%20%20%20%20%20start%2Eopacity%20%3D%20opacity%28t%29%3B%0A%20%20%20%20%20%20%20%20return%20start%20%2B%20%22%22%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20cubehelix%24%241%2Egamma%20%3D%20cubehelixGamma%3B%0A%0A%20%20%20%20return%20cubehelix%24%241%3B%0A%20%20%7D%29%281%29%3B%0A%7D%0A%0Avar%20cubehelix%242%20%3D%20cubehelix%241%28hue%29%3B%0Avar%20cubehelixLong%20%3D%20cubehelix%241%28nogamma%29%3B%0A%0Afunction%20quantize%28interpolator%2C%20n%29%20%7B%0A%20%20var%20samples%20%3D%20new%20Array%28n%29%3B%0A%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20samples%5Bi%5D%20%3D%20interpolator%28i%20%2F%20%28n%20%2D%201%29%29%3B%0A%20%20return%20samples%3B%0A%7D%0A%0Avar%20frame%20%3D%200%2C%20%2F%2F%20is%20an%20animation%20frame%20pending%3F%0A%20%20%20%20timeout%20%3D%200%2C%20%2F%2F%20is%20a%20timeout%20pending%3F%0A%20%20%20%20interval%20%3D%200%2C%20%2F%2F%20are%20any%20timers%20active%3F%0A%20%20%20%20pokeDelay%20%3D%201000%2C%20%2F%2F%20how%20frequently%20we%20check%20for%20clock%20skew%0A%20%20%20%20taskHead%2C%0A%20%20%20%20taskTail%2C%0A%20%20%20%20clockLast%20%3D%200%2C%0A%20%20%20%20clockNow%20%3D%200%2C%0A%20%20%20%20clockSkew%20%3D%200%2C%0A%20%20%20%20clock%20%3D%20typeof%20performance%20%3D%3D%3D%20%22object%22%20%26%26%20performance%2Enow%20%3F%20performance%20%3A%20Date%2C%0A%20%20%20%20setFrame%20%3D%20typeof%20window%20%3D%3D%3D%20%22object%22%20%26%26%20window%2ErequestAnimationFrame%20%3F%20window%2ErequestAnimationFrame%2Ebind%28window%29%20%3A%20function%28f%29%20%7B%20setTimeout%28f%2C%2017%29%3B%20%7D%3B%0A%0Afunction%20now%28%29%20%7B%0A%20%20return%20clockNow%20%7C%7C%20%28setFrame%28clearNow%29%2C%20clockNow%20%3D%20clock%2Enow%28%29%20%2B%20clockSkew%29%3B%0A%7D%0A%0Afunction%20clearNow%28%29%20%7B%0A%20%20clockNow%20%3D%200%3B%0A%7D%0A%0Afunction%20Timer%28%29%20%7B%0A%20%20this%2E%5Fcall%20%3D%0A%20%20this%2E%5Ftime%20%3D%0A%20%20this%2E%5Fnext%20%3D%20null%3B%0A%7D%0A%0ATimer%2Eprototype%20%3D%20timer%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20Timer%2C%0A%20%20restart%3A%20function%28callback%2C%20delay%2C%20time%29%20%7B%0A%20%20%20%20if%20%28typeof%20callback%20%21%3D%3D%20%22function%22%29%20throw%20new%20TypeError%28%22callback%20is%20not%20a%20function%22%29%3B%0A%20%20%20%20time%20%3D%20%28time%20%3D%3D%20null%20%3F%20now%28%29%20%3A%20%2Btime%29%20%2B%20%28delay%20%3D%3D%20null%20%3F%200%20%3A%20%2Bdelay%29%3B%0A%20%20%20%20if%20%28%21this%2E%5Fnext%20%26%26%20taskTail%20%21%3D%3D%20this%29%20%7B%0A%20%20%20%20%20%20if%20%28taskTail%29%20taskTail%2E%5Fnext%20%3D%20this%3B%0A%20%20%20%20%20%20else%20taskHead%20%3D%20this%3B%0A%20%20%20%20%20%20taskTail%20%3D%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20this%2E%5Fcall%20%3D%20callback%3B%0A%20%20%20%20this%2E%5Ftime%20%3D%20time%3B%0A%20%20%20%20sleep%28%29%3B%0A%20%20%7D%2C%0A%20%20stop%3A%20function%28%29%20%7B%0A%20%20%20%20if%20%28this%2E%5Fcall%29%20%7B%0A%20%20%20%20%20%20this%2E%5Fcall%20%3D%20null%3B%0A%20%20%20%20%20%20this%2E%5Ftime%20%3D%20Infinity%3B%0A%20%20%20%20%20%20sleep%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20timer%28callback%2C%20delay%2C%20time%29%20%7B%0A%20%20var%20t%20%3D%20new%20Timer%3B%0A%20%20t%2Erestart%28callback%2C%20delay%2C%20time%29%3B%0A%20%20return%20t%3B%0A%7D%0A%0Afunction%20timerFlush%28%29%20%7B%0A%20%20now%28%29%3B%20%2F%2F%20Get%20the%20current%20time%2C%20if%20not%20already%20set%2E%0A%20%20%2B%2Bframe%3B%20%2F%2F%20Pretend%20we%E2%80%99ve%20set%20an%20alarm%2C%20if%20we%20haven%E2%80%99t%20already%2E%0A%20%20var%20t%20%3D%20taskHead%2C%20e%3B%0A%20%20while%20%28t%29%20%7B%0A%20%20%20%20if%20%28%28e%20%3D%20clockNow%20%2D%20t%2E%5Ftime%29%20%3E%3D%200%29%20t%2E%5Fcall%2Ecall%28null%2C%20e%29%3B%0A%20%20%20%20t%20%3D%20t%2E%5Fnext%3B%0A%20%20%7D%0A%20%20%2D%2Dframe%3B%0A%7D%0A%0Afunction%20wake%28%29%20%7B%0A%20%20clockNow%20%3D%20%28clockLast%20%3D%20clock%2Enow%28%29%29%20%2B%20clockSkew%3B%0A%20%20frame%20%3D%20timeout%20%3D%200%3B%0A%20%20try%20%7B%0A%20%20%20%20timerFlush%28%29%3B%0A%20%20%7D%20finally%20%7B%0A%20%20%20%20frame%20%3D%200%3B%0A%20%20%20%20nap%28%29%3B%0A%20%20%20%20clockNow%20%3D%200%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20poke%28%29%20%7B%0A%20%20var%20now%20%3D%20clock%2Enow%28%29%2C%20delay%20%3D%20now%20%2D%20clockLast%3B%0A%20%20if%20%28delay%20%3E%20pokeDelay%29%20clockSkew%20%2D%3D%20delay%2C%20clockLast%20%3D%20now%3B%0A%7D%0A%0Afunction%20nap%28%29%20%7B%0A%20%20var%20t0%2C%20t1%20%3D%20taskHead%2C%20t2%2C%20time%20%3D%20Infinity%3B%0A%20%20while%20%28t1%29%20%7B%0A%20%20%20%20if%20%28t1%2E%5Fcall%29%20%7B%0A%20%20%20%20%20%20if%20%28time%20%3E%20t1%2E%5Ftime%29%20time%20%3D%20t1%2E%5Ftime%3B%0A%20%20%20%20%20%20t0%20%3D%20t1%2C%20t1%20%3D%20t1%2E%5Fnext%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20t2%20%3D%20t1%2E%5Fnext%2C%20t1%2E%5Fnext%20%3D%20null%3B%0A%20%20%20%20%20%20t1%20%3D%20t0%20%3F%20t0%2E%5Fnext%20%3D%20t2%20%3A%20taskHead%20%3D%20t2%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20taskTail%20%3D%20t0%3B%0A%20%20sleep%28time%29%3B%0A%7D%0A%0Afunction%20sleep%28time%29%20%7B%0A%20%20if%20%28frame%29%20return%3B%20%2F%2F%20Soonest%20alarm%20already%20set%2C%20or%20will%20be%2E%0A%20%20if%20%28timeout%29%20timeout%20%3D%20clearTimeout%28timeout%29%3B%0A%20%20var%20delay%20%3D%20time%20%2D%20clockNow%3B%20%2F%2F%20Strictly%20less%20than%20if%20we%20recomputed%20clockNow%2E%0A%20%20if%20%28delay%20%3E%2024%29%20%7B%0A%20%20%20%20if%20%28time%20%3C%20Infinity%29%20timeout%20%3D%20setTimeout%28wake%2C%20time%20%2D%20clock%2Enow%28%29%20%2D%20clockSkew%29%3B%0A%20%20%20%20if%20%28interval%29%20interval%20%3D%20clearInterval%28interval%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28%21interval%29%20clockLast%20%3D%20clock%2Enow%28%29%2C%20interval%20%3D%20setInterval%28poke%2C%20pokeDelay%29%3B%0A%20%20%20%20frame%20%3D%201%2C%20setFrame%28wake%29%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20timeout%241%28callback%2C%20delay%2C%20time%29%20%7B%0A%20%20var%20t%20%3D%20new%20Timer%3B%0A%20%20delay%20%3D%20delay%20%3D%3D%20null%20%3F%200%20%3A%20%2Bdelay%3B%0A%20%20t%2Erestart%28function%28elapsed%29%20%7B%0A%20%20%20%20t%2Estop%28%29%3B%0A%20%20%20%20callback%28elapsed%20%2B%20delay%29%3B%0A%20%20%7D%2C%20delay%2C%20time%29%3B%0A%20%20return%20t%3B%0A%7D%0A%0Afunction%20interval%241%28callback%2C%20delay%2C%20time%29%20%7B%0A%20%20var%20t%20%3D%20new%20Timer%2C%20total%20%3D%20delay%3B%0A%20%20if%20%28delay%20%3D%3D%20null%29%20return%20t%2Erestart%28callback%2C%20delay%2C%20time%29%2C%20t%3B%0A%20%20delay%20%3D%20%2Bdelay%2C%20time%20%3D%20time%20%3D%3D%20null%20%3F%20now%28%29%20%3A%20%2Btime%3B%0A%20%20t%2Erestart%28function%20tick%28elapsed%29%20%7B%0A%20%20%20%20elapsed%20%2B%3D%20total%3B%0A%20%20%20%20t%2Erestart%28tick%2C%20total%20%2B%3D%20delay%2C%20time%29%3B%0A%20%20%20%20callback%28elapsed%29%3B%0A%20%20%7D%2C%20delay%2C%20time%29%3B%0A%20%20return%20t%3B%0A%7D%0A%0Avar%20emptyOn%20%3D%20dispatch%28%22start%22%2C%20%22end%22%2C%20%22interrupt%22%29%3B%0Avar%20emptyTween%20%3D%20%5B%5D%3B%0A%0Avar%20CREATED%20%3D%200%3B%0Avar%20SCHEDULED%20%3D%201%3B%0Avar%20STARTING%20%3D%202%3B%0Avar%20STARTED%20%3D%203%3B%0Avar%20RUNNING%20%3D%204%3B%0Avar%20ENDING%20%3D%205%3B%0Avar%20ENDED%20%3D%206%3B%0A%0Afunction%20schedule%28node%2C%20name%2C%20id%2C%20index%2C%20group%2C%20timing%29%20%7B%0A%20%20var%20schedules%20%3D%20node%2E%5F%5Ftransition%3B%0A%20%20if%20%28%21schedules%29%20node%2E%5F%5Ftransition%20%3D%20%7B%7D%3B%0A%20%20else%20if%20%28id%20in%20schedules%29%20return%3B%0A%20%20create%241%28node%2C%20id%2C%20%7B%0A%20%20%20%20name%3A%20name%2C%0A%20%20%20%20index%3A%20index%2C%20%2F%2F%20For%20context%20during%20callback%2E%0A%20%20%20%20group%3A%20group%2C%20%2F%2F%20For%20context%20during%20callback%2E%0A%20%20%20%20on%3A%20emptyOn%2C%0A%20%20%20%20tween%3A%20emptyTween%2C%0A%20%20%20%20time%3A%20timing%2Etime%2C%0A%20%20%20%20delay%3A%20timing%2Edelay%2C%0A%20%20%20%20duration%3A%20timing%2Eduration%2C%0A%20%20%20%20ease%3A%20timing%2Eease%2C%0A%20%20%20%20timer%3A%20null%2C%0A%20%20%20%20state%3A%20CREATED%0A%20%20%7D%29%3B%0A%7D%0A%0Afunction%20init%28node%2C%20id%29%20%7B%0A%20%20var%20schedule%20%3D%20get%241%28node%2C%20id%29%3B%0A%20%20if%20%28schedule%2Estate%20%3E%20CREATED%29%20throw%20new%20Error%28%22too%20late%3B%20already%20scheduled%22%29%3B%0A%20%20return%20schedule%3B%0A%7D%0A%0Afunction%20set%241%28node%2C%20id%29%20%7B%0A%20%20var%20schedule%20%3D%20get%241%28node%2C%20id%29%3B%0A%20%20if%20%28schedule%2Estate%20%3E%20STARTING%29%20throw%20new%20Error%28%22too%20late%3B%20already%20started%22%29%3B%0A%20%20return%20schedule%3B%0A%7D%0A%0Afunction%20get%241%28node%2C%20id%29%20%7B%0A%20%20var%20schedule%20%3D%20node%2E%5F%5Ftransition%3B%0A%20%20if%20%28%21schedule%20%7C%7C%20%21%28schedule%20%3D%20schedule%5Bid%5D%29%29%20throw%20new%20Error%28%22transition%20not%20found%22%29%3B%0A%20%20return%20schedule%3B%0A%7D%0A%0Afunction%20create%241%28node%2C%20id%2C%20self%29%20%7B%0A%20%20var%20schedules%20%3D%20node%2E%5F%5Ftransition%2C%0A%20%20%20%20%20%20tween%3B%0A%0A%20%20%2F%2F%20Initialize%20the%20self%20timer%20when%20the%20transition%20is%20created%2E%0A%20%20%2F%2F%20Note%20the%20actual%20delay%20is%20not%20known%20until%20the%20first%20callback%21%0A%20%20schedules%5Bid%5D%20%3D%20self%3B%0A%20%20self%2Etimer%20%3D%20timer%28schedule%2C%200%2C%20self%2Etime%29%3B%0A%0A%20%20function%20schedule%28elapsed%29%20%7B%0A%20%20%20%20self%2Estate%20%3D%20SCHEDULED%3B%0A%20%20%20%20self%2Etimer%2Erestart%28start%2C%20self%2Edelay%2C%20self%2Etime%29%3B%0A%0A%20%20%20%20%2F%2F%20If%20the%20elapsed%20delay%20is%20less%20than%20our%20first%20sleep%2C%20start%20immediately%2E%0A%20%20%20%20if%20%28self%2Edelay%20%3C%3D%20elapsed%29%20start%28elapsed%20%2D%20self%2Edelay%29%3B%0A%20%20%7D%0A%0A%20%20function%20start%28elapsed%29%20%7B%0A%20%20%20%20var%20i%2C%20j%2C%20n%2C%20o%3B%0A%0A%20%20%20%20%2F%2F%20If%20the%20state%20is%20not%20SCHEDULED%2C%20then%20we%20previously%20errored%20on%20start%2E%0A%20%20%20%20if%20%28self%2Estate%20%21%3D%3D%20SCHEDULED%29%20return%20stop%28%29%3B%0A%0A%20%20%20%20for%20%28i%20in%20schedules%29%20%7B%0A%20%20%20%20%20%20o%20%3D%20schedules%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28o%2Ename%20%21%3D%3D%20self%2Ename%29%20continue%3B%0A%0A%20%20%20%20%20%20%2F%2F%20While%20this%20element%20already%20has%20a%20starting%20transition%20during%20this%20frame%2C%0A%20%20%20%20%20%20%2F%2F%20defer%20starting%20an%20interrupting%20transition%20until%20that%20transition%20has%20a%0A%20%20%20%20%20%20%2F%2F%20chance%20to%20tick%20%28and%20possibly%20end%29%3B%20see%20d3%2Fd3%2Dtransition%2354%21%0A%20%20%20%20%20%20if%20%28o%2Estate%20%3D%3D%3D%20STARTED%29%20return%20timeout%241%28start%29%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Interrupt%20the%20active%20transition%2C%20if%20any%2E%0A%20%20%20%20%20%20%2F%2F%20Dispatch%20the%20interrupt%20event%2E%0A%20%20%20%20%20%20if%20%28o%2Estate%20%3D%3D%3D%20RUNNING%29%20%7B%0A%20%20%20%20%20%20%20%20o%2Estate%20%3D%20ENDED%3B%0A%20%20%20%20%20%20%20%20o%2Etimer%2Estop%28%29%3B%0A%20%20%20%20%20%20%20%20o%2Eon%2Ecall%28%22interrupt%22%2C%20node%2C%20node%2E%5F%5Fdata%5F%5F%2C%20o%2Eindex%2C%20o%2Egroup%29%3B%0A%20%20%20%20%20%20%20%20delete%20schedules%5Bi%5D%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20Cancel%20any%20pre%2Dempted%20transitions%2E%20No%20interrupt%20event%20is%20dispatched%0A%20%20%20%20%20%20%2F%2F%20because%20the%20cancelled%20transitions%20never%20started%2E%20Note%20that%20this%20also%0A%20%20%20%20%20%20%2F%2F%20removes%20this%20transition%20from%20the%20pending%20list%21%0A%20%20%20%20%20%20else%20if%20%28%2Bi%20%3C%20id%29%20%7B%0A%20%20%20%20%20%20%20%20o%2Estate%20%3D%20ENDED%3B%0A%20%20%20%20%20%20%20%20o%2Etimer%2Estop%28%29%3B%0A%20%20%20%20%20%20%20%20delete%20schedules%5Bi%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Defer%20the%20first%20tick%20to%20end%20of%20the%20current%20frame%3B%20see%20d3%2Fd3%231576%2E%0A%20%20%20%20%2F%2F%20Note%20the%20transition%20may%20be%20canceled%20after%20start%20and%20before%20the%20first%20tick%21%0A%20%20%20%20%2F%2F%20Note%20this%20must%20be%20scheduled%20before%20the%20start%20event%3B%20see%20d3%2Fd3%2Dtransition%2316%21%0A%20%20%20%20%2F%2F%20Assuming%20this%20is%20successful%2C%20subsequent%20callbacks%20go%20straight%20to%20tick%2E%0A%20%20%20%20timeout%241%28function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28self%2Estate%20%3D%3D%3D%20STARTED%29%20%7B%0A%20%20%20%20%20%20%20%20self%2Estate%20%3D%20RUNNING%3B%0A%20%20%20%20%20%20%20%20self%2Etimer%2Erestart%28tick%2C%20self%2Edelay%2C%20self%2Etime%29%3B%0A%20%20%20%20%20%20%20%20tick%28elapsed%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20%2F%2F%20Dispatch%20the%20start%20event%2E%0A%20%20%20%20%2F%2F%20Note%20this%20must%20be%20done%20before%20the%20tween%20are%20initialized%2E%0A%20%20%20%20self%2Estate%20%3D%20STARTING%3B%0A%20%20%20%20self%2Eon%2Ecall%28%22start%22%2C%20node%2C%20node%2E%5F%5Fdata%5F%5F%2C%20self%2Eindex%2C%20self%2Egroup%29%3B%0A%20%20%20%20if%20%28self%2Estate%20%21%3D%3D%20STARTING%29%20return%3B%20%2F%2F%20interrupted%0A%20%20%20%20self%2Estate%20%3D%20STARTED%3B%0A%0A%20%20%20%20%2F%2F%20Initialize%20the%20tween%2C%20deleting%20null%20tween%2E%0A%20%20%20%20tween%20%3D%20new%20Array%28n%20%3D%20self%2Etween%2Elength%29%3B%0A%20%20%20%20for%20%28i%20%3D%200%2C%20j%20%3D%20%2D1%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28o%20%3D%20self%2Etween%5Bi%5D%2Evalue%2Ecall%28node%2C%20node%2E%5F%5Fdata%5F%5F%2C%20self%2Eindex%2C%20self%2Egroup%29%29%20%7B%0A%20%20%20%20%20%20%20%20tween%5B%2B%2Bj%5D%20%3D%20o%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20tween%2Elength%20%3D%20j%20%2B%201%3B%0A%20%20%7D%0A%0A%20%20function%20tick%28elapsed%29%20%7B%0A%20%20%20%20var%20t%20%3D%20elapsed%20%3C%20self%2Eduration%20%3F%20self%2Eease%2Ecall%28null%2C%20elapsed%20%2F%20self%2Eduration%29%20%3A%20%28self%2Etimer%2Erestart%28stop%29%2C%20self%2Estate%20%3D%20ENDING%2C%201%29%2C%0A%20%20%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20tween%2Elength%3B%0A%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20tween%5Bi%5D%2Ecall%28null%2C%20t%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Dispatch%20the%20end%20event%2E%0A%20%20%20%20if%20%28self%2Estate%20%3D%3D%3D%20ENDING%29%20%7B%0A%20%20%20%20%20%20self%2Eon%2Ecall%28%22end%22%2C%20node%2C%20node%2E%5F%5Fdata%5F%5F%2C%20self%2Eindex%2C%20self%2Egroup%29%3B%0A%20%20%20%20%20%20stop%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20stop%28%29%20%7B%0A%20%20%20%20self%2Estate%20%3D%20ENDED%3B%0A%20%20%20%20self%2Etimer%2Estop%28%29%3B%0A%20%20%20%20delete%20schedules%5Bid%5D%3B%0A%20%20%20%20for%20%28var%20i%20in%20schedules%29%20return%3B%20%2F%2F%20eslint%2Ddisable%2Dline%20no%2Dunused%2Dvars%0A%20%20%20%20delete%20node%2E%5F%5Ftransition%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20interrupt%28node%2C%20name%29%20%7B%0A%20%20var%20schedules%20%3D%20node%2E%5F%5Ftransition%2C%0A%20%20%20%20%20%20schedule%24%241%2C%0A%20%20%20%20%20%20active%2C%0A%20%20%20%20%20%20empty%20%3D%20true%2C%0A%20%20%20%20%20%20i%3B%0A%0A%20%20if%20%28%21schedules%29%20return%3B%0A%0A%20%20name%20%3D%20name%20%3D%3D%20null%20%3F%20null%20%3A%20name%20%2B%20%22%22%3B%0A%0A%20%20for%20%28i%20in%20schedules%29%20%7B%0A%20%20%20%20if%20%28%28schedule%24%241%20%3D%20schedules%5Bi%5D%29%2Ename%20%21%3D%3D%20name%29%20%7B%20empty%20%3D%20false%3B%20continue%3B%20%7D%0A%20%20%20%20active%20%3D%20schedule%24%241%2Estate%20%3E%20STARTING%20%26%26%20schedule%24%241%2Estate%20%3C%20ENDING%3B%0A%20%20%20%20schedule%24%241%2Estate%20%3D%20ENDED%3B%0A%20%20%20%20schedule%24%241%2Etimer%2Estop%28%29%3B%0A%20%20%20%20if%20%28active%29%20schedule%24%241%2Eon%2Ecall%28%22interrupt%22%2C%20node%2C%20node%2E%5F%5Fdata%5F%5F%2C%20schedule%24%241%2Eindex%2C%20schedule%24%241%2Egroup%29%3B%0A%20%20%20%20delete%20schedules%5Bi%5D%3B%0A%20%20%7D%0A%0A%20%20if%20%28empty%29%20delete%20node%2E%5F%5Ftransition%3B%0A%7D%0A%0Afunction%20selection%5Finterrupt%28name%29%20%7B%0A%20%20return%20this%2Eeach%28function%28%29%20%7B%0A%20%20%20%20interrupt%28this%2C%20name%29%3B%0A%20%20%7D%29%3B%0A%7D%0A%0Afunction%20tweenRemove%28id%2C%20name%29%20%7B%0A%20%20var%20tween0%2C%20tween1%3B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20schedule%24%241%20%3D%20set%241%28this%2C%20id%29%2C%0A%20%20%20%20%20%20%20%20tween%20%3D%20schedule%24%241%2Etween%3B%0A%0A%20%20%20%20%2F%2F%20If%20this%20node%20shared%20tween%20with%20the%20previous%20node%2C%0A%20%20%20%20%2F%2F%20just%20assign%20the%20updated%20shared%20tween%20and%20we%E2%80%99re%20done%21%0A%20%20%20%20%2F%2F%20Otherwise%2C%20copy%2Don%2Dwrite%2E%0A%20%20%20%20if%20%28tween%20%21%3D%3D%20tween0%29%20%7B%0A%20%20%20%20%20%20tween1%20%3D%20tween0%20%3D%20tween%3B%0A%20%20%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20tween1%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28tween1%5Bi%5D%2Ename%20%3D%3D%3D%20name%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20tween1%20%3D%20tween1%2Eslice%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20tween1%2Esplice%28i%2C%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20schedule%24%241%2Etween%20%3D%20tween1%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20tweenFunction%28id%2C%20name%2C%20value%29%20%7B%0A%20%20var%20tween0%2C%20tween1%3B%0A%20%20if%20%28typeof%20value%20%21%3D%3D%20%22function%22%29%20throw%20new%20Error%3B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20schedule%24%241%20%3D%20set%241%28this%2C%20id%29%2C%0A%20%20%20%20%20%20%20%20tween%20%3D%20schedule%24%241%2Etween%3B%0A%0A%20%20%20%20%2F%2F%20If%20this%20node%20shared%20tween%20with%20the%20previous%20node%2C%0A%20%20%20%20%2F%2F%20just%20assign%20the%20updated%20shared%20tween%20and%20we%E2%80%99re%20done%21%0A%20%20%20%20%2F%2F%20Otherwise%2C%20copy%2Don%2Dwrite%2E%0A%20%20%20%20if%20%28tween%20%21%3D%3D%20tween0%29%20%7B%0A%20%20%20%20%20%20tween1%20%3D%20%28tween0%20%3D%20tween%29%2Eslice%28%29%3B%0A%20%20%20%20%20%20for%20%28var%20t%20%3D%20%7Bname%3A%20name%2C%20value%3A%20value%7D%2C%20i%20%3D%200%2C%20n%20%3D%20tween1%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28tween1%5Bi%5D%2Ename%20%3D%3D%3D%20name%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20tween1%5Bi%5D%20%3D%20t%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28i%20%3D%3D%3D%20n%29%20tween1%2Epush%28t%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20schedule%24%241%2Etween%20%3D%20tween1%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20transition%5Ftween%28name%2C%20value%29%20%7B%0A%20%20var%20id%20%3D%20this%2E%5Fid%3B%0A%0A%20%20name%20%2B%3D%20%22%22%3B%0A%0A%20%20if%20%28arguments%2Elength%20%3C%202%29%20%7B%0A%20%20%20%20var%20tween%20%3D%20get%241%28this%2Enode%28%29%2C%20id%29%2Etween%3B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20tween%2Elength%2C%20t%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28%28t%20%3D%20tween%5Bi%5D%29%2Ename%20%3D%3D%3D%20name%29%20%7B%0A%20%20%20%20%20%20%20%20return%20t%2Evalue%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20null%3B%0A%20%20%7D%0A%0A%20%20return%20this%2Eeach%28%28value%20%3D%3D%20null%20%3F%20tweenRemove%20%3A%20tweenFunction%29%28id%2C%20name%2C%20value%29%29%3B%0A%7D%0A%0Afunction%20tweenValue%28transition%2C%20name%2C%20value%29%20%7B%0A%20%20var%20id%20%3D%20transition%2E%5Fid%3B%0A%0A%20%20transition%2Eeach%28function%28%29%20%7B%0A%20%20%20%20var%20schedule%24%241%20%3D%20set%241%28this%2C%20id%29%3B%0A%20%20%20%20%28schedule%24%241%2Evalue%20%7C%7C%20%28schedule%24%241%2Evalue%20%3D%20%7B%7D%29%29%5Bname%5D%20%3D%20value%2Eapply%28this%2C%20arguments%29%3B%0A%20%20%7D%29%3B%0A%0A%20%20return%20function%28node%29%20%7B%0A%20%20%20%20return%20get%241%28node%2C%20id%29%2Evalue%5Bname%5D%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20interpolate%28a%2C%20b%29%20%7B%0A%20%20var%20c%3B%0A%20%20return%20%28typeof%20b%20%3D%3D%3D%20%22number%22%20%3F%20reinterpolate%0A%20%20%20%20%20%20%3A%20b%20instanceof%20color%20%3F%20interpolateRgb%0A%20%20%20%20%20%20%3A%20%28c%20%3D%20color%28b%29%29%20%3F%20%28b%20%3D%20c%2C%20interpolateRgb%29%0A%20%20%20%20%20%20%3A%20interpolateString%29%28a%2C%20b%29%3B%0A%7D%0A%0Afunction%20attrRemove%241%28name%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20this%2EremoveAttribute%28name%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20attrRemoveNS%241%28fullname%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20this%2EremoveAttributeNS%28fullname%2Espace%2C%20fullname%2Elocal%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20attrConstant%241%28name%2C%20interpolate%24%241%2C%20value1%29%20%7B%0A%20%20var%20value00%2C%0A%20%20%20%20%20%20interpolate0%3B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20value0%20%3D%20this%2EgetAttribute%28name%29%3B%0A%20%20%20%20return%20value0%20%3D%3D%3D%20value1%20%3F%20null%0A%20%20%20%20%20%20%20%20%3A%20value0%20%3D%3D%3D%20value00%20%3F%20interpolate0%0A%20%20%20%20%20%20%20%20%3A%20interpolate0%20%3D%20interpolate%24%241%28value00%20%3D%20value0%2C%20value1%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20attrConstantNS%241%28fullname%2C%20interpolate%24%241%2C%20value1%29%20%7B%0A%20%20var%20value00%2C%0A%20%20%20%20%20%20interpolate0%3B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20value0%20%3D%20this%2EgetAttributeNS%28fullname%2Espace%2C%20fullname%2Elocal%29%3B%0A%20%20%20%20return%20value0%20%3D%3D%3D%20value1%20%3F%20null%0A%20%20%20%20%20%20%20%20%3A%20value0%20%3D%3D%3D%20value00%20%3F%20interpolate0%0A%20%20%20%20%20%20%20%20%3A%20interpolate0%20%3D%20interpolate%24%241%28value00%20%3D%20value0%2C%20value1%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20attrFunction%241%28name%2C%20interpolate%24%241%2C%20value%29%20%7B%0A%20%20var%20value00%2C%0A%20%20%20%20%20%20value10%2C%0A%20%20%20%20%20%20interpolate0%3B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20value0%2C%20value1%20%3D%20value%28this%29%3B%0A%20%20%20%20if%20%28value1%20%3D%3D%20null%29%20return%20void%20this%2EremoveAttribute%28name%29%3B%0A%20%20%20%20value0%20%3D%20this%2EgetAttribute%28name%29%3B%0A%20%20%20%20return%20value0%20%3D%3D%3D%20value1%20%3F%20null%0A%20%20%20%20%20%20%20%20%3A%20value0%20%3D%3D%3D%20value00%20%26%26%20value1%20%3D%3D%3D%20value10%20%3F%20interpolate0%0A%20%20%20%20%20%20%20%20%3A%20interpolate0%20%3D%20interpolate%24%241%28value00%20%3D%20value0%2C%20value10%20%3D%20value1%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20attrFunctionNS%241%28fullname%2C%20interpolate%24%241%2C%20value%29%20%7B%0A%20%20var%20value00%2C%0A%20%20%20%20%20%20value10%2C%0A%20%20%20%20%20%20interpolate0%3B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20value0%2C%20value1%20%3D%20value%28this%29%3B%0A%20%20%20%20if%20%28value1%20%3D%3D%20null%29%20return%20void%20this%2EremoveAttributeNS%28fullname%2Espace%2C%20fullname%2Elocal%29%3B%0A%20%20%20%20value0%20%3D%20this%2EgetAttributeNS%28fullname%2Espace%2C%20fullname%2Elocal%29%3B%0A%20%20%20%20return%20value0%20%3D%3D%3D%20value1%20%3F%20null%0A%20%20%20%20%20%20%20%20%3A%20value0%20%3D%3D%3D%20value00%20%26%26%20value1%20%3D%3D%3D%20value10%20%3F%20interpolate0%0A%20%20%20%20%20%20%20%20%3A%20interpolate0%20%3D%20interpolate%24%241%28value00%20%3D%20value0%2C%20value10%20%3D%20value1%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20transition%5Fattr%28name%2C%20value%29%20%7B%0A%20%20var%20fullname%20%3D%20namespace%28name%29%2C%20i%20%3D%20fullname%20%3D%3D%3D%20%22transform%22%20%3F%20interpolateTransformSvg%20%3A%20interpolate%3B%0A%20%20return%20this%2EattrTween%28name%2C%20typeof%20value%20%3D%3D%3D%20%22function%22%0A%20%20%20%20%20%20%3F%20%28fullname%2Elocal%20%3F%20attrFunctionNS%241%20%3A%20attrFunction%241%29%28fullname%2C%20i%2C%20tweenValue%28this%2C%20%22attr%2E%22%20%2B%20name%2C%20value%29%29%0A%20%20%20%20%20%20%3A%20value%20%3D%3D%20null%20%3F%20%28fullname%2Elocal%20%3F%20attrRemoveNS%241%20%3A%20attrRemove%241%29%28fullname%29%0A%20%20%20%20%20%20%3A%20%28fullname%2Elocal%20%3F%20attrConstantNS%241%20%3A%20attrConstant%241%29%28fullname%2C%20i%2C%20value%20%2B%20%22%22%29%29%3B%0A%7D%0A%0Afunction%20attrTweenNS%28fullname%2C%20value%29%20%7B%0A%20%20function%20tween%28%29%20%7B%0A%20%20%20%20var%20node%20%3D%20this%2C%20i%20%3D%20value%2Eapply%28node%2C%20arguments%29%3B%0A%20%20%20%20return%20i%20%26%26%20function%28t%29%20%7B%0A%20%20%20%20%20%20node%2EsetAttributeNS%28fullname%2Espace%2C%20fullname%2Elocal%2C%20i%28t%29%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20tween%2E%5Fvalue%20%3D%20value%3B%0A%20%20return%20tween%3B%0A%7D%0A%0Afunction%20attrTween%28name%2C%20value%29%20%7B%0A%20%20function%20tween%28%29%20%7B%0A%20%20%20%20var%20node%20%3D%20this%2C%20i%20%3D%20value%2Eapply%28node%2C%20arguments%29%3B%0A%20%20%20%20return%20i%20%26%26%20function%28t%29%20%7B%0A%20%20%20%20%20%20node%2EsetAttribute%28name%2C%20i%28t%29%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20tween%2E%5Fvalue%20%3D%20value%3B%0A%20%20return%20tween%3B%0A%7D%0A%0Afunction%20transition%5FattrTween%28name%2C%20value%29%20%7B%0A%20%20var%20key%20%3D%20%22attr%2E%22%20%2B%20name%3B%0A%20%20if%20%28arguments%2Elength%20%3C%202%29%20return%20%28key%20%3D%20this%2Etween%28key%29%29%20%26%26%20key%2E%5Fvalue%3B%0A%20%20if%20%28value%20%3D%3D%20null%29%20return%20this%2Etween%28key%2C%20null%29%3B%0A%20%20if%20%28typeof%20value%20%21%3D%3D%20%22function%22%29%20throw%20new%20Error%3B%0A%20%20var%20fullname%20%3D%20namespace%28name%29%3B%0A%20%20return%20this%2Etween%28key%2C%20%28fullname%2Elocal%20%3F%20attrTweenNS%20%3A%20attrTween%29%28fullname%2C%20value%29%29%3B%0A%7D%0A%0Afunction%20delayFunction%28id%2C%20value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20init%28this%2C%20id%29%2Edelay%20%3D%20%2Bvalue%2Eapply%28this%2C%20arguments%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20delayConstant%28id%2C%20value%29%20%7B%0A%20%20return%20value%20%3D%20%2Bvalue%2C%20function%28%29%20%7B%0A%20%20%20%20init%28this%2C%20id%29%2Edelay%20%3D%20value%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20transition%5Fdelay%28value%29%20%7B%0A%20%20var%20id%20%3D%20this%2E%5Fid%3B%0A%0A%20%20return%20arguments%2Elength%0A%20%20%20%20%20%20%3F%20this%2Eeach%28%28typeof%20value%20%3D%3D%3D%20%22function%22%0A%20%20%20%20%20%20%20%20%20%20%3F%20delayFunction%0A%20%20%20%20%20%20%20%20%20%20%3A%20delayConstant%29%28id%2C%20value%29%29%0A%20%20%20%20%20%20%3A%20get%241%28this%2Enode%28%29%2C%20id%29%2Edelay%3B%0A%7D%0A%0Afunction%20durationFunction%28id%2C%20value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20set%241%28this%2C%20id%29%2Eduration%20%3D%20%2Bvalue%2Eapply%28this%2C%20arguments%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20durationConstant%28id%2C%20value%29%20%7B%0A%20%20return%20value%20%3D%20%2Bvalue%2C%20function%28%29%20%7B%0A%20%20%20%20set%241%28this%2C%20id%29%2Eduration%20%3D%20value%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20transition%5Fduration%28value%29%20%7B%0A%20%20var%20id%20%3D%20this%2E%5Fid%3B%0A%0A%20%20return%20arguments%2Elength%0A%20%20%20%20%20%20%3F%20this%2Eeach%28%28typeof%20value%20%3D%3D%3D%20%22function%22%0A%20%20%20%20%20%20%20%20%20%20%3F%20durationFunction%0A%20%20%20%20%20%20%20%20%20%20%3A%20durationConstant%29%28id%2C%20value%29%29%0A%20%20%20%20%20%20%3A%20get%241%28this%2Enode%28%29%2C%20id%29%2Eduration%3B%0A%7D%0A%0Afunction%20easeConstant%28id%2C%20value%29%20%7B%0A%20%20if%20%28typeof%20value%20%21%3D%3D%20%22function%22%29%20throw%20new%20Error%3B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20set%241%28this%2C%20id%29%2Eease%20%3D%20value%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20transition%5Fease%28value%29%20%7B%0A%20%20var%20id%20%3D%20this%2E%5Fid%3B%0A%0A%20%20return%20arguments%2Elength%0A%20%20%20%20%20%20%3F%20this%2Eeach%28easeConstant%28id%2C%20value%29%29%0A%20%20%20%20%20%20%3A%20get%241%28this%2Enode%28%29%2C%20id%29%2Eease%3B%0A%7D%0A%0Afunction%20transition%5Ffilter%28match%29%20%7B%0A%20%20if%20%28typeof%20match%20%21%3D%3D%20%22function%22%29%20match%20%3D%20matcher%241%28match%29%3B%0A%0A%20%20for%20%28var%20groups%20%3D%20this%2E%5Fgroups%2C%20m%20%3D%20groups%2Elength%2C%20subgroups%20%3D%20new%20Array%28m%29%2C%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20group%20%3D%20groups%5Bj%5D%2C%20n%20%3D%20group%2Elength%2C%20subgroup%20%3D%20subgroups%5Bj%5D%20%3D%20%5B%5D%2C%20node%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28%28node%20%3D%20group%5Bi%5D%29%20%26%26%20match%2Ecall%28node%2C%20node%2E%5F%5Fdata%5F%5F%2C%20i%2C%20group%29%29%20%7B%0A%20%20%20%20%20%20%20%20subgroup%2Epush%28node%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20new%20Transition%28subgroups%2C%20this%2E%5Fparents%2C%20this%2E%5Fname%2C%20this%2E%5Fid%29%3B%0A%7D%0A%0Afunction%20transition%5Fmerge%28transition%24%241%29%20%7B%0A%20%20if%20%28transition%24%241%2E%5Fid%20%21%3D%3D%20this%2E%5Fid%29%20throw%20new%20Error%3B%0A%0A%20%20for%20%28var%20groups0%20%3D%20this%2E%5Fgroups%2C%20groups1%20%3D%20transition%24%241%2E%5Fgroups%2C%20m0%20%3D%20groups0%2Elength%2C%20m1%20%3D%20groups1%2Elength%2C%20m%20%3D%20Math%2Emin%28m0%2C%20m1%29%2C%20merges%20%3D%20new%20Array%28m0%29%2C%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20group0%20%3D%20groups0%5Bj%5D%2C%20group1%20%3D%20groups1%5Bj%5D%2C%20n%20%3D%20group0%2Elength%2C%20merge%20%3D%20merges%5Bj%5D%20%3D%20new%20Array%28n%29%2C%20node%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28node%20%3D%20group0%5Bi%5D%20%7C%7C%20group1%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20merge%5Bi%5D%20%3D%20node%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20for%20%28%3B%20j%20%3C%20m0%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20merges%5Bj%5D%20%3D%20groups0%5Bj%5D%3B%0A%20%20%7D%0A%0A%20%20return%20new%20Transition%28merges%2C%20this%2E%5Fparents%2C%20this%2E%5Fname%2C%20this%2E%5Fid%29%3B%0A%7D%0A%0Afunction%20start%28name%29%20%7B%0A%20%20return%20%28name%20%2B%20%22%22%29%2Etrim%28%29%2Esplit%28%2F%5E%7C%5Cs%2B%2F%29%2Eevery%28function%28t%29%20%7B%0A%20%20%20%20var%20i%20%3D%20t%2EindexOf%28%22%2E%22%29%3B%0A%20%20%20%20if%20%28i%20%3E%3D%200%29%20t%20%3D%20t%2Eslice%280%2C%20i%29%3B%0A%20%20%20%20return%20%21t%20%7C%7C%20t%20%3D%3D%3D%20%22start%22%3B%0A%20%20%7D%29%3B%0A%7D%0A%0Afunction%20onFunction%28id%2C%20name%2C%20listener%29%20%7B%0A%20%20var%20on0%2C%20on1%2C%20sit%20%3D%20start%28name%29%20%3F%20init%20%3A%20set%241%3B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20schedule%24%241%20%3D%20sit%28this%2C%20id%29%2C%0A%20%20%20%20%20%20%20%20on%20%3D%20schedule%24%241%2Eon%3B%0A%0A%20%20%20%20%2F%2F%20If%20this%20node%20shared%20a%20dispatch%20with%20the%20previous%20node%2C%0A%20%20%20%20%2F%2F%20just%20assign%20the%20updated%20shared%20dispatch%20and%20we%E2%80%99re%20done%21%0A%20%20%20%20%2F%2F%20Otherwise%2C%20copy%2Don%2Dwrite%2E%0A%20%20%20%20if%20%28on%20%21%3D%3D%20on0%29%20%28on1%20%3D%20%28on0%20%3D%20on%29%2Ecopy%28%29%29%2Eon%28name%2C%20listener%29%3B%0A%0A%20%20%20%20schedule%24%241%2Eon%20%3D%20on1%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20transition%5Fon%28name%2C%20listener%29%20%7B%0A%20%20var%20id%20%3D%20this%2E%5Fid%3B%0A%0A%20%20return%20arguments%2Elength%20%3C%202%0A%20%20%20%20%20%20%3F%20get%241%28this%2Enode%28%29%2C%20id%29%2Eon%2Eon%28name%29%0A%20%20%20%20%20%20%3A%20this%2Eeach%28onFunction%28id%2C%20name%2C%20listener%29%29%3B%0A%7D%0A%0Afunction%20removeFunction%28id%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20parent%20%3D%20this%2EparentNode%3B%0A%20%20%20%20for%20%28var%20i%20in%20this%2E%5F%5Ftransition%29%20if%20%28%2Bi%20%21%3D%3D%20id%29%20return%3B%0A%20%20%20%20if%20%28parent%29%20parent%2EremoveChild%28this%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20transition%5Fremove%28%29%20%7B%0A%20%20return%20this%2Eon%28%22end%2Eremove%22%2C%20removeFunction%28this%2E%5Fid%29%29%3B%0A%7D%0A%0Afunction%20transition%5Fselect%28select%24%241%29%20%7B%0A%20%20var%20name%20%3D%20this%2E%5Fname%2C%0A%20%20%20%20%20%20id%20%3D%20this%2E%5Fid%3B%0A%0A%20%20if%20%28typeof%20select%24%241%20%21%3D%3D%20%22function%22%29%20select%24%241%20%3D%20selector%28select%24%241%29%3B%0A%0A%20%20for%20%28var%20groups%20%3D%20this%2E%5Fgroups%2C%20m%20%3D%20groups%2Elength%2C%20subgroups%20%3D%20new%20Array%28m%29%2C%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20group%20%3D%20groups%5Bj%5D%2C%20n%20%3D%20group%2Elength%2C%20subgroup%20%3D%20subgroups%5Bj%5D%20%3D%20new%20Array%28n%29%2C%20node%2C%20subnode%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28%28node%20%3D%20group%5Bi%5D%29%20%26%26%20%28subnode%20%3D%20select%24%241%2Ecall%28node%2C%20node%2E%5F%5Fdata%5F%5F%2C%20i%2C%20group%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%22%5F%5Fdata%5F%5F%22%20in%20node%29%20subnode%2E%5F%5Fdata%5F%5F%20%3D%20node%2E%5F%5Fdata%5F%5F%3B%0A%20%20%20%20%20%20%20%20subgroup%5Bi%5D%20%3D%20subnode%3B%0A%20%20%20%20%20%20%20%20schedule%28subgroup%5Bi%5D%2C%20name%2C%20id%2C%20i%2C%20subgroup%2C%20get%241%28node%2C%20id%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20new%20Transition%28subgroups%2C%20this%2E%5Fparents%2C%20name%2C%20id%29%3B%0A%7D%0A%0Afunction%20transition%5FselectAll%28select%24%241%29%20%7B%0A%20%20var%20name%20%3D%20this%2E%5Fname%2C%0A%20%20%20%20%20%20id%20%3D%20this%2E%5Fid%3B%0A%0A%20%20if%20%28typeof%20select%24%241%20%21%3D%3D%20%22function%22%29%20select%24%241%20%3D%20selectorAll%28select%24%241%29%3B%0A%0A%20%20for%20%28var%20groups%20%3D%20this%2E%5Fgroups%2C%20m%20%3D%20groups%2Elength%2C%20subgroups%20%3D%20%5B%5D%2C%20parents%20%3D%20%5B%5D%2C%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20group%20%3D%20groups%5Bj%5D%2C%20n%20%3D%20group%2Elength%2C%20node%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28node%20%3D%20group%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28var%20children%20%3D%20select%24%241%2Ecall%28node%2C%20node%2E%5F%5Fdata%5F%5F%2C%20i%2C%20group%29%2C%20child%2C%20inherit%20%3D%20get%241%28node%2C%20id%29%2C%20k%20%3D%200%2C%20l%20%3D%20children%2Elength%3B%20k%20%3C%20l%3B%20%2B%2Bk%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28child%20%3D%20children%5Bk%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20schedule%28child%2C%20name%2C%20id%2C%20k%2C%20children%2C%20inherit%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20subgroups%2Epush%28children%29%3B%0A%20%20%20%20%20%20%20%20parents%2Epush%28node%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20new%20Transition%28subgroups%2C%20parents%2C%20name%2C%20id%29%3B%0A%7D%0A%0Avar%20Selection%241%20%3D%20selection%2Eprototype%2Econstructor%3B%0A%0Afunction%20transition%5Fselection%28%29%20%7B%0A%20%20return%20new%20Selection%241%28this%2E%5Fgroups%2C%20this%2E%5Fparents%29%3B%0A%7D%0A%0Afunction%20styleRemove%241%28name%2C%20interpolate%24%241%29%20%7B%0A%20%20var%20value00%2C%0A%20%20%20%20%20%20value10%2C%0A%20%20%20%20%20%20interpolate0%3B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20value0%20%3D%20styleValue%28this%2C%20name%29%2C%0A%20%20%20%20%20%20%20%20value1%20%3D%20%28this%2Estyle%2EremoveProperty%28name%29%2C%20styleValue%28this%2C%20name%29%29%3B%0A%20%20%20%20return%20value0%20%3D%3D%3D%20value1%20%3F%20null%0A%20%20%20%20%20%20%20%20%3A%20value0%20%3D%3D%3D%20value00%20%26%26%20value1%20%3D%3D%3D%20value10%20%3F%20interpolate0%0A%20%20%20%20%20%20%20%20%3A%20interpolate0%20%3D%20interpolate%24%241%28value00%20%3D%20value0%2C%20value10%20%3D%20value1%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20styleRemoveEnd%28name%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20this%2Estyle%2EremoveProperty%28name%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20styleConstant%241%28name%2C%20interpolate%24%241%2C%20value1%29%20%7B%0A%20%20var%20value00%2C%0A%20%20%20%20%20%20interpolate0%3B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20value0%20%3D%20styleValue%28this%2C%20name%29%3B%0A%20%20%20%20return%20value0%20%3D%3D%3D%20value1%20%3F%20null%0A%20%20%20%20%20%20%20%20%3A%20value0%20%3D%3D%3D%20value00%20%3F%20interpolate0%0A%20%20%20%20%20%20%20%20%3A%20interpolate0%20%3D%20interpolate%24%241%28value00%20%3D%20value0%2C%20value1%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20styleFunction%241%28name%2C%20interpolate%24%241%2C%20value%29%20%7B%0A%20%20var%20value00%2C%0A%20%20%20%20%20%20value10%2C%0A%20%20%20%20%20%20interpolate0%3B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20value0%20%3D%20styleValue%28this%2C%20name%29%2C%0A%20%20%20%20%20%20%20%20value1%20%3D%20value%28this%29%3B%0A%20%20%20%20if%20%28value1%20%3D%3D%20null%29%20value1%20%3D%20%28this%2Estyle%2EremoveProperty%28name%29%2C%20styleValue%28this%2C%20name%29%29%3B%0A%20%20%20%20return%20value0%20%3D%3D%3D%20value1%20%3F%20null%0A%20%20%20%20%20%20%20%20%3A%20value0%20%3D%3D%3D%20value00%20%26%26%20value1%20%3D%3D%3D%20value10%20%3F%20interpolate0%0A%20%20%20%20%20%20%20%20%3A%20interpolate0%20%3D%20interpolate%24%241%28value00%20%3D%20value0%2C%20value10%20%3D%20value1%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20transition%5Fstyle%28name%2C%20value%2C%20priority%29%20%7B%0A%20%20var%20i%20%3D%20%28name%20%2B%3D%20%22%22%29%20%3D%3D%3D%20%22transform%22%20%3F%20interpolateTransformCss%20%3A%20interpolate%3B%0A%20%20return%20value%20%3D%3D%20null%20%3F%20this%0A%20%20%20%20%20%20%20%20%20%20%2EstyleTween%28name%2C%20styleRemove%241%28name%2C%20i%29%29%0A%20%20%20%20%20%20%20%20%20%20%2Eon%28%22end%2Estyle%2E%22%20%2B%20name%2C%20styleRemoveEnd%28name%29%29%0A%20%20%20%20%20%20%3A%20this%2EstyleTween%28name%2C%20typeof%20value%20%3D%3D%3D%20%22function%22%0A%20%20%20%20%20%20%20%20%20%20%3F%20styleFunction%241%28name%2C%20i%2C%20tweenValue%28this%2C%20%22style%2E%22%20%2B%20name%2C%20value%29%29%0A%20%20%20%20%20%20%20%20%20%20%3A%20styleConstant%241%28name%2C%20i%2C%20value%20%2B%20%22%22%29%2C%20priority%29%3B%0A%7D%0A%0Afunction%20styleTween%28name%2C%20value%2C%20priority%29%20%7B%0A%20%20function%20tween%28%29%20%7B%0A%20%20%20%20var%20node%20%3D%20this%2C%20i%20%3D%20value%2Eapply%28node%2C%20arguments%29%3B%0A%20%20%20%20return%20i%20%26%26%20function%28t%29%20%7B%0A%20%20%20%20%20%20node%2Estyle%2EsetProperty%28name%2C%20i%28t%29%2C%20priority%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20tween%2E%5Fvalue%20%3D%20value%3B%0A%20%20return%20tween%3B%0A%7D%0A%0Afunction%20transition%5FstyleTween%28name%2C%20value%2C%20priority%29%20%7B%0A%20%20var%20key%20%3D%20%22style%2E%22%20%2B%20%28name%20%2B%3D%20%22%22%29%3B%0A%20%20if%20%28arguments%2Elength%20%3C%202%29%20return%20%28key%20%3D%20this%2Etween%28key%29%29%20%26%26%20key%2E%5Fvalue%3B%0A%20%20if%20%28value%20%3D%3D%20null%29%20return%20this%2Etween%28key%2C%20null%29%3B%0A%20%20if%20%28typeof%20value%20%21%3D%3D%20%22function%22%29%20throw%20new%20Error%3B%0A%20%20return%20this%2Etween%28key%2C%20styleTween%28name%2C%20value%2C%20priority%20%3D%3D%20null%20%3F%20%22%22%20%3A%20priority%29%29%3B%0A%7D%0A%0Afunction%20textConstant%241%28value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20this%2EtextContent%20%3D%20value%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20textFunction%241%28value%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20value1%20%3D%20value%28this%29%3B%0A%20%20%20%20this%2EtextContent%20%3D%20value1%20%3D%3D%20null%20%3F%20%22%22%20%3A%20value1%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20transition%5Ftext%28value%29%20%7B%0A%20%20return%20this%2Etween%28%22text%22%2C%20typeof%20value%20%3D%3D%3D%20%22function%22%0A%20%20%20%20%20%20%3F%20textFunction%241%28tweenValue%28this%2C%20%22text%22%2C%20value%29%29%0A%20%20%20%20%20%20%3A%20textConstant%241%28value%20%3D%3D%20null%20%3F%20%22%22%20%3A%20value%20%2B%20%22%22%29%29%3B%0A%7D%0A%0Afunction%20transition%5Ftransition%28%29%20%7B%0A%20%20var%20name%20%3D%20this%2E%5Fname%2C%0A%20%20%20%20%20%20id0%20%3D%20this%2E%5Fid%2C%0A%20%20%20%20%20%20id1%20%3D%20newId%28%29%3B%0A%0A%20%20for%20%28var%20groups%20%3D%20this%2E%5Fgroups%2C%20m%20%3D%20groups%2Elength%2C%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20group%20%3D%20groups%5Bj%5D%2C%20n%20%3D%20group%2Elength%2C%20node%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28node%20%3D%20group%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20var%20inherit%20%3D%20get%241%28node%2C%20id0%29%3B%0A%20%20%20%20%20%20%20%20schedule%28node%2C%20name%2C%20id1%2C%20i%2C%20group%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20time%3A%20inherit%2Etime%20%2B%20inherit%2Edelay%20%2B%20inherit%2Eduration%2C%0A%20%20%20%20%20%20%20%20%20%20delay%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20duration%3A%20inherit%2Eduration%2C%0A%20%20%20%20%20%20%20%20%20%20ease%3A%20inherit%2Eease%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20new%20Transition%28groups%2C%20this%2E%5Fparents%2C%20name%2C%20id1%29%3B%0A%7D%0A%0Avar%20id%20%3D%200%3B%0A%0Afunction%20Transition%28groups%2C%20parents%2C%20name%2C%20id%29%20%7B%0A%20%20this%2E%5Fgroups%20%3D%20groups%3B%0A%20%20this%2E%5Fparents%20%3D%20parents%3B%0A%20%20this%2E%5Fname%20%3D%20name%3B%0A%20%20this%2E%5Fid%20%3D%20id%3B%0A%7D%0A%0Afunction%20transition%28name%29%20%7B%0A%20%20return%20selection%28%29%2Etransition%28name%29%3B%0A%7D%0A%0Afunction%20newId%28%29%20%7B%0A%20%20return%20%2B%2Bid%3B%0A%7D%0A%0Avar%20selection%5Fprototype%20%3D%20selection%2Eprototype%3B%0A%0ATransition%2Eprototype%20%3D%20transition%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20Transition%2C%0A%20%20select%3A%20transition%5Fselect%2C%0A%20%20selectAll%3A%20transition%5FselectAll%2C%0A%20%20filter%3A%20transition%5Ffilter%2C%0A%20%20merge%3A%20transition%5Fmerge%2C%0A%20%20selection%3A%20transition%5Fselection%2C%0A%20%20transition%3A%20transition%5Ftransition%2C%0A%20%20call%3A%20selection%5Fprototype%2Ecall%2C%0A%20%20nodes%3A%20selection%5Fprototype%2Enodes%2C%0A%20%20node%3A%20selection%5Fprototype%2Enode%2C%0A%20%20size%3A%20selection%5Fprototype%2Esize%2C%0A%20%20empty%3A%20selection%5Fprototype%2Eempty%2C%0A%20%20each%3A%20selection%5Fprototype%2Eeach%2C%0A%20%20on%3A%20transition%5Fon%2C%0A%20%20attr%3A%20transition%5Fattr%2C%0A%20%20attrTween%3A%20transition%5FattrTween%2C%0A%20%20style%3A%20transition%5Fstyle%2C%0A%20%20styleTween%3A%20transition%5FstyleTween%2C%0A%20%20text%3A%20transition%5Ftext%2C%0A%20%20remove%3A%20transition%5Fremove%2C%0A%20%20tween%3A%20transition%5Ftween%2C%0A%20%20delay%3A%20transition%5Fdelay%2C%0A%20%20duration%3A%20transition%5Fduration%2C%0A%20%20ease%3A%20transition%5Fease%0A%7D%3B%0A%0Afunction%20linear%241%28t%29%20%7B%0A%20%20return%20%2Bt%3B%0A%7D%0A%0Afunction%20quadIn%28t%29%20%7B%0A%20%20return%20t%20%2A%20t%3B%0A%7D%0A%0Afunction%20quadOut%28t%29%20%7B%0A%20%20return%20t%20%2A%20%282%20%2D%20t%29%3B%0A%7D%0A%0Afunction%20quadInOut%28t%29%20%7B%0A%20%20return%20%28%28t%20%2A%3D%202%29%20%3C%3D%201%20%3F%20t%20%2A%20t%20%3A%20%2D%2Dt%20%2A%20%282%20%2D%20t%29%20%2B%201%29%20%2F%202%3B%0A%7D%0A%0Afunction%20cubicIn%28t%29%20%7B%0A%20%20return%20t%20%2A%20t%20%2A%20t%3B%0A%7D%0A%0Afunction%20cubicOut%28t%29%20%7B%0A%20%20return%20%2D%2Dt%20%2A%20t%20%2A%20t%20%2B%201%3B%0A%7D%0A%0Afunction%20cubicInOut%28t%29%20%7B%0A%20%20return%20%28%28t%20%2A%3D%202%29%20%3C%3D%201%20%3F%20t%20%2A%20t%20%2A%20t%20%3A%20%28t%20%2D%3D%202%29%20%2A%20t%20%2A%20t%20%2B%202%29%20%2F%202%3B%0A%7D%0A%0Avar%20exponent%20%3D%203%3B%0A%0Avar%20polyIn%20%3D%20%28function%20custom%28e%29%20%7B%0A%20%20e%20%3D%20%2Be%3B%0A%0A%20%20function%20polyIn%28t%29%20%7B%0A%20%20%20%20return%20Math%2Epow%28t%2C%20e%29%3B%0A%20%20%7D%0A%0A%20%20polyIn%2Eexponent%20%3D%20custom%3B%0A%0A%20%20return%20polyIn%3B%0A%7D%29%28exponent%29%3B%0A%0Avar%20polyOut%20%3D%20%28function%20custom%28e%29%20%7B%0A%20%20e%20%3D%20%2Be%3B%0A%0A%20%20function%20polyOut%28t%29%20%7B%0A%20%20%20%20return%201%20%2D%20Math%2Epow%281%20%2D%20t%2C%20e%29%3B%0A%20%20%7D%0A%0A%20%20polyOut%2Eexponent%20%3D%20custom%3B%0A%0A%20%20return%20polyOut%3B%0A%7D%29%28exponent%29%3B%0A%0Avar%20polyInOut%20%3D%20%28function%20custom%28e%29%20%7B%0A%20%20e%20%3D%20%2Be%3B%0A%0A%20%20function%20polyInOut%28t%29%20%7B%0A%20%20%20%20return%20%28%28t%20%2A%3D%202%29%20%3C%3D%201%20%3F%20Math%2Epow%28t%2C%20e%29%20%3A%202%20%2D%20Math%2Epow%282%20%2D%20t%2C%20e%29%29%20%2F%202%3B%0A%20%20%7D%0A%0A%20%20polyInOut%2Eexponent%20%3D%20custom%3B%0A%0A%20%20return%20polyInOut%3B%0A%7D%29%28exponent%29%3B%0A%0Avar%20pi%20%3D%20Math%2EPI%2C%0A%20%20%20%20halfPi%20%3D%20pi%20%2F%202%3B%0A%0Afunction%20sinIn%28t%29%20%7B%0A%20%20return%201%20%2D%20Math%2Ecos%28t%20%2A%20halfPi%29%3B%0A%7D%0A%0Afunction%20sinOut%28t%29%20%7B%0A%20%20return%20Math%2Esin%28t%20%2A%20halfPi%29%3B%0A%7D%0A%0Afunction%20sinInOut%28t%29%20%7B%0A%20%20return%20%281%20%2D%20Math%2Ecos%28pi%20%2A%20t%29%29%20%2F%202%3B%0A%7D%0A%0Afunction%20expIn%28t%29%20%7B%0A%20%20return%20Math%2Epow%282%2C%2010%20%2A%20t%20%2D%2010%29%3B%0A%7D%0A%0Afunction%20expOut%28t%29%20%7B%0A%20%20return%201%20%2D%20Math%2Epow%282%2C%20%2D10%20%2A%20t%29%3B%0A%7D%0A%0Afunction%20expInOut%28t%29%20%7B%0A%20%20return%20%28%28t%20%2A%3D%202%29%20%3C%3D%201%20%3F%20Math%2Epow%282%2C%2010%20%2A%20t%20%2D%2010%29%20%3A%202%20%2D%20Math%2Epow%282%2C%2010%20%2D%2010%20%2A%20t%29%29%20%2F%202%3B%0A%7D%0A%0Afunction%20circleIn%28t%29%20%7B%0A%20%20return%201%20%2D%20Math%2Esqrt%281%20%2D%20t%20%2A%20t%29%3B%0A%7D%0A%0Afunction%20circleOut%28t%29%20%7B%0A%20%20return%20Math%2Esqrt%281%20%2D%20%2D%2Dt%20%2A%20t%29%3B%0A%7D%0A%0Afunction%20circleInOut%28t%29%20%7B%0A%20%20return%20%28%28t%20%2A%3D%202%29%20%3C%3D%201%20%3F%201%20%2D%20Math%2Esqrt%281%20%2D%20t%20%2A%20t%29%20%3A%20Math%2Esqrt%281%20%2D%20%28t%20%2D%3D%202%29%20%2A%20t%29%20%2B%201%29%20%2F%202%3B%0A%7D%0A%0Avar%20b1%20%3D%204%20%2F%2011%2C%0A%20%20%20%20b2%20%3D%206%20%2F%2011%2C%0A%20%20%20%20b3%20%3D%208%20%2F%2011%2C%0A%20%20%20%20b4%20%3D%203%20%2F%204%2C%0A%20%20%20%20b5%20%3D%209%20%2F%2011%2C%0A%20%20%20%20b6%20%3D%2010%20%2F%2011%2C%0A%20%20%20%20b7%20%3D%2015%20%2F%2016%2C%0A%20%20%20%20b8%20%3D%2021%20%2F%2022%2C%0A%20%20%20%20b9%20%3D%2063%20%2F%2064%2C%0A%20%20%20%20b0%20%3D%201%20%2F%20b1%20%2F%20b1%3B%0A%0Afunction%20bounceIn%28t%29%20%7B%0A%20%20return%201%20%2D%20bounceOut%281%20%2D%20t%29%3B%0A%7D%0A%0Afunction%20bounceOut%28t%29%20%7B%0A%20%20return%20%28t%20%3D%20%2Bt%29%20%3C%20b1%20%3F%20b0%20%2A%20t%20%2A%20t%20%3A%20t%20%3C%20b3%20%3F%20b0%20%2A%20%28t%20%2D%3D%20b2%29%20%2A%20t%20%2B%20b4%20%3A%20t%20%3C%20b6%20%3F%20b0%20%2A%20%28t%20%2D%3D%20b5%29%20%2A%20t%20%2B%20b7%20%3A%20b0%20%2A%20%28t%20%2D%3D%20b8%29%20%2A%20t%20%2B%20b9%3B%0A%7D%0A%0Afunction%20bounceInOut%28t%29%20%7B%0A%20%20return%20%28%28t%20%2A%3D%202%29%20%3C%3D%201%20%3F%201%20%2D%20bounceOut%281%20%2D%20t%29%20%3A%20bounceOut%28t%20%2D%201%29%20%2B%201%29%20%2F%202%3B%0A%7D%0A%0Avar%20overshoot%20%3D%201%2E70158%3B%0A%0Avar%20backIn%20%3D%20%28function%20custom%28s%29%20%7B%0A%20%20s%20%3D%20%2Bs%3B%0A%0A%20%20function%20backIn%28t%29%20%7B%0A%20%20%20%20return%20t%20%2A%20t%20%2A%20%28%28s%20%2B%201%29%20%2A%20t%20%2D%20s%29%3B%0A%20%20%7D%0A%0A%20%20backIn%2Eovershoot%20%3D%20custom%3B%0A%0A%20%20return%20backIn%3B%0A%7D%29%28overshoot%29%3B%0A%0Avar%20backOut%20%3D%20%28function%20custom%28s%29%20%7B%0A%20%20s%20%3D%20%2Bs%3B%0A%0A%20%20function%20backOut%28t%29%20%7B%0A%20%20%20%20return%20%2D%2Dt%20%2A%20t%20%2A%20%28%28s%20%2B%201%29%20%2A%20t%20%2B%20s%29%20%2B%201%3B%0A%20%20%7D%0A%0A%20%20backOut%2Eovershoot%20%3D%20custom%3B%0A%0A%20%20return%20backOut%3B%0A%7D%29%28overshoot%29%3B%0A%0Avar%20backInOut%20%3D%20%28function%20custom%28s%29%20%7B%0A%20%20s%20%3D%20%2Bs%3B%0A%0A%20%20function%20backInOut%28t%29%20%7B%0A%20%20%20%20return%20%28%28t%20%2A%3D%202%29%20%3C%201%20%3F%20t%20%2A%20t%20%2A%20%28%28s%20%2B%201%29%20%2A%20t%20%2D%20s%29%20%3A%20%28t%20%2D%3D%202%29%20%2A%20t%20%2A%20%28%28s%20%2B%201%29%20%2A%20t%20%2B%20s%29%20%2B%202%29%20%2F%202%3B%0A%20%20%7D%0A%0A%20%20backInOut%2Eovershoot%20%3D%20custom%3B%0A%0A%20%20return%20backInOut%3B%0A%7D%29%28overshoot%29%3B%0A%0Avar%20tau%20%3D%202%20%2A%20Math%2EPI%2C%0A%20%20%20%20amplitude%20%3D%201%2C%0A%20%20%20%20period%20%3D%200%2E3%3B%0A%0Avar%20elasticIn%20%3D%20%28function%20custom%28a%2C%20p%29%20%7B%0A%20%20var%20s%20%3D%20Math%2Easin%281%20%2F%20%28a%20%3D%20Math%2Emax%281%2C%20a%29%29%29%20%2A%20%28p%20%2F%3D%20tau%29%3B%0A%0A%20%20function%20elasticIn%28t%29%20%7B%0A%20%20%20%20return%20a%20%2A%20Math%2Epow%282%2C%2010%20%2A%20%2D%2Dt%29%20%2A%20Math%2Esin%28%28s%20%2D%20t%29%20%2F%20p%29%3B%0A%20%20%7D%0A%0A%20%20elasticIn%2Eamplitude%20%3D%20function%28a%29%20%7B%20return%20custom%28a%2C%20p%20%2A%20tau%29%3B%20%7D%3B%0A%20%20elasticIn%2Eperiod%20%3D%20function%28p%29%20%7B%20return%20custom%28a%2C%20p%29%3B%20%7D%3B%0A%0A%20%20return%20elasticIn%3B%0A%7D%29%28amplitude%2C%20period%29%3B%0A%0Avar%20elasticOut%20%3D%20%28function%20custom%28a%2C%20p%29%20%7B%0A%20%20var%20s%20%3D%20Math%2Easin%281%20%2F%20%28a%20%3D%20Math%2Emax%281%2C%20a%29%29%29%20%2A%20%28p%20%2F%3D%20tau%29%3B%0A%0A%20%20function%20elasticOut%28t%29%20%7B%0A%20%20%20%20return%201%20%2D%20a%20%2A%20Math%2Epow%282%2C%20%2D10%20%2A%20%28t%20%3D%20%2Bt%29%29%20%2A%20Math%2Esin%28%28t%20%2B%20s%29%20%2F%20p%29%3B%0A%20%20%7D%0A%0A%20%20elasticOut%2Eamplitude%20%3D%20function%28a%29%20%7B%20return%20custom%28a%2C%20p%20%2A%20tau%29%3B%20%7D%3B%0A%20%20elasticOut%2Eperiod%20%3D%20function%28p%29%20%7B%20return%20custom%28a%2C%20p%29%3B%20%7D%3B%0A%0A%20%20return%20elasticOut%3B%0A%7D%29%28amplitude%2C%20period%29%3B%0A%0Avar%20elasticInOut%20%3D%20%28function%20custom%28a%2C%20p%29%20%7B%0A%20%20var%20s%20%3D%20Math%2Easin%281%20%2F%20%28a%20%3D%20Math%2Emax%281%2C%20a%29%29%29%20%2A%20%28p%20%2F%3D%20tau%29%3B%0A%0A%20%20function%20elasticInOut%28t%29%20%7B%0A%20%20%20%20return%20%28%28t%20%3D%20t%20%2A%202%20%2D%201%29%20%3C%200%0A%20%20%20%20%20%20%20%20%3F%20a%20%2A%20Math%2Epow%282%2C%2010%20%2A%20t%29%20%2A%20Math%2Esin%28%28s%20%2D%20t%29%20%2F%20p%29%0A%20%20%20%20%20%20%20%20%3A%202%20%2D%20a%20%2A%20Math%2Epow%282%2C%20%2D10%20%2A%20t%29%20%2A%20Math%2Esin%28%28s%20%2B%20t%29%20%2F%20p%29%29%20%2F%202%3B%0A%20%20%7D%0A%0A%20%20elasticInOut%2Eamplitude%20%3D%20function%28a%29%20%7B%20return%20custom%28a%2C%20p%20%2A%20tau%29%3B%20%7D%3B%0A%20%20elasticInOut%2Eperiod%20%3D%20function%28p%29%20%7B%20return%20custom%28a%2C%20p%29%3B%20%7D%3B%0A%0A%20%20return%20elasticInOut%3B%0A%7D%29%28amplitude%2C%20period%29%3B%0A%0Avar%20defaultTiming%20%3D%20%7B%0A%20%20time%3A%20null%2C%20%2F%2F%20Set%20on%20use%2E%0A%20%20delay%3A%200%2C%0A%20%20duration%3A%20250%2C%0A%20%20ease%3A%20cubicInOut%0A%7D%3B%0A%0Afunction%20inherit%28node%2C%20id%29%20%7B%0A%20%20var%20timing%3B%0A%20%20while%20%28%21%28timing%20%3D%20node%2E%5F%5Ftransition%29%20%7C%7C%20%21%28timing%20%3D%20timing%5Bid%5D%29%29%20%7B%0A%20%20%20%20if%20%28%21%28node%20%3D%20node%2EparentNode%29%29%20%7B%0A%20%20%20%20%20%20return%20defaultTiming%2Etime%20%3D%20now%28%29%2C%20defaultTiming%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20timing%3B%0A%7D%0A%0Afunction%20selection%5Ftransition%28name%29%20%7B%0A%20%20var%20id%2C%0A%20%20%20%20%20%20timing%3B%0A%0A%20%20if%20%28name%20instanceof%20Transition%29%20%7B%0A%20%20%20%20id%20%3D%20name%2E%5Fid%2C%20name%20%3D%20name%2E%5Fname%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20id%20%3D%20newId%28%29%2C%20%28timing%20%3D%20defaultTiming%29%2Etime%20%3D%20now%28%29%2C%20name%20%3D%20name%20%3D%3D%20null%20%3F%20null%20%3A%20name%20%2B%20%22%22%3B%0A%20%20%7D%0A%0A%20%20for%20%28var%20groups%20%3D%20this%2E%5Fgroups%2C%20m%20%3D%20groups%2Elength%2C%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20group%20%3D%20groups%5Bj%5D%2C%20n%20%3D%20group%2Elength%2C%20node%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28node%20%3D%20group%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20schedule%28node%2C%20name%2C%20id%2C%20i%2C%20group%2C%20timing%20%7C%7C%20inherit%28node%2C%20id%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20new%20Transition%28groups%2C%20this%2E%5Fparents%2C%20name%2C%20id%29%3B%0A%7D%0A%0Aselection%2Eprototype%2Einterrupt%20%3D%20selection%5Finterrupt%3B%0Aselection%2Eprototype%2Etransition%20%3D%20selection%5Ftransition%3B%0A%0Avar%20root%241%20%3D%20%5Bnull%5D%3B%0A%0Afunction%20active%28node%2C%20name%29%20%7B%0A%20%20var%20schedules%20%3D%20node%2E%5F%5Ftransition%2C%0A%20%20%20%20%20%20schedule%24%241%2C%0A%20%20%20%20%20%20i%3B%0A%0A%20%20if%20%28schedules%29%20%7B%0A%20%20%20%20name%20%3D%20name%20%3D%3D%20null%20%3F%20null%20%3A%20name%20%2B%20%22%22%3B%0A%20%20%20%20for%20%28i%20in%20schedules%29%20%7B%0A%20%20%20%20%20%20if%20%28%28schedule%24%241%20%3D%20schedules%5Bi%5D%29%2Estate%20%3E%20SCHEDULED%20%26%26%20schedule%24%241%2Ename%20%3D%3D%3D%20name%29%20%7B%0A%20%20%20%20%20%20%20%20return%20new%20Transition%28%5B%5Bnode%5D%5D%2C%20root%241%2C%20name%2C%20%2Bi%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20null%3B%0A%7D%0A%0Afunction%20constant%244%28x%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20BrushEvent%28target%2C%20type%2C%20selection%29%20%7B%0A%20%20this%2Etarget%20%3D%20target%3B%0A%20%20this%2Etype%20%3D%20type%3B%0A%20%20this%2Eselection%20%3D%20selection%3B%0A%7D%0A%0Afunction%20nopropagation%241%28%29%20%7B%0A%20%20exports%2Eevent%2EstopImmediatePropagation%28%29%3B%0A%7D%0A%0Afunction%20noevent%241%28%29%20%7B%0A%20%20exports%2Eevent%2EpreventDefault%28%29%3B%0A%20%20exports%2Eevent%2EstopImmediatePropagation%28%29%3B%0A%7D%0A%0Avar%20MODE%5FDRAG%20%3D%20%7Bname%3A%20%22drag%22%7D%2C%0A%20%20%20%20MODE%5FSPACE%20%3D%20%7Bname%3A%20%22space%22%7D%2C%0A%20%20%20%20MODE%5FHANDLE%20%3D%20%7Bname%3A%20%22handle%22%7D%2C%0A%20%20%20%20MODE%5FCENTER%20%3D%20%7Bname%3A%20%22center%22%7D%3B%0A%0Avar%20X%20%3D%20%7B%0A%20%20name%3A%20%22x%22%2C%0A%20%20handles%3A%20%5B%22e%22%2C%20%22w%22%5D%2Emap%28type%29%2C%0A%20%20input%3A%20function%28x%2C%20e%29%20%7B%20return%20x%20%26%26%20%5B%5Bx%5B0%5D%2C%20e%5B0%5D%5B1%5D%5D%2C%20%5Bx%5B1%5D%2C%20e%5B1%5D%5B1%5D%5D%5D%3B%20%7D%2C%0A%20%20output%3A%20function%28xy%29%20%7B%20return%20xy%20%26%26%20%5Bxy%5B0%5D%5B0%5D%2C%20xy%5B1%5D%5B0%5D%5D%3B%20%7D%0A%7D%3B%0A%0Avar%20Y%20%3D%20%7B%0A%20%20name%3A%20%22y%22%2C%0A%20%20handles%3A%20%5B%22n%22%2C%20%22s%22%5D%2Emap%28type%29%2C%0A%20%20input%3A%20function%28y%2C%20e%29%20%7B%20return%20y%20%26%26%20%5B%5Be%5B0%5D%5B0%5D%2C%20y%5B0%5D%5D%2C%20%5Be%5B1%5D%5B0%5D%2C%20y%5B1%5D%5D%5D%3B%20%7D%2C%0A%20%20output%3A%20function%28xy%29%20%7B%20return%20xy%20%26%26%20%5Bxy%5B0%5D%5B1%5D%2C%20xy%5B1%5D%5B1%5D%5D%3B%20%7D%0A%7D%3B%0A%0Avar%20XY%20%3D%20%7B%0A%20%20name%3A%20%22xy%22%2C%0A%20%20handles%3A%20%5B%22n%22%2C%20%22e%22%2C%20%22s%22%2C%20%22w%22%2C%20%22nw%22%2C%20%22ne%22%2C%20%22se%22%2C%20%22sw%22%5D%2Emap%28type%29%2C%0A%20%20input%3A%20function%28xy%29%20%7B%20return%20xy%3B%20%7D%2C%0A%20%20output%3A%20function%28xy%29%20%7B%20return%20xy%3B%20%7D%0A%7D%3B%0A%0Avar%20cursors%20%3D%20%7B%0A%20%20overlay%3A%20%22crosshair%22%2C%0A%20%20selection%3A%20%22move%22%2C%0A%20%20n%3A%20%22ns%2Dresize%22%2C%0A%20%20e%3A%20%22ew%2Dresize%22%2C%0A%20%20s%3A%20%22ns%2Dresize%22%2C%0A%20%20w%3A%20%22ew%2Dresize%22%2C%0A%20%20nw%3A%20%22nwse%2Dresize%22%2C%0A%20%20ne%3A%20%22nesw%2Dresize%22%2C%0A%20%20se%3A%20%22nwse%2Dresize%22%2C%0A%20%20sw%3A%20%22nesw%2Dresize%22%0A%7D%3B%0A%0Avar%20flipX%20%3D%20%7B%0A%20%20e%3A%20%22w%22%2C%0A%20%20w%3A%20%22e%22%2C%0A%20%20nw%3A%20%22ne%22%2C%0A%20%20ne%3A%20%22nw%22%2C%0A%20%20se%3A%20%22sw%22%2C%0A%20%20sw%3A%20%22se%22%0A%7D%3B%0A%0Avar%20flipY%20%3D%20%7B%0A%20%20n%3A%20%22s%22%2C%0A%20%20s%3A%20%22n%22%2C%0A%20%20nw%3A%20%22sw%22%2C%0A%20%20ne%3A%20%22se%22%2C%0A%20%20se%3A%20%22ne%22%2C%0A%20%20sw%3A%20%22nw%22%0A%7D%3B%0A%0Avar%20signsX%20%3D%20%7B%0A%20%20overlay%3A%20%2B1%2C%0A%20%20selection%3A%20%2B1%2C%0A%20%20n%3A%20null%2C%0A%20%20e%3A%20%2B1%2C%0A%20%20s%3A%20null%2C%0A%20%20w%3A%20%2D1%2C%0A%20%20nw%3A%20%2D1%2C%0A%20%20ne%3A%20%2B1%2C%0A%20%20se%3A%20%2B1%2C%0A%20%20sw%3A%20%2D1%0A%7D%3B%0A%0Avar%20signsY%20%3D%20%7B%0A%20%20overlay%3A%20%2B1%2C%0A%20%20selection%3A%20%2B1%2C%0A%20%20n%3A%20%2D1%2C%0A%20%20e%3A%20null%2C%0A%20%20s%3A%20%2B1%2C%0A%20%20w%3A%20null%2C%0A%20%20nw%3A%20%2D1%2C%0A%20%20ne%3A%20%2D1%2C%0A%20%20se%3A%20%2B1%2C%0A%20%20sw%3A%20%2B1%0A%7D%3B%0A%0Afunction%20type%28t%29%20%7B%0A%20%20return%20%7Btype%3A%20t%7D%3B%0A%7D%0A%0A%2F%2F%20Ignore%20right%2Dclick%2C%20since%20that%20should%20open%20the%20context%20menu%2E%0Afunction%20defaultFilter%241%28%29%20%7B%0A%20%20return%20%21exports%2Eevent%2Ebutton%3B%0A%7D%0A%0Afunction%20defaultExtent%28%29%20%7B%0A%20%20var%20svg%20%3D%20this%2EownerSVGElement%20%7C%7C%20this%3B%0A%20%20return%20%5B%5B0%2C%200%5D%2C%20%5Bsvg%2Ewidth%2EbaseVal%2Evalue%2C%20svg%2Eheight%2EbaseVal%2Evalue%5D%5D%3B%0A%7D%0A%0A%2F%2F%20Like%20d3%2Elocal%2C%20but%20with%20the%20name%20%E2%80%9C%5F%5Fbrush%E2%80%9D%20rather%20than%20auto%2Dgenerated%2E%0Afunction%20local%241%28node%29%20%7B%0A%20%20while%20%28%21node%2E%5F%5Fbrush%29%20if%20%28%21%28node%20%3D%20node%2EparentNode%29%29%20return%3B%0A%20%20return%20node%2E%5F%5Fbrush%3B%0A%7D%0A%0Afunction%20empty%241%28extent%29%20%7B%0A%20%20return%20extent%5B0%5D%5B0%5D%20%3D%3D%3D%20extent%5B1%5D%5B0%5D%0A%20%20%20%20%20%20%7C%7C%20extent%5B0%5D%5B1%5D%20%3D%3D%3D%20extent%5B1%5D%5B1%5D%3B%0A%7D%0A%0Afunction%20brushSelection%28node%29%20%7B%0A%20%20var%20state%20%3D%20node%2E%5F%5Fbrush%3B%0A%20%20return%20state%20%3F%20state%2Edim%2Eoutput%28state%2Eselection%29%20%3A%20null%3B%0A%7D%0A%0Afunction%20brushX%28%29%20%7B%0A%20%20return%20brush%241%28X%29%3B%0A%7D%0A%0Afunction%20brushY%28%29%20%7B%0A%20%20return%20brush%241%28Y%29%3B%0A%7D%0A%0Afunction%20brush%28%29%20%7B%0A%20%20return%20brush%241%28XY%29%3B%0A%7D%0A%0Afunction%20brush%241%28dim%29%20%7B%0A%20%20var%20extent%20%3D%20defaultExtent%2C%0A%20%20%20%20%20%20filter%20%3D%20defaultFilter%241%2C%0A%20%20%20%20%20%20listeners%20%3D%20dispatch%28brush%2C%20%22start%22%2C%20%22brush%22%2C%20%22end%22%29%2C%0A%20%20%20%20%20%20handleSize%20%3D%206%2C%0A%20%20%20%20%20%20touchending%3B%0A%0A%20%20function%20brush%28group%29%20%7B%0A%20%20%20%20var%20overlay%20%3D%20group%0A%20%20%20%20%20%20%20%20%2Eproperty%28%22%5F%5Fbrush%22%2C%20initialize%29%0A%20%20%20%20%20%20%2EselectAll%28%22%2Eoverlay%22%29%0A%20%20%20%20%20%20%2Edata%28%5Btype%28%22overlay%22%29%5D%29%3B%0A%0A%20%20%20%20overlay%2Eenter%28%29%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%20%22overlay%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22pointer%2Devents%22%2C%20%22all%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22cursor%22%2C%20cursors%2Eoverlay%29%0A%20%20%20%20%20%20%2Emerge%28overlay%29%0A%20%20%20%20%20%20%20%20%2Eeach%28function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20extent%20%3D%20local%241%28this%29%2Eextent%3B%0A%20%20%20%20%20%20%20%20%20%20select%28this%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20extent%5B0%5D%5B0%5D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20extent%5B0%5D%5B1%5D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2C%20extent%5B1%5D%5B0%5D%20%2D%20extent%5B0%5D%5B0%5D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20extent%5B1%5D%5B1%5D%20%2D%20extent%5B0%5D%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20group%2EselectAll%28%22%2Eselection%22%29%0A%20%20%20%20%20%20%2Edata%28%5Btype%28%22selection%22%29%5D%29%0A%20%20%20%20%20%20%2Eenter%28%29%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%20%22selection%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22cursor%22%2C%20cursors%2Eselection%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22%23777%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%2Dopacity%22%2C%200%2E3%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%22%2C%20%22%23fff%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22shape%2Drendering%22%2C%20%22crispEdges%22%29%3B%0A%0A%20%20%20%20var%20handle%20%3D%20group%2EselectAll%28%22%2Ehandle%22%29%0A%20%20%20%20%20%20%2Edata%28dim%2Ehandles%2C%20function%28d%29%20%7B%20return%20d%2Etype%3B%20%7D%29%3B%0A%0A%20%20%20%20handle%2Eexit%28%29%2Eremove%28%29%3B%0A%0A%20%20%20%20handle%2Eenter%28%29%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%20function%28d%29%20%7B%20return%20%22handle%20handle%2D%2D%22%20%2B%20d%2Etype%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22cursor%22%2C%20function%28d%29%20%7B%20return%20cursors%5Bd%2Etype%5D%3B%20%7D%29%3B%0A%0A%20%20%20%20group%0A%20%20%20%20%20%20%20%20%2Eeach%28redraw%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22none%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22pointer%2Devents%22%2C%20%22all%22%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22%2Dwebkit%2Dtap%2Dhighlight%2Dcolor%22%2C%20%22rgba%280%2C0%2C0%2C0%29%22%29%0A%20%20%20%20%20%20%20%20%2Eon%28%22mousedown%2Ebrush%20touchstart%2Ebrush%22%2C%20started%29%3B%0A%20%20%7D%0A%0A%20%20brush%2Emove%20%3D%20function%28group%2C%20selection%24%241%29%20%7B%0A%20%20%20%20if%20%28group%2Eselection%29%20%7B%0A%20%20%20%20%20%20group%0A%20%20%20%20%20%20%20%20%20%20%2Eon%28%22start%2Ebrush%22%2C%20function%28%29%20%7B%20emitter%28this%2C%20arguments%29%2Ebeforestart%28%29%2Estart%28%29%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eon%28%22interrupt%2Ebrush%20end%2Ebrush%22%2C%20function%28%29%20%7B%20emitter%28this%2C%20arguments%29%2Eend%28%29%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%2Etween%28%22brush%22%2C%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20that%20%3D%20this%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state%20%3D%20that%2E%5F%5Fbrush%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20emit%20%3D%20emitter%28that%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20selection0%20%3D%20state%2Eselection%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20selection1%20%3D%20dim%2Einput%28typeof%20selection%24%241%20%3D%3D%3D%20%22function%22%20%3F%20selection%24%241%2Eapply%28this%2C%20arguments%29%20%3A%20selection%24%241%2C%20state%2Eextent%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20i%20%3D%20interpolateValue%28selection0%2C%20selection1%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20function%20tween%28t%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20state%2Eselection%20%3D%20t%20%3D%3D%3D%201%20%26%26%20empty%241%28selection1%29%20%3F%20null%20%3A%20i%28t%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20redraw%2Ecall%28that%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20emit%2Ebrush%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20selection0%20%26%26%20selection1%20%3F%20tween%20%3A%20tween%281%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20group%0A%20%20%20%20%20%20%20%20%20%20%2Eeach%28function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20that%20%3D%20this%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args%20%3D%20arguments%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state%20%3D%20that%2E%5F%5Fbrush%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20selection1%20%3D%20dim%2Einput%28typeof%20selection%24%241%20%3D%3D%3D%20%22function%22%20%3F%20selection%24%241%2Eapply%28that%2C%20args%29%20%3A%20selection%24%241%2C%20state%2Eextent%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20emit%20%3D%20emitter%28that%2C%20args%29%2Ebeforestart%28%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20interrupt%28that%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20state%2Eselection%20%3D%20selection1%20%3D%3D%20null%20%7C%7C%20empty%241%28selection1%29%20%3F%20null%20%3A%20selection1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20redraw%2Ecall%28that%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20emit%2Estart%28%29%2Ebrush%28%29%2Eend%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20function%20redraw%28%29%20%7B%0A%20%20%20%20var%20group%20%3D%20select%28this%29%2C%0A%20%20%20%20%20%20%20%20selection%24%241%20%3D%20local%241%28this%29%2Eselection%3B%0A%0A%20%20%20%20if%20%28selection%24%241%29%20%7B%0A%20%20%20%20%20%20group%2EselectAll%28%22%2Eselection%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22display%22%2C%20null%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20selection%24%241%5B0%5D%5B0%5D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20selection%24%241%5B0%5D%5B1%5D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2C%20selection%24%241%5B1%5D%5B0%5D%20%2D%20selection%24%241%5B0%5D%5B0%5D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20selection%24%241%5B1%5D%5B1%5D%20%2D%20selection%24%241%5B0%5D%5B1%5D%29%3B%0A%0A%20%20%20%20%20%20group%2EselectAll%28%22%2Ehandle%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22display%22%2C%20null%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20function%28d%29%20%7B%20return%20d%2Etype%5Bd%2Etype%2Elength%20%2D%201%5D%20%3D%3D%3D%20%22e%22%20%3F%20selection%24%241%5B1%5D%5B0%5D%20%2D%20handleSize%20%2F%202%20%3A%20selection%24%241%5B0%5D%5B0%5D%20%2D%20handleSize%20%2F%202%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20function%28d%29%20%7B%20return%20d%2Etype%5B0%5D%20%3D%3D%3D%20%22s%22%20%3F%20selection%24%241%5B1%5D%5B1%5D%20%2D%20handleSize%20%2F%202%20%3A%20selection%24%241%5B0%5D%5B1%5D%20%2D%20handleSize%20%2F%202%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2C%20function%28d%29%20%7B%20return%20d%2Etype%20%3D%3D%3D%20%22n%22%20%7C%7C%20d%2Etype%20%3D%3D%3D%20%22s%22%20%3F%20selection%24%241%5B1%5D%5B0%5D%20%2D%20selection%24%241%5B0%5D%5B0%5D%20%2B%20handleSize%20%3A%20handleSize%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20function%28d%29%20%7B%20return%20d%2Etype%20%3D%3D%3D%20%22e%22%20%7C%7C%20d%2Etype%20%3D%3D%3D%20%22w%22%20%3F%20selection%24%241%5B1%5D%5B1%5D%20%2D%20selection%24%241%5B0%5D%5B1%5D%20%2B%20handleSize%20%3A%20handleSize%3B%20%7D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20group%2EselectAll%28%22%2Eselection%2C%2Ehandle%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22display%22%2C%20%22none%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20null%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20null%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2C%20null%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20null%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20emitter%28that%2C%20args%29%20%7B%0A%20%20%20%20return%20that%2E%5F%5Fbrush%2Eemitter%20%7C%7C%20new%20Emitter%28that%2C%20args%29%3B%0A%20%20%7D%0A%0A%20%20function%20Emitter%28that%2C%20args%29%20%7B%0A%20%20%20%20this%2Ethat%20%3D%20that%3B%0A%20%20%20%20this%2Eargs%20%3D%20args%3B%0A%20%20%20%20this%2Estate%20%3D%20that%2E%5F%5Fbrush%3B%0A%20%20%20%20this%2Eactive%20%3D%200%3B%0A%20%20%7D%0A%0A%20%20Emitter%2Eprototype%20%3D%20%7B%0A%20%20%20%20beforestart%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28%2B%2Bthis%2Eactive%20%3D%3D%3D%201%29%20this%2Estate%2Eemitter%20%3D%20this%2C%20this%2Estarting%20%3D%20true%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20start%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28this%2Estarting%29%20this%2Estarting%20%3D%20false%2C%20this%2Eemit%28%22start%22%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20brush%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20this%2Eemit%28%22brush%22%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20end%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28%2D%2Dthis%2Eactive%20%3D%3D%3D%200%29%20delete%20this%2Estate%2Eemitter%2C%20this%2Eemit%28%22end%22%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20emit%3A%20function%28type%29%20%7B%0A%20%20%20%20%20%20customEvent%28new%20BrushEvent%28brush%2C%20type%2C%20dim%2Eoutput%28this%2Estate%2Eselection%29%29%2C%20listeners%2Eapply%2C%20listeners%2C%20%5Btype%2C%20this%2Ethat%2C%20this%2Eargs%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20function%20started%28%29%20%7B%0A%20%20%20%20if%20%28exports%2Eevent%2Etouches%29%20%7B%20if%20%28exports%2Eevent%2EchangedTouches%2Elength%20%3C%20exports%2Eevent%2Etouches%2Elength%29%20return%20noevent%241%28%29%3B%20%7D%0A%20%20%20%20else%20if%20%28touchending%29%20return%3B%0A%20%20%20%20if%20%28%21filter%2Eapply%28this%2C%20arguments%29%29%20return%3B%0A%0A%20%20%20%20var%20that%20%3D%20this%2C%0A%20%20%20%20%20%20%20%20type%20%3D%20exports%2Eevent%2Etarget%2E%5F%5Fdata%5F%5F%2Etype%2C%0A%20%20%20%20%20%20%20%20mode%20%3D%20%28exports%2Eevent%2EmetaKey%20%3F%20type%20%3D%20%22overlay%22%20%3A%20type%29%20%3D%3D%3D%20%22selection%22%20%3F%20MODE%5FDRAG%20%3A%20%28exports%2Eevent%2EaltKey%20%3F%20MODE%5FCENTER%20%3A%20MODE%5FHANDLE%29%2C%0A%20%20%20%20%20%20%20%20signX%20%3D%20dim%20%3D%3D%3D%20Y%20%3F%20null%20%3A%20signsX%5Btype%5D%2C%0A%20%20%20%20%20%20%20%20signY%20%3D%20dim%20%3D%3D%3D%20X%20%3F%20null%20%3A%20signsY%5Btype%5D%2C%0A%20%20%20%20%20%20%20%20state%20%3D%20local%241%28that%29%2C%0A%20%20%20%20%20%20%20%20extent%20%3D%20state%2Eextent%2C%0A%20%20%20%20%20%20%20%20selection%24%241%20%3D%20state%2Eselection%2C%0A%20%20%20%20%20%20%20%20W%20%3D%20extent%5B0%5D%5B0%5D%2C%20w0%2C%20w1%2C%0A%20%20%20%20%20%20%20%20N%20%3D%20extent%5B0%5D%5B1%5D%2C%20n0%2C%20n1%2C%0A%20%20%20%20%20%20%20%20E%20%3D%20extent%5B1%5D%5B0%5D%2C%20e0%2C%20e1%2C%0A%20%20%20%20%20%20%20%20S%20%3D%20extent%5B1%5D%5B1%5D%2C%20s0%2C%20s1%2C%0A%20%20%20%20%20%20%20%20dx%2C%0A%20%20%20%20%20%20%20%20dy%2C%0A%20%20%20%20%20%20%20%20moving%2C%0A%20%20%20%20%20%20%20%20shifting%20%3D%20signX%20%26%26%20signY%20%26%26%20exports%2Eevent%2EshiftKey%2C%0A%20%20%20%20%20%20%20%20lockX%2C%0A%20%20%20%20%20%20%20%20lockY%2C%0A%20%20%20%20%20%20%20%20point0%20%3D%20mouse%28that%29%2C%0A%20%20%20%20%20%20%20%20point%24%241%20%3D%20point0%2C%0A%20%20%20%20%20%20%20%20emit%20%3D%20emitter%28that%2C%20arguments%29%2Ebeforestart%28%29%3B%0A%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22overlay%22%29%20%7B%0A%20%20%20%20%20%20state%2Eselection%20%3D%20selection%24%241%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%5Bw0%20%3D%20dim%20%3D%3D%3D%20Y%20%3F%20W%20%3A%20point0%5B0%5D%2C%20n0%20%3D%20dim%20%3D%3D%3D%20X%20%3F%20N%20%3A%20point0%5B1%5D%5D%2C%0A%20%20%20%20%20%20%20%20%5Be0%20%3D%20dim%20%3D%3D%3D%20Y%20%3F%20E%20%3A%20w0%2C%20s0%20%3D%20dim%20%3D%3D%3D%20X%20%3F%20S%20%3A%20n0%5D%0A%20%20%20%20%20%20%5D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20w0%20%3D%20selection%24%241%5B0%5D%5B0%5D%3B%0A%20%20%20%20%20%20n0%20%3D%20selection%24%241%5B0%5D%5B1%5D%3B%0A%20%20%20%20%20%20e0%20%3D%20selection%24%241%5B1%5D%5B0%5D%3B%0A%20%20%20%20%20%20s0%20%3D%20selection%24%241%5B1%5D%5B1%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20w1%20%3D%20w0%3B%0A%20%20%20%20n1%20%3D%20n0%3B%0A%20%20%20%20e1%20%3D%20e0%3B%0A%20%20%20%20s1%20%3D%20s0%3B%0A%0A%20%20%20%20var%20group%20%3D%20select%28that%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22pointer%2Devents%22%2C%20%22none%22%29%3B%0A%0A%20%20%20%20var%20overlay%20%3D%20group%2EselectAll%28%22%2Eoverlay%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22cursor%22%2C%20cursors%5Btype%5D%29%3B%0A%0A%20%20%20%20if%20%28exports%2Eevent%2Etouches%29%20%7B%0A%20%20%20%20%20%20group%0A%20%20%20%20%20%20%20%20%20%20%2Eon%28%22touchmove%2Ebrush%22%2C%20moved%2C%20true%29%0A%20%20%20%20%20%20%20%20%20%20%2Eon%28%22touchend%2Ebrush%20touchcancel%2Ebrush%22%2C%20ended%2C%20true%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20var%20view%20%3D%20select%28exports%2Eevent%2Eview%29%0A%20%20%20%20%20%20%20%20%20%20%2Eon%28%22keydown%2Ebrush%22%2C%20keydowned%2C%20true%29%0A%20%20%20%20%20%20%20%20%20%20%2Eon%28%22keyup%2Ebrush%22%2C%20keyupped%2C%20true%29%0A%20%20%20%20%20%20%20%20%20%20%2Eon%28%22mousemove%2Ebrush%22%2C%20moved%2C%20true%29%0A%20%20%20%20%20%20%20%20%20%20%2Eon%28%22mouseup%2Ebrush%22%2C%20ended%2C%20true%29%3B%0A%0A%20%20%20%20%20%20dragDisable%28exports%2Eevent%2Eview%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20nopropagation%241%28%29%3B%0A%20%20%20%20interrupt%28that%29%3B%0A%20%20%20%20redraw%2Ecall%28that%29%3B%0A%20%20%20%20emit%2Estart%28%29%3B%0A%0A%20%20%20%20function%20moved%28%29%20%7B%0A%20%20%20%20%20%20var%20point1%20%3D%20mouse%28that%29%3B%0A%20%20%20%20%20%20if%20%28shifting%20%26%26%20%21lockX%20%26%26%20%21lockY%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28Math%2Eabs%28point1%5B0%5D%20%2D%20point%24%241%5B0%5D%29%20%3E%20Math%2Eabs%28point1%5B1%5D%20%2D%20point%24%241%5B1%5D%29%29%20lockY%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20else%20lockX%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20point%24%241%20%3D%20point1%3B%0A%20%20%20%20%20%20moving%20%3D%20true%3B%0A%20%20%20%20%20%20noevent%241%28%29%3B%0A%20%20%20%20%20%20move%28%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20move%28%29%20%7B%0A%20%20%20%20%20%20var%20t%3B%0A%0A%20%20%20%20%20%20dx%20%3D%20point%24%241%5B0%5D%20%2D%20point0%5B0%5D%3B%0A%20%20%20%20%20%20dy%20%3D%20point%24%241%5B1%5D%20%2D%20point0%5B1%5D%3B%0A%0A%20%20%20%20%20%20switch%20%28mode%29%20%7B%0A%20%20%20%20%20%20%20%20case%20MODE%5FSPACE%3A%0A%20%20%20%20%20%20%20%20case%20MODE%5FDRAG%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28signX%29%20dx%20%3D%20Math%2Emax%28W%20%2D%20w0%2C%20Math%2Emin%28E%20%2D%20e0%2C%20dx%29%29%2C%20w1%20%3D%20w0%20%2B%20dx%2C%20e1%20%3D%20e0%20%2B%20dx%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28signY%29%20dy%20%3D%20Math%2Emax%28N%20%2D%20n0%2C%20Math%2Emin%28S%20%2D%20s0%2C%20dy%29%29%2C%20n1%20%3D%20n0%20%2B%20dy%2C%20s1%20%3D%20s0%20%2B%20dy%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20case%20MODE%5FHANDLE%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28signX%20%3C%200%29%20dx%20%3D%20Math%2Emax%28W%20%2D%20w0%2C%20Math%2Emin%28E%20%2D%20w0%2C%20dx%29%29%2C%20w1%20%3D%20w0%20%2B%20dx%2C%20e1%20%3D%20e0%3B%0A%20%20%20%20%20%20%20%20%20%20else%20if%20%28signX%20%3E%200%29%20dx%20%3D%20Math%2Emax%28W%20%2D%20e0%2C%20Math%2Emin%28E%20%2D%20e0%2C%20dx%29%29%2C%20w1%20%3D%20w0%2C%20e1%20%3D%20e0%20%2B%20dx%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28signY%20%3C%200%29%20dy%20%3D%20Math%2Emax%28N%20%2D%20n0%2C%20Math%2Emin%28S%20%2D%20n0%2C%20dy%29%29%2C%20n1%20%3D%20n0%20%2B%20dy%2C%20s1%20%3D%20s0%3B%0A%20%20%20%20%20%20%20%20%20%20else%20if%20%28signY%20%3E%200%29%20dy%20%3D%20Math%2Emax%28N%20%2D%20s0%2C%20Math%2Emin%28S%20%2D%20s0%2C%20dy%29%29%2C%20n1%20%3D%20n0%2C%20s1%20%3D%20s0%20%2B%20dy%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20case%20MODE%5FCENTER%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28signX%29%20w1%20%3D%20Math%2Emax%28W%2C%20Math%2Emin%28E%2C%20w0%20%2D%20dx%20%2A%20signX%29%29%2C%20e1%20%3D%20Math%2Emax%28W%2C%20Math%2Emin%28E%2C%20e0%20%2B%20dx%20%2A%20signX%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28signY%29%20n1%20%3D%20Math%2Emax%28N%2C%20Math%2Emin%28S%2C%20n0%20%2D%20dy%20%2A%20signY%29%29%2C%20s1%20%3D%20Math%2Emax%28N%2C%20Math%2Emin%28S%2C%20s0%20%2B%20dy%20%2A%20signY%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20if%20%28e1%20%3C%20w1%29%20%7B%0A%20%20%20%20%20%20%20%20signX%20%2A%3D%20%2D1%3B%0A%20%20%20%20%20%20%20%20t%20%3D%20w0%2C%20w0%20%3D%20e0%2C%20e0%20%3D%20t%3B%0A%20%20%20%20%20%20%20%20t%20%3D%20w1%2C%20w1%20%3D%20e1%2C%20e1%20%3D%20t%3B%0A%20%20%20%20%20%20%20%20if%20%28type%20in%20flipX%29%20overlay%2Eattr%28%22cursor%22%2C%20cursors%5Btype%20%3D%20flipX%5Btype%5D%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20if%20%28s1%20%3C%20n1%29%20%7B%0A%20%20%20%20%20%20%20%20signY%20%2A%3D%20%2D1%3B%0A%20%20%20%20%20%20%20%20t%20%3D%20n0%2C%20n0%20%3D%20s0%2C%20s0%20%3D%20t%3B%0A%20%20%20%20%20%20%20%20t%20%3D%20n1%2C%20n1%20%3D%20s1%2C%20s1%20%3D%20t%3B%0A%20%20%20%20%20%20%20%20if%20%28type%20in%20flipY%29%20overlay%2Eattr%28%22cursor%22%2C%20cursors%5Btype%20%3D%20flipY%5Btype%5D%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20if%20%28state%2Eselection%29%20selection%24%241%20%3D%20state%2Eselection%3B%20%2F%2F%20May%20be%20set%20by%20brush%2Emove%21%0A%20%20%20%20%20%20if%20%28lockX%29%20w1%20%3D%20selection%24%241%5B0%5D%5B0%5D%2C%20e1%20%3D%20selection%24%241%5B1%5D%5B0%5D%3B%0A%20%20%20%20%20%20if%20%28lockY%29%20n1%20%3D%20selection%24%241%5B0%5D%5B1%5D%2C%20s1%20%3D%20selection%24%241%5B1%5D%5B1%5D%3B%0A%0A%20%20%20%20%20%20if%20%28selection%24%241%5B0%5D%5B0%5D%20%21%3D%3D%20w1%0A%20%20%20%20%20%20%20%20%20%20%7C%7C%20selection%24%241%5B0%5D%5B1%5D%20%21%3D%3D%20n1%0A%20%20%20%20%20%20%20%20%20%20%7C%7C%20selection%24%241%5B1%5D%5B0%5D%20%21%3D%3D%20e1%0A%20%20%20%20%20%20%20%20%20%20%7C%7C%20selection%24%241%5B1%5D%5B1%5D%20%21%3D%3D%20s1%29%20%7B%0A%20%20%20%20%20%20%20%20state%2Eselection%20%3D%20%5B%5Bw1%2C%20n1%5D%2C%20%5Be1%2C%20s1%5D%5D%3B%0A%20%20%20%20%20%20%20%20redraw%2Ecall%28that%29%3B%0A%20%20%20%20%20%20%20%20emit%2Ebrush%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ended%28%29%20%7B%0A%20%20%20%20%20%20nopropagation%241%28%29%3B%0A%20%20%20%20%20%20if%20%28exports%2Eevent%2Etouches%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28exports%2Eevent%2Etouches%2Elength%29%20return%3B%0A%20%20%20%20%20%20%20%20if%20%28touchending%29%20clearTimeout%28touchending%29%3B%0A%20%20%20%20%20%20%20%20touchending%20%3D%20setTimeout%28function%28%29%20%7B%20touchending%20%3D%20null%3B%20%7D%2C%20500%29%3B%20%2F%2F%20Ghost%20clicks%20are%20delayed%21%0A%20%20%20%20%20%20%20%20group%2Eon%28%22touchmove%2Ebrush%20touchend%2Ebrush%20touchcancel%2Ebrush%22%2C%20null%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20yesdrag%28exports%2Eevent%2Eview%2C%20moving%29%3B%0A%20%20%20%20%20%20%20%20view%2Eon%28%22keydown%2Ebrush%20keyup%2Ebrush%20mousemove%2Ebrush%20mouseup%2Ebrush%22%2C%20null%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20group%2Eattr%28%22pointer%2Devents%22%2C%20%22all%22%29%3B%0A%20%20%20%20%20%20overlay%2Eattr%28%22cursor%22%2C%20cursors%2Eoverlay%29%3B%0A%20%20%20%20%20%20if%20%28state%2Eselection%29%20selection%24%241%20%3D%20state%2Eselection%3B%20%2F%2F%20May%20be%20set%20by%20brush%2Emove%20%28on%20start%29%21%0A%20%20%20%20%20%20if%20%28empty%241%28selection%24%241%29%29%20state%2Eselection%20%3D%20null%2C%20redraw%2Ecall%28that%29%3B%0A%20%20%20%20%20%20emit%2Eend%28%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20keydowned%28%29%20%7B%0A%20%20%20%20%20%20switch%20%28exports%2Eevent%2EkeyCode%29%20%7B%0A%20%20%20%20%20%20%20%20case%2016%3A%20%7B%20%2F%2F%20SHIFT%0A%20%20%20%20%20%20%20%20%20%20shifting%20%3D%20signX%20%26%26%20signY%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20case%2018%3A%20%7B%20%2F%2F%20ALT%0A%20%20%20%20%20%20%20%20%20%20if%20%28mode%20%3D%3D%3D%20MODE%5FHANDLE%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28signX%29%20e0%20%3D%20e1%20%2D%20dx%20%2A%20signX%2C%20w0%20%3D%20w1%20%2B%20dx%20%2A%20signX%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28signY%29%20s0%20%3D%20s1%20%2D%20dy%20%2A%20signY%2C%20n0%20%3D%20n1%20%2B%20dy%20%2A%20signY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20mode%20%3D%20MODE%5FCENTER%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20move%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20case%2032%3A%20%7B%20%2F%2F%20SPACE%3B%20takes%20priority%20over%20ALT%0A%20%20%20%20%20%20%20%20%20%20if%20%28mode%20%3D%3D%3D%20MODE%5FHANDLE%20%7C%7C%20mode%20%3D%3D%3D%20MODE%5FCENTER%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28signX%20%3C%200%29%20e0%20%3D%20e1%20%2D%20dx%3B%20else%20if%20%28signX%20%3E%200%29%20w0%20%3D%20w1%20%2D%20dx%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28signY%20%3C%200%29%20s0%20%3D%20s1%20%2D%20dy%3B%20else%20if%20%28signY%20%3E%200%29%20n0%20%3D%20n1%20%2D%20dy%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20mode%20%3D%20MODE%5FSPACE%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20overlay%2Eattr%28%22cursor%22%2C%20cursors%2Eselection%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20move%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20default%3A%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20noevent%241%28%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20keyupped%28%29%20%7B%0A%20%20%20%20%20%20switch%20%28exports%2Eevent%2EkeyCode%29%20%7B%0A%20%20%20%20%20%20%20%20case%2016%3A%20%7B%20%2F%2F%20SHIFT%0A%20%20%20%20%20%20%20%20%20%20if%20%28shifting%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20lockX%20%3D%20lockY%20%3D%20shifting%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20move%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20case%2018%3A%20%7B%20%2F%2F%20ALT%0A%20%20%20%20%20%20%20%20%20%20if%20%28mode%20%3D%3D%3D%20MODE%5FCENTER%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28signX%20%3C%200%29%20e0%20%3D%20e1%3B%20else%20if%20%28signX%20%3E%200%29%20w0%20%3D%20w1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28signY%20%3C%200%29%20s0%20%3D%20s1%3B%20else%20if%20%28signY%20%3E%200%29%20n0%20%3D%20n1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20mode%20%3D%20MODE%5FHANDLE%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20move%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20case%2032%3A%20%7B%20%2F%2F%20SPACE%0A%20%20%20%20%20%20%20%20%20%20if%20%28mode%20%3D%3D%3D%20MODE%5FSPACE%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28exports%2Eevent%2EaltKey%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28signX%29%20e0%20%3D%20e1%20%2D%20dx%20%2A%20signX%2C%20w0%20%3D%20w1%20%2B%20dx%20%2A%20signX%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28signY%29%20s0%20%3D%20s1%20%2D%20dy%20%2A%20signY%2C%20n0%20%3D%20n1%20%2B%20dy%20%2A%20signY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%20%3D%20MODE%5FCENTER%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28signX%20%3C%200%29%20e0%20%3D%20e1%3B%20else%20if%20%28signX%20%3E%200%29%20w0%20%3D%20w1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28signY%20%3C%200%29%20s0%20%3D%20s1%3B%20else%20if%20%28signY%20%3E%200%29%20n0%20%3D%20n1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%20%3D%20MODE%5FHANDLE%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20overlay%2Eattr%28%22cursor%22%2C%20cursors%5Btype%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20move%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20default%3A%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20noevent%241%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20initialize%28%29%20%7B%0A%20%20%20%20var%20state%20%3D%20this%2E%5F%5Fbrush%20%7C%7C%20%7Bselection%3A%20null%7D%3B%0A%20%20%20%20state%2Eextent%20%3D%20extent%2Eapply%28this%2C%20arguments%29%3B%0A%20%20%20%20state%2Edim%20%3D%20dim%3B%0A%20%20%20%20return%20state%3B%0A%20%20%7D%0A%0A%20%20brush%2Eextent%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28extent%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%244%28%5B%5B%2B%5F%5B0%5D%5B0%5D%2C%20%2B%5F%5B0%5D%5B1%5D%5D%2C%20%5B%2B%5F%5B1%5D%5B0%5D%2C%20%2B%5F%5B1%5D%5B1%5D%5D%5D%29%2C%20brush%29%20%3A%20extent%3B%0A%20%20%7D%3B%0A%0A%20%20brush%2Efilter%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28filter%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%244%28%21%21%5F%29%2C%20brush%29%20%3A%20filter%3B%0A%20%20%7D%3B%0A%0A%20%20brush%2EhandleSize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28handleSize%20%3D%20%2B%5F%2C%20brush%29%20%3A%20handleSize%3B%0A%20%20%7D%3B%0A%0A%20%20brush%2Eon%20%3D%20function%28%29%20%7B%0A%20%20%20%20var%20value%20%3D%20listeners%2Eon%2Eapply%28listeners%2C%20arguments%29%3B%0A%20%20%20%20return%20value%20%3D%3D%3D%20listeners%20%3F%20brush%20%3A%20value%3B%0A%20%20%7D%3B%0A%0A%20%20return%20brush%3B%0A%7D%0A%0Avar%20cos%20%3D%20Math%2Ecos%3B%0Avar%20sin%20%3D%20Math%2Esin%3B%0Avar%20pi%241%20%3D%20Math%2EPI%3B%0Avar%20halfPi%241%20%3D%20pi%241%20%2F%202%3B%0Avar%20tau%241%20%3D%20pi%241%20%2A%202%3B%0Avar%20max%241%20%3D%20Math%2Emax%3B%0A%0Afunction%20compareValue%28compare%29%20%7B%0A%20%20return%20function%28a%2C%20b%29%20%7B%0A%20%20%20%20return%20compare%28%0A%20%20%20%20%20%20a%2Esource%2Evalue%20%2B%20a%2Etarget%2Evalue%2C%0A%20%20%20%20%20%20b%2Esource%2Evalue%20%2B%20b%2Etarget%2Evalue%0A%20%20%20%20%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20chord%28%29%20%7B%0A%20%20var%20padAngle%20%3D%200%2C%0A%20%20%20%20%20%20sortGroups%20%3D%20null%2C%0A%20%20%20%20%20%20sortSubgroups%20%3D%20null%2C%0A%20%20%20%20%20%20sortChords%20%3D%20null%3B%0A%0A%20%20function%20chord%28matrix%29%20%7B%0A%20%20%20%20var%20n%20%3D%20matrix%2Elength%2C%0A%20%20%20%20%20%20%20%20groupSums%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20groupIndex%20%3D%20sequence%28n%29%2C%0A%20%20%20%20%20%20%20%20subgroupIndex%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20chords%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20groups%20%3D%20chords%2Egroups%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20%20%20subgroups%20%3D%20new%20Array%28n%20%2A%20n%29%2C%0A%20%20%20%20%20%20%20%20k%2C%0A%20%20%20%20%20%20%20%20x%2C%0A%20%20%20%20%20%20%20%20x0%2C%0A%20%20%20%20%20%20%20%20dx%2C%0A%20%20%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20%20%20j%3B%0A%0A%20%20%20%20%2F%2F%20Compute%20the%20sum%2E%0A%20%20%20%20k%20%3D%200%2C%20i%20%3D%20%2D1%3B%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20x%20%3D%200%2C%20j%20%3D%20%2D1%3B%20while%20%28%2B%2Bj%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20%20%20x%20%2B%3D%20matrix%5Bi%5D%5Bj%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20groupSums%2Epush%28x%29%3B%0A%20%20%20%20%20%20subgroupIndex%2Epush%28sequence%28n%29%29%3B%0A%20%20%20%20%20%20k%20%2B%3D%20x%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Sort%20groups%E2%80%A6%0A%20%20%20%20if%20%28sortGroups%29%20groupIndex%2Esort%28function%28a%2C%20b%29%20%7B%0A%20%20%20%20%20%20return%20sortGroups%28groupSums%5Ba%5D%2C%20groupSums%5Bb%5D%29%3B%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20%2F%2F%20Sort%20subgroups%E2%80%A6%0A%20%20%20%20if%20%28sortSubgroups%29%20subgroupIndex%2EforEach%28function%28d%2C%20i%29%20%7B%0A%20%20%20%20%20%20d%2Esort%28function%28a%2C%20b%29%20%7B%0A%20%20%20%20%20%20%20%20return%20sortSubgroups%28matrix%5Bi%5D%5Ba%5D%2C%20matrix%5Bi%5D%5Bb%5D%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20%2F%2F%20Convert%20the%20sum%20to%20scaling%20factor%20for%20%5B0%2C%202pi%5D%2E%0A%20%20%20%20%2F%2F%20TODO%20Allow%20start%20and%20end%20angle%20to%20be%20specified%3F%0A%20%20%20%20%2F%2F%20TODO%20Allow%20padding%20to%20be%20specified%20as%20percentage%3F%0A%20%20%20%20k%20%3D%20max%241%280%2C%20tau%241%20%2D%20padAngle%20%2A%20n%29%20%2F%20k%3B%0A%20%20%20%20dx%20%3D%20k%20%3F%20padAngle%20%3A%20tau%241%20%2F%20n%3B%0A%0A%20%20%20%20%2F%2F%20Compute%20the%20start%20and%20end%20angle%20for%20each%20group%20and%20subgroup%2E%0A%20%20%20%20%2F%2F%20Note%3A%20Opera%20has%20a%20bug%20reordering%20object%20literal%20properties%21%0A%20%20%20%20x%20%3D%200%2C%20i%20%3D%20%2D1%3B%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20x0%20%3D%20x%2C%20j%20%3D%20%2D1%3B%20while%20%28%2B%2Bj%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20%20%20var%20di%20%3D%20groupIndex%5Bi%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20dj%20%3D%20subgroupIndex%5Bdi%5D%5Bj%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20v%20%3D%20matrix%5Bdi%5D%5Bdj%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20a0%20%3D%20x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20a1%20%3D%20x%20%2B%3D%20v%20%2A%20k%3B%0A%20%20%20%20%20%20%20%20subgroups%5Bdj%20%2A%20n%20%2B%20di%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20index%3A%20di%2C%0A%20%20%20%20%20%20%20%20%20%20subindex%3A%20dj%2C%0A%20%20%20%20%20%20%20%20%20%20startAngle%3A%20a0%2C%0A%20%20%20%20%20%20%20%20%20%20endAngle%3A%20a1%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20v%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20groups%5Bdi%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20index%3A%20di%2C%0A%20%20%20%20%20%20%20%20startAngle%3A%20x0%2C%0A%20%20%20%20%20%20%20%20endAngle%3A%20x%2C%0A%20%20%20%20%20%20%20%20value%3A%20groupSums%5Bdi%5D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20x%20%2B%3D%20dx%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Generate%20chords%20for%20each%20%28non%2Dempty%29%20subgroup%2Dsubgroup%20link%2E%0A%20%20%20%20i%20%3D%20%2D1%3B%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20j%20%3D%20i%20%2D%201%3B%20while%20%28%2B%2Bj%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20%20%20var%20source%20%3D%20subgroups%5Bj%20%2A%20n%20%2B%20i%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20target%20%3D%20subgroups%5Bi%20%2A%20n%20%2B%20j%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28source%2Evalue%20%7C%7C%20target%2Evalue%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20chords%2Epush%28source%2Evalue%20%3C%20target%2Evalue%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3F%20%7Bsource%3A%20target%2C%20target%3A%20source%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20%7Bsource%3A%20source%2C%20target%3A%20target%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20sortChords%20%3F%20chords%2Esort%28sortChords%29%20%3A%20chords%3B%0A%20%20%7D%0A%0A%20%20chord%2EpadAngle%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28padAngle%20%3D%20max%241%280%2C%20%5F%29%2C%20chord%29%20%3A%20padAngle%3B%0A%20%20%7D%3B%0A%0A%20%20chord%2EsortGroups%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28sortGroups%20%3D%20%5F%2C%20chord%29%20%3A%20sortGroups%3B%0A%20%20%7D%3B%0A%0A%20%20chord%2EsortSubgroups%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28sortSubgroups%20%3D%20%5F%2C%20chord%29%20%3A%20sortSubgroups%3B%0A%20%20%7D%3B%0A%0A%20%20chord%2EsortChords%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28%5F%20%3D%3D%20null%20%3F%20sortChords%20%3D%20null%20%3A%20%28sortChords%20%3D%20compareValue%28%5F%29%29%2E%5F%20%3D%20%5F%2C%20chord%29%20%3A%20sortChords%20%26%26%20sortChords%2E%5F%3B%0A%20%20%7D%3B%0A%0A%20%20return%20chord%3B%0A%7D%0A%0Avar%20slice%242%20%3D%20Array%2Eprototype%2Eslice%3B%0A%0Afunction%20constant%245%28x%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Avar%20pi%242%20%3D%20Math%2EPI%2C%0A%20%20%20%20tau%242%20%3D%202%20%2A%20pi%242%2C%0A%20%20%20%20epsilon%241%20%3D%201e%2D6%2C%0A%20%20%20%20tauEpsilon%20%3D%20tau%242%20%2D%20epsilon%241%3B%0A%0Afunction%20Path%28%29%20%7B%0A%20%20this%2E%5Fx0%20%3D%20this%2E%5Fy0%20%3D%20%2F%2F%20start%20of%20current%20subpath%0A%20%20this%2E%5Fx1%20%3D%20this%2E%5Fy1%20%3D%20null%3B%20%2F%2F%20end%20of%20current%20subpath%0A%20%20this%2E%5F%20%3D%20%22%22%3B%0A%7D%0A%0Afunction%20path%28%29%20%7B%0A%20%20return%20new%20Path%3B%0A%7D%0A%0APath%2Eprototype%20%3D%20path%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20Path%2C%0A%20%20moveTo%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20this%2E%5F%20%2B%3D%20%22M%22%20%2B%20%28this%2E%5Fx0%20%3D%20this%2E%5Fx1%20%3D%20%2Bx%29%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fy0%20%3D%20this%2E%5Fy1%20%3D%20%2By%29%3B%0A%20%20%7D%2C%0A%20%20closePath%3A%20function%28%29%20%7B%0A%20%20%20%20if%20%28this%2E%5Fx1%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this%2E%5Fx1%20%3D%20this%2E%5Fx0%2C%20this%2E%5Fy1%20%3D%20this%2E%5Fy0%3B%0A%20%20%20%20%20%20this%2E%5F%20%2B%3D%20%22Z%22%3B%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20lineTo%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20this%2E%5F%20%2B%3D%20%22L%22%20%2B%20%28this%2E%5Fx1%20%3D%20%2Bx%29%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fy1%20%3D%20%2By%29%3B%0A%20%20%7D%2C%0A%20%20quadraticCurveTo%3A%20function%28x1%2C%20y1%2C%20x%2C%20y%29%20%7B%0A%20%20%20%20this%2E%5F%20%2B%3D%20%22Q%22%20%2B%20%28%2Bx1%29%20%2B%20%22%2C%22%20%2B%20%28%2By1%29%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fx1%20%3D%20%2Bx%29%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fy1%20%3D%20%2By%29%3B%0A%20%20%7D%2C%0A%20%20bezierCurveTo%3A%20function%28x1%2C%20y1%2C%20x2%2C%20y2%2C%20x%2C%20y%29%20%7B%0A%20%20%20%20this%2E%5F%20%2B%3D%20%22C%22%20%2B%20%28%2Bx1%29%20%2B%20%22%2C%22%20%2B%20%28%2By1%29%20%2B%20%22%2C%22%20%2B%20%28%2Bx2%29%20%2B%20%22%2C%22%20%2B%20%28%2By2%29%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fx1%20%3D%20%2Bx%29%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fy1%20%3D%20%2By%29%3B%0A%20%20%7D%2C%0A%20%20arcTo%3A%20function%28x1%2C%20y1%2C%20x2%2C%20y2%2C%20r%29%20%7B%0A%20%20%20%20x1%20%3D%20%2Bx1%2C%20y1%20%3D%20%2By1%2C%20x2%20%3D%20%2Bx2%2C%20y2%20%3D%20%2By2%2C%20r%20%3D%20%2Br%3B%0A%20%20%20%20var%20x0%20%3D%20this%2E%5Fx1%2C%0A%20%20%20%20%20%20%20%20y0%20%3D%20this%2E%5Fy1%2C%0A%20%20%20%20%20%20%20%20x21%20%3D%20x2%20%2D%20x1%2C%0A%20%20%20%20%20%20%20%20y21%20%3D%20y2%20%2D%20y1%2C%0A%20%20%20%20%20%20%20%20x01%20%3D%20x0%20%2D%20x1%2C%0A%20%20%20%20%20%20%20%20y01%20%3D%20y0%20%2D%20y1%2C%0A%20%20%20%20%20%20%20%20l01%5F2%20%3D%20x01%20%2A%20x01%20%2B%20y01%20%2A%20y01%3B%0A%0A%20%20%20%20%2F%2F%20Is%20the%20radius%20negative%3F%20Error%2E%0A%20%20%20%20if%20%28r%20%3C%200%29%20throw%20new%20Error%28%22negative%20radius%3A%20%22%20%2B%20r%29%3B%0A%0A%20%20%20%20%2F%2F%20Is%20this%20path%20empty%3F%20Move%20to%20%28x1%2Cy1%29%2E%0A%20%20%20%20if%20%28this%2E%5Fx1%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this%2E%5F%20%2B%3D%20%22M%22%20%2B%20%28this%2E%5Fx1%20%3D%20x1%29%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fy1%20%3D%20y1%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Or%2C%20is%20%28x1%2Cy1%29%20coincident%20with%20%28x0%2Cy0%29%3F%20Do%20nothing%2E%0A%20%20%20%20else%20if%20%28%21%28l01%5F2%20%3E%20epsilon%241%29%29%20%7B%7D%0A%0A%20%20%20%20%2F%2F%20Or%2C%20are%20%28x0%2Cy0%29%2C%20%28x1%2Cy1%29%20and%20%28x2%2Cy2%29%20collinear%3F%0A%20%20%20%20%2F%2F%20Equivalently%2C%20is%20%28x1%2Cy1%29%20coincident%20with%20%28x2%2Cy2%29%3F%0A%20%20%20%20%2F%2F%20Or%2C%20is%20the%20radius%20zero%3F%20Line%20to%20%28x1%2Cy1%29%2E%0A%20%20%20%20else%20if%20%28%21%28Math%2Eabs%28y01%20%2A%20x21%20%2D%20y21%20%2A%20x01%29%20%3E%20epsilon%241%29%20%7C%7C%20%21r%29%20%7B%0A%20%20%20%20%20%20this%2E%5F%20%2B%3D%20%22L%22%20%2B%20%28this%2E%5Fx1%20%3D%20x1%29%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fy1%20%3D%20y1%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Otherwise%2C%20draw%20an%20arc%21%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20var%20x20%20%3D%20x2%20%2D%20x0%2C%0A%20%20%20%20%20%20%20%20%20%20y20%20%3D%20y2%20%2D%20y0%2C%0A%20%20%20%20%20%20%20%20%20%20l21%5F2%20%3D%20x21%20%2A%20x21%20%2B%20y21%20%2A%20y21%2C%0A%20%20%20%20%20%20%20%20%20%20l20%5F2%20%3D%20x20%20%2A%20x20%20%2B%20y20%20%2A%20y20%2C%0A%20%20%20%20%20%20%20%20%20%20l21%20%3D%20Math%2Esqrt%28l21%5F2%29%2C%0A%20%20%20%20%20%20%20%20%20%20l01%20%3D%20Math%2Esqrt%28l01%5F2%29%2C%0A%20%20%20%20%20%20%20%20%20%20l%20%3D%20r%20%2A%20Math%2Etan%28%28pi%242%20%2D%20Math%2Eacos%28%28l21%5F2%20%2B%20l01%5F2%20%2D%20l20%5F2%29%20%2F%20%282%20%2A%20l21%20%2A%20l01%29%29%29%20%2F%202%29%2C%0A%20%20%20%20%20%20%20%20%20%20t01%20%3D%20l%20%2F%20l01%2C%0A%20%20%20%20%20%20%20%20%20%20t21%20%3D%20l%20%2F%20l21%3B%0A%0A%20%20%20%20%20%20%2F%2F%20If%20the%20start%20tangent%20is%20not%20coincident%20with%20%28x0%2Cy0%29%2C%20line%20to%2E%0A%20%20%20%20%20%20if%20%28Math%2Eabs%28t01%20%2D%201%29%20%3E%20epsilon%241%29%20%7B%0A%20%20%20%20%20%20%20%20this%2E%5F%20%2B%3D%20%22L%22%20%2B%20%28x1%20%2B%20t01%20%2A%20x01%29%20%2B%20%22%2C%22%20%2B%20%28y1%20%2B%20t01%20%2A%20y01%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20this%2E%5F%20%2B%3D%20%22A%22%20%2B%20r%20%2B%20%22%2C%22%20%2B%20r%20%2B%20%22%2C0%2C0%2C%22%20%2B%20%28%2B%28y01%20%2A%20x20%20%3E%20x01%20%2A%20y20%29%29%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fx1%20%3D%20x1%20%2B%20t21%20%2A%20x21%29%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fy1%20%3D%20y1%20%2B%20t21%20%2A%20y21%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20arc%3A%20function%28x%2C%20y%2C%20r%2C%20a0%2C%20a1%2C%20ccw%29%20%7B%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%2C%20r%20%3D%20%2Br%3B%0A%20%20%20%20var%20dx%20%3D%20r%20%2A%20Math%2Ecos%28a0%29%2C%0A%20%20%20%20%20%20%20%20dy%20%3D%20r%20%2A%20Math%2Esin%28a0%29%2C%0A%20%20%20%20%20%20%20%20x0%20%3D%20x%20%2B%20dx%2C%0A%20%20%20%20%20%20%20%20y0%20%3D%20y%20%2B%20dy%2C%0A%20%20%20%20%20%20%20%20cw%20%3D%201%20%5E%20ccw%2C%0A%20%20%20%20%20%20%20%20da%20%3D%20ccw%20%3F%20a0%20%2D%20a1%20%3A%20a1%20%2D%20a0%3B%0A%0A%20%20%20%20%2F%2F%20Is%20the%20radius%20negative%3F%20Error%2E%0A%20%20%20%20if%20%28r%20%3C%200%29%20throw%20new%20Error%28%22negative%20radius%3A%20%22%20%2B%20r%29%3B%0A%0A%20%20%20%20%2F%2F%20Is%20this%20path%20empty%3F%20Move%20to%20%28x0%2Cy0%29%2E%0A%20%20%20%20if%20%28this%2E%5Fx1%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this%2E%5F%20%2B%3D%20%22M%22%20%2B%20x0%20%2B%20%22%2C%22%20%2B%20y0%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Or%2C%20is%20%28x0%2Cy0%29%20not%20coincident%20with%20the%20previous%20point%3F%20Line%20to%20%28x0%2Cy0%29%2E%0A%20%20%20%20else%20if%20%28Math%2Eabs%28this%2E%5Fx1%20%2D%20x0%29%20%3E%20epsilon%241%20%7C%7C%20Math%2Eabs%28this%2E%5Fy1%20%2D%20y0%29%20%3E%20epsilon%241%29%20%7B%0A%20%20%20%20%20%20this%2E%5F%20%2B%3D%20%22L%22%20%2B%20x0%20%2B%20%22%2C%22%20%2B%20y0%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Is%20this%20arc%20empty%3F%20We%E2%80%99re%20done%2E%0A%20%20%20%20if%20%28%21r%29%20return%3B%0A%0A%20%20%20%20%2F%2F%20Does%20the%20angle%20go%20the%20wrong%20way%3F%20Flip%20the%20direction%2E%0A%20%20%20%20if%20%28da%20%3C%200%29%20da%20%3D%20da%20%25%20tau%242%20%2B%20tau%242%3B%0A%0A%20%20%20%20%2F%2F%20Is%20this%20a%20complete%20circle%3F%20Draw%20two%20arcs%20to%20complete%20the%20circle%2E%0A%20%20%20%20if%20%28da%20%3E%20tauEpsilon%29%20%7B%0A%20%20%20%20%20%20this%2E%5F%20%2B%3D%20%22A%22%20%2B%20r%20%2B%20%22%2C%22%20%2B%20r%20%2B%20%22%2C0%2C1%2C%22%20%2B%20cw%20%2B%20%22%2C%22%20%2B%20%28x%20%2D%20dx%29%20%2B%20%22%2C%22%20%2B%20%28y%20%2D%20dy%29%20%2B%20%22A%22%20%2B%20r%20%2B%20%22%2C%22%20%2B%20r%20%2B%20%22%2C0%2C1%2C%22%20%2B%20cw%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fx1%20%3D%20x0%29%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fy1%20%3D%20y0%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Is%20this%20arc%20non%2Dempty%3F%20Draw%20an%20arc%21%0A%20%20%20%20else%20if%20%28da%20%3E%20epsilon%241%29%20%7B%0A%20%20%20%20%20%20this%2E%5F%20%2B%3D%20%22A%22%20%2B%20r%20%2B%20%22%2C%22%20%2B%20r%20%2B%20%22%2C0%2C%22%20%2B%20%28%2B%28da%20%3E%3D%20pi%242%29%29%20%2B%20%22%2C%22%20%2B%20cw%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fx1%20%3D%20x%20%2B%20r%20%2A%20Math%2Ecos%28a1%29%29%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fy1%20%3D%20y%20%2B%20r%20%2A%20Math%2Esin%28a1%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20rect%3A%20function%28x%2C%20y%2C%20w%2C%20h%29%20%7B%0A%20%20%20%20this%2E%5F%20%2B%3D%20%22M%22%20%2B%20%28this%2E%5Fx0%20%3D%20this%2E%5Fx1%20%3D%20%2Bx%29%20%2B%20%22%2C%22%20%2B%20%28this%2E%5Fy0%20%3D%20this%2E%5Fy1%20%3D%20%2By%29%20%2B%20%22h%22%20%2B%20%28%2Bw%29%20%2B%20%22v%22%20%2B%20%28%2Bh%29%20%2B%20%22h%22%20%2B%20%28%2Dw%29%20%2B%20%22Z%22%3B%0A%20%20%7D%2C%0A%20%20toString%3A%20function%28%29%20%7B%0A%20%20%20%20return%20this%2E%5F%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20defaultSource%28d%29%20%7B%0A%20%20return%20d%2Esource%3B%0A%7D%0A%0Afunction%20defaultTarget%28d%29%20%7B%0A%20%20return%20d%2Etarget%3B%0A%7D%0A%0Afunction%20defaultRadius%28d%29%20%7B%0A%20%20return%20d%2Eradius%3B%0A%7D%0A%0Afunction%20defaultStartAngle%28d%29%20%7B%0A%20%20return%20d%2EstartAngle%3B%0A%7D%0A%0Afunction%20defaultEndAngle%28d%29%20%7B%0A%20%20return%20d%2EendAngle%3B%0A%7D%0A%0Afunction%20ribbon%28%29%20%7B%0A%20%20var%20source%20%3D%20defaultSource%2C%0A%20%20%20%20%20%20target%20%3D%20defaultTarget%2C%0A%20%20%20%20%20%20radius%20%3D%20defaultRadius%2C%0A%20%20%20%20%20%20startAngle%20%3D%20defaultStartAngle%2C%0A%20%20%20%20%20%20endAngle%20%3D%20defaultEndAngle%2C%0A%20%20%20%20%20%20context%20%3D%20null%3B%0A%0A%20%20function%20ribbon%28%29%20%7B%0A%20%20%20%20var%20buffer%2C%0A%20%20%20%20%20%20%20%20argv%20%3D%20slice%242%2Ecall%28arguments%29%2C%0A%20%20%20%20%20%20%20%20s%20%3D%20source%2Eapply%28this%2C%20argv%29%2C%0A%20%20%20%20%20%20%20%20t%20%3D%20target%2Eapply%28this%2C%20argv%29%2C%0A%20%20%20%20%20%20%20%20sr%20%3D%20%2Bradius%2Eapply%28this%2C%20%28argv%5B0%5D%20%3D%20s%2C%20argv%29%29%2C%0A%20%20%20%20%20%20%20%20sa0%20%3D%20startAngle%2Eapply%28this%2C%20argv%29%20%2D%20halfPi%241%2C%0A%20%20%20%20%20%20%20%20sa1%20%3D%20endAngle%2Eapply%28this%2C%20argv%29%20%2D%20halfPi%241%2C%0A%20%20%20%20%20%20%20%20sx0%20%3D%20sr%20%2A%20cos%28sa0%29%2C%0A%20%20%20%20%20%20%20%20sy0%20%3D%20sr%20%2A%20sin%28sa0%29%2C%0A%20%20%20%20%20%20%20%20tr%20%3D%20%2Bradius%2Eapply%28this%2C%20%28argv%5B0%5D%20%3D%20t%2C%20argv%29%29%2C%0A%20%20%20%20%20%20%20%20ta0%20%3D%20startAngle%2Eapply%28this%2C%20argv%29%20%2D%20halfPi%241%2C%0A%20%20%20%20%20%20%20%20ta1%20%3D%20endAngle%2Eapply%28this%2C%20argv%29%20%2D%20halfPi%241%3B%0A%0A%20%20%20%20if%20%28%21context%29%20context%20%3D%20buffer%20%3D%20path%28%29%3B%0A%0A%20%20%20%20context%2EmoveTo%28sx0%2C%20sy0%29%3B%0A%20%20%20%20context%2Earc%280%2C%200%2C%20sr%2C%20sa0%2C%20sa1%29%3B%0A%20%20%20%20if%20%28sa0%20%21%3D%3D%20ta0%20%7C%7C%20sa1%20%21%3D%3D%20ta1%29%20%7B%20%2F%2F%20TODO%20sr%20%21%3D%3D%20tr%3F%0A%20%20%20%20%20%20context%2EquadraticCurveTo%280%2C%200%2C%20tr%20%2A%20cos%28ta0%29%2C%20tr%20%2A%20sin%28ta0%29%29%3B%0A%20%20%20%20%20%20context%2Earc%280%2C%200%2C%20tr%2C%20ta0%2C%20ta1%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20context%2EquadraticCurveTo%280%2C%200%2C%20sx0%2C%20sy0%29%3B%0A%20%20%20%20context%2EclosePath%28%29%3B%0A%0A%20%20%20%20if%20%28buffer%29%20return%20context%20%3D%20null%2C%20buffer%20%2B%20%22%22%20%7C%7C%20null%3B%0A%20%20%7D%0A%0A%20%20ribbon%2Eradius%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28radius%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%245%28%2B%5F%29%2C%20ribbon%29%20%3A%20radius%3B%0A%20%20%7D%3B%0A%0A%20%20ribbon%2EstartAngle%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28startAngle%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%245%28%2B%5F%29%2C%20ribbon%29%20%3A%20startAngle%3B%0A%20%20%7D%3B%0A%0A%20%20ribbon%2EendAngle%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28endAngle%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%245%28%2B%5F%29%2C%20ribbon%29%20%3A%20endAngle%3B%0A%20%20%7D%3B%0A%0A%20%20ribbon%2Esource%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28source%20%3D%20%5F%2C%20ribbon%29%20%3A%20source%3B%0A%20%20%7D%3B%0A%0A%20%20ribbon%2Etarget%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28target%20%3D%20%5F%2C%20ribbon%29%20%3A%20target%3B%0A%20%20%7D%3B%0A%0A%20%20ribbon%2Econtext%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28context%20%3D%20%5F%20%3D%3D%20null%20%3F%20null%20%3A%20%5F%2C%20ribbon%29%20%3A%20context%3B%0A%20%20%7D%3B%0A%0A%20%20return%20ribbon%3B%0A%7D%0A%0Avar%20prefix%20%3D%20%22%24%22%3B%0A%0Afunction%20Map%28%29%20%7B%7D%0A%0AMap%2Eprototype%20%3D%20map%241%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20Map%2C%0A%20%20has%3A%20function%28key%29%20%7B%0A%20%20%20%20return%20%28prefix%20%2B%20key%29%20in%20this%3B%0A%20%20%7D%2C%0A%20%20get%3A%20function%28key%29%20%7B%0A%20%20%20%20return%20this%5Bprefix%20%2B%20key%5D%3B%0A%20%20%7D%2C%0A%20%20set%3A%20function%28key%2C%20value%29%20%7B%0A%20%20%20%20this%5Bprefix%20%2B%20key%5D%20%3D%20value%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%2C%0A%20%20remove%3A%20function%28key%29%20%7B%0A%20%20%20%20var%20property%20%3D%20prefix%20%2B%20key%3B%0A%20%20%20%20return%20property%20in%20this%20%26%26%20delete%20this%5Bproperty%5D%3B%0A%20%20%7D%2C%0A%20%20clear%3A%20function%28%29%20%7B%0A%20%20%20%20for%20%28var%20property%20in%20this%29%20if%20%28property%5B0%5D%20%3D%3D%3D%20prefix%29%20delete%20this%5Bproperty%5D%3B%0A%20%20%7D%2C%0A%20%20keys%3A%20function%28%29%20%7B%0A%20%20%20%20var%20keys%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28var%20property%20in%20this%29%20if%20%28property%5B0%5D%20%3D%3D%3D%20prefix%29%20keys%2Epush%28property%2Eslice%281%29%29%3B%0A%20%20%20%20return%20keys%3B%0A%20%20%7D%2C%0A%20%20values%3A%20function%28%29%20%7B%0A%20%20%20%20var%20values%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28var%20property%20in%20this%29%20if%20%28property%5B0%5D%20%3D%3D%3D%20prefix%29%20values%2Epush%28this%5Bproperty%5D%29%3B%0A%20%20%20%20return%20values%3B%0A%20%20%7D%2C%0A%20%20entries%3A%20function%28%29%20%7B%0A%20%20%20%20var%20entries%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28var%20property%20in%20this%29%20if%20%28property%5B0%5D%20%3D%3D%3D%20prefix%29%20entries%2Epush%28%7Bkey%3A%20property%2Eslice%281%29%2C%20value%3A%20this%5Bproperty%5D%7D%29%3B%0A%20%20%20%20return%20entries%3B%0A%20%20%7D%2C%0A%20%20size%3A%20function%28%29%20%7B%0A%20%20%20%20var%20size%20%3D%200%3B%0A%20%20%20%20for%20%28var%20property%20in%20this%29%20if%20%28property%5B0%5D%20%3D%3D%3D%20prefix%29%20%2B%2Bsize%3B%0A%20%20%20%20return%20size%3B%0A%20%20%7D%2C%0A%20%20empty%3A%20function%28%29%20%7B%0A%20%20%20%20for%20%28var%20property%20in%20this%29%20if%20%28property%5B0%5D%20%3D%3D%3D%20prefix%29%20return%20false%3B%0A%20%20%20%20return%20true%3B%0A%20%20%7D%2C%0A%20%20each%3A%20function%28f%29%20%7B%0A%20%20%20%20for%20%28var%20property%20in%20this%29%20if%20%28property%5B0%5D%20%3D%3D%3D%20prefix%29%20f%28this%5Bproperty%5D%2C%20property%2Eslice%281%29%2C%20this%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20map%241%28object%2C%20f%29%20%7B%0A%20%20var%20map%20%3D%20new%20Map%3B%0A%0A%20%20%2F%2F%20Copy%20constructor%2E%0A%20%20if%20%28object%20instanceof%20Map%29%20object%2Eeach%28function%28value%2C%20key%29%20%7B%20map%2Eset%28key%2C%20value%29%3B%20%7D%29%3B%0A%0A%20%20%2F%2F%20Index%20array%20by%20numeric%20index%20or%20specified%20key%20function%2E%0A%20%20else%20if%20%28Array%2EisArray%28object%29%29%20%7B%0A%20%20%20%20var%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20object%2Elength%2C%0A%20%20%20%20%20%20%20%20o%3B%0A%0A%20%20%20%20if%20%28f%20%3D%3D%20null%29%20while%20%28%2B%2Bi%20%3C%20n%29%20map%2Eset%28i%2C%20object%5Bi%5D%29%3B%0A%20%20%20%20else%20while%20%28%2B%2Bi%20%3C%20n%29%20map%2Eset%28f%28o%20%3D%20object%5Bi%5D%2C%20i%2C%20object%29%2C%20o%29%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Convert%20object%20to%20map%2E%0A%20%20else%20if%20%28object%29%20for%20%28var%20key%20in%20object%29%20map%2Eset%28key%2C%20object%5Bkey%5D%29%3B%0A%0A%20%20return%20map%3B%0A%7D%0A%0Afunction%20nest%28%29%20%7B%0A%20%20var%20keys%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20sortKeys%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20sortValues%2C%0A%20%20%20%20%20%20rollup%2C%0A%20%20%20%20%20%20nest%3B%0A%0A%20%20function%20apply%28array%2C%20depth%2C%20createResult%2C%20setResult%29%20%7B%0A%20%20%20%20if%20%28depth%20%3E%3D%20keys%2Elength%29%20%7B%0A%20%20%20%20%20%20if%20%28sortValues%20%21%3D%20null%29%20array%2Esort%28sortValues%29%3B%0A%20%20%20%20%20%20return%20rollup%20%21%3D%20null%20%3F%20rollup%28array%29%20%3A%20array%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20array%2Elength%2C%0A%20%20%20%20%20%20%20%20key%20%3D%20keys%5Bdepth%2B%2B%5D%2C%0A%20%20%20%20%20%20%20%20keyValue%2C%0A%20%20%20%20%20%20%20%20value%2C%0A%20%20%20%20%20%20%20%20valuesByKey%20%3D%20map%241%28%29%2C%0A%20%20%20%20%20%20%20%20values%2C%0A%20%20%20%20%20%20%20%20result%20%3D%20createResult%28%29%3B%0A%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20if%20%28values%20%3D%20valuesByKey%2Eget%28keyValue%20%3D%20key%28value%20%3D%20array%5Bi%5D%29%20%2B%20%22%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20values%2Epush%28value%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20valuesByKey%2Eset%28keyValue%2C%20%5Bvalue%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20valuesByKey%2Eeach%28function%28values%2C%20key%29%20%7B%0A%20%20%20%20%20%20setResult%28result%2C%20key%2C%20apply%28values%2C%20depth%2C%20createResult%2C%20setResult%29%29%3B%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%0A%20%20function%20entries%28map%2C%20depth%29%20%7B%0A%20%20%20%20if%20%28%2B%2Bdepth%20%3E%20keys%2Elength%29%20return%20map%3B%0A%20%20%20%20var%20array%2C%20sortKey%20%3D%20sortKeys%5Bdepth%20%2D%201%5D%3B%0A%20%20%20%20if%20%28rollup%20%21%3D%20null%20%26%26%20depth%20%3E%3D%20keys%2Elength%29%20array%20%3D%20map%2Eentries%28%29%3B%0A%20%20%20%20else%20array%20%3D%20%5B%5D%2C%20map%2Eeach%28function%28v%2C%20k%29%20%7B%20array%2Epush%28%7Bkey%3A%20k%2C%20values%3A%20entries%28v%2C%20depth%29%7D%29%3B%20%7D%29%3B%0A%20%20%20%20return%20sortKey%20%21%3D%20null%20%3F%20array%2Esort%28function%28a%2C%20b%29%20%7B%20return%20sortKey%28a%2Ekey%2C%20b%2Ekey%29%3B%20%7D%29%20%3A%20array%3B%0A%20%20%7D%0A%0A%20%20return%20nest%20%3D%20%7B%0A%20%20%20%20object%3A%20function%28array%29%20%7B%20return%20apply%28array%2C%200%2C%20createObject%2C%20setObject%29%3B%20%7D%2C%0A%20%20%20%20map%3A%20function%28array%29%20%7B%20return%20apply%28array%2C%200%2C%20createMap%2C%20setMap%29%3B%20%7D%2C%0A%20%20%20%20entries%3A%20function%28array%29%20%7B%20return%20entries%28apply%28array%2C%200%2C%20createMap%2C%20setMap%29%2C%200%29%3B%20%7D%2C%0A%20%20%20%20key%3A%20function%28d%29%20%7B%20keys%2Epush%28d%29%3B%20return%20nest%3B%20%7D%2C%0A%20%20%20%20sortKeys%3A%20function%28order%29%20%7B%20sortKeys%5Bkeys%2Elength%20%2D%201%5D%20%3D%20order%3B%20return%20nest%3B%20%7D%2C%0A%20%20%20%20sortValues%3A%20function%28order%29%20%7B%20sortValues%20%3D%20order%3B%20return%20nest%3B%20%7D%2C%0A%20%20%20%20rollup%3A%20function%28f%29%20%7B%20rollup%20%3D%20f%3B%20return%20nest%3B%20%7D%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20createObject%28%29%20%7B%0A%20%20return%20%7B%7D%3B%0A%7D%0A%0Afunction%20setObject%28object%2C%20key%2C%20value%29%20%7B%0A%20%20object%5Bkey%5D%20%3D%20value%3B%0A%7D%0A%0Afunction%20createMap%28%29%20%7B%0A%20%20return%20map%241%28%29%3B%0A%7D%0A%0Afunction%20setMap%28map%2C%20key%2C%20value%29%20%7B%0A%20%20map%2Eset%28key%2C%20value%29%3B%0A%7D%0A%0Afunction%20Set%28%29%20%7B%7D%0A%0Avar%20proto%20%3D%20map%241%2Eprototype%3B%0A%0ASet%2Eprototype%20%3D%20set%242%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20Set%2C%0A%20%20has%3A%20proto%2Ehas%2C%0A%20%20add%3A%20function%28value%29%20%7B%0A%20%20%20%20value%20%2B%3D%20%22%22%3B%0A%20%20%20%20this%5Bprefix%20%2B%20value%5D%20%3D%20value%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%2C%0A%20%20remove%3A%20proto%2Eremove%2C%0A%20%20clear%3A%20proto%2Eclear%2C%0A%20%20values%3A%20proto%2Ekeys%2C%0A%20%20size%3A%20proto%2Esize%2C%0A%20%20empty%3A%20proto%2Eempty%2C%0A%20%20each%3A%20proto%2Eeach%0A%7D%3B%0A%0Afunction%20set%242%28object%2C%20f%29%20%7B%0A%20%20var%20set%20%3D%20new%20Set%3B%0A%0A%20%20%2F%2F%20Copy%20constructor%2E%0A%20%20if%20%28object%20instanceof%20Set%29%20object%2Eeach%28function%28value%29%20%7B%20set%2Eadd%28value%29%3B%20%7D%29%3B%0A%0A%20%20%2F%2F%20Otherwise%2C%20assume%20it%E2%80%99s%20an%20array%2E%0A%20%20else%20if%20%28object%29%20%7B%0A%20%20%20%20var%20i%20%3D%20%2D1%2C%20n%20%3D%20object%2Elength%3B%0A%20%20%20%20if%20%28f%20%3D%3D%20null%29%20while%20%28%2B%2Bi%20%3C%20n%29%20set%2Eadd%28object%5Bi%5D%29%3B%0A%20%20%20%20else%20while%20%28%2B%2Bi%20%3C%20n%29%20set%2Eadd%28f%28object%5Bi%5D%2C%20i%2C%20object%29%29%3B%0A%20%20%7D%0A%0A%20%20return%20set%3B%0A%7D%0A%0Afunction%20keys%28map%29%20%7B%0A%20%20var%20keys%20%3D%20%5B%5D%3B%0A%20%20for%20%28var%20key%20in%20map%29%20keys%2Epush%28key%29%3B%0A%20%20return%20keys%3B%0A%7D%0A%0Afunction%20values%28map%29%20%7B%0A%20%20var%20values%20%3D%20%5B%5D%3B%0A%20%20for%20%28var%20key%20in%20map%29%20values%2Epush%28map%5Bkey%5D%29%3B%0A%20%20return%20values%3B%0A%7D%0A%0Afunction%20entries%28map%29%20%7B%0A%20%20var%20entries%20%3D%20%5B%5D%3B%0A%20%20for%20%28var%20key%20in%20map%29%20entries%2Epush%28%7Bkey%3A%20key%2C%20value%3A%20map%5Bkey%5D%7D%29%3B%0A%20%20return%20entries%3B%0A%7D%0A%0Avar%20array%242%20%3D%20Array%2Eprototype%3B%0A%0Avar%20slice%243%20%3D%20array%242%2Eslice%3B%0A%0Afunction%20ascending%242%28a%2C%20b%29%20%7B%0A%20%20return%20a%20%2D%20b%3B%0A%7D%0A%0Afunction%20area%28ring%29%20%7B%0A%20%20var%20i%20%3D%200%2C%20n%20%3D%20ring%2Elength%2C%20area%20%3D%20ring%5Bn%20%2D%201%5D%5B1%5D%20%2A%20ring%5B0%5D%5B0%5D%20%2D%20ring%5Bn%20%2D%201%5D%5B0%5D%20%2A%20ring%5B0%5D%5B1%5D%3B%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20area%20%2B%3D%20ring%5Bi%20%2D%201%5D%5B1%5D%20%2A%20ring%5Bi%5D%5B0%5D%20%2D%20ring%5Bi%20%2D%201%5D%5B0%5D%20%2A%20ring%5Bi%5D%5B1%5D%3B%0A%20%20return%20area%3B%0A%7D%0A%0Afunction%20constant%246%28x%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20contains%28ring%2C%20hole%29%20%7B%0A%20%20var%20i%20%3D%20%2D1%2C%20n%20%3D%20hole%2Elength%2C%20c%3B%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20if%20%28c%20%3D%20ringContains%28ring%2C%20hole%5Bi%5D%29%29%20return%20c%3B%0A%20%20return%200%3B%0A%7D%0A%0Afunction%20ringContains%28ring%2C%20point%29%20%7B%0A%20%20var%20x%20%3D%20point%5B0%5D%2C%20y%20%3D%20point%5B1%5D%2C%20contains%20%3D%20%2D1%3B%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20ring%2Elength%2C%20j%20%3D%20n%20%2D%201%3B%20i%20%3C%20n%3B%20j%20%3D%20i%2B%2B%29%20%7B%0A%20%20%20%20var%20pi%20%3D%20ring%5Bi%5D%2C%20xi%20%3D%20pi%5B0%5D%2C%20yi%20%3D%20pi%5B1%5D%2C%20pj%20%3D%20ring%5Bj%5D%2C%20xj%20%3D%20pj%5B0%5D%2C%20yj%20%3D%20pj%5B1%5D%3B%0A%20%20%20%20if%20%28segmentContains%28pi%2C%20pj%2C%20point%29%29%20return%200%3B%0A%20%20%20%20if%20%28%28%28yi%20%3E%20y%29%20%21%3D%3D%20%28yj%20%3E%20y%29%29%20%26%26%20%28%28x%20%3C%20%28xj%20%2D%20xi%29%20%2A%20%28y%20%2D%20yi%29%20%2F%20%28yj%20%2D%20yi%29%20%2B%20xi%29%29%29%20contains%20%3D%20%2Dcontains%3B%0A%20%20%7D%0A%20%20return%20contains%3B%0A%7D%0A%0Afunction%20segmentContains%28a%2C%20b%2C%20c%29%20%7B%0A%20%20var%20i%3B%20return%20collinear%28a%2C%20b%2C%20c%29%20%26%26%20within%28a%5Bi%20%3D%20%2B%28a%5B0%5D%20%3D%3D%3D%20b%5B0%5D%29%5D%2C%20c%5Bi%5D%2C%20b%5Bi%5D%29%3B%0A%7D%0A%0Afunction%20collinear%28a%2C%20b%2C%20c%29%20%7B%0A%20%20return%20%28b%5B0%5D%20%2D%20a%5B0%5D%29%20%2A%20%28c%5B1%5D%20%2D%20a%5B1%5D%29%20%3D%3D%3D%20%28c%5B0%5D%20%2D%20a%5B0%5D%29%20%2A%20%28b%5B1%5D%20%2D%20a%5B1%5D%29%3B%0A%7D%0A%0Afunction%20within%28p%2C%20q%2C%20r%29%20%7B%0A%20%20return%20p%20%3C%3D%20q%20%26%26%20q%20%3C%3D%20r%20%7C%7C%20r%20%3C%3D%20q%20%26%26%20q%20%3C%3D%20p%3B%0A%7D%0A%0Afunction%20noop%241%28%29%20%7B%7D%0A%0Avar%20cases%20%3D%20%5B%0A%20%20%5B%5D%2C%0A%20%20%5B%5B%5B1%2E0%2C%201%2E5%5D%2C%20%5B0%2E5%2C%201%2E0%5D%5D%5D%2C%0A%20%20%5B%5B%5B1%2E5%2C%201%2E0%5D%2C%20%5B1%2E0%2C%201%2E5%5D%5D%5D%2C%0A%20%20%5B%5B%5B1%2E5%2C%201%2E0%5D%2C%20%5B0%2E5%2C%201%2E0%5D%5D%5D%2C%0A%20%20%5B%5B%5B1%2E0%2C%200%2E5%5D%2C%20%5B1%2E5%2C%201%2E0%5D%5D%5D%2C%0A%20%20%5B%5B%5B1%2E0%2C%201%2E5%5D%2C%20%5B0%2E5%2C%201%2E0%5D%5D%2C%20%5B%5B1%2E0%2C%200%2E5%5D%2C%20%5B1%2E5%2C%201%2E0%5D%5D%5D%2C%0A%20%20%5B%5B%5B1%2E0%2C%200%2E5%5D%2C%20%5B1%2E0%2C%201%2E5%5D%5D%5D%2C%0A%20%20%5B%5B%5B1%2E0%2C%200%2E5%5D%2C%20%5B0%2E5%2C%201%2E0%5D%5D%5D%2C%0A%20%20%5B%5B%5B0%2E5%2C%201%2E0%5D%2C%20%5B1%2E0%2C%200%2E5%5D%5D%5D%2C%0A%20%20%5B%5B%5B1%2E0%2C%201%2E5%5D%2C%20%5B1%2E0%2C%200%2E5%5D%5D%5D%2C%0A%20%20%5B%5B%5B0%2E5%2C%201%2E0%5D%2C%20%5B1%2E0%2C%200%2E5%5D%5D%2C%20%5B%5B1%2E5%2C%201%2E0%5D%2C%20%5B1%2E0%2C%201%2E5%5D%5D%5D%2C%0A%20%20%5B%5B%5B1%2E5%2C%201%2E0%5D%2C%20%5B1%2E0%2C%200%2E5%5D%5D%5D%2C%0A%20%20%5B%5B%5B0%2E5%2C%201%2E0%5D%2C%20%5B1%2E5%2C%201%2E0%5D%5D%5D%2C%0A%20%20%5B%5B%5B1%2E0%2C%201%2E5%5D%2C%20%5B1%2E5%2C%201%2E0%5D%5D%5D%2C%0A%20%20%5B%5B%5B0%2E5%2C%201%2E0%5D%2C%20%5B1%2E0%2C%201%2E5%5D%5D%5D%2C%0A%20%20%5B%5D%0A%5D%3B%0A%0Afunction%20contours%28%29%20%7B%0A%20%20var%20dx%20%3D%201%2C%0A%20%20%20%20%20%20dy%20%3D%201%2C%0A%20%20%20%20%20%20threshold%24%241%20%3D%20thresholdSturges%2C%0A%20%20%20%20%20%20smooth%20%3D%20smoothLinear%3B%0A%0A%20%20function%20contours%28values%29%20%7B%0A%20%20%20%20var%20tz%20%3D%20threshold%24%241%28values%29%3B%0A%0A%20%20%20%20%2F%2F%20Convert%20number%20of%20thresholds%20into%20uniform%20thresholds%2E%0A%20%20%20%20if%20%28%21Array%2EisArray%28tz%29%29%20%7B%0A%20%20%20%20%20%20var%20domain%20%3D%20extent%28values%29%2C%20start%20%3D%20domain%5B0%5D%2C%20stop%20%3D%20domain%5B1%5D%3B%0A%20%20%20%20%20%20tz%20%3D%20tickStep%28start%2C%20stop%2C%20tz%29%3B%0A%20%20%20%20%20%20tz%20%3D%20sequence%28Math%2Efloor%28start%20%2F%20tz%29%20%2A%20tz%2C%20Math%2Efloor%28stop%20%2F%20tz%29%20%2A%20tz%2C%20tz%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20tz%20%3D%20tz%2Eslice%28%29%2Esort%28ascending%242%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20tz%2Emap%28function%28value%29%20%7B%0A%20%20%20%20%20%20return%20contour%28values%2C%20value%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Accumulate%2C%20smooth%20contour%20rings%2C%20assign%20holes%20to%20exterior%20rings%2E%0A%20%20%2F%2F%20Based%20on%20https%3A%2F%2Fgithub%2Ecom%2Fmbostock%2Fshapefile%2Fblob%2Fv0%2E6%2E2%2Fshp%2Fpolygon%2Ejs%0A%20%20function%20contour%28values%2C%20value%29%20%7B%0A%20%20%20%20var%20polygons%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20holes%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20isorings%28values%2C%20value%2C%20function%28ring%29%20%7B%0A%20%20%20%20%20%20smooth%28ring%2C%20values%2C%20value%29%3B%0A%20%20%20%20%20%20if%20%28area%28ring%29%20%3E%200%29%20polygons%2Epush%28%5Bring%5D%29%3B%0A%20%20%20%20%20%20else%20holes%2Epush%28ring%29%3B%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20holes%2EforEach%28function%28hole%29%20%7B%0A%20%20%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20polygons%2Elength%2C%20polygon%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28contains%28%28polygon%20%3D%20polygons%5Bi%5D%29%5B0%5D%2C%20hole%29%20%21%3D%3D%20%2D1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20polygon%2Epush%28hole%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20type%3A%20%22MultiPolygon%22%2C%0A%20%20%20%20%20%20value%3A%20value%2C%0A%20%20%20%20%20%20coordinates%3A%20polygons%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Marching%20squares%20with%20isolines%20stitched%20into%20rings%2E%0A%20%20%2F%2F%20Based%20on%20https%3A%2F%2Fgithub%2Ecom%2Ftopojson%2Ftopojson%2Dclient%2Fblob%2Fv3%2E0%2E0%2Fsrc%2Fstitch%2Ejs%0A%20%20function%20isorings%28values%2C%20value%2C%20callback%29%20%7B%0A%20%20%20%20var%20fragmentByStart%20%3D%20new%20Array%2C%0A%20%20%20%20%20%20%20%20fragmentByEnd%20%3D%20new%20Array%2C%0A%20%20%20%20%20%20%20%20x%2C%20y%2C%20t0%2C%20t1%2C%20t2%2C%20t3%3B%0A%0A%20%20%20%20%2F%2F%20Special%20case%20for%20the%20first%20row%20%28y%20%3D%20%2D1%2C%20t2%20%3D%20t3%20%3D%200%29%2E%0A%20%20%20%20x%20%3D%20y%20%3D%20%2D1%3B%0A%20%20%20%20t1%20%3D%20values%5B0%5D%20%3E%3D%20value%3B%0A%20%20%20%20cases%5Bt1%20%3C%3C%201%5D%2EforEach%28stitch%29%3B%0A%20%20%20%20while%20%28%2B%2Bx%20%3C%20dx%20%2D%201%29%20%7B%0A%20%20%20%20%20%20t0%20%3D%20t1%2C%20t1%20%3D%20values%5Bx%20%2B%201%5D%20%3E%3D%20value%3B%0A%20%20%20%20%20%20cases%5Bt0%20%7C%20t1%20%3C%3C%201%5D%2EforEach%28stitch%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20cases%5Bt1%20%3C%3C%200%5D%2EforEach%28stitch%29%3B%0A%0A%20%20%20%20%2F%2F%20General%20case%20for%20the%20intermediate%20rows%2E%0A%20%20%20%20while%20%28%2B%2By%20%3C%20dy%20%2D%201%29%20%7B%0A%20%20%20%20%20%20x%20%3D%20%2D1%3B%0A%20%20%20%20%20%20t1%20%3D%20values%5By%20%2A%20dx%20%2B%20dx%5D%20%3E%3D%20value%3B%0A%20%20%20%20%20%20t2%20%3D%20values%5By%20%2A%20dx%5D%20%3E%3D%20value%3B%0A%20%20%20%20%20%20cases%5Bt1%20%3C%3C%201%20%7C%20t2%20%3C%3C%202%5D%2EforEach%28stitch%29%3B%0A%20%20%20%20%20%20while%20%28%2B%2Bx%20%3C%20dx%20%2D%201%29%20%7B%0A%20%20%20%20%20%20%20%20t0%20%3D%20t1%2C%20t1%20%3D%20values%5By%20%2A%20dx%20%2B%20dx%20%2B%20x%20%2B%201%5D%20%3E%3D%20value%3B%0A%20%20%20%20%20%20%20%20t3%20%3D%20t2%2C%20t2%20%3D%20values%5By%20%2A%20dx%20%2B%20x%20%2B%201%5D%20%3E%3D%20value%3B%0A%20%20%20%20%20%20%20%20cases%5Bt0%20%7C%20t1%20%3C%3C%201%20%7C%20t2%20%3C%3C%202%20%7C%20t3%20%3C%3C%203%5D%2EforEach%28stitch%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20cases%5Bt1%20%7C%20t2%20%3C%3C%203%5D%2EforEach%28stitch%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Special%20case%20for%20the%20last%20row%20%28y%20%3D%20dy%20%2D%201%2C%20t0%20%3D%20t1%20%3D%200%29%2E%0A%20%20%20%20x%20%3D%20%2D1%3B%0A%20%20%20%20t2%20%3D%20values%5By%20%2A%20dx%5D%20%3E%3D%20value%3B%0A%20%20%20%20cases%5Bt2%20%3C%3C%202%5D%2EforEach%28stitch%29%3B%0A%20%20%20%20while%20%28%2B%2Bx%20%3C%20dx%20%2D%201%29%20%7B%0A%20%20%20%20%20%20t3%20%3D%20t2%2C%20t2%20%3D%20values%5By%20%2A%20dx%20%2B%20x%20%2B%201%5D%20%3E%3D%20value%3B%0A%20%20%20%20%20%20cases%5Bt2%20%3C%3C%202%20%7C%20t3%20%3C%3C%203%5D%2EforEach%28stitch%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20cases%5Bt2%20%3C%3C%203%5D%2EforEach%28stitch%29%3B%0A%0A%20%20%20%20function%20stitch%28line%29%20%7B%0A%20%20%20%20%20%20var%20start%20%3D%20%5Bline%5B0%5D%5B0%5D%20%2B%20x%2C%20line%5B0%5D%5B1%5D%20%2B%20y%5D%2C%0A%20%20%20%20%20%20%20%20%20%20end%20%3D%20%5Bline%5B1%5D%5B0%5D%20%2B%20x%2C%20line%5B1%5D%5B1%5D%20%2B%20y%5D%2C%0A%20%20%20%20%20%20%20%20%20%20startIndex%20%3D%20index%28start%29%2C%0A%20%20%20%20%20%20%20%20%20%20endIndex%20%3D%20index%28end%29%2C%0A%20%20%20%20%20%20%20%20%20%20f%2C%20g%3B%0A%20%20%20%20%20%20if%20%28f%20%3D%20fragmentByEnd%5BstartIndex%5D%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28g%20%3D%20fragmentByStart%5BendIndex%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20delete%20fragmentByEnd%5Bf%2Eend%5D%3B%0A%20%20%20%20%20%20%20%20%20%20delete%20fragmentByStart%5Bg%2Estart%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28f%20%3D%3D%3D%20g%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20f%2Ering%2Epush%28end%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback%28f%2Ering%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20fragmentByStart%5Bf%2Estart%5D%20%3D%20fragmentByEnd%5Bg%2Eend%5D%20%3D%20%7Bstart%3A%20f%2Estart%2C%20end%3A%20g%2Eend%2C%20ring%3A%20f%2Ering%2Econcat%28g%2Ering%29%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20delete%20fragmentByEnd%5Bf%2Eend%5D%3B%0A%20%20%20%20%20%20%20%20%20%20f%2Ering%2Epush%28end%29%3B%0A%20%20%20%20%20%20%20%20%20%20fragmentByEnd%5Bf%2Eend%20%3D%20endIndex%5D%20%3D%20f%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28f%20%3D%20fragmentByStart%5BendIndex%5D%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28g%20%3D%20fragmentByEnd%5BstartIndex%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20delete%20fragmentByStart%5Bf%2Estart%5D%3B%0A%20%20%20%20%20%20%20%20%20%20delete%20fragmentByEnd%5Bg%2Eend%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28f%20%3D%3D%3D%20g%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20f%2Ering%2Epush%28end%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback%28f%2Ering%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20fragmentByStart%5Bg%2Estart%5D%20%3D%20fragmentByEnd%5Bf%2Eend%5D%20%3D%20%7Bstart%3A%20g%2Estart%2C%20end%3A%20f%2Eend%2C%20ring%3A%20g%2Ering%2Econcat%28f%2Ering%29%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20delete%20fragmentByStart%5Bf%2Estart%5D%3B%0A%20%20%20%20%20%20%20%20%20%20f%2Ering%2Eunshift%28start%29%3B%0A%20%20%20%20%20%20%20%20%20%20fragmentByStart%5Bf%2Estart%20%3D%20startIndex%5D%20%3D%20f%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20fragmentByStart%5BstartIndex%5D%20%3D%20fragmentByEnd%5BendIndex%5D%20%3D%20%7Bstart%3A%20startIndex%2C%20end%3A%20endIndex%2C%20ring%3A%20%5Bstart%2C%20end%5D%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20index%28point%29%20%7B%0A%20%20%20%20return%20point%5B0%5D%20%2A%202%20%2B%20point%5B1%5D%20%2A%20%28dx%20%2B%201%29%20%2A%204%3B%0A%20%20%7D%0A%0A%20%20function%20smoothLinear%28ring%2C%20values%2C%20value%29%20%7B%0A%20%20%20%20ring%2EforEach%28function%28point%29%20%7B%0A%20%20%20%20%20%20var%20x%20%3D%20point%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20y%20%3D%20point%5B1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20xt%20%3D%20x%20%7C%200%2C%0A%20%20%20%20%20%20%20%20%20%20yt%20%3D%20y%20%7C%200%2C%0A%20%20%20%20%20%20%20%20%20%20v0%2C%0A%20%20%20%20%20%20%20%20%20%20v1%20%3D%20values%5Byt%20%2A%20dx%20%2B%20xt%5D%3B%0A%20%20%20%20%20%20if%20%28x%20%3E%200%20%26%26%20x%20%3C%20dx%20%26%26%20xt%20%3D%3D%3D%20x%29%20%7B%0A%20%20%20%20%20%20%20%20v0%20%3D%20values%5Byt%20%2A%20dx%20%2B%20xt%20%2D%201%5D%3B%0A%20%20%20%20%20%20%20%20point%5B0%5D%20%3D%20x%20%2B%20%28value%20%2D%20v0%29%20%2F%20%28v1%20%2D%20v0%29%20%2D%200%2E5%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28y%20%3E%200%20%26%26%20y%20%3C%20dy%20%26%26%20yt%20%3D%3D%3D%20y%29%20%7B%0A%20%20%20%20%20%20%20%20v0%20%3D%20values%5B%28yt%20%2D%201%29%20%2A%20dx%20%2B%20xt%5D%3B%0A%20%20%20%20%20%20%20%20point%5B1%5D%20%3D%20y%20%2B%20%28value%20%2D%20v0%29%20%2F%20%28v1%20%2D%20v0%29%20%2D%200%2E5%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%0A%20%20contours%2Econtour%20%3D%20contour%3B%0A%0A%20%20contours%2Esize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20%5Bdx%2C%20dy%5D%3B%0A%20%20%20%20var%20%5F0%20%3D%20Math%2Eceil%28%5F%5B0%5D%29%2C%20%5F1%20%3D%20Math%2Eceil%28%5F%5B1%5D%29%3B%0A%20%20%20%20if%20%28%21%28%5F0%20%3E%200%29%20%7C%7C%20%21%28%5F1%20%3E%200%29%29%20throw%20new%20Error%28%22invalid%20size%22%29%3B%0A%20%20%20%20return%20dx%20%3D%20%5F0%2C%20dy%20%3D%20%5F1%2C%20contours%3B%0A%20%20%7D%3B%0A%0A%20%20contours%2Ethresholds%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28threshold%24%241%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20Array%2EisArray%28%5F%29%20%3F%20constant%246%28slice%243%2Ecall%28%5F%29%29%20%3A%20constant%246%28%5F%29%2C%20contours%29%20%3A%20threshold%24%241%3B%0A%20%20%7D%3B%0A%0A%20%20contours%2Esmooth%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28smooth%20%3D%20%5F%20%3F%20smoothLinear%20%3A%20noop%241%2C%20contours%29%20%3A%20smooth%20%3D%3D%3D%20smoothLinear%3B%0A%20%20%7D%3B%0A%0A%20%20return%20contours%3B%0A%7D%0A%0A%2F%2F%20TODO%20Optimize%20edge%20cases%2E%0A%2F%2F%20TODO%20Optimize%20index%20calculation%2E%0A%2F%2F%20TODO%20Optimize%20arguments%2E%0Afunction%20blurX%28source%2C%20target%2C%20r%29%20%7B%0A%20%20var%20n%20%3D%20source%2Ewidth%2C%0A%20%20%20%20%20%20m%20%3D%20source%2Eheight%2C%0A%20%20%20%20%20%20w%20%3D%20%28r%20%3C%3C%201%29%20%2B%201%3B%0A%20%20for%20%28var%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20sr%20%3D%200%3B%20i%20%3C%20n%20%2B%20r%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28i%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20%20%20sr%20%2B%3D%20source%2Edata%5Bi%20%2B%20j%20%2A%20n%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28i%20%3E%3D%20r%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28i%20%3E%3D%20w%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20sr%20%2D%3D%20source%2Edata%5Bi%20%2D%20w%20%2B%20j%20%2A%20n%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20target%2Edata%5Bi%20%2D%20r%20%2B%20j%20%2A%20n%5D%20%3D%20sr%20%2F%20Math%2Emin%28i%20%2B%201%2C%20n%20%2D%201%20%2B%20w%20%2D%20i%2C%20w%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0A%2F%2F%20TODO%20Optimize%20edge%20cases%2E%0A%2F%2F%20TODO%20Optimize%20index%20calculation%2E%0A%2F%2F%20TODO%20Optimize%20arguments%2E%0Afunction%20blurY%28source%2C%20target%2C%20r%29%20%7B%0A%20%20var%20n%20%3D%20source%2Ewidth%2C%0A%20%20%20%20%20%20m%20%3D%20source%2Eheight%2C%0A%20%20%20%20%20%20w%20%3D%20%28r%20%3C%3C%201%29%20%2B%201%3B%0A%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20for%20%28var%20j%20%3D%200%2C%20sr%20%3D%200%3B%20j%20%3C%20m%20%2B%20r%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20if%20%28j%20%3C%20m%29%20%7B%0A%20%20%20%20%20%20%20%20sr%20%2B%3D%20source%2Edata%5Bi%20%2B%20j%20%2A%20n%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28j%20%3E%3D%20r%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28j%20%3E%3D%20w%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20sr%20%2D%3D%20source%2Edata%5Bi%20%2B%20%28j%20%2D%20w%29%20%2A%20n%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20target%2Edata%5Bi%20%2B%20%28j%20%2D%20r%29%20%2A%20n%5D%20%3D%20sr%20%2F%20Math%2Emin%28j%20%2B%201%2C%20m%20%2D%201%20%2B%20w%20%2D%20j%2C%20w%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Afunction%20defaultX%28d%29%20%7B%0A%20%20return%20d%5B0%5D%3B%0A%7D%0A%0Afunction%20defaultY%28d%29%20%7B%0A%20%20return%20d%5B1%5D%3B%0A%7D%0A%0Afunction%20density%28%29%20%7B%0A%20%20var%20x%20%3D%20defaultX%2C%0A%20%20%20%20%20%20y%20%3D%20defaultY%2C%0A%20%20%20%20%20%20dx%20%3D%20960%2C%0A%20%20%20%20%20%20dy%20%3D%20500%2C%0A%20%20%20%20%20%20r%20%3D%2020%2C%20%2F%2F%20blur%20radius%0A%20%20%20%20%20%20k%20%3D%202%2C%20%2F%2F%20log2%28grid%20cell%20size%29%0A%20%20%20%20%20%20o%20%3D%20r%20%2A%203%2C%20%2F%2F%20grid%20offset%2C%20to%20pad%20for%20blur%0A%20%20%20%20%20%20n%20%3D%20%28dx%20%2B%20o%20%2A%202%29%20%3E%3E%20k%2C%20%2F%2F%20grid%20width%0A%20%20%20%20%20%20m%20%3D%20%28dy%20%2B%20o%20%2A%202%29%20%3E%3E%20k%2C%20%2F%2F%20grid%20height%0A%20%20%20%20%20%20threshold%24%241%20%3D%20constant%246%2820%29%3B%0A%0A%20%20function%20density%28data%29%20%7B%0A%20%20%20%20var%20values0%20%3D%20new%20Float32Array%28n%20%2A%20m%29%2C%0A%20%20%20%20%20%20%20%20values1%20%3D%20new%20Float32Array%28n%20%2A%20m%29%3B%0A%0A%20%20%20%20data%2EforEach%28function%28d%2C%20i%2C%20data%29%20%7B%0A%20%20%20%20%20%20var%20xi%20%3D%20%28x%28d%2C%20i%2C%20data%29%20%2B%20o%29%20%3E%3E%20k%2C%0A%20%20%20%20%20%20%20%20%20%20yi%20%3D%20%28y%28d%2C%20i%2C%20data%29%20%2B%20o%29%20%3E%3E%20k%3B%0A%20%20%20%20%20%20if%20%28xi%20%3E%3D%200%20%26%26%20xi%20%3C%20n%20%26%26%20yi%20%3E%3D%200%20%26%26%20yi%20%3C%20m%29%20%7B%0A%20%20%20%20%20%20%20%20%2B%2Bvalues0%5Bxi%20%2B%20yi%20%2A%20n%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20%2F%2F%20TODO%20Optimize%2E%0A%20%20%20%20blurX%28%7Bwidth%3A%20n%2C%20height%3A%20m%2C%20data%3A%20values0%7D%2C%20%7Bwidth%3A%20n%2C%20height%3A%20m%2C%20data%3A%20values1%7D%2C%20r%20%3E%3E%20k%29%3B%0A%20%20%20%20blurY%28%7Bwidth%3A%20n%2C%20height%3A%20m%2C%20data%3A%20values1%7D%2C%20%7Bwidth%3A%20n%2C%20height%3A%20m%2C%20data%3A%20values0%7D%2C%20r%20%3E%3E%20k%29%3B%0A%20%20%20%20blurX%28%7Bwidth%3A%20n%2C%20height%3A%20m%2C%20data%3A%20values0%7D%2C%20%7Bwidth%3A%20n%2C%20height%3A%20m%2C%20data%3A%20values1%7D%2C%20r%20%3E%3E%20k%29%3B%0A%20%20%20%20blurY%28%7Bwidth%3A%20n%2C%20height%3A%20m%2C%20data%3A%20values1%7D%2C%20%7Bwidth%3A%20n%2C%20height%3A%20m%2C%20data%3A%20values0%7D%2C%20r%20%3E%3E%20k%29%3B%0A%20%20%20%20blurX%28%7Bwidth%3A%20n%2C%20height%3A%20m%2C%20data%3A%20values0%7D%2C%20%7Bwidth%3A%20n%2C%20height%3A%20m%2C%20data%3A%20values1%7D%2C%20r%20%3E%3E%20k%29%3B%0A%20%20%20%20blurY%28%7Bwidth%3A%20n%2C%20height%3A%20m%2C%20data%3A%20values1%7D%2C%20%7Bwidth%3A%20n%2C%20height%3A%20m%2C%20data%3A%20values0%7D%2C%20r%20%3E%3E%20k%29%3B%0A%0A%20%20%20%20var%20tz%20%3D%20threshold%24%241%28values0%29%3B%0A%0A%20%20%20%20%2F%2F%20Convert%20number%20of%20thresholds%20into%20uniform%20thresholds%2E%0A%20%20%20%20if%20%28%21Array%2EisArray%28tz%29%29%20%7B%0A%20%20%20%20%20%20var%20stop%20%3D%20max%28values0%29%3B%0A%20%20%20%20%20%20tz%20%3D%20tickStep%280%2C%20stop%2C%20tz%29%3B%0A%20%20%20%20%20%20tz%20%3D%20sequence%280%2C%20Math%2Efloor%28stop%20%2F%20tz%29%20%2A%20tz%2C%20tz%29%3B%0A%20%20%20%20%20%20tz%2Eshift%28%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20contours%28%29%0A%20%20%20%20%20%20%20%20%2Ethresholds%28tz%29%0A%20%20%20%20%20%20%20%20%2Esize%28%5Bn%2C%20m%5D%29%0A%20%20%20%20%20%20%28values0%29%0A%20%20%20%20%20%20%20%20%2Emap%28transform%29%3B%0A%20%20%7D%0A%0A%20%20function%20transform%28geometry%29%20%7B%0A%20%20%20%20geometry%2Evalue%20%2A%3D%20Math%2Epow%282%2C%20%2D2%20%2A%20k%29%3B%20%2F%2F%20Density%20in%20points%20per%20square%20pixel%2E%0A%20%20%20%20geometry%2Ecoordinates%2EforEach%28transformPolygon%29%3B%0A%20%20%20%20return%20geometry%3B%0A%20%20%7D%0A%0A%20%20function%20transformPolygon%28coordinates%29%20%7B%0A%20%20%20%20coordinates%2EforEach%28transformRing%29%3B%0A%20%20%7D%0A%0A%20%20function%20transformRing%28coordinates%29%20%7B%0A%20%20%20%20coordinates%2EforEach%28transformPoint%29%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20TODO%20Optimize%2E%0A%20%20function%20transformPoint%28coordinates%29%20%7B%0A%20%20%20%20coordinates%5B0%5D%20%3D%20coordinates%5B0%5D%20%2A%20Math%2Epow%282%2C%20k%29%20%2D%20o%3B%0A%20%20%20%20coordinates%5B1%5D%20%3D%20coordinates%5B1%5D%20%2A%20Math%2Epow%282%2C%20k%29%20%2D%20o%3B%0A%20%20%7D%0A%0A%20%20function%20resize%28%29%20%7B%0A%20%20%20%20o%20%3D%20r%20%2A%203%3B%0A%20%20%20%20n%20%3D%20%28dx%20%2B%20o%20%2A%202%29%20%3E%3E%20k%3B%0A%20%20%20%20m%20%3D%20%28dy%20%2B%20o%20%2A%202%29%20%3E%3E%20k%3B%0A%20%20%20%20return%20density%3B%0A%20%20%7D%0A%0A%20%20density%2Ex%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28x%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%246%28%2B%5F%29%2C%20density%29%20%3A%20x%3B%0A%20%20%7D%3B%0A%0A%20%20density%2Ey%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28y%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%246%28%2B%5F%29%2C%20density%29%20%3A%20y%3B%0A%20%20%7D%3B%0A%0A%20%20density%2Esize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20%5Bdx%2C%20dy%5D%3B%0A%20%20%20%20var%20%5F0%20%3D%20Math%2Eceil%28%5F%5B0%5D%29%2C%20%5F1%20%3D%20Math%2Eceil%28%5F%5B1%5D%29%3B%0A%20%20%20%20if%20%28%21%28%5F0%20%3E%3D%200%29%20%26%26%20%21%28%5F0%20%3E%3D%200%29%29%20throw%20new%20Error%28%22invalid%20size%22%29%3B%0A%20%20%20%20return%20dx%20%3D%20%5F0%2C%20dy%20%3D%20%5F1%2C%20resize%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20density%2EcellSize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%201%20%3C%3C%20k%3B%0A%20%20%20%20if%20%28%21%28%28%5F%20%3D%20%2B%5F%29%20%3E%3D%201%29%29%20throw%20new%20Error%28%22invalid%20cell%20size%22%29%3B%0A%20%20%20%20return%20k%20%3D%20Math%2Efloor%28Math%2Elog%28%5F%29%20%2F%20Math%2ELN2%29%2C%20resize%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20density%2Ethresholds%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28threshold%24%241%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20Array%2EisArray%28%5F%29%20%3F%20constant%246%28slice%243%2Ecall%28%5F%29%29%20%3A%20constant%246%28%5F%29%2C%20density%29%20%3A%20threshold%24%241%3B%0A%20%20%7D%3B%0A%0A%20%20density%2Ebandwidth%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20Math%2Esqrt%28r%20%2A%20%28r%20%2B%201%29%29%3B%0A%20%20%20%20if%20%28%21%28%28%5F%20%3D%20%2B%5F%29%20%3E%3D%200%29%29%20throw%20new%20Error%28%22invalid%20bandwidth%22%29%3B%0A%20%20%20%20return%20r%20%3D%20Math%2Eround%28%28Math%2Esqrt%284%20%2A%20%5F%20%2A%20%5F%20%2B%201%29%20%2D%201%29%20%2F%202%29%2C%20resize%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20density%3B%0A%7D%0A%0Avar%20EOL%20%3D%20%7B%7D%2C%0A%20%20%20%20EOF%20%3D%20%7B%7D%2C%0A%20%20%20%20QUOTE%20%3D%2034%2C%0A%20%20%20%20NEWLINE%20%3D%2010%2C%0A%20%20%20%20RETURN%20%3D%2013%3B%0A%0Afunction%20objectConverter%28columns%29%20%7B%0A%20%20return%20new%20Function%28%22d%22%2C%20%22return%20%7B%22%20%2B%20columns%2Emap%28function%28name%2C%20i%29%20%7B%0A%20%20%20%20return%20JSON%2Estringify%28name%29%20%2B%20%22%3A%20d%5B%22%20%2B%20i%20%2B%20%22%5D%22%3B%0A%20%20%7D%29%2Ejoin%28%22%2C%22%29%20%2B%20%22%7D%22%29%3B%0A%7D%0A%0Afunction%20customConverter%28columns%2C%20f%29%20%7B%0A%20%20var%20object%20%3D%20objectConverter%28columns%29%3B%0A%20%20return%20function%28row%2C%20i%29%20%7B%0A%20%20%20%20return%20f%28object%28row%29%2C%20i%2C%20columns%29%3B%0A%20%20%7D%3B%0A%7D%0A%0A%2F%2F%20Compute%20unique%20columns%20in%20order%20of%20discovery%2E%0Afunction%20inferColumns%28rows%29%20%7B%0A%20%20var%20columnSet%20%3D%20Object%2Ecreate%28null%29%2C%0A%20%20%20%20%20%20columns%20%3D%20%5B%5D%3B%0A%0A%20%20rows%2EforEach%28function%28row%29%20%7B%0A%20%20%20%20for%20%28var%20column%20in%20row%29%20%7B%0A%20%20%20%20%20%20if%20%28%21%28column%20in%20columnSet%29%29%20%7B%0A%20%20%20%20%20%20%20%20columns%2Epush%28columnSet%5Bcolumn%5D%20%3D%20column%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%29%3B%0A%0A%20%20return%20columns%3B%0A%7D%0A%0Afunction%20dsvFormat%28delimiter%29%20%7B%0A%20%20var%20reFormat%20%3D%20new%20RegExp%28%22%5B%5C%22%22%20%2B%20delimiter%20%2B%20%22%5Cn%5Cr%5D%22%29%2C%0A%20%20%20%20%20%20DELIMITER%20%3D%20delimiter%2EcharCodeAt%280%29%3B%0A%0A%20%20function%20parse%28text%2C%20f%29%20%7B%0A%20%20%20%20var%20convert%2C%20columns%2C%20rows%20%3D%20parseRows%28text%2C%20function%28row%2C%20i%29%20%7B%0A%20%20%20%20%20%20if%20%28convert%29%20return%20convert%28row%2C%20i%20%2D%201%29%3B%0A%20%20%20%20%20%20columns%20%3D%20row%2C%20convert%20%3D%20f%20%3F%20customConverter%28row%2C%20f%29%20%3A%20objectConverter%28row%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20rows%2Ecolumns%20%3D%20columns%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20return%20rows%3B%0A%20%20%7D%0A%0A%20%20function%20parseRows%28text%2C%20f%29%20%7B%0A%20%20%20%20var%20rows%20%3D%20%5B%5D%2C%20%2F%2F%20output%20rows%0A%20%20%20%20%20%20%20%20N%20%3D%20text%2Elength%2C%0A%20%20%20%20%20%20%20%20I%20%3D%200%2C%20%2F%2F%20current%20character%20index%0A%20%20%20%20%20%20%20%20n%20%3D%200%2C%20%2F%2F%20current%20line%20number%0A%20%20%20%20%20%20%20%20t%2C%20%2F%2F%20current%20token%0A%20%20%20%20%20%20%20%20eof%20%3D%20N%20%3C%3D%200%2C%20%2F%2F%20current%20token%20followed%20by%20EOF%3F%0A%20%20%20%20%20%20%20%20eol%20%3D%20false%3B%20%2F%2F%20current%20token%20followed%20by%20EOL%3F%0A%0A%20%20%20%20%2F%2F%20Strip%20the%20trailing%20newline%2E%0A%20%20%20%20if%20%28text%2EcharCodeAt%28N%20%2D%201%29%20%3D%3D%3D%20NEWLINE%29%20%2D%2DN%3B%0A%20%20%20%20if%20%28text%2EcharCodeAt%28N%20%2D%201%29%20%3D%3D%3D%20RETURN%29%20%2D%2DN%3B%0A%0A%20%20%20%20function%20token%28%29%20%7B%0A%20%20%20%20%20%20if%20%28eof%29%20return%20EOF%3B%0A%20%20%20%20%20%20if%20%28eol%29%20return%20eol%20%3D%20false%2C%20EOL%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Unescape%20quotes%2E%0A%20%20%20%20%20%20var%20i%2C%20j%20%3D%20I%2C%20c%3B%0A%20%20%20%20%20%20if%20%28text%2EcharCodeAt%28j%29%20%3D%3D%3D%20QUOTE%29%20%7B%0A%20%20%20%20%20%20%20%20while%20%28I%2B%2B%20%3C%20N%20%26%26%20text%2EcharCodeAt%28I%29%20%21%3D%3D%20QUOTE%20%7C%7C%20text%2EcharCodeAt%28%2B%2BI%29%20%3D%3D%3D%20QUOTE%29%3B%0A%20%20%20%20%20%20%20%20if%20%28%28i%20%3D%20I%29%20%3E%3D%20N%29%20eof%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20else%20if%20%28%28c%20%3D%20text%2EcharCodeAt%28I%2B%2B%29%29%20%3D%3D%3D%20NEWLINE%29%20eol%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20else%20if%20%28c%20%3D%3D%3D%20RETURN%29%20%7B%20eol%20%3D%20true%3B%20if%20%28text%2EcharCodeAt%28I%29%20%3D%3D%3D%20NEWLINE%29%20%2B%2BI%3B%20%7D%0A%20%20%20%20%20%20%20%20return%20text%2Eslice%28j%20%2B%201%2C%20i%20%2D%201%29%2Ereplace%28%2F%22%22%2Fg%2C%20%22%5C%22%22%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20Find%20next%20delimiter%20or%20newline%2E%0A%20%20%20%20%20%20while%20%28I%20%3C%20N%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%28c%20%3D%20text%2EcharCodeAt%28i%20%3D%20I%2B%2B%29%29%20%3D%3D%3D%20NEWLINE%29%20eol%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20else%20if%20%28c%20%3D%3D%3D%20RETURN%29%20%7B%20eol%20%3D%20true%3B%20if%20%28text%2EcharCodeAt%28I%29%20%3D%3D%3D%20NEWLINE%29%20%2B%2BI%3B%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20%28c%20%21%3D%3D%20DELIMITER%29%20continue%3B%0A%20%20%20%20%20%20%20%20return%20text%2Eslice%28j%2C%20i%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20Return%20last%20token%20before%20EOF%2E%0A%20%20%20%20%20%20return%20eof%20%3D%20true%2C%20text%2Eslice%28j%2C%20N%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20while%20%28%28t%20%3D%20token%28%29%29%20%21%3D%3D%20EOF%29%20%7B%0A%20%20%20%20%20%20var%20row%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20while%20%28t%20%21%3D%3D%20EOL%20%26%26%20t%20%21%3D%3D%20EOF%29%20row%2Epush%28t%29%2C%20t%20%3D%20token%28%29%3B%0A%20%20%20%20%20%20if%20%28f%20%26%26%20%28row%20%3D%20f%28row%2C%20n%2B%2B%29%29%20%3D%3D%20null%29%20continue%3B%0A%20%20%20%20%20%20rows%2Epush%28row%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20rows%3B%0A%20%20%7D%0A%0A%20%20function%20format%28rows%2C%20columns%29%20%7B%0A%20%20%20%20if%20%28columns%20%3D%3D%20null%29%20columns%20%3D%20inferColumns%28rows%29%3B%0A%20%20%20%20return%20%5Bcolumns%2Emap%28formatValue%29%2Ejoin%28delimiter%29%5D%2Econcat%28rows%2Emap%28function%28row%29%20%7B%0A%20%20%20%20%20%20return%20columns%2Emap%28function%28column%29%20%7B%0A%20%20%20%20%20%20%20%20return%20formatValue%28row%5Bcolumn%5D%29%3B%0A%20%20%20%20%20%20%7D%29%2Ejoin%28delimiter%29%3B%0A%20%20%20%20%7D%29%29%2Ejoin%28%22%5Cn%22%29%3B%0A%20%20%7D%0A%0A%20%20function%20formatRows%28rows%29%20%7B%0A%20%20%20%20return%20rows%2Emap%28formatRow%29%2Ejoin%28%22%5Cn%22%29%3B%0A%20%20%7D%0A%0A%20%20function%20formatRow%28row%29%20%7B%0A%20%20%20%20return%20row%2Emap%28formatValue%29%2Ejoin%28delimiter%29%3B%0A%20%20%7D%0A%0A%20%20function%20formatValue%28text%29%20%7B%0A%20%20%20%20return%20text%20%3D%3D%20null%20%3F%20%22%22%0A%20%20%20%20%20%20%20%20%3A%20reFormat%2Etest%28text%20%2B%3D%20%22%22%29%20%3F%20%22%5C%22%22%20%2B%20text%2Ereplace%28%2F%22%2Fg%2C%20%22%5C%22%5C%22%22%29%20%2B%20%22%5C%22%22%0A%20%20%20%20%20%20%20%20%3A%20text%3B%0A%20%20%7D%0A%0A%20%20return%20%7B%0A%20%20%20%20parse%3A%20parse%2C%0A%20%20%20%20parseRows%3A%20parseRows%2C%0A%20%20%20%20format%3A%20format%2C%0A%20%20%20%20formatRows%3A%20formatRows%0A%20%20%7D%3B%0A%7D%0A%0Avar%20csv%20%3D%20dsvFormat%28%22%2C%22%29%3B%0A%0Avar%20csvParse%20%3D%20csv%2Eparse%3B%0Avar%20csvParseRows%20%3D%20csv%2EparseRows%3B%0Avar%20csvFormat%20%3D%20csv%2Eformat%3B%0Avar%20csvFormatRows%20%3D%20csv%2EformatRows%3B%0A%0Avar%20tsv%20%3D%20dsvFormat%28%22%5Ct%22%29%3B%0A%0Avar%20tsvParse%20%3D%20tsv%2Eparse%3B%0Avar%20tsvParseRows%20%3D%20tsv%2EparseRows%3B%0Avar%20tsvFormat%20%3D%20tsv%2Eformat%3B%0Avar%20tsvFormatRows%20%3D%20tsv%2EformatRows%3B%0A%0Afunction%20responseBlob%28response%29%20%7B%0A%20%20if%20%28%21response%2Eok%29%20throw%20new%20Error%28response%2Estatus%20%2B%20%22%20%22%20%2B%20response%2EstatusText%29%3B%0A%20%20return%20response%2Eblob%28%29%3B%0A%7D%0A%0Afunction%20blob%28input%2C%20init%29%20%7B%0A%20%20return%20fetch%28input%2C%20init%29%2Ethen%28responseBlob%29%3B%0A%7D%0A%0Afunction%20responseArrayBuffer%28response%29%20%7B%0A%20%20if%20%28%21response%2Eok%29%20throw%20new%20Error%28response%2Estatus%20%2B%20%22%20%22%20%2B%20response%2EstatusText%29%3B%0A%20%20return%20response%2EarrayBuffer%28%29%3B%0A%7D%0A%0Afunction%20buffer%28input%2C%20init%29%20%7B%0A%20%20return%20fetch%28input%2C%20init%29%2Ethen%28responseArrayBuffer%29%3B%0A%7D%0A%0Afunction%20responseText%28response%29%20%7B%0A%20%20if%20%28%21response%2Eok%29%20throw%20new%20Error%28response%2Estatus%20%2B%20%22%20%22%20%2B%20response%2EstatusText%29%3B%0A%20%20return%20response%2Etext%28%29%3B%0A%7D%0A%0Afunction%20text%28input%2C%20init%29%20%7B%0A%20%20return%20fetch%28input%2C%20init%29%2Ethen%28responseText%29%3B%0A%7D%0A%0Afunction%20dsvParse%28parse%29%20%7B%0A%20%20return%20function%28input%2C%20init%2C%20row%29%20%7B%0A%20%20%20%20if%20%28arguments%2Elength%20%3D%3D%3D%202%20%26%26%20typeof%20init%20%3D%3D%3D%20%22function%22%29%20row%20%3D%20init%2C%20init%20%3D%20undefined%3B%0A%20%20%20%20return%20text%28input%2C%20init%29%2Ethen%28function%28response%29%20%7B%0A%20%20%20%20%20%20return%20parse%28response%2C%20row%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20dsv%28delimiter%2C%20input%2C%20init%2C%20row%29%20%7B%0A%20%20if%20%28arguments%2Elength%20%3D%3D%3D%203%20%26%26%20typeof%20init%20%3D%3D%3D%20%22function%22%29%20row%20%3D%20init%2C%20init%20%3D%20undefined%3B%0A%20%20var%20format%20%3D%20dsvFormat%28delimiter%29%3B%0A%20%20return%20text%28input%2C%20init%29%2Ethen%28function%28response%29%20%7B%0A%20%20%20%20return%20format%2Eparse%28response%2C%20row%29%3B%0A%20%20%7D%29%3B%0A%7D%0A%0Avar%20csv%241%20%3D%20dsvParse%28csvParse%29%3B%0Avar%20tsv%241%20%3D%20dsvParse%28tsvParse%29%3B%0A%0Afunction%20image%28input%2C%20init%29%20%7B%0A%20%20return%20new%20Promise%28function%28resolve%2C%20reject%29%20%7B%0A%20%20%20%20var%20image%20%3D%20new%20Image%3B%0A%20%20%20%20for%20%28var%20key%20in%20init%29%20image%5Bkey%5D%20%3D%20init%5Bkey%5D%3B%0A%20%20%20%20image%2Eonerror%20%3D%20reject%3B%0A%20%20%20%20image%2Eonload%20%3D%20function%28%29%20%7B%20resolve%28image%29%3B%20%7D%3B%0A%20%20%20%20image%2Esrc%20%3D%20input%3B%0A%20%20%7D%29%3B%0A%7D%0A%0Afunction%20responseJson%28response%29%20%7B%0A%20%20if%20%28%21response%2Eok%29%20throw%20new%20Error%28response%2Estatus%20%2B%20%22%20%22%20%2B%20response%2EstatusText%29%3B%0A%20%20return%20response%2Ejson%28%29%3B%0A%7D%0A%0Afunction%20json%28input%2C%20init%29%20%7B%0A%20%20return%20fetch%28input%2C%20init%29%2Ethen%28responseJson%29%3B%0A%7D%0A%0Afunction%20parser%28type%29%20%7B%0A%20%20return%20function%28input%2C%20init%29%20%20%7B%0A%20%20%20%20return%20text%28input%2C%20init%29%2Ethen%28function%28text%24%241%29%20%7B%0A%20%20%20%20%20%20return%20%28new%20DOMParser%29%2EparseFromString%28text%24%241%2C%20type%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Avar%20xml%20%3D%20parser%28%22application%2Fxml%22%29%3B%0A%0Avar%20html%20%3D%20parser%28%22text%2Fhtml%22%29%3B%0A%0Avar%20svg%20%3D%20parser%28%22image%2Fsvg%2Bxml%22%29%3B%0A%0Afunction%20center%241%28x%2C%20y%29%20%7B%0A%20%20var%20nodes%3B%0A%0A%20%20if%20%28x%20%3D%3D%20null%29%20x%20%3D%200%3B%0A%20%20if%20%28y%20%3D%3D%20null%29%20y%20%3D%200%3B%0A%0A%20%20function%20force%28%29%20%7B%0A%20%20%20%20var%20i%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20nodes%2Elength%2C%0A%20%20%20%20%20%20%20%20node%2C%0A%20%20%20%20%20%20%20%20sx%20%3D%200%2C%0A%20%20%20%20%20%20%20%20sy%20%3D%200%3B%0A%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%2C%20sx%20%2B%3D%20node%2Ex%2C%20sy%20%2B%3D%20node%2Ey%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20for%20%28sx%20%3D%20sx%20%2F%20n%20%2D%20x%2C%20sy%20%3D%20sy%20%2F%20n%20%2D%20y%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%2C%20node%2Ex%20%2D%3D%20sx%2C%20node%2Ey%20%2D%3D%20sy%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20force%2Einitialize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20nodes%20%3D%20%5F%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Ex%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28x%20%3D%20%2B%5F%2C%20force%29%20%3A%20x%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Ey%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28y%20%3D%20%2B%5F%2C%20force%29%20%3A%20y%3B%0A%20%20%7D%3B%0A%0A%20%20return%20force%3B%0A%7D%0A%0Afunction%20constant%247%28x%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20jiggle%28%29%20%7B%0A%20%20return%20%28Math%2Erandom%28%29%20%2D%200%2E5%29%20%2A%201e%2D6%3B%0A%7D%0A%0Afunction%20tree%5Fadd%28d%29%20%7B%0A%20%20var%20x%20%3D%20%2Bthis%2E%5Fx%2Ecall%28null%2C%20d%29%2C%0A%20%20%20%20%20%20y%20%3D%20%2Bthis%2E%5Fy%2Ecall%28null%2C%20d%29%3B%0A%20%20return%20add%28this%2Ecover%28x%2C%20y%29%2C%20x%2C%20y%2C%20d%29%3B%0A%7D%0A%0Afunction%20add%28tree%2C%20x%2C%20y%2C%20d%29%20%7B%0A%20%20if%20%28isNaN%28x%29%20%7C%7C%20isNaN%28y%29%29%20return%20tree%3B%20%2F%2F%20ignore%20invalid%20points%0A%0A%20%20var%20parent%2C%0A%20%20%20%20%20%20node%20%3D%20tree%2E%5Froot%2C%0A%20%20%20%20%20%20leaf%20%3D%20%7Bdata%3A%20d%7D%2C%0A%20%20%20%20%20%20x0%20%3D%20tree%2E%5Fx0%2C%0A%20%20%20%20%20%20y0%20%3D%20tree%2E%5Fy0%2C%0A%20%20%20%20%20%20x1%20%3D%20tree%2E%5Fx1%2C%0A%20%20%20%20%20%20y1%20%3D%20tree%2E%5Fy1%2C%0A%20%20%20%20%20%20xm%2C%0A%20%20%20%20%20%20ym%2C%0A%20%20%20%20%20%20xp%2C%0A%20%20%20%20%20%20yp%2C%0A%20%20%20%20%20%20right%2C%0A%20%20%20%20%20%20bottom%2C%0A%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20j%3B%0A%0A%20%20%2F%2F%20If%20the%20tree%20is%20empty%2C%20initialize%20the%20root%20as%20a%20leaf%2E%0A%20%20if%20%28%21node%29%20return%20tree%2E%5Froot%20%3D%20leaf%2C%20tree%3B%0A%0A%20%20%2F%2F%20Find%20the%20existing%20leaf%20for%20the%20new%20point%2C%20or%20add%20it%2E%0A%20%20while%20%28node%2Elength%29%20%7B%0A%20%20%20%20if%20%28right%20%3D%20x%20%3E%3D%20%28xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%29%29%20x0%20%3D%20xm%3B%20else%20x1%20%3D%20xm%3B%0A%20%20%20%20if%20%28bottom%20%3D%20y%20%3E%3D%20%28ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%29%29%20y0%20%3D%20ym%3B%20else%20y1%20%3D%20ym%3B%0A%20%20%20%20if%20%28parent%20%3D%20node%2C%20%21%28node%20%3D%20node%5Bi%20%3D%20bottom%20%3C%3C%201%20%7C%20right%5D%29%29%20return%20parent%5Bi%5D%20%3D%20leaf%2C%20tree%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Is%20the%20new%20point%20is%20exactly%20coincident%20with%20the%20existing%20point%3F%0A%20%20xp%20%3D%20%2Btree%2E%5Fx%2Ecall%28null%2C%20node%2Edata%29%3B%0A%20%20yp%20%3D%20%2Btree%2E%5Fy%2Ecall%28null%2C%20node%2Edata%29%3B%0A%20%20if%20%28x%20%3D%3D%3D%20xp%20%26%26%20y%20%3D%3D%3D%20yp%29%20return%20leaf%2Enext%20%3D%20node%2C%20parent%20%3F%20parent%5Bi%5D%20%3D%20leaf%20%3A%20tree%2E%5Froot%20%3D%20leaf%2C%20tree%3B%0A%0A%20%20%2F%2F%20Otherwise%2C%20split%20the%20leaf%20node%20until%20the%20old%20and%20new%20point%20are%20separated%2E%0A%20%20do%20%7B%0A%20%20%20%20parent%20%3D%20parent%20%3F%20parent%5Bi%5D%20%3D%20new%20Array%284%29%20%3A%20tree%2E%5Froot%20%3D%20new%20Array%284%29%3B%0A%20%20%20%20if%20%28right%20%3D%20x%20%3E%3D%20%28xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%29%29%20x0%20%3D%20xm%3B%20else%20x1%20%3D%20xm%3B%0A%20%20%20%20if%20%28bottom%20%3D%20y%20%3E%3D%20%28ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%29%29%20y0%20%3D%20ym%3B%20else%20y1%20%3D%20ym%3B%0A%20%20%7D%20while%20%28%28i%20%3D%20bottom%20%3C%3C%201%20%7C%20right%29%20%3D%3D%3D%20%28j%20%3D%20%28yp%20%3E%3D%20ym%29%20%3C%3C%201%20%7C%20%28xp%20%3E%3D%20xm%29%29%29%3B%0A%20%20return%20parent%5Bj%5D%20%3D%20node%2C%20parent%5Bi%5D%20%3D%20leaf%2C%20tree%3B%0A%7D%0A%0Afunction%20addAll%28data%29%20%7B%0A%20%20var%20d%2C%20i%2C%20n%20%3D%20data%2Elength%2C%0A%20%20%20%20%20%20x%2C%0A%20%20%20%20%20%20y%2C%0A%20%20%20%20%20%20xz%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20yz%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20x0%20%3D%20Infinity%2C%0A%20%20%20%20%20%20y0%20%3D%20Infinity%2C%0A%20%20%20%20%20%20x1%20%3D%20%2DInfinity%2C%0A%20%20%20%20%20%20y1%20%3D%20%2DInfinity%3B%0A%0A%20%20%2F%2F%20Compute%20the%20points%20and%20their%20extent%2E%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28isNaN%28x%20%3D%20%2Bthis%2E%5Fx%2Ecall%28null%2C%20d%20%3D%20data%5Bi%5D%29%29%20%7C%7C%20isNaN%28y%20%3D%20%2Bthis%2E%5Fy%2Ecall%28null%2C%20d%29%29%29%20continue%3B%0A%20%20%20%20xz%5Bi%5D%20%3D%20x%3B%0A%20%20%20%20yz%5Bi%5D%20%3D%20y%3B%0A%20%20%20%20if%20%28x%20%3C%20x0%29%20x0%20%3D%20x%3B%0A%20%20%20%20if%20%28x%20%3E%20x1%29%20x1%20%3D%20x%3B%0A%20%20%20%20if%20%28y%20%3C%20y0%29%20y0%20%3D%20y%3B%0A%20%20%20%20if%20%28y%20%3E%20y1%29%20y1%20%3D%20y%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20If%20there%20were%20no%20%28valid%29%20points%2C%20inherit%20the%20existing%20extent%2E%0A%20%20if%20%28x1%20%3C%20x0%29%20x0%20%3D%20this%2E%5Fx0%2C%20x1%20%3D%20this%2E%5Fx1%3B%0A%20%20if%20%28y1%20%3C%20y0%29%20y0%20%3D%20this%2E%5Fy0%2C%20y1%20%3D%20this%2E%5Fy1%3B%0A%0A%20%20%2F%2F%20Expand%20the%20tree%20to%20cover%20the%20new%20points%2E%0A%20%20this%2Ecover%28x0%2C%20y0%29%2Ecover%28x1%2C%20y1%29%3B%0A%0A%20%20%2F%2F%20Add%20the%20new%20points%2E%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20add%28this%2C%20xz%5Bi%5D%2C%20yz%5Bi%5D%2C%20data%5Bi%5D%29%3B%0A%20%20%7D%0A%0A%20%20return%20this%3B%0A%7D%0A%0Afunction%20tree%5Fcover%28x%2C%20y%29%20%7B%0A%20%20if%20%28isNaN%28x%20%3D%20%2Bx%29%20%7C%7C%20isNaN%28y%20%3D%20%2By%29%29%20return%20this%3B%20%2F%2F%20ignore%20invalid%20points%0A%0A%20%20var%20x0%20%3D%20this%2E%5Fx0%2C%0A%20%20%20%20%20%20y0%20%3D%20this%2E%5Fy0%2C%0A%20%20%20%20%20%20x1%20%3D%20this%2E%5Fx1%2C%0A%20%20%20%20%20%20y1%20%3D%20this%2E%5Fy1%3B%0A%0A%20%20%2F%2F%20If%20the%20quadtree%20has%20no%20extent%2C%20initialize%20them%2E%0A%20%20%2F%2F%20Integer%20extent%20are%20necessary%20so%20that%20if%20we%20later%20double%20the%20extent%2C%0A%20%20%2F%2F%20the%20existing%20quadrant%20boundaries%20don%E2%80%99t%20change%20due%20to%20floating%20point%20error%21%0A%20%20if%20%28isNaN%28x0%29%29%20%7B%0A%20%20%20%20x1%20%3D%20%28x0%20%3D%20Math%2Efloor%28x%29%29%20%2B%201%3B%0A%20%20%20%20y1%20%3D%20%28y0%20%3D%20Math%2Efloor%28y%29%29%20%2B%201%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Otherwise%2C%20double%20repeatedly%20to%20cover%2E%0A%20%20else%20if%20%28x0%20%3E%20x%20%7C%7C%20x%20%3E%20x1%20%7C%7C%20y0%20%3E%20y%20%7C%7C%20y%20%3E%20y1%29%20%7B%0A%20%20%20%20var%20z%20%3D%20x1%20%2D%20x0%2C%0A%20%20%20%20%20%20%20%20node%20%3D%20this%2E%5Froot%2C%0A%20%20%20%20%20%20%20%20parent%2C%0A%20%20%20%20%20%20%20%20i%3B%0A%0A%20%20%20%20switch%20%28i%20%3D%20%28y%20%3C%20%28y0%20%2B%20y1%29%20%2F%202%29%20%3C%3C%201%20%7C%20%28x%20%3C%20%28x0%20%2B%20x1%29%20%2F%202%29%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20%7B%0A%20%20%20%20%20%20%20%20do%20parent%20%3D%20new%20Array%284%29%2C%20parent%5Bi%5D%20%3D%20node%2C%20node%20%3D%20parent%3B%0A%20%20%20%20%20%20%20%20while%20%28z%20%2A%3D%202%2C%20x1%20%3D%20x0%20%2B%20z%2C%20y1%20%3D%20y0%20%2B%20z%2C%20x%20%3E%20x1%20%7C%7C%20y%20%3E%20y1%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20case%201%3A%20%7B%0A%20%20%20%20%20%20%20%20do%20parent%20%3D%20new%20Array%284%29%2C%20parent%5Bi%5D%20%3D%20node%2C%20node%20%3D%20parent%3B%0A%20%20%20%20%20%20%20%20while%20%28z%20%2A%3D%202%2C%20x0%20%3D%20x1%20%2D%20z%2C%20y1%20%3D%20y0%20%2B%20z%2C%20x0%20%3E%20x%20%7C%7C%20y%20%3E%20y1%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20case%202%3A%20%7B%0A%20%20%20%20%20%20%20%20do%20parent%20%3D%20new%20Array%284%29%2C%20parent%5Bi%5D%20%3D%20node%2C%20node%20%3D%20parent%3B%0A%20%20%20%20%20%20%20%20while%20%28z%20%2A%3D%202%2C%20x1%20%3D%20x0%20%2B%20z%2C%20y0%20%3D%20y1%20%2D%20z%2C%20x%20%3E%20x1%20%7C%7C%20y0%20%3E%20y%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20case%203%3A%20%7B%0A%20%20%20%20%20%20%20%20do%20parent%20%3D%20new%20Array%284%29%2C%20parent%5Bi%5D%20%3D%20node%2C%20node%20%3D%20parent%3B%0A%20%20%20%20%20%20%20%20while%20%28z%20%2A%3D%202%2C%20x0%20%3D%20x1%20%2D%20z%2C%20y0%20%3D%20y1%20%2D%20z%2C%20x0%20%3E%20x%20%7C%7C%20y0%20%3E%20y%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28this%2E%5Froot%20%26%26%20this%2E%5Froot%2Elength%29%20this%2E%5Froot%20%3D%20node%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20If%20the%20quadtree%20covers%20the%20point%20already%2C%20just%20return%2E%0A%20%20else%20return%20this%3B%0A%0A%20%20this%2E%5Fx0%20%3D%20x0%3B%0A%20%20this%2E%5Fy0%20%3D%20y0%3B%0A%20%20this%2E%5Fx1%20%3D%20x1%3B%0A%20%20this%2E%5Fy1%20%3D%20y1%3B%0A%20%20return%20this%3B%0A%7D%0A%0Afunction%20tree%5Fdata%28%29%20%7B%0A%20%20var%20data%20%3D%20%5B%5D%3B%0A%20%20this%2Evisit%28function%28node%29%20%7B%0A%20%20%20%20if%20%28%21node%2Elength%29%20do%20data%2Epush%28node%2Edata%29%3B%20while%20%28node%20%3D%20node%2Enext%29%0A%20%20%7D%29%3B%0A%20%20return%20data%3B%0A%7D%0A%0Afunction%20tree%5Fextent%28%5F%29%20%7B%0A%20%20return%20arguments%2Elength%0A%20%20%20%20%20%20%3F%20this%2Ecover%28%2B%5F%5B0%5D%5B0%5D%2C%20%2B%5F%5B0%5D%5B1%5D%29%2Ecover%28%2B%5F%5B1%5D%5B0%5D%2C%20%2B%5F%5B1%5D%5B1%5D%29%0A%20%20%20%20%20%20%3A%20isNaN%28this%2E%5Fx0%29%20%3F%20undefined%20%3A%20%5B%5Bthis%2E%5Fx0%2C%20this%2E%5Fy0%5D%2C%20%5Bthis%2E%5Fx1%2C%20this%2E%5Fy1%5D%5D%3B%0A%7D%0A%0Afunction%20Quad%28node%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20this%2Enode%20%3D%20node%3B%0A%20%20this%2Ex0%20%3D%20x0%3B%0A%20%20this%2Ey0%20%3D%20y0%3B%0A%20%20this%2Ex1%20%3D%20x1%3B%0A%20%20this%2Ey1%20%3D%20y1%3B%0A%7D%0A%0Afunction%20tree%5Ffind%28x%2C%20y%2C%20radius%29%20%7B%0A%20%20var%20data%2C%0A%20%20%20%20%20%20x0%20%3D%20this%2E%5Fx0%2C%0A%20%20%20%20%20%20y0%20%3D%20this%2E%5Fy0%2C%0A%20%20%20%20%20%20x1%2C%0A%20%20%20%20%20%20y1%2C%0A%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%20x3%20%3D%20this%2E%5Fx1%2C%0A%20%20%20%20%20%20y3%20%3D%20this%2E%5Fy1%2C%0A%20%20%20%20%20%20quads%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20node%20%3D%20this%2E%5Froot%2C%0A%20%20%20%20%20%20q%2C%0A%20%20%20%20%20%20i%3B%0A%0A%20%20if%20%28node%29%20quads%2Epush%28new%20Quad%28node%2C%20x0%2C%20y0%2C%20x3%2C%20y3%29%29%3B%0A%20%20if%20%28radius%20%3D%3D%20null%29%20radius%20%3D%20Infinity%3B%0A%20%20else%20%7B%0A%20%20%20%20x0%20%3D%20x%20%2D%20radius%2C%20y0%20%3D%20y%20%2D%20radius%3B%0A%20%20%20%20x3%20%3D%20x%20%2B%20radius%2C%20y3%20%3D%20y%20%2B%20radius%3B%0A%20%20%20%20radius%20%2A%3D%20radius%3B%0A%20%20%7D%0A%0A%20%20while%20%28q%20%3D%20quads%2Epop%28%29%29%20%7B%0A%0A%20%20%20%20%2F%2F%20Stop%20searching%20if%20this%20quadrant%20can%E2%80%99t%20contain%20a%20closer%20node%2E%0A%20%20%20%20if%20%28%21%28node%20%3D%20q%2Enode%29%0A%20%20%20%20%20%20%20%20%7C%7C%20%28x1%20%3D%20q%2Ex0%29%20%3E%20x3%0A%20%20%20%20%20%20%20%20%7C%7C%20%28y1%20%3D%20q%2Ey0%29%20%3E%20y3%0A%20%20%20%20%20%20%20%20%7C%7C%20%28x2%20%3D%20q%2Ex1%29%20%3C%20x0%0A%20%20%20%20%20%20%20%20%7C%7C%20%28y2%20%3D%20q%2Ey1%29%20%3C%20y0%29%20continue%3B%0A%0A%20%20%20%20%2F%2F%20Bisect%20the%20current%20quadrant%2E%0A%20%20%20%20if%20%28node%2Elength%29%20%7B%0A%20%20%20%20%20%20var%20xm%20%3D%20%28x1%20%2B%20x2%29%20%2F%202%2C%0A%20%20%20%20%20%20%20%20%20%20ym%20%3D%20%28y1%20%2B%20y2%29%20%2F%202%3B%0A%0A%20%20%20%20%20%20quads%2Epush%28%0A%20%20%20%20%20%20%20%20new%20Quad%28node%5B3%5D%2C%20xm%2C%20ym%2C%20x2%2C%20y2%29%2C%0A%20%20%20%20%20%20%20%20new%20Quad%28node%5B2%5D%2C%20x1%2C%20ym%2C%20xm%2C%20y2%29%2C%0A%20%20%20%20%20%20%20%20new%20Quad%28node%5B1%5D%2C%20xm%2C%20y1%2C%20x2%2C%20ym%29%2C%0A%20%20%20%20%20%20%20%20new%20Quad%28node%5B0%5D%2C%20x1%2C%20y1%2C%20xm%2C%20ym%29%0A%20%20%20%20%20%20%29%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Visit%20the%20closest%20quadrant%20first%2E%0A%20%20%20%20%20%20if%20%28i%20%3D%20%28y%20%3E%3D%20ym%29%20%3C%3C%201%20%7C%20%28x%20%3E%3D%20xm%29%29%20%7B%0A%20%20%20%20%20%20%20%20q%20%3D%20quads%5Bquads%2Elength%20%2D%201%5D%3B%0A%20%20%20%20%20%20%20%20quads%5Bquads%2Elength%20%2D%201%5D%20%3D%20quads%5Bquads%2Elength%20%2D%201%20%2D%20i%5D%3B%0A%20%20%20%20%20%20%20%20quads%5Bquads%2Elength%20%2D%201%20%2D%20i%5D%20%3D%20q%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Visit%20this%20point%2E%20%28Visiting%20coincident%20points%20isn%E2%80%99t%20necessary%21%29%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20var%20dx%20%3D%20x%20%2D%20%2Bthis%2E%5Fx%2Ecall%28null%2C%20node%2Edata%29%2C%0A%20%20%20%20%20%20%20%20%20%20dy%20%3D%20y%20%2D%20%2Bthis%2E%5Fy%2Ecall%28null%2C%20node%2Edata%29%2C%0A%20%20%20%20%20%20%20%20%20%20d2%20%3D%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%3B%0A%20%20%20%20%20%20if%20%28d2%20%3C%20radius%29%20%7B%0A%20%20%20%20%20%20%20%20var%20d%20%3D%20Math%2Esqrt%28radius%20%3D%20d2%29%3B%0A%20%20%20%20%20%20%20%20x0%20%3D%20x%20%2D%20d%2C%20y0%20%3D%20y%20%2D%20d%3B%0A%20%20%20%20%20%20%20%20x3%20%3D%20x%20%2B%20d%2C%20y3%20%3D%20y%20%2B%20d%3B%0A%20%20%20%20%20%20%20%20data%20%3D%20node%2Edata%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20data%3B%0A%7D%0A%0Afunction%20tree%5Fremove%28d%29%20%7B%0A%20%20if%20%28isNaN%28x%20%3D%20%2Bthis%2E%5Fx%2Ecall%28null%2C%20d%29%29%20%7C%7C%20isNaN%28y%20%3D%20%2Bthis%2E%5Fy%2Ecall%28null%2C%20d%29%29%29%20return%20this%3B%20%2F%2F%20ignore%20invalid%20points%0A%0A%20%20var%20parent%2C%0A%20%20%20%20%20%20node%20%3D%20this%2E%5Froot%2C%0A%20%20%20%20%20%20retainer%2C%0A%20%20%20%20%20%20previous%2C%0A%20%20%20%20%20%20next%2C%0A%20%20%20%20%20%20x0%20%3D%20this%2E%5Fx0%2C%0A%20%20%20%20%20%20y0%20%3D%20this%2E%5Fy0%2C%0A%20%20%20%20%20%20x1%20%3D%20this%2E%5Fx1%2C%0A%20%20%20%20%20%20y1%20%3D%20this%2E%5Fy1%2C%0A%20%20%20%20%20%20x%2C%0A%20%20%20%20%20%20y%2C%0A%20%20%20%20%20%20xm%2C%0A%20%20%20%20%20%20ym%2C%0A%20%20%20%20%20%20right%2C%0A%20%20%20%20%20%20bottom%2C%0A%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20j%3B%0A%0A%20%20%2F%2F%20If%20the%20tree%20is%20empty%2C%20initialize%20the%20root%20as%20a%20leaf%2E%0A%20%20if%20%28%21node%29%20return%20this%3B%0A%0A%20%20%2F%2F%20Find%20the%20leaf%20node%20for%20the%20point%2E%0A%20%20%2F%2F%20While%20descending%2C%20also%20retain%20the%20deepest%20parent%20with%20a%20non%2Dremoved%20sibling%2E%0A%20%20if%20%28node%2Elength%29%20while%20%28true%29%20%7B%0A%20%20%20%20if%20%28right%20%3D%20x%20%3E%3D%20%28xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%29%29%20x0%20%3D%20xm%3B%20else%20x1%20%3D%20xm%3B%0A%20%20%20%20if%20%28bottom%20%3D%20y%20%3E%3D%20%28ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%29%29%20y0%20%3D%20ym%3B%20else%20y1%20%3D%20ym%3B%0A%20%20%20%20if%20%28%21%28parent%20%3D%20node%2C%20node%20%3D%20node%5Bi%20%3D%20bottom%20%3C%3C%201%20%7C%20right%5D%29%29%20return%20this%3B%0A%20%20%20%20if%20%28%21node%2Elength%29%20break%3B%0A%20%20%20%20if%20%28parent%5B%28i%20%2B%201%29%20%26%203%5D%20%7C%7C%20parent%5B%28i%20%2B%202%29%20%26%203%5D%20%7C%7C%20parent%5B%28i%20%2B%203%29%20%26%203%5D%29%20retainer%20%3D%20parent%2C%20j%20%3D%20i%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Find%20the%20point%20to%20remove%2E%0A%20%20while%20%28node%2Edata%20%21%3D%3D%20d%29%20if%20%28%21%28previous%20%3D%20node%2C%20node%20%3D%20node%2Enext%29%29%20return%20this%3B%0A%20%20if%20%28next%20%3D%20node%2Enext%29%20delete%20node%2Enext%3B%0A%0A%20%20%2F%2F%20If%20there%20are%20multiple%20coincident%20points%2C%20remove%20just%20the%20point%2E%0A%20%20if%20%28previous%29%20return%20next%20%3F%20previous%2Enext%20%3D%20next%20%3A%20delete%20previous%2Enext%2C%20this%3B%0A%0A%20%20%2F%2F%20If%20this%20is%20the%20root%20point%2C%20remove%20it%2E%0A%20%20if%20%28%21parent%29%20return%20this%2E%5Froot%20%3D%20next%2C%20this%3B%0A%0A%20%20%2F%2F%20Remove%20this%20leaf%2E%0A%20%20next%20%3F%20parent%5Bi%5D%20%3D%20next%20%3A%20delete%20parent%5Bi%5D%3B%0A%0A%20%20%2F%2F%20If%20the%20parent%20now%20contains%20exactly%20one%20leaf%2C%20collapse%20superfluous%20parents%2E%0A%20%20if%20%28%28node%20%3D%20parent%5B0%5D%20%7C%7C%20parent%5B1%5D%20%7C%7C%20parent%5B2%5D%20%7C%7C%20parent%5B3%5D%29%0A%20%20%20%20%20%20%26%26%20node%20%3D%3D%3D%20%28parent%5B3%5D%20%7C%7C%20parent%5B2%5D%20%7C%7C%20parent%5B1%5D%20%7C%7C%20parent%5B0%5D%29%0A%20%20%20%20%20%20%26%26%20%21node%2Elength%29%20%7B%0A%20%20%20%20if%20%28retainer%29%20retainer%5Bj%5D%20%3D%20node%3B%0A%20%20%20%20else%20this%2E%5Froot%20%3D%20node%3B%0A%20%20%7D%0A%0A%20%20return%20this%3B%0A%7D%0A%0Afunction%20removeAll%28data%29%20%7B%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20data%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20this%2Eremove%28data%5Bi%5D%29%3B%0A%20%20return%20this%3B%0A%7D%0A%0Afunction%20tree%5Froot%28%29%20%7B%0A%20%20return%20this%2E%5Froot%3B%0A%7D%0A%0Afunction%20tree%5Fsize%28%29%20%7B%0A%20%20var%20size%20%3D%200%3B%0A%20%20this%2Evisit%28function%28node%29%20%7B%0A%20%20%20%20if%20%28%21node%2Elength%29%20do%20%2B%2Bsize%3B%20while%20%28node%20%3D%20node%2Enext%29%0A%20%20%7D%29%3B%0A%20%20return%20size%3B%0A%7D%0A%0Afunction%20tree%5Fvisit%28callback%29%20%7B%0A%20%20var%20quads%20%3D%20%5B%5D%2C%20q%2C%20node%20%3D%20this%2E%5Froot%2C%20child%2C%20x0%2C%20y0%2C%20x1%2C%20y1%3B%0A%20%20if%20%28node%29%20quads%2Epush%28new%20Quad%28node%2C%20this%2E%5Fx0%2C%20this%2E%5Fy0%2C%20this%2E%5Fx1%2C%20this%2E%5Fy1%29%29%3B%0A%20%20while%20%28q%20%3D%20quads%2Epop%28%29%29%20%7B%0A%20%20%20%20if%20%28%21callback%28node%20%3D%20q%2Enode%2C%20x0%20%3D%20q%2Ex0%2C%20y0%20%3D%20q%2Ey0%2C%20x1%20%3D%20q%2Ex1%2C%20y1%20%3D%20q%2Ey1%29%20%26%26%20node%2Elength%29%20%7B%0A%20%20%20%20%20%20var%20xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%2C%20ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B3%5D%29%20quads%2Epush%28new%20Quad%28child%2C%20xm%2C%20ym%2C%20x1%2C%20y1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B2%5D%29%20quads%2Epush%28new%20Quad%28child%2C%20x0%2C%20ym%2C%20xm%2C%20y1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B1%5D%29%20quads%2Epush%28new%20Quad%28child%2C%20xm%2C%20y0%2C%20x1%2C%20ym%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B0%5D%29%20quads%2Epush%28new%20Quad%28child%2C%20x0%2C%20y0%2C%20xm%2C%20ym%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0Afunction%20tree%5FvisitAfter%28callback%29%20%7B%0A%20%20var%20quads%20%3D%20%5B%5D%2C%20next%20%3D%20%5B%5D%2C%20q%3B%0A%20%20if%20%28this%2E%5Froot%29%20quads%2Epush%28new%20Quad%28this%2E%5Froot%2C%20this%2E%5Fx0%2C%20this%2E%5Fy0%2C%20this%2E%5Fx1%2C%20this%2E%5Fy1%29%29%3B%0A%20%20while%20%28q%20%3D%20quads%2Epop%28%29%29%20%7B%0A%20%20%20%20var%20node%20%3D%20q%2Enode%3B%0A%20%20%20%20if%20%28node%2Elength%29%20%7B%0A%20%20%20%20%20%20var%20child%2C%20x0%20%3D%20q%2Ex0%2C%20y0%20%3D%20q%2Ey0%2C%20x1%20%3D%20q%2Ex1%2C%20y1%20%3D%20q%2Ey1%2C%20xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%2C%20ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B0%5D%29%20quads%2Epush%28new%20Quad%28child%2C%20x0%2C%20y0%2C%20xm%2C%20ym%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B1%5D%29%20quads%2Epush%28new%20Quad%28child%2C%20xm%2C%20y0%2C%20x1%2C%20ym%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B2%5D%29%20quads%2Epush%28new%20Quad%28child%2C%20x0%2C%20ym%2C%20xm%2C%20y1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B3%5D%29%20quads%2Epush%28new%20Quad%28child%2C%20xm%2C%20ym%2C%20x1%2C%20y1%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20next%2Epush%28q%29%3B%0A%20%20%7D%0A%20%20while%20%28q%20%3D%20next%2Epop%28%29%29%20%7B%0A%20%20%20%20callback%28q%2Enode%2C%20q%2Ex0%2C%20q%2Ey0%2C%20q%2Ex1%2C%20q%2Ey1%29%3B%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0Afunction%20defaultX%241%28d%29%20%7B%0A%20%20return%20d%5B0%5D%3B%0A%7D%0A%0Afunction%20tree%5Fx%28%5F%29%20%7B%0A%20%20return%20arguments%2Elength%20%3F%20%28this%2E%5Fx%20%3D%20%5F%2C%20this%29%20%3A%20this%2E%5Fx%3B%0A%7D%0A%0Afunction%20defaultY%241%28d%29%20%7B%0A%20%20return%20d%5B1%5D%3B%0A%7D%0A%0Afunction%20tree%5Fy%28%5F%29%20%7B%0A%20%20return%20arguments%2Elength%20%3F%20%28this%2E%5Fy%20%3D%20%5F%2C%20this%29%20%3A%20this%2E%5Fy%3B%0A%7D%0A%0Afunction%20quadtree%28nodes%2C%20x%2C%20y%29%20%7B%0A%20%20var%20tree%20%3D%20new%20Quadtree%28x%20%3D%3D%20null%20%3F%20defaultX%241%20%3A%20x%2C%20y%20%3D%3D%20null%20%3F%20defaultY%241%20%3A%20y%2C%20NaN%2C%20NaN%2C%20NaN%2C%20NaN%29%3B%0A%20%20return%20nodes%20%3D%3D%20null%20%3F%20tree%20%3A%20tree%2EaddAll%28nodes%29%3B%0A%7D%0A%0Afunction%20Quadtree%28x%2C%20y%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20this%2E%5Fx%20%3D%20x%3B%0A%20%20this%2E%5Fy%20%3D%20y%3B%0A%20%20this%2E%5Fx0%20%3D%20x0%3B%0A%20%20this%2E%5Fy0%20%3D%20y0%3B%0A%20%20this%2E%5Fx1%20%3D%20x1%3B%0A%20%20this%2E%5Fy1%20%3D%20y1%3B%0A%20%20this%2E%5Froot%20%3D%20undefined%3B%0A%7D%0A%0Afunction%20leaf%5Fcopy%28leaf%29%20%7B%0A%20%20var%20copy%20%3D%20%7Bdata%3A%20leaf%2Edata%7D%2C%20next%20%3D%20copy%3B%0A%20%20while%20%28leaf%20%3D%20leaf%2Enext%29%20next%20%3D%20next%2Enext%20%3D%20%7Bdata%3A%20leaf%2Edata%7D%3B%0A%20%20return%20copy%3B%0A%7D%0A%0Avar%20treeProto%20%3D%20quadtree%2Eprototype%20%3D%20Quadtree%2Eprototype%3B%0A%0AtreeProto%2Ecopy%20%3D%20function%28%29%20%7B%0A%20%20var%20copy%20%3D%20new%20Quadtree%28this%2E%5Fx%2C%20this%2E%5Fy%2C%20this%2E%5Fx0%2C%20this%2E%5Fy0%2C%20this%2E%5Fx1%2C%20this%2E%5Fy1%29%2C%0A%20%20%20%20%20%20node%20%3D%20this%2E%5Froot%2C%0A%20%20%20%20%20%20nodes%2C%0A%20%20%20%20%20%20child%3B%0A%0A%20%20if%20%28%21node%29%20return%20copy%3B%0A%0A%20%20if%20%28%21node%2Elength%29%20return%20copy%2E%5Froot%20%3D%20leaf%5Fcopy%28node%29%2C%20copy%3B%0A%0A%20%20nodes%20%3D%20%5B%7Bsource%3A%20node%2C%20target%3A%20copy%2E%5Froot%20%3D%20new%20Array%284%29%7D%5D%3B%0A%20%20while%20%28node%20%3D%20nodes%2Epop%28%29%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%204%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%2Esource%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28child%2Elength%29%20nodes%2Epush%28%7Bsource%3A%20child%2C%20target%3A%20node%2Etarget%5Bi%5D%20%3D%20new%20Array%284%29%7D%29%3B%0A%20%20%20%20%20%20%20%20else%20node%2Etarget%5Bi%5D%20%3D%20leaf%5Fcopy%28child%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20copy%3B%0A%7D%3B%0A%0AtreeProto%2Eadd%20%3D%20tree%5Fadd%3B%0AtreeProto%2EaddAll%20%3D%20addAll%3B%0AtreeProto%2Ecover%20%3D%20tree%5Fcover%3B%0AtreeProto%2Edata%20%3D%20tree%5Fdata%3B%0AtreeProto%2Eextent%20%3D%20tree%5Fextent%3B%0AtreeProto%2Efind%20%3D%20tree%5Ffind%3B%0AtreeProto%2Eremove%20%3D%20tree%5Fremove%3B%0AtreeProto%2EremoveAll%20%3D%20removeAll%3B%0AtreeProto%2Eroot%20%3D%20tree%5Froot%3B%0AtreeProto%2Esize%20%3D%20tree%5Fsize%3B%0AtreeProto%2Evisit%20%3D%20tree%5Fvisit%3B%0AtreeProto%2EvisitAfter%20%3D%20tree%5FvisitAfter%3B%0AtreeProto%2Ex%20%3D%20tree%5Fx%3B%0AtreeProto%2Ey%20%3D%20tree%5Fy%3B%0A%0Afunction%20x%28d%29%20%7B%0A%20%20return%20d%2Ex%20%2B%20d%2Evx%3B%0A%7D%0A%0Afunction%20y%28d%29%20%7B%0A%20%20return%20d%2Ey%20%2B%20d%2Evy%3B%0A%7D%0A%0Afunction%20collide%28radius%29%20%7B%0A%20%20var%20nodes%2C%0A%20%20%20%20%20%20radii%2C%0A%20%20%20%20%20%20strength%20%3D%201%2C%0A%20%20%20%20%20%20iterations%20%3D%201%3B%0A%0A%20%20if%20%28typeof%20radius%20%21%3D%3D%20%22function%22%29%20radius%20%3D%20constant%247%28radius%20%3D%3D%20null%20%3F%201%20%3A%20%2Bradius%29%3B%0A%0A%20%20function%20force%28%29%20%7B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes%2Elength%2C%0A%20%20%20%20%20%20%20%20tree%2C%0A%20%20%20%20%20%20%20%20node%2C%0A%20%20%20%20%20%20%20%20xi%2C%0A%20%20%20%20%20%20%20%20yi%2C%0A%20%20%20%20%20%20%20%20ri%2C%0A%20%20%20%20%20%20%20%20ri2%3B%0A%0A%20%20%20%20for%20%28var%20k%20%3D%200%3B%20k%20%3C%20iterations%3B%20%2B%2Bk%29%20%7B%0A%20%20%20%20%20%20tree%20%3D%20quadtree%28nodes%2C%20x%2C%20y%29%2EvisitAfter%28prepare%29%3B%0A%20%20%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20ri%20%3D%20radii%5Bnode%2Eindex%5D%2C%20ri2%20%3D%20ri%20%2A%20ri%3B%0A%20%20%20%20%20%20%20%20xi%20%3D%20node%2Ex%20%2B%20node%2Evx%3B%0A%20%20%20%20%20%20%20%20yi%20%3D%20node%2Ey%20%2B%20node%2Evy%3B%0A%20%20%20%20%20%20%20%20tree%2Evisit%28apply%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20apply%28quad%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20%20%20%20%20var%20data%20%3D%20quad%2Edata%2C%20rj%20%3D%20quad%2Er%2C%20r%20%3D%20ri%20%2B%20rj%3B%0A%20%20%20%20%20%20if%20%28data%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28data%2Eindex%20%3E%20node%2Eindex%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20x%20%3D%20xi%20%2D%20data%2Ex%20%2D%20data%2Evx%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%20%3D%20yi%20%2D%20data%2Ey%20%2D%20data%2Evy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20l%20%3D%20x%20%2A%20x%20%2B%20y%20%2A%20y%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28l%20%3C%20r%20%2A%20r%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28x%20%3D%3D%3D%200%29%20x%20%3D%20jiggle%28%29%2C%20l%20%2B%3D%20x%20%2A%20x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28y%20%3D%3D%3D%200%29%20y%20%3D%20jiggle%28%29%2C%20l%20%2B%3D%20y%20%2A%20y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20l%20%3D%20%28r%20%2D%20%28l%20%3D%20Math%2Esqrt%28l%29%29%29%20%2F%20l%20%2A%20strength%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20node%2Evx%20%2B%3D%20%28x%20%2A%3D%20l%29%20%2A%20%28r%20%3D%20%28rj%20%2A%3D%20rj%29%20%2F%20%28ri2%20%2B%20rj%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20node%2Evy%20%2B%3D%20%28y%20%2A%3D%20l%29%20%2A%20r%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20data%2Evx%20%2D%3D%20x%20%2A%20%28r%20%3D%201%20%2D%20r%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20data%2Evy%20%2D%3D%20y%20%2A%20r%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20x0%20%3E%20xi%20%2B%20r%20%7C%7C%20x1%20%3C%20xi%20%2D%20r%20%7C%7C%20y0%20%3E%20yi%20%2B%20r%20%7C%7C%20y1%20%3C%20yi%20%2D%20r%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20prepare%28quad%29%20%7B%0A%20%20%20%20if%20%28quad%2Edata%29%20return%20quad%2Er%20%3D%20radii%5Bquad%2Edata%2Eindex%5D%3B%0A%20%20%20%20for%20%28var%20i%20%3D%20quad%2Er%20%3D%200%3B%20i%20%3C%204%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28quad%5Bi%5D%20%26%26%20quad%5Bi%5D%2Er%20%3E%20quad%2Er%29%20%7B%0A%20%20%20%20%20%20%20%20quad%2Er%20%3D%20quad%5Bi%5D%2Er%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20initialize%28%29%20%7B%0A%20%20%20%20if%20%28%21nodes%29%20return%3B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes%2Elength%2C%20node%3B%0A%20%20%20%20radii%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20node%20%3D%20nodes%5Bi%5D%2C%20radii%5Bnode%2Eindex%5D%20%3D%20%2Bradius%28node%2C%20i%2C%20nodes%29%3B%0A%20%20%7D%0A%0A%20%20force%2Einitialize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20nodes%20%3D%20%5F%3B%0A%20%20%20%20initialize%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Eiterations%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28iterations%20%3D%20%2B%5F%2C%20force%29%20%3A%20iterations%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Estrength%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28strength%20%3D%20%2B%5F%2C%20force%29%20%3A%20strength%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Eradius%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28radius%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%247%28%2B%5F%29%2C%20initialize%28%29%2C%20force%29%20%3A%20radius%3B%0A%20%20%7D%3B%0A%0A%20%20return%20force%3B%0A%7D%0A%0Afunction%20index%28d%29%20%7B%0A%20%20return%20d%2Eindex%3B%0A%7D%0A%0Afunction%20find%28nodeById%2C%20nodeId%29%20%7B%0A%20%20var%20node%20%3D%20nodeById%2Eget%28nodeId%29%3B%0A%20%20if%20%28%21node%29%20throw%20new%20Error%28%22missing%3A%20%22%20%2B%20nodeId%29%3B%0A%20%20return%20node%3B%0A%7D%0A%0Afunction%20link%28links%29%20%7B%0A%20%20var%20id%20%3D%20index%2C%0A%20%20%20%20%20%20strength%20%3D%20defaultStrength%2C%0A%20%20%20%20%20%20strengths%2C%0A%20%20%20%20%20%20distance%20%3D%20constant%247%2830%29%2C%0A%20%20%20%20%20%20distances%2C%0A%20%20%20%20%20%20nodes%2C%0A%20%20%20%20%20%20count%2C%0A%20%20%20%20%20%20bias%2C%0A%20%20%20%20%20%20iterations%20%3D%201%3B%0A%0A%20%20if%20%28links%20%3D%3D%20null%29%20links%20%3D%20%5B%5D%3B%0A%0A%20%20function%20defaultStrength%28link%29%20%7B%0A%20%20%20%20return%201%20%2F%20Math%2Emin%28count%5Blink%2Esource%2Eindex%5D%2C%20count%5Blink%2Etarget%2Eindex%5D%29%3B%0A%20%20%7D%0A%0A%20%20function%20force%28alpha%29%20%7B%0A%20%20%20%20for%20%28var%20k%20%3D%200%2C%20n%20%3D%20links%2Elength%3B%20k%20%3C%20iterations%3B%20%2B%2Bk%29%20%7B%0A%20%20%20%20%20%20for%20%28var%20i%20%3D%200%2C%20link%2C%20source%2C%20target%2C%20x%2C%20y%2C%20l%2C%20b%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20link%20%3D%20links%5Bi%5D%2C%20source%20%3D%20link%2Esource%2C%20target%20%3D%20link%2Etarget%3B%0A%20%20%20%20%20%20%20%20x%20%3D%20target%2Ex%20%2B%20target%2Evx%20%2D%20source%2Ex%20%2D%20source%2Evx%20%7C%7C%20jiggle%28%29%3B%0A%20%20%20%20%20%20%20%20y%20%3D%20target%2Ey%20%2B%20target%2Evy%20%2D%20source%2Ey%20%2D%20source%2Evy%20%7C%7C%20jiggle%28%29%3B%0A%20%20%20%20%20%20%20%20l%20%3D%20Math%2Esqrt%28x%20%2A%20x%20%2B%20y%20%2A%20y%29%3B%0A%20%20%20%20%20%20%20%20l%20%3D%20%28l%20%2D%20distances%5Bi%5D%29%20%2F%20l%20%2A%20alpha%20%2A%20strengths%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20x%20%2A%3D%20l%2C%20y%20%2A%3D%20l%3B%0A%20%20%20%20%20%20%20%20target%2Evx%20%2D%3D%20x%20%2A%20%28b%20%3D%20bias%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20target%2Evy%20%2D%3D%20y%20%2A%20b%3B%0A%20%20%20%20%20%20%20%20source%2Evx%20%2B%3D%20x%20%2A%20%28b%20%3D%201%20%2D%20b%29%3B%0A%20%20%20%20%20%20%20%20source%2Evy%20%2B%3D%20y%20%2A%20b%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20initialize%28%29%20%7B%0A%20%20%20%20if%20%28%21nodes%29%20return%3B%0A%0A%20%20%20%20var%20i%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20nodes%2Elength%2C%0A%20%20%20%20%20%20%20%20m%20%3D%20links%2Elength%2C%0A%20%20%20%20%20%20%20%20nodeById%20%3D%20map%241%28nodes%2C%20id%29%2C%0A%20%20%20%20%20%20%20%20link%3B%0A%0A%20%20%20%20for%20%28i%20%3D%200%2C%20count%20%3D%20new%20Array%28n%29%3B%20i%20%3C%20m%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20link%20%3D%20links%5Bi%5D%2C%20link%2Eindex%20%3D%20i%3B%0A%20%20%20%20%20%20if%20%28typeof%20link%2Esource%20%21%3D%3D%20%22object%22%29%20link%2Esource%20%3D%20find%28nodeById%2C%20link%2Esource%29%3B%0A%20%20%20%20%20%20if%20%28typeof%20link%2Etarget%20%21%3D%3D%20%22object%22%29%20link%2Etarget%20%3D%20find%28nodeById%2C%20link%2Etarget%29%3B%0A%20%20%20%20%20%20count%5Blink%2Esource%2Eindex%5D%20%3D%20%28count%5Blink%2Esource%2Eindex%5D%20%7C%7C%200%29%20%2B%201%3B%0A%20%20%20%20%20%20count%5Blink%2Etarget%2Eindex%5D%20%3D%20%28count%5Blink%2Etarget%2Eindex%5D%20%7C%7C%200%29%20%2B%201%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20for%20%28i%20%3D%200%2C%20bias%20%3D%20new%20Array%28m%29%3B%20i%20%3C%20m%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20link%20%3D%20links%5Bi%5D%2C%20bias%5Bi%5D%20%3D%20count%5Blink%2Esource%2Eindex%5D%20%2F%20%28count%5Blink%2Esource%2Eindex%5D%20%2B%20count%5Blink%2Etarget%2Eindex%5D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20strengths%20%3D%20new%20Array%28m%29%2C%20initializeStrength%28%29%3B%0A%20%20%20%20distances%20%3D%20new%20Array%28m%29%2C%20initializeDistance%28%29%3B%0A%20%20%7D%0A%0A%20%20function%20initializeStrength%28%29%20%7B%0A%20%20%20%20if%20%28%21nodes%29%20return%3B%0A%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20links%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20strengths%5Bi%5D%20%3D%20%2Bstrength%28links%5Bi%5D%2C%20i%2C%20links%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20initializeDistance%28%29%20%7B%0A%20%20%20%20if%20%28%21nodes%29%20return%3B%0A%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20links%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20distances%5Bi%5D%20%3D%20%2Bdistance%28links%5Bi%5D%2C%20i%2C%20links%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20force%2Einitialize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20nodes%20%3D%20%5F%3B%0A%20%20%20%20initialize%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Elinks%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28links%20%3D%20%5F%2C%20initialize%28%29%2C%20force%29%20%3A%20links%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Eid%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28id%20%3D%20%5F%2C%20force%29%20%3A%20id%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Eiterations%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28iterations%20%3D%20%2B%5F%2C%20force%29%20%3A%20iterations%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Estrength%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28strength%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%247%28%2B%5F%29%2C%20initializeStrength%28%29%2C%20force%29%20%3A%20strength%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Edistance%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28distance%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%247%28%2B%5F%29%2C%20initializeDistance%28%29%2C%20force%29%20%3A%20distance%3B%0A%20%20%7D%3B%0A%0A%20%20return%20force%3B%0A%7D%0A%0Afunction%20x%241%28d%29%20%7B%0A%20%20return%20d%2Ex%3B%0A%7D%0A%0Afunction%20y%241%28d%29%20%7B%0A%20%20return%20d%2Ey%3B%0A%7D%0A%0Avar%20initialRadius%20%3D%2010%2C%0A%20%20%20%20initialAngle%20%3D%20Math%2EPI%20%2A%20%283%20%2D%20Math%2Esqrt%285%29%29%3B%0A%0Afunction%20simulation%28nodes%29%20%7B%0A%20%20var%20simulation%2C%0A%20%20%20%20%20%20alpha%20%3D%201%2C%0A%20%20%20%20%20%20alphaMin%20%3D%200%2E001%2C%0A%20%20%20%20%20%20alphaDecay%20%3D%201%20%2D%20Math%2Epow%28alphaMin%2C%201%20%2F%20300%29%2C%0A%20%20%20%20%20%20alphaTarget%20%3D%200%2C%0A%20%20%20%20%20%20velocityDecay%20%3D%200%2E6%2C%0A%20%20%20%20%20%20forces%20%3D%20map%241%28%29%2C%0A%20%20%20%20%20%20stepper%20%3D%20timer%28step%29%2C%0A%20%20%20%20%20%20event%20%3D%20dispatch%28%22tick%22%2C%20%22end%22%29%3B%0A%0A%20%20if%20%28nodes%20%3D%3D%20null%29%20nodes%20%3D%20%5B%5D%3B%0A%0A%20%20function%20step%28%29%20%7B%0A%20%20%20%20tick%28%29%3B%0A%20%20%20%20event%2Ecall%28%22tick%22%2C%20simulation%29%3B%0A%20%20%20%20if%20%28alpha%20%3C%20alphaMin%29%20%7B%0A%20%20%20%20%20%20stepper%2Estop%28%29%3B%0A%20%20%20%20%20%20event%2Ecall%28%22end%22%2C%20simulation%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20tick%28%29%20%7B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes%2Elength%2C%20node%3B%0A%0A%20%20%20%20alpha%20%2B%3D%20%28alphaTarget%20%2D%20alpha%29%20%2A%20alphaDecay%3B%0A%0A%20%20%20%20forces%2Eeach%28function%28force%29%20%7B%0A%20%20%20%20%20%20force%28alpha%29%3B%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28node%2Efx%20%3D%3D%20null%29%20node%2Ex%20%2B%3D%20node%2Evx%20%2A%3D%20velocityDecay%3B%0A%20%20%20%20%20%20else%20node%2Ex%20%3D%20node%2Efx%2C%20node%2Evx%20%3D%200%3B%0A%20%20%20%20%20%20if%20%28node%2Efy%20%3D%3D%20null%29%20node%2Ey%20%2B%3D%20node%2Evy%20%2A%3D%20velocityDecay%3B%0A%20%20%20%20%20%20else%20node%2Ey%20%3D%20node%2Efy%2C%20node%2Evy%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20initializeNodes%28%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20nodes%2Elength%2C%20node%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%2C%20node%2Eindex%20%3D%20i%3B%0A%20%20%20%20%20%20if%20%28isNaN%28node%2Ex%29%20%7C%7C%20isNaN%28node%2Ey%29%29%20%7B%0A%20%20%20%20%20%20%20%20var%20radius%20%3D%20initialRadius%20%2A%20Math%2Esqrt%28i%29%2C%20angle%20%3D%20i%20%2A%20initialAngle%3B%0A%20%20%20%20%20%20%20%20node%2Ex%20%3D%20radius%20%2A%20Math%2Ecos%28angle%29%3B%0A%20%20%20%20%20%20%20%20node%2Ey%20%3D%20radius%20%2A%20Math%2Esin%28angle%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28isNaN%28node%2Evx%29%20%7C%7C%20isNaN%28node%2Evy%29%29%20%7B%0A%20%20%20%20%20%20%20%20node%2Evx%20%3D%20node%2Evy%20%3D%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20initializeForce%28force%29%20%7B%0A%20%20%20%20if%20%28force%2Einitialize%29%20force%2Einitialize%28nodes%29%3B%0A%20%20%20%20return%20force%3B%0A%20%20%7D%0A%0A%20%20initializeNodes%28%29%3B%0A%0A%20%20return%20simulation%20%3D%20%7B%0A%20%20%20%20tick%3A%20tick%2C%0A%0A%20%20%20%20restart%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20stepper%2Erestart%28step%29%2C%20simulation%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20stop%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20stepper%2Estop%28%29%2C%20simulation%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20nodes%3A%20function%28%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3F%20%28nodes%20%3D%20%5F%2C%20initializeNodes%28%29%2C%20forces%2Eeach%28initializeForce%29%2C%20simulation%29%20%3A%20nodes%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20alpha%3A%20function%28%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3F%20%28alpha%20%3D%20%2B%5F%2C%20simulation%29%20%3A%20alpha%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20alphaMin%3A%20function%28%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3F%20%28alphaMin%20%3D%20%2B%5F%2C%20simulation%29%20%3A%20alphaMin%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20alphaDecay%3A%20function%28%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3F%20%28alphaDecay%20%3D%20%2B%5F%2C%20simulation%29%20%3A%20%2BalphaDecay%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20alphaTarget%3A%20function%28%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3F%20%28alphaTarget%20%3D%20%2B%5F%2C%20simulation%29%20%3A%20alphaTarget%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20velocityDecay%3A%20function%28%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3F%20%28velocityDecay%20%3D%201%20%2D%20%5F%2C%20simulation%29%20%3A%201%20%2D%20velocityDecay%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20force%3A%20function%28name%2C%20%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3E%201%20%3F%20%28%5F%20%3D%3D%20null%20%3F%20forces%2Eremove%28name%29%20%3A%20forces%2Eset%28name%2C%20initializeForce%28%5F%29%29%2C%20simulation%29%20%3A%20forces%2Eget%28name%29%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20find%3A%20function%28x%2C%20y%2C%20radius%29%20%7B%0A%20%20%20%20%20%20var%20i%20%3D%200%2C%0A%20%20%20%20%20%20%20%20%20%20n%20%3D%20nodes%2Elength%2C%0A%20%20%20%20%20%20%20%20%20%20dx%2C%0A%20%20%20%20%20%20%20%20%20%20dy%2C%0A%20%20%20%20%20%20%20%20%20%20d2%2C%0A%20%20%20%20%20%20%20%20%20%20node%2C%0A%20%20%20%20%20%20%20%20%20%20closest%3B%0A%0A%20%20%20%20%20%20if%20%28radius%20%3D%3D%20null%29%20radius%20%3D%20Infinity%3B%0A%20%20%20%20%20%20else%20radius%20%2A%3D%20radius%3B%0A%0A%20%20%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20dx%20%3D%20x%20%2D%20node%2Ex%3B%0A%20%20%20%20%20%20%20%20dy%20%3D%20y%20%2D%20node%2Ey%3B%0A%20%20%20%20%20%20%20%20d2%20%3D%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%3B%0A%20%20%20%20%20%20%20%20if%20%28d2%20%3C%20radius%29%20closest%20%3D%20node%2C%20radius%20%3D%20d2%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20return%20closest%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20on%3A%20function%28name%2C%20%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3E%201%20%3F%20%28event%2Eon%28name%2C%20%5F%29%2C%20simulation%29%20%3A%20event%2Eon%28name%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20manyBody%28%29%20%7B%0A%20%20var%20nodes%2C%0A%20%20%20%20%20%20node%2C%0A%20%20%20%20%20%20alpha%2C%0A%20%20%20%20%20%20strength%20%3D%20constant%247%28%2D30%29%2C%0A%20%20%20%20%20%20strengths%2C%0A%20%20%20%20%20%20distanceMin2%20%3D%201%2C%0A%20%20%20%20%20%20distanceMax2%20%3D%20Infinity%2C%0A%20%20%20%20%20%20theta2%20%3D%200%2E81%3B%0A%0A%20%20function%20force%28%5F%29%20%7B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes%2Elength%2C%20tree%20%3D%20quadtree%28nodes%2C%20x%241%2C%20y%241%29%2EvisitAfter%28accumulate%29%3B%0A%20%20%20%20for%20%28alpha%20%3D%20%5F%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20node%20%3D%20nodes%5Bi%5D%2C%20tree%2Evisit%28apply%29%3B%0A%20%20%7D%0A%0A%20%20function%20initialize%28%29%20%7B%0A%20%20%20%20if%20%28%21nodes%29%20return%3B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes%2Elength%2C%20node%3B%0A%20%20%20%20strengths%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20node%20%3D%20nodes%5Bi%5D%2C%20strengths%5Bnode%2Eindex%5D%20%3D%20%2Bstrength%28node%2C%20i%2C%20nodes%29%3B%0A%20%20%7D%0A%0A%20%20function%20accumulate%28quad%29%20%7B%0A%20%20%20%20var%20strength%20%3D%200%2C%20q%2C%20c%2C%20weight%20%3D%200%2C%20x%2C%20y%2C%20i%3B%0A%0A%20%20%20%20%2F%2F%20For%20internal%20nodes%2C%20accumulate%20forces%20from%20child%20quadrants%2E%0A%20%20%20%20if%20%28quad%2Elength%29%20%7B%0A%20%20%20%20%20%20for%20%28x%20%3D%20y%20%3D%20i%20%3D%200%3B%20i%20%3C%204%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%28q%20%3D%20quad%5Bi%5D%29%20%26%26%20%28c%20%3D%20Math%2Eabs%28q%2Evalue%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20strength%20%2B%3D%20q%2Evalue%2C%20weight%20%2B%3D%20c%2C%20x%20%2B%3D%20c%20%2A%20q%2Ex%2C%20y%20%2B%3D%20c%20%2A%20q%2Ey%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20quad%2Ex%20%3D%20x%20%2F%20weight%3B%0A%20%20%20%20%20%20quad%2Ey%20%3D%20y%20%2F%20weight%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20For%20leaf%20nodes%2C%20accumulate%20forces%20from%20coincident%20quadrants%2E%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20q%20%3D%20quad%3B%0A%20%20%20%20%20%20q%2Ex%20%3D%20q%2Edata%2Ex%3B%0A%20%20%20%20%20%20q%2Ey%20%3D%20q%2Edata%2Ey%3B%0A%20%20%20%20%20%20do%20strength%20%2B%3D%20strengths%5Bq%2Edata%2Eindex%5D%3B%0A%20%20%20%20%20%20while%20%28q%20%3D%20q%2Enext%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20quad%2Evalue%20%3D%20strength%3B%0A%20%20%7D%0A%0A%20%20function%20apply%28quad%2C%20x1%2C%20%5F%2C%20x2%29%20%7B%0A%20%20%20%20if%20%28%21quad%2Evalue%29%20return%20true%3B%0A%0A%20%20%20%20var%20x%20%3D%20quad%2Ex%20%2D%20node%2Ex%2C%0A%20%20%20%20%20%20%20%20y%20%3D%20quad%2Ey%20%2D%20node%2Ey%2C%0A%20%20%20%20%20%20%20%20w%20%3D%20x2%20%2D%20x1%2C%0A%20%20%20%20%20%20%20%20l%20%3D%20x%20%2A%20x%20%2B%20y%20%2A%20y%3B%0A%0A%20%20%20%20%2F%2F%20Apply%20the%20Barnes%2DHut%20approximation%20if%20possible%2E%0A%20%20%20%20%2F%2F%20Limit%20forces%20for%20very%20close%20nodes%3B%20randomize%20direction%20if%20coincident%2E%0A%20%20%20%20if%20%28w%20%2A%20w%20%2F%20theta2%20%3C%20l%29%20%7B%0A%20%20%20%20%20%20if%20%28l%20%3C%20distanceMax2%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28x%20%3D%3D%3D%200%29%20x%20%3D%20jiggle%28%29%2C%20l%20%2B%3D%20x%20%2A%20x%3B%0A%20%20%20%20%20%20%20%20if%20%28y%20%3D%3D%3D%200%29%20y%20%3D%20jiggle%28%29%2C%20l%20%2B%3D%20y%20%2A%20y%3B%0A%20%20%20%20%20%20%20%20if%20%28l%20%3C%20distanceMin2%29%20l%20%3D%20Math%2Esqrt%28distanceMin2%20%2A%20l%29%3B%0A%20%20%20%20%20%20%20%20node%2Evx%20%2B%3D%20x%20%2A%20quad%2Evalue%20%2A%20alpha%20%2F%20l%3B%0A%20%20%20%20%20%20%20%20node%2Evy%20%2B%3D%20y%20%2A%20quad%2Evalue%20%2A%20alpha%20%2F%20l%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Otherwise%2C%20process%20points%20directly%2E%0A%20%20%20%20else%20if%20%28quad%2Elength%20%7C%7C%20l%20%3E%3D%20distanceMax2%29%20return%3B%0A%0A%20%20%20%20%2F%2F%20Limit%20forces%20for%20very%20close%20nodes%3B%20randomize%20direction%20if%20coincident%2E%0A%20%20%20%20if%20%28quad%2Edata%20%21%3D%3D%20node%20%7C%7C%20quad%2Enext%29%20%7B%0A%20%20%20%20%20%20if%20%28x%20%3D%3D%3D%200%29%20x%20%3D%20jiggle%28%29%2C%20l%20%2B%3D%20x%20%2A%20x%3B%0A%20%20%20%20%20%20if%20%28y%20%3D%3D%3D%200%29%20y%20%3D%20jiggle%28%29%2C%20l%20%2B%3D%20y%20%2A%20y%3B%0A%20%20%20%20%20%20if%20%28l%20%3C%20distanceMin2%29%20l%20%3D%20Math%2Esqrt%28distanceMin2%20%2A%20l%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20do%20if%20%28quad%2Edata%20%21%3D%3D%20node%29%20%7B%0A%20%20%20%20%20%20w%20%3D%20strengths%5Bquad%2Edata%2Eindex%5D%20%2A%20alpha%20%2F%20l%3B%0A%20%20%20%20%20%20node%2Evx%20%2B%3D%20x%20%2A%20w%3B%0A%20%20%20%20%20%20node%2Evy%20%2B%3D%20y%20%2A%20w%3B%0A%20%20%20%20%7D%20while%20%28quad%20%3D%20quad%2Enext%29%3B%0A%20%20%7D%0A%0A%20%20force%2Einitialize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20nodes%20%3D%20%5F%3B%0A%20%20%20%20initialize%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Estrength%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28strength%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%247%28%2B%5F%29%2C%20initialize%28%29%2C%20force%29%20%3A%20strength%3B%0A%20%20%7D%3B%0A%0A%20%20force%2EdistanceMin%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28distanceMin2%20%3D%20%5F%20%2A%20%5F%2C%20force%29%20%3A%20Math%2Esqrt%28distanceMin2%29%3B%0A%20%20%7D%3B%0A%0A%20%20force%2EdistanceMax%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28distanceMax2%20%3D%20%5F%20%2A%20%5F%2C%20force%29%20%3A%20Math%2Esqrt%28distanceMax2%29%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Etheta%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28theta2%20%3D%20%5F%20%2A%20%5F%2C%20force%29%20%3A%20Math%2Esqrt%28theta2%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20force%3B%0A%7D%0A%0Afunction%20radial%28radius%2C%20x%2C%20y%29%20%7B%0A%20%20var%20nodes%2C%0A%20%20%20%20%20%20strength%20%3D%20constant%247%280%2E1%29%2C%0A%20%20%20%20%20%20strengths%2C%0A%20%20%20%20%20%20radiuses%3B%0A%0A%20%20if%20%28typeof%20radius%20%21%3D%3D%20%22function%22%29%20radius%20%3D%20constant%247%28%2Bradius%29%3B%0A%20%20if%20%28x%20%3D%3D%20null%29%20x%20%3D%200%3B%0A%20%20if%20%28y%20%3D%3D%20null%29%20y%20%3D%200%3B%0A%0A%20%20function%20force%28alpha%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20nodes%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20var%20node%20%3D%20nodes%5Bi%5D%2C%0A%20%20%20%20%20%20%20%20%20%20dx%20%3D%20node%2Ex%20%2D%20x%20%7C%7C%201e%2D6%2C%0A%20%20%20%20%20%20%20%20%20%20dy%20%3D%20node%2Ey%20%2D%20y%20%7C%7C%201e%2D6%2C%0A%20%20%20%20%20%20%20%20%20%20r%20%3D%20Math%2Esqrt%28dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%29%2C%0A%20%20%20%20%20%20%20%20%20%20k%20%3D%20%28radiuses%5Bi%5D%20%2D%20r%29%20%2A%20strengths%5Bi%5D%20%2A%20alpha%20%2F%20r%3B%0A%20%20%20%20%20%20node%2Evx%20%2B%3D%20dx%20%2A%20k%3B%0A%20%20%20%20%20%20node%2Evy%20%2B%3D%20dy%20%2A%20k%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20initialize%28%29%20%7B%0A%20%20%20%20if%20%28%21nodes%29%20return%3B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes%2Elength%3B%0A%20%20%20%20strengths%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20radiuses%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20radiuses%5Bi%5D%20%3D%20%2Bradius%28nodes%5Bi%5D%2C%20i%2C%20nodes%29%3B%0A%20%20%20%20%20%20strengths%5Bi%5D%20%3D%20isNaN%28radiuses%5Bi%5D%29%20%3F%200%20%3A%20%2Bstrength%28nodes%5Bi%5D%2C%20i%2C%20nodes%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20force%2Einitialize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20nodes%20%3D%20%5F%2C%20initialize%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Estrength%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28strength%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%247%28%2B%5F%29%2C%20initialize%28%29%2C%20force%29%20%3A%20strength%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Eradius%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28radius%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%247%28%2B%5F%29%2C%20initialize%28%29%2C%20force%29%20%3A%20radius%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Ex%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28x%20%3D%20%2B%5F%2C%20force%29%20%3A%20x%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Ey%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28y%20%3D%20%2B%5F%2C%20force%29%20%3A%20y%3B%0A%20%20%7D%3B%0A%0A%20%20return%20force%3B%0A%7D%0A%0Afunction%20x%242%28x%29%20%7B%0A%20%20var%20strength%20%3D%20constant%247%280%2E1%29%2C%0A%20%20%20%20%20%20nodes%2C%0A%20%20%20%20%20%20strengths%2C%0A%20%20%20%20%20%20xz%3B%0A%0A%20%20if%20%28typeof%20x%20%21%3D%3D%20%22function%22%29%20x%20%3D%20constant%247%28x%20%3D%3D%20null%20%3F%200%20%3A%20%2Bx%29%3B%0A%0A%20%20function%20force%28alpha%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20nodes%2Elength%2C%20node%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%2C%20node%2Evx%20%2B%3D%20%28xz%5Bi%5D%20%2D%20node%2Ex%29%20%2A%20strengths%5Bi%5D%20%2A%20alpha%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20initialize%28%29%20%7B%0A%20%20%20%20if%20%28%21nodes%29%20return%3B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes%2Elength%3B%0A%20%20%20%20strengths%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20xz%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20strengths%5Bi%5D%20%3D%20isNaN%28xz%5Bi%5D%20%3D%20%2Bx%28nodes%5Bi%5D%2C%20i%2C%20nodes%29%29%20%3F%200%20%3A%20%2Bstrength%28nodes%5Bi%5D%2C%20i%2C%20nodes%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20force%2Einitialize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20nodes%20%3D%20%5F%3B%0A%20%20%20%20initialize%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Estrength%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28strength%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%247%28%2B%5F%29%2C%20initialize%28%29%2C%20force%29%20%3A%20strength%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Ex%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28x%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%247%28%2B%5F%29%2C%20initialize%28%29%2C%20force%29%20%3A%20x%3B%0A%20%20%7D%3B%0A%0A%20%20return%20force%3B%0A%7D%0A%0Afunction%20y%242%28y%29%20%7B%0A%20%20var%20strength%20%3D%20constant%247%280%2E1%29%2C%0A%20%20%20%20%20%20nodes%2C%0A%20%20%20%20%20%20strengths%2C%0A%20%20%20%20%20%20yz%3B%0A%0A%20%20if%20%28typeof%20y%20%21%3D%3D%20%22function%22%29%20y%20%3D%20constant%247%28y%20%3D%3D%20null%20%3F%200%20%3A%20%2By%29%3B%0A%0A%20%20function%20force%28alpha%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20nodes%2Elength%2C%20node%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%2C%20node%2Evy%20%2B%3D%20%28yz%5Bi%5D%20%2D%20node%2Ey%29%20%2A%20strengths%5Bi%5D%20%2A%20alpha%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20initialize%28%29%20%7B%0A%20%20%20%20if%20%28%21nodes%29%20return%3B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes%2Elength%3B%0A%20%20%20%20strengths%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20yz%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20strengths%5Bi%5D%20%3D%20isNaN%28yz%5Bi%5D%20%3D%20%2By%28nodes%5Bi%5D%2C%20i%2C%20nodes%29%29%20%3F%200%20%3A%20%2Bstrength%28nodes%5Bi%5D%2C%20i%2C%20nodes%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20force%2Einitialize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20nodes%20%3D%20%5F%3B%0A%20%20%20%20initialize%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Estrength%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28strength%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%247%28%2B%5F%29%2C%20initialize%28%29%2C%20force%29%20%3A%20strength%3B%0A%20%20%7D%3B%0A%0A%20%20force%2Ey%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28y%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%247%28%2B%5F%29%2C%20initialize%28%29%2C%20force%29%20%3A%20y%3B%0A%20%20%7D%3B%0A%0A%20%20return%20force%3B%0A%7D%0A%0A%2F%2F%20Computes%20the%20decimal%20coefficient%20and%20exponent%20of%20the%20specified%20number%20x%20with%0A%2F%2F%20significant%20digits%20p%2C%20where%20x%20is%20positive%20and%20p%20is%20in%20%5B1%2C%2021%5D%20or%20undefined%2E%0A%2F%2F%20For%20example%2C%20formatDecimal%281%2E23%29%20returns%20%5B%22123%22%2C%200%5D%2E%0Afunction%20formatDecimal%28x%2C%20p%29%20%7B%0A%20%20if%20%28%28i%20%3D%20%28x%20%3D%20p%20%3F%20x%2EtoExponential%28p%20%2D%201%29%20%3A%20x%2EtoExponential%28%29%29%2EindexOf%28%22e%22%29%29%20%3C%200%29%20return%20null%3B%20%2F%2F%20NaN%2C%20%C2%B1Infinity%0A%20%20var%20i%2C%20coefficient%20%3D%20x%2Eslice%280%2C%20i%29%3B%0A%0A%20%20%2F%2F%20The%20string%20returned%20by%20toExponential%20either%20has%20the%20form%20%5Cd%5C%2E%5Cd%2Be%5B%2D%2B%5D%5Cd%2B%0A%20%20%2F%2F%20%28e%2Eg%2E%2C%201%2E2e%2B3%29%20or%20the%20form%20%5Cde%5B%2D%2B%5D%5Cd%2B%20%28e%2Eg%2E%2C%201e%2B3%29%2E%0A%20%20return%20%5B%0A%20%20%20%20coefficient%2Elength%20%3E%201%20%3F%20coefficient%5B0%5D%20%2B%20coefficient%2Eslice%282%29%20%3A%20coefficient%2C%0A%20%20%20%20%2Bx%2Eslice%28i%20%2B%201%29%0A%20%20%5D%3B%0A%7D%0A%0Afunction%20exponent%241%28x%29%20%7B%0A%20%20return%20x%20%3D%20formatDecimal%28Math%2Eabs%28x%29%29%2C%20x%20%3F%20x%5B1%5D%20%3A%20NaN%3B%0A%7D%0A%0Afunction%20formatGroup%28grouping%2C%20thousands%29%20%7B%0A%20%20return%20function%28value%2C%20width%29%20%7B%0A%20%20%20%20var%20i%20%3D%20value%2Elength%2C%0A%20%20%20%20%20%20%20%20t%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20j%20%3D%200%2C%0A%20%20%20%20%20%20%20%20g%20%3D%20grouping%5B0%5D%2C%0A%20%20%20%20%20%20%20%20length%20%3D%200%3B%0A%0A%20%20%20%20while%20%28i%20%3E%200%20%26%26%20g%20%3E%200%29%20%7B%0A%20%20%20%20%20%20if%20%28length%20%2B%20g%20%2B%201%20%3E%20width%29%20g%20%3D%20Math%2Emax%281%2C%20width%20%2D%20length%29%3B%0A%20%20%20%20%20%20t%2Epush%28value%2Esubstring%28i%20%2D%3D%20g%2C%20i%20%2B%20g%29%29%3B%0A%20%20%20%20%20%20if%20%28%28length%20%2B%3D%20g%20%2B%201%29%20%3E%20width%29%20break%3B%0A%20%20%20%20%20%20g%20%3D%20grouping%5Bj%20%3D%20%28j%20%2B%201%29%20%25%20grouping%2Elength%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20t%2Ereverse%28%29%2Ejoin%28thousands%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20formatNumerals%28numerals%29%20%7B%0A%20%20return%20function%28value%29%20%7B%0A%20%20%20%20return%20value%2Ereplace%28%2F%5B0%2D9%5D%2Fg%2C%20function%28i%29%20%7B%0A%20%20%20%20%20%20return%20numerals%5B%2Bi%5D%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20formatDefault%28x%2C%20p%29%20%7B%0A%20%20x%20%3D%20x%2EtoPrecision%28p%29%3B%0A%0A%20%20out%3A%20for%20%28var%20n%20%3D%20x%2Elength%2C%20i%20%3D%201%2C%20i0%20%3D%20%2D1%2C%20i1%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20switch%20%28x%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20case%20%22%2E%22%3A%20i0%20%3D%20i1%20%3D%20i%3B%20break%3B%0A%20%20%20%20%20%20case%20%220%22%3A%20if%20%28i0%20%3D%3D%3D%200%29%20i0%20%3D%20i%3B%20i1%20%3D%20i%3B%20break%3B%0A%20%20%20%20%20%20case%20%22e%22%3A%20break%20out%3B%0A%20%20%20%20%20%20default%3A%20if%20%28i0%20%3E%200%29%20i0%20%3D%200%3B%20break%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20i0%20%3E%200%20%3F%20x%2Eslice%280%2C%20i0%29%20%2B%20x%2Eslice%28i1%20%2B%201%29%20%3A%20x%3B%0A%7D%0A%0Avar%20prefixExponent%3B%0A%0Afunction%20formatPrefixAuto%28x%2C%20p%29%20%7B%0A%20%20var%20d%20%3D%20formatDecimal%28x%2C%20p%29%3B%0A%20%20if%20%28%21d%29%20return%20x%20%2B%20%22%22%3B%0A%20%20var%20coefficient%20%3D%20d%5B0%5D%2C%0A%20%20%20%20%20%20exponent%20%3D%20d%5B1%5D%2C%0A%20%20%20%20%20%20i%20%3D%20exponent%20%2D%20%28prefixExponent%20%3D%20Math%2Emax%28%2D8%2C%20Math%2Emin%288%2C%20Math%2Efloor%28exponent%20%2F%203%29%29%29%20%2A%203%29%20%2B%201%2C%0A%20%20%20%20%20%20n%20%3D%20coefficient%2Elength%3B%0A%20%20return%20i%20%3D%3D%3D%20n%20%3F%20coefficient%0A%20%20%20%20%20%20%3A%20i%20%3E%20n%20%3F%20coefficient%20%2B%20new%20Array%28i%20%2D%20n%20%2B%201%29%2Ejoin%28%220%22%29%0A%20%20%20%20%20%20%3A%20i%20%3E%200%20%3F%20coefficient%2Eslice%280%2C%20i%29%20%2B%20%22%2E%22%20%2B%20coefficient%2Eslice%28i%29%0A%20%20%20%20%20%20%3A%20%220%2E%22%20%2B%20new%20Array%281%20%2D%20i%29%2Ejoin%28%220%22%29%20%2B%20formatDecimal%28x%2C%20Math%2Emax%280%2C%20p%20%2B%20i%20%2D%201%29%29%5B0%5D%3B%20%2F%2F%20less%20than%201y%21%0A%7D%0A%0Afunction%20formatRounded%28x%2C%20p%29%20%7B%0A%20%20var%20d%20%3D%20formatDecimal%28x%2C%20p%29%3B%0A%20%20if%20%28%21d%29%20return%20x%20%2B%20%22%22%3B%0A%20%20var%20coefficient%20%3D%20d%5B0%5D%2C%0A%20%20%20%20%20%20exponent%20%3D%20d%5B1%5D%3B%0A%20%20return%20exponent%20%3C%200%20%3F%20%220%2E%22%20%2B%20new%20Array%28%2Dexponent%29%2Ejoin%28%220%22%29%20%2B%20coefficient%0A%20%20%20%20%20%20%3A%20coefficient%2Elength%20%3E%20exponent%20%2B%201%20%3F%20coefficient%2Eslice%280%2C%20exponent%20%2B%201%29%20%2B%20%22%2E%22%20%2B%20coefficient%2Eslice%28exponent%20%2B%201%29%0A%20%20%20%20%20%20%3A%20coefficient%20%2B%20new%20Array%28exponent%20%2D%20coefficient%2Elength%20%2B%202%29%2Ejoin%28%220%22%29%3B%0A%7D%0A%0Avar%20formatTypes%20%3D%20%7B%0A%20%20%22%22%3A%20formatDefault%2C%0A%20%20%22%25%22%3A%20function%28x%2C%20p%29%20%7B%20return%20%28x%20%2A%20100%29%2EtoFixed%28p%29%3B%20%7D%2C%0A%20%20%22b%22%3A%20function%28x%29%20%7B%20return%20Math%2Eround%28x%29%2EtoString%282%29%3B%20%7D%2C%0A%20%20%22c%22%3A%20function%28x%29%20%7B%20return%20x%20%2B%20%22%22%3B%20%7D%2C%0A%20%20%22d%22%3A%20function%28x%29%20%7B%20return%20Math%2Eround%28x%29%2EtoString%2810%29%3B%20%7D%2C%0A%20%20%22e%22%3A%20function%28x%2C%20p%29%20%7B%20return%20x%2EtoExponential%28p%29%3B%20%7D%2C%0A%20%20%22f%22%3A%20function%28x%2C%20p%29%20%7B%20return%20x%2EtoFixed%28p%29%3B%20%7D%2C%0A%20%20%22g%22%3A%20function%28x%2C%20p%29%20%7B%20return%20x%2EtoPrecision%28p%29%3B%20%7D%2C%0A%20%20%22o%22%3A%20function%28x%29%20%7B%20return%20Math%2Eround%28x%29%2EtoString%288%29%3B%20%7D%2C%0A%20%20%22p%22%3A%20function%28x%2C%20p%29%20%7B%20return%20formatRounded%28x%20%2A%20100%2C%20p%29%3B%20%7D%2C%0A%20%20%22r%22%3A%20formatRounded%2C%0A%20%20%22s%22%3A%20formatPrefixAuto%2C%0A%20%20%22X%22%3A%20function%28x%29%20%7B%20return%20Math%2Eround%28x%29%2EtoString%2816%29%2EtoUpperCase%28%29%3B%20%7D%2C%0A%20%20%22x%22%3A%20function%28x%29%20%7B%20return%20Math%2Eround%28x%29%2EtoString%2816%29%3B%20%7D%0A%7D%3B%0A%0A%2F%2F%20%5B%5Bfill%5Dalign%5D%5Bsign%5D%5Bsymbol%5D%5B0%5D%5Bwidth%5D%5B%2C%5D%5B%2Eprecision%5D%5Btype%5D%0Avar%20re%20%3D%20%2F%5E%28%3F%3A%28%2E%29%3F%28%5B%3C%3E%3D%5E%5D%29%29%3F%28%5B%2B%5C%2D%5C%28%20%5D%29%3F%28%5B%24%23%5D%29%3F%280%29%3F%28%5Cd%2B%29%3F%28%2C%29%3F%28%5C%2E%5Cd%2B%29%3F%28%5Ba%2Dz%25%5D%29%3F%24%2Fi%3B%0A%0Afunction%20formatSpecifier%28specifier%29%20%7B%0A%20%20return%20new%20FormatSpecifier%28specifier%29%3B%0A%7D%0A%0AformatSpecifier%2Eprototype%20%3D%20FormatSpecifier%2Eprototype%3B%20%2F%2F%20instanceof%0A%0Afunction%20FormatSpecifier%28specifier%29%20%7B%0A%20%20if%20%28%21%28match%20%3D%20re%2Eexec%28specifier%29%29%29%20throw%20new%20Error%28%22invalid%20format%3A%20%22%20%2B%20specifier%29%3B%0A%0A%20%20var%20match%2C%0A%20%20%20%20%20%20fill%20%3D%20match%5B1%5D%20%7C%7C%20%22%20%22%2C%0A%20%20%20%20%20%20align%20%3D%20match%5B2%5D%20%7C%7C%20%22%3E%22%2C%0A%20%20%20%20%20%20sign%20%3D%20match%5B3%5D%20%7C%7C%20%22%2D%22%2C%0A%20%20%20%20%20%20symbol%20%3D%20match%5B4%5D%20%7C%7C%20%22%22%2C%0A%20%20%20%20%20%20zero%20%3D%20%21%21match%5B5%5D%2C%0A%20%20%20%20%20%20width%20%3D%20match%5B6%5D%20%26%26%20%2Bmatch%5B6%5D%2C%0A%20%20%20%20%20%20comma%20%3D%20%21%21match%5B7%5D%2C%0A%20%20%20%20%20%20precision%20%3D%20match%5B8%5D%20%26%26%20%2Bmatch%5B8%5D%2Eslice%281%29%2C%0A%20%20%20%20%20%20type%20%3D%20match%5B9%5D%20%7C%7C%20%22%22%3B%0A%0A%20%20%2F%2F%20The%20%22n%22%20type%20is%20an%20alias%20for%20%22%2Cg%22%2E%0A%20%20if%20%28type%20%3D%3D%3D%20%22n%22%29%20comma%20%3D%20true%2C%20type%20%3D%20%22g%22%3B%0A%0A%20%20%2F%2F%20Map%20invalid%20types%20to%20the%20default%20format%2E%0A%20%20else%20if%20%28%21formatTypes%5Btype%5D%29%20type%20%3D%20%22%22%3B%0A%0A%20%20%2F%2F%20If%20zero%20fill%20is%20specified%2C%20padding%20goes%20after%20sign%20and%20before%20digits%2E%0A%20%20if%20%28zero%20%7C%7C%20%28fill%20%3D%3D%3D%20%220%22%20%26%26%20align%20%3D%3D%3D%20%22%3D%22%29%29%20zero%20%3D%20true%2C%20fill%20%3D%20%220%22%2C%20align%20%3D%20%22%3D%22%3B%0A%0A%20%20this%2Efill%20%3D%20fill%3B%0A%20%20this%2Ealign%20%3D%20align%3B%0A%20%20this%2Esign%20%3D%20sign%3B%0A%20%20this%2Esymbol%20%3D%20symbol%3B%0A%20%20this%2Ezero%20%3D%20zero%3B%0A%20%20this%2Ewidth%20%3D%20width%3B%0A%20%20this%2Ecomma%20%3D%20comma%3B%0A%20%20this%2Eprecision%20%3D%20precision%3B%0A%20%20this%2Etype%20%3D%20type%3B%0A%7D%0A%0AFormatSpecifier%2Eprototype%2EtoString%20%3D%20function%28%29%20%7B%0A%20%20return%20this%2Efill%0A%20%20%20%20%20%20%2B%20this%2Ealign%0A%20%20%20%20%20%20%2B%20this%2Esign%0A%20%20%20%20%20%20%2B%20this%2Esymbol%0A%20%20%20%20%20%20%2B%20%28this%2Ezero%20%3F%20%220%22%20%3A%20%22%22%29%0A%20%20%20%20%20%20%2B%20%28this%2Ewidth%20%3D%3D%20null%20%3F%20%22%22%20%3A%20Math%2Emax%281%2C%20this%2Ewidth%20%7C%200%29%29%0A%20%20%20%20%20%20%2B%20%28this%2Ecomma%20%3F%20%22%2C%22%20%3A%20%22%22%29%0A%20%20%20%20%20%20%2B%20%28this%2Eprecision%20%3D%3D%20null%20%3F%20%22%22%20%3A%20%22%2E%22%20%2B%20Math%2Emax%280%2C%20this%2Eprecision%20%7C%200%29%29%0A%20%20%20%20%20%20%2B%20this%2Etype%3B%0A%7D%3B%0A%0Afunction%20identity%243%28x%29%20%7B%0A%20%20return%20x%3B%0A%7D%0A%0Avar%20prefixes%20%3D%20%5B%22y%22%2C%22z%22%2C%22a%22%2C%22f%22%2C%22p%22%2C%22n%22%2C%22%5CxB5%22%2C%22m%22%2C%22%22%2C%22k%22%2C%22M%22%2C%22G%22%2C%22T%22%2C%22P%22%2C%22E%22%2C%22Z%22%2C%22Y%22%5D%3B%0A%0Afunction%20formatLocale%28locale%29%20%7B%0A%20%20var%20group%20%3D%20locale%2Egrouping%20%26%26%20locale%2Ethousands%20%3F%20formatGroup%28locale%2Egrouping%2C%20locale%2Ethousands%29%20%3A%20identity%243%2C%0A%20%20%20%20%20%20currency%20%3D%20locale%2Ecurrency%2C%0A%20%20%20%20%20%20decimal%20%3D%20locale%2Edecimal%2C%0A%20%20%20%20%20%20numerals%20%3D%20locale%2Enumerals%20%3F%20formatNumerals%28locale%2Enumerals%29%20%3A%20identity%243%2C%0A%20%20%20%20%20%20percent%20%3D%20locale%2Epercent%20%7C%7C%20%22%25%22%3B%0A%0A%20%20function%20newFormat%28specifier%29%20%7B%0A%20%20%20%20specifier%20%3D%20formatSpecifier%28specifier%29%3B%0A%0A%20%20%20%20var%20fill%20%3D%20specifier%2Efill%2C%0A%20%20%20%20%20%20%20%20align%20%3D%20specifier%2Ealign%2C%0A%20%20%20%20%20%20%20%20sign%20%3D%20specifier%2Esign%2C%0A%20%20%20%20%20%20%20%20symbol%20%3D%20specifier%2Esymbol%2C%0A%20%20%20%20%20%20%20%20zero%20%3D%20specifier%2Ezero%2C%0A%20%20%20%20%20%20%20%20width%20%3D%20specifier%2Ewidth%2C%0A%20%20%20%20%20%20%20%20comma%20%3D%20specifier%2Ecomma%2C%0A%20%20%20%20%20%20%20%20precision%20%3D%20specifier%2Eprecision%2C%0A%20%20%20%20%20%20%20%20type%20%3D%20specifier%2Etype%3B%0A%0A%20%20%20%20%2F%2F%20Compute%20the%20prefix%20and%20suffix%2E%0A%20%20%20%20%2F%2F%20For%20SI%2Dprefix%2C%20the%20suffix%20is%20lazily%20computed%2E%0A%20%20%20%20var%20prefix%20%3D%20symbol%20%3D%3D%3D%20%22%24%22%20%3F%20currency%5B0%5D%20%3A%20symbol%20%3D%3D%3D%20%22%23%22%20%26%26%20%2F%5BboxX%5D%2F%2Etest%28type%29%20%3F%20%220%22%20%2B%20type%2EtoLowerCase%28%29%20%3A%20%22%22%2C%0A%20%20%20%20%20%20%20%20suffix%20%3D%20symbol%20%3D%3D%3D%20%22%24%22%20%3F%20currency%5B1%5D%20%3A%20%2F%5B%25p%5D%2F%2Etest%28type%29%20%3F%20percent%20%3A%20%22%22%3B%0A%0A%20%20%20%20%2F%2F%20What%20format%20function%20should%20we%20use%3F%0A%20%20%20%20%2F%2F%20Is%20this%20an%20integer%20type%3F%0A%20%20%20%20%2F%2F%20Can%20this%20type%20generate%20exponential%20notation%3F%0A%20%20%20%20var%20formatType%20%3D%20formatTypes%5Btype%5D%2C%0A%20%20%20%20%20%20%20%20maybeSuffix%20%3D%20%21type%20%7C%7C%20%2F%5Bdefgprs%25%5D%2F%2Etest%28type%29%3B%0A%0A%20%20%20%20%2F%2F%20Set%20the%20default%20precision%20if%20not%20specified%2C%0A%20%20%20%20%2F%2F%20or%20clamp%20the%20specified%20precision%20to%20the%20supported%20range%2E%0A%20%20%20%20%2F%2F%20For%20significant%20precision%2C%20it%20must%20be%20in%20%5B1%2C%2021%5D%2E%0A%20%20%20%20%2F%2F%20For%20fixed%20precision%2C%20it%20must%20be%20in%20%5B0%2C%2020%5D%2E%0A%20%20%20%20precision%20%3D%20precision%20%3D%3D%20null%20%3F%20%28type%20%3F%206%20%3A%2012%29%0A%20%20%20%20%20%20%20%20%3A%20%2F%5Bgprs%5D%2F%2Etest%28type%29%20%3F%20Math%2Emax%281%2C%20Math%2Emin%2821%2C%20precision%29%29%0A%20%20%20%20%20%20%20%20%3A%20Math%2Emax%280%2C%20Math%2Emin%2820%2C%20precision%29%29%3B%0A%0A%20%20%20%20function%20format%28value%29%20%7B%0A%20%20%20%20%20%20var%20valuePrefix%20%3D%20prefix%2C%0A%20%20%20%20%20%20%20%20%20%20valueSuffix%20%3D%20suffix%2C%0A%20%20%20%20%20%20%20%20%20%20i%2C%20n%2C%20c%3B%0A%0A%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20%22c%22%29%20%7B%0A%20%20%20%20%20%20%20%20valueSuffix%20%3D%20formatType%28value%29%20%2B%20valueSuffix%3B%0A%20%20%20%20%20%20%20%20value%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20value%20%3D%20%2Bvalue%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Perform%20the%20initial%20formatting%2E%0A%20%20%20%20%20%20%20%20var%20valueNegative%20%3D%20value%20%3C%200%3B%0A%20%20%20%20%20%20%20%20value%20%3D%20formatType%28Math%2Eabs%28value%29%2C%20precision%29%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20If%20a%20negative%20value%20rounds%20to%20zero%20during%20formatting%2C%20treat%20as%20positive%2E%0A%20%20%20%20%20%20%20%20if%20%28valueNegative%20%26%26%20%2Bvalue%20%3D%3D%3D%200%29%20valueNegative%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Compute%20the%20prefix%20and%20suffix%2E%0A%20%20%20%20%20%20%20%20valuePrefix%20%3D%20%28valueNegative%20%3F%20%28sign%20%3D%3D%3D%20%22%28%22%20%3F%20sign%20%3A%20%22%2D%22%29%20%3A%20sign%20%3D%3D%3D%20%22%2D%22%20%7C%7C%20sign%20%3D%3D%3D%20%22%28%22%20%3F%20%22%22%20%3A%20sign%29%20%2B%20valuePrefix%3B%0A%20%20%20%20%20%20%20%20valueSuffix%20%3D%20%28type%20%3D%3D%3D%20%22s%22%20%3F%20prefixes%5B8%20%2B%20prefixExponent%20%2F%203%5D%20%3A%20%22%22%29%20%2B%20valueSuffix%20%2B%20%28valueNegative%20%26%26%20sign%20%3D%3D%3D%20%22%28%22%20%3F%20%22%29%22%20%3A%20%22%22%29%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Break%20the%20formatted%20value%20into%20the%20integer%20%E2%80%9Cvalue%E2%80%9D%20part%20that%20can%20be%0A%20%20%20%20%20%20%20%20%2F%2F%20grouped%2C%20and%20fractional%20or%20exponential%20%E2%80%9Csuffix%E2%80%9D%20part%20that%20is%20not%2E%0A%20%20%20%20%20%20%20%20if%20%28maybeSuffix%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20i%20%3D%20%2D1%2C%20n%20%3D%20value%2Elength%3B%0A%20%20%20%20%20%20%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28c%20%3D%20value%2EcharCodeAt%28i%29%2C%2048%20%3E%20c%20%7C%7C%20c%20%3E%2057%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20valueSuffix%20%3D%20%28c%20%3D%3D%3D%2046%20%3F%20decimal%20%2B%20value%2Eslice%28i%20%2B%201%29%20%3A%20value%2Eslice%28i%29%29%20%2B%20valueSuffix%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20value%20%3D%20value%2Eslice%280%2C%20i%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20If%20the%20fill%20character%20is%20not%20%220%22%2C%20grouping%20is%20applied%20before%20padding%2E%0A%20%20%20%20%20%20if%20%28comma%20%26%26%20%21zero%29%20value%20%3D%20group%28value%2C%20Infinity%29%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Compute%20the%20padding%2E%0A%20%20%20%20%20%20var%20length%20%3D%20valuePrefix%2Elength%20%2B%20value%2Elength%20%2B%20valueSuffix%2Elength%2C%0A%20%20%20%20%20%20%20%20%20%20padding%20%3D%20length%20%3C%20width%20%3F%20new%20Array%28width%20%2D%20length%20%2B%201%29%2Ejoin%28fill%29%20%3A%20%22%22%3B%0A%0A%20%20%20%20%20%20%2F%2F%20If%20the%20fill%20character%20is%20%220%22%2C%20grouping%20is%20applied%20after%20padding%2E%0A%20%20%20%20%20%20if%20%28comma%20%26%26%20zero%29%20value%20%3D%20group%28padding%20%2B%20value%2C%20padding%2Elength%20%3F%20width%20%2D%20valueSuffix%2Elength%20%3A%20Infinity%29%2C%20padding%20%3D%20%22%22%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Reconstruct%20the%20final%20output%20based%20on%20the%20desired%20alignment%2E%0A%20%20%20%20%20%20switch%20%28align%29%20%7B%0A%20%20%20%20%20%20%20%20case%20%22%3C%22%3A%20value%20%3D%20valuePrefix%20%2B%20value%20%2B%20valueSuffix%20%2B%20padding%3B%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22%3D%22%3A%20value%20%3D%20valuePrefix%20%2B%20padding%20%2B%20value%20%2B%20valueSuffix%3B%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22%5E%22%3A%20value%20%3D%20padding%2Eslice%280%2C%20length%20%3D%20padding%2Elength%20%3E%3E%201%29%20%2B%20valuePrefix%20%2B%20value%20%2B%20valueSuffix%20%2B%20padding%2Eslice%28length%29%3B%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%20value%20%3D%20padding%20%2B%20valuePrefix%20%2B%20value%20%2B%20valueSuffix%3B%20break%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20return%20numerals%28value%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20format%2EtoString%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20specifier%20%2B%20%22%22%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20return%20format%3B%0A%20%20%7D%0A%0A%20%20function%20formatPrefix%28specifier%2C%20value%29%20%7B%0A%20%20%20%20var%20f%20%3D%20newFormat%28%28specifier%20%3D%20formatSpecifier%28specifier%29%2C%20specifier%2Etype%20%3D%20%22f%22%2C%20specifier%29%29%2C%0A%20%20%20%20%20%20%20%20e%20%3D%20Math%2Emax%28%2D8%2C%20Math%2Emin%288%2C%20Math%2Efloor%28exponent%241%28value%29%20%2F%203%29%29%29%20%2A%203%2C%0A%20%20%20%20%20%20%20%20k%20%3D%20Math%2Epow%2810%2C%20%2De%29%2C%0A%20%20%20%20%20%20%20%20prefix%20%3D%20prefixes%5B8%20%2B%20e%20%2F%203%5D%3B%0A%20%20%20%20return%20function%28value%29%20%7B%0A%20%20%20%20%20%20return%20f%28k%20%2A%20value%29%20%2B%20prefix%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20return%20%7B%0A%20%20%20%20format%3A%20newFormat%2C%0A%20%20%20%20formatPrefix%3A%20formatPrefix%0A%20%20%7D%3B%0A%7D%0A%0Avar%20locale%3B%0A%0AdefaultLocale%28%7B%0A%20%20decimal%3A%20%22%2E%22%2C%0A%20%20thousands%3A%20%22%2C%22%2C%0A%20%20grouping%3A%20%5B3%5D%2C%0A%20%20currency%3A%20%5B%22%24%22%2C%20%22%22%5D%0A%7D%29%3B%0A%0Afunction%20defaultLocale%28definition%29%20%7B%0A%20%20locale%20%3D%20formatLocale%28definition%29%3B%0A%20%20exports%2Eformat%20%3D%20locale%2Eformat%3B%0A%20%20exports%2EformatPrefix%20%3D%20locale%2EformatPrefix%3B%0A%20%20return%20locale%3B%0A%7D%0A%0Afunction%20precisionFixed%28step%29%20%7B%0A%20%20return%20Math%2Emax%280%2C%20%2Dexponent%241%28Math%2Eabs%28step%29%29%29%3B%0A%7D%0A%0Afunction%20precisionPrefix%28step%2C%20value%29%20%7B%0A%20%20return%20Math%2Emax%280%2C%20Math%2Emax%28%2D8%2C%20Math%2Emin%288%2C%20Math%2Efloor%28exponent%241%28value%29%20%2F%203%29%29%29%20%2A%203%20%2D%20exponent%241%28Math%2Eabs%28step%29%29%29%3B%0A%7D%0A%0Afunction%20precisionRound%28step%2C%20max%29%20%7B%0A%20%20step%20%3D%20Math%2Eabs%28step%29%2C%20max%20%3D%20Math%2Eabs%28max%29%20%2D%20step%3B%0A%20%20return%20Math%2Emax%280%2C%20exponent%241%28max%29%20%2D%20exponent%241%28step%29%29%20%2B%201%3B%0A%7D%0A%0A%2F%2F%20Adds%20floating%20point%20numbers%20with%20twice%20the%20normal%20precision%2E%0A%2F%2F%20Reference%3A%20J%2E%20R%2E%20Shewchuk%2C%20Adaptive%20Precision%20Floating%2DPoint%20Arithmetic%20and%0A%2F%2F%20Fast%20Robust%20Geometric%20Predicates%2C%20Discrete%20%26%20Computational%20Geometry%2018%283%29%0A%2F%2F%20305%E2%80%93363%20%281997%29%2E%0A%2F%2F%20Code%20adapted%20from%20GeographicLib%20by%20Charles%20F%2E%20F%2E%20Karney%2C%0A%2F%2F%20http%3A%2F%2Fgeographiclib%2Esourceforge%2Enet%2F%0A%0Afunction%20adder%28%29%20%7B%0A%20%20return%20new%20Adder%3B%0A%7D%0A%0Afunction%20Adder%28%29%20%7B%0A%20%20this%2Ereset%28%29%3B%0A%7D%0A%0AAdder%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20Adder%2C%0A%20%20reset%3A%20function%28%29%20%7B%0A%20%20%20%20this%2Es%20%3D%20%2F%2F%20rounded%20value%0A%20%20%20%20this%2Et%20%3D%200%3B%20%2F%2F%20exact%20error%0A%20%20%7D%2C%0A%20%20add%3A%20function%28y%29%20%7B%0A%20%20%20%20add%241%28temp%2C%20y%2C%20this%2Et%29%3B%0A%20%20%20%20add%241%28this%2C%20temp%2Es%2C%20this%2Es%29%3B%0A%20%20%20%20if%20%28this%2Es%29%20this%2Et%20%2B%3D%20temp%2Et%3B%0A%20%20%20%20else%20this%2Es%20%3D%20temp%2Et%3B%0A%20%20%7D%2C%0A%20%20valueOf%3A%20function%28%29%20%7B%0A%20%20%20%20return%20this%2Es%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20temp%20%3D%20new%20Adder%3B%0A%0Afunction%20add%241%28adder%2C%20a%2C%20b%29%20%7B%0A%20%20var%20x%20%3D%20adder%2Es%20%3D%20a%20%2B%20b%2C%0A%20%20%20%20%20%20bv%20%3D%20x%20%2D%20a%2C%0A%20%20%20%20%20%20av%20%3D%20x%20%2D%20bv%3B%0A%20%20adder%2Et%20%3D%20%28a%20%2D%20av%29%20%2B%20%28b%20%2D%20bv%29%3B%0A%7D%0A%0Avar%20epsilon%242%20%3D%201e%2D6%3B%0Avar%20epsilon2%241%20%3D%201e%2D12%3B%0Avar%20pi%243%20%3D%20Math%2EPI%3B%0Avar%20halfPi%242%20%3D%20pi%243%20%2F%202%3B%0Avar%20quarterPi%20%3D%20pi%243%20%2F%204%3B%0Avar%20tau%243%20%3D%20pi%243%20%2A%202%3B%0A%0Avar%20degrees%241%20%3D%20180%20%2F%20pi%243%3B%0Avar%20radians%20%3D%20pi%243%20%2F%20180%3B%0A%0Avar%20abs%20%3D%20Math%2Eabs%3B%0Avar%20atan%20%3D%20Math%2Eatan%3B%0Avar%20atan2%20%3D%20Math%2Eatan2%3B%0Avar%20cos%241%20%3D%20Math%2Ecos%3B%0Avar%20ceil%20%3D%20Math%2Eceil%3B%0Avar%20exp%20%3D%20Math%2Eexp%3B%0Avar%20log%20%3D%20Math%2Elog%3B%0Avar%20pow%20%3D%20Math%2Epow%3B%0Avar%20sin%241%20%3D%20Math%2Esin%3B%0Avar%20sign%20%3D%20Math%2Esign%20%7C%7C%20function%28x%29%20%7B%20return%20x%20%3E%200%20%3F%201%20%3A%20x%20%3C%200%20%3F%20%2D1%20%3A%200%3B%20%7D%3B%0Avar%20sqrt%20%3D%20Math%2Esqrt%3B%0Avar%20tan%20%3D%20Math%2Etan%3B%0A%0Afunction%20acos%28x%29%20%7B%0A%20%20return%20x%20%3E%201%20%3F%200%20%3A%20x%20%3C%20%2D1%20%3F%20pi%243%20%3A%20Math%2Eacos%28x%29%3B%0A%7D%0A%0Afunction%20asin%28x%29%20%7B%0A%20%20return%20x%20%3E%201%20%3F%20halfPi%242%20%3A%20x%20%3C%20%2D1%20%3F%20%2DhalfPi%242%20%3A%20Math%2Easin%28x%29%3B%0A%7D%0A%0Afunction%20haversin%28x%29%20%7B%0A%20%20return%20%28x%20%3D%20sin%241%28x%20%2F%202%29%29%20%2A%20x%3B%0A%7D%0A%0Afunction%20noop%242%28%29%20%7B%7D%0A%0Afunction%20streamGeometry%28geometry%2C%20stream%29%20%7B%0A%20%20if%20%28geometry%20%26%26%20streamGeometryType%2EhasOwnProperty%28geometry%2Etype%29%29%20%7B%0A%20%20%20%20streamGeometryType%5Bgeometry%2Etype%5D%28geometry%2C%20stream%29%3B%0A%20%20%7D%0A%7D%0A%0Avar%20streamObjectType%20%3D%20%7B%0A%20%20Feature%3A%20function%28object%2C%20stream%29%20%7B%0A%20%20%20%20streamGeometry%28object%2Egeometry%2C%20stream%29%3B%0A%20%20%7D%2C%0A%20%20FeatureCollection%3A%20function%28object%2C%20stream%29%20%7B%0A%20%20%20%20var%20features%20%3D%20object%2Efeatures%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20features%2Elength%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20streamGeometry%28features%5Bi%5D%2Egeometry%2C%20stream%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20streamGeometryType%20%3D%20%7B%0A%20%20Sphere%3A%20function%28object%2C%20stream%29%20%7B%0A%20%20%20%20stream%2Esphere%28%29%3B%0A%20%20%7D%2C%0A%20%20Point%3A%20function%28object%2C%20stream%29%20%7B%0A%20%20%20%20object%20%3D%20object%2Ecoordinates%3B%0A%20%20%20%20stream%2Epoint%28object%5B0%5D%2C%20object%5B1%5D%2C%20object%5B2%5D%29%3B%0A%20%20%7D%2C%0A%20%20MultiPoint%3A%20function%28object%2C%20stream%29%20%7B%0A%20%20%20%20var%20coordinates%20%3D%20object%2Ecoordinates%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20coordinates%2Elength%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20object%20%3D%20coordinates%5Bi%5D%2C%20stream%2Epoint%28object%5B0%5D%2C%20object%5B1%5D%2C%20object%5B2%5D%29%3B%0A%20%20%7D%2C%0A%20%20LineString%3A%20function%28object%2C%20stream%29%20%7B%0A%20%20%20%20streamLine%28object%2Ecoordinates%2C%20stream%2C%200%29%3B%0A%20%20%7D%2C%0A%20%20MultiLineString%3A%20function%28object%2C%20stream%29%20%7B%0A%20%20%20%20var%20coordinates%20%3D%20object%2Ecoordinates%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20coordinates%2Elength%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20streamLine%28coordinates%5Bi%5D%2C%20stream%2C%200%29%3B%0A%20%20%7D%2C%0A%20%20Polygon%3A%20function%28object%2C%20stream%29%20%7B%0A%20%20%20%20streamPolygon%28object%2Ecoordinates%2C%20stream%29%3B%0A%20%20%7D%2C%0A%20%20MultiPolygon%3A%20function%28object%2C%20stream%29%20%7B%0A%20%20%20%20var%20coordinates%20%3D%20object%2Ecoordinates%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20coordinates%2Elength%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20streamPolygon%28coordinates%5Bi%5D%2C%20stream%29%3B%0A%20%20%7D%2C%0A%20%20GeometryCollection%3A%20function%28object%2C%20stream%29%20%7B%0A%20%20%20%20var%20geometries%20%3D%20object%2Egeometries%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20geometries%2Elength%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20streamGeometry%28geometries%5Bi%5D%2C%20stream%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20streamLine%28coordinates%2C%20stream%2C%20closed%29%20%7B%0A%20%20var%20i%20%3D%20%2D1%2C%20n%20%3D%20coordinates%2Elength%20%2D%20closed%2C%20coordinate%3B%0A%20%20stream%2ElineStart%28%29%3B%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20coordinate%20%3D%20coordinates%5Bi%5D%2C%20stream%2Epoint%28coordinate%5B0%5D%2C%20coordinate%5B1%5D%2C%20coordinate%5B2%5D%29%3B%0A%20%20stream%2ElineEnd%28%29%3B%0A%7D%0A%0Afunction%20streamPolygon%28coordinates%2C%20stream%29%20%7B%0A%20%20var%20i%20%3D%20%2D1%2C%20n%20%3D%20coordinates%2Elength%3B%0A%20%20stream%2EpolygonStart%28%29%3B%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20streamLine%28coordinates%5Bi%5D%2C%20stream%2C%201%29%3B%0A%20%20stream%2EpolygonEnd%28%29%3B%0A%7D%0A%0Afunction%20geoStream%28object%2C%20stream%29%20%7B%0A%20%20if%20%28object%20%26%26%20streamObjectType%2EhasOwnProperty%28object%2Etype%29%29%20%7B%0A%20%20%20%20streamObjectType%5Bobject%2Etype%5D%28object%2C%20stream%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20streamGeometry%28object%2C%20stream%29%3B%0A%20%20%7D%0A%7D%0A%0Avar%20areaRingSum%20%3D%20adder%28%29%3B%0A%0Avar%20areaSum%20%3D%20adder%28%29%2C%0A%20%20%20%20lambda00%2C%0A%20%20%20%20phi00%2C%0A%20%20%20%20lambda0%2C%0A%20%20%20%20cosPhi0%2C%0A%20%20%20%20sinPhi0%3B%0A%0Avar%20areaStream%20%3D%20%7B%0A%20%20point%3A%20noop%242%2C%0A%20%20lineStart%3A%20noop%242%2C%0A%20%20lineEnd%3A%20noop%242%2C%0A%20%20polygonStart%3A%20function%28%29%20%7B%0A%20%20%20%20areaRingSum%2Ereset%28%29%3B%0A%20%20%20%20areaStream%2ElineStart%20%3D%20areaRingStart%3B%0A%20%20%20%20areaStream%2ElineEnd%20%3D%20areaRingEnd%3B%0A%20%20%7D%2C%0A%20%20polygonEnd%3A%20function%28%29%20%7B%0A%20%20%20%20var%20areaRing%20%3D%20%2BareaRingSum%3B%0A%20%20%20%20areaSum%2Eadd%28areaRing%20%3C%200%20%3F%20tau%243%20%2B%20areaRing%20%3A%20areaRing%29%3B%0A%20%20%20%20this%2ElineStart%20%3D%20this%2ElineEnd%20%3D%20this%2Epoint%20%3D%20noop%242%3B%0A%20%20%7D%2C%0A%20%20sphere%3A%20function%28%29%20%7B%0A%20%20%20%20areaSum%2Eadd%28tau%243%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20areaRingStart%28%29%20%7B%0A%20%20areaStream%2Epoint%20%3D%20areaPointFirst%3B%0A%7D%0A%0Afunction%20areaRingEnd%28%29%20%7B%0A%20%20areaPoint%28lambda00%2C%20phi00%29%3B%0A%7D%0A%0Afunction%20areaPointFirst%28lambda%2C%20phi%29%20%7B%0A%20%20areaStream%2Epoint%20%3D%20areaPoint%3B%0A%20%20lambda00%20%3D%20lambda%2C%20phi00%20%3D%20phi%3B%0A%20%20lambda%20%2A%3D%20radians%2C%20phi%20%2A%3D%20radians%3B%0A%20%20lambda0%20%3D%20lambda%2C%20cosPhi0%20%3D%20cos%241%28phi%20%3D%20phi%20%2F%202%20%2B%20quarterPi%29%2C%20sinPhi0%20%3D%20sin%241%28phi%29%3B%0A%7D%0A%0Afunction%20areaPoint%28lambda%2C%20phi%29%20%7B%0A%20%20lambda%20%2A%3D%20radians%2C%20phi%20%2A%3D%20radians%3B%0A%20%20phi%20%3D%20phi%20%2F%202%20%2B%20quarterPi%3B%20%2F%2F%20half%20the%20angular%20distance%20from%20south%20pole%0A%0A%20%20%2F%2F%20Spherical%20excess%20E%20for%20a%20spherical%20triangle%20with%20vertices%3A%20south%20pole%2C%0A%20%20%2F%2F%20previous%20point%2C%20current%20point%2E%20%20Uses%20a%20formula%20derived%20from%20Cagnoli%E2%80%99s%0A%20%20%2F%2F%20theorem%2E%20%20See%20Todhunter%2C%20Spherical%20Trig%2E%20%281871%29%2C%20Sec%2E%20103%2C%20Eq%2E%20%282%29%2E%0A%20%20var%20dLambda%20%3D%20lambda%20%2D%20lambda0%2C%0A%20%20%20%20%20%20sdLambda%20%3D%20dLambda%20%3E%3D%200%20%3F%201%20%3A%20%2D1%2C%0A%20%20%20%20%20%20adLambda%20%3D%20sdLambda%20%2A%20dLambda%2C%0A%20%20%20%20%20%20cosPhi%20%3D%20cos%241%28phi%29%2C%0A%20%20%20%20%20%20sinPhi%20%3D%20sin%241%28phi%29%2C%0A%20%20%20%20%20%20k%20%3D%20sinPhi0%20%2A%20sinPhi%2C%0A%20%20%20%20%20%20u%20%3D%20cosPhi0%20%2A%20cosPhi%20%2B%20k%20%2A%20cos%241%28adLambda%29%2C%0A%20%20%20%20%20%20v%20%3D%20k%20%2A%20sdLambda%20%2A%20sin%241%28adLambda%29%3B%0A%20%20areaRingSum%2Eadd%28atan2%28v%2C%20u%29%29%3B%0A%0A%20%20%2F%2F%20Advance%20the%20previous%20points%2E%0A%20%20lambda0%20%3D%20lambda%2C%20cosPhi0%20%3D%20cosPhi%2C%20sinPhi0%20%3D%20sinPhi%3B%0A%7D%0A%0Afunction%20area%241%28object%29%20%7B%0A%20%20areaSum%2Ereset%28%29%3B%0A%20%20geoStream%28object%2C%20areaStream%29%3B%0A%20%20return%20areaSum%20%2A%202%3B%0A%7D%0A%0Afunction%20spherical%28cartesian%29%20%7B%0A%20%20return%20%5Batan2%28cartesian%5B1%5D%2C%20cartesian%5B0%5D%29%2C%20asin%28cartesian%5B2%5D%29%5D%3B%0A%7D%0A%0Afunction%20cartesian%28spherical%29%20%7B%0A%20%20var%20lambda%20%3D%20spherical%5B0%5D%2C%20phi%20%3D%20spherical%5B1%5D%2C%20cosPhi%20%3D%20cos%241%28phi%29%3B%0A%20%20return%20%5BcosPhi%20%2A%20cos%241%28lambda%29%2C%20cosPhi%20%2A%20sin%241%28lambda%29%2C%20sin%241%28phi%29%5D%3B%0A%7D%0A%0Afunction%20cartesianDot%28a%2C%20b%29%20%7B%0A%20%20return%20a%5B0%5D%20%2A%20b%5B0%5D%20%2B%20a%5B1%5D%20%2A%20b%5B1%5D%20%2B%20a%5B2%5D%20%2A%20b%5B2%5D%3B%0A%7D%0A%0Afunction%20cartesianCross%28a%2C%20b%29%20%7B%0A%20%20return%20%5Ba%5B1%5D%20%2A%20b%5B2%5D%20%2D%20a%5B2%5D%20%2A%20b%5B1%5D%2C%20a%5B2%5D%20%2A%20b%5B0%5D%20%2D%20a%5B0%5D%20%2A%20b%5B2%5D%2C%20a%5B0%5D%20%2A%20b%5B1%5D%20%2D%20a%5B1%5D%20%2A%20b%5B0%5D%5D%3B%0A%7D%0A%0A%2F%2F%20TODO%20return%20a%0Afunction%20cartesianAddInPlace%28a%2C%20b%29%20%7B%0A%20%20a%5B0%5D%20%2B%3D%20b%5B0%5D%2C%20a%5B1%5D%20%2B%3D%20b%5B1%5D%2C%20a%5B2%5D%20%2B%3D%20b%5B2%5D%3B%0A%7D%0A%0Afunction%20cartesianScale%28vector%2C%20k%29%20%7B%0A%20%20return%20%5Bvector%5B0%5D%20%2A%20k%2C%20vector%5B1%5D%20%2A%20k%2C%20vector%5B2%5D%20%2A%20k%5D%3B%0A%7D%0A%0A%2F%2F%20TODO%20return%20d%0Afunction%20cartesianNormalizeInPlace%28d%29%20%7B%0A%20%20var%20l%20%3D%20sqrt%28d%5B0%5D%20%2A%20d%5B0%5D%20%2B%20d%5B1%5D%20%2A%20d%5B1%5D%20%2B%20d%5B2%5D%20%2A%20d%5B2%5D%29%3B%0A%20%20d%5B0%5D%20%2F%3D%20l%2C%20d%5B1%5D%20%2F%3D%20l%2C%20d%5B2%5D%20%2F%3D%20l%3B%0A%7D%0A%0Avar%20lambda0%241%2C%20phi0%2C%20lambda1%2C%20phi1%2C%20%2F%2F%20bounds%0A%20%20%20%20lambda2%2C%20%2F%2F%20previous%20lambda%2Dcoordinate%0A%20%20%20%20lambda00%241%2C%20phi00%241%2C%20%2F%2F%20first%20point%0A%20%20%20%20p0%2C%20%2F%2F%20previous%203D%20point%0A%20%20%20%20deltaSum%20%3D%20adder%28%29%2C%0A%20%20%20%20ranges%2C%0A%20%20%20%20range%3B%0A%0Avar%20boundsStream%20%3D%20%7B%0A%20%20point%3A%20boundsPoint%2C%0A%20%20lineStart%3A%20boundsLineStart%2C%0A%20%20lineEnd%3A%20boundsLineEnd%2C%0A%20%20polygonStart%3A%20function%28%29%20%7B%0A%20%20%20%20boundsStream%2Epoint%20%3D%20boundsRingPoint%3B%0A%20%20%20%20boundsStream%2ElineStart%20%3D%20boundsRingStart%3B%0A%20%20%20%20boundsStream%2ElineEnd%20%3D%20boundsRingEnd%3B%0A%20%20%20%20deltaSum%2Ereset%28%29%3B%0A%20%20%20%20areaStream%2EpolygonStart%28%29%3B%0A%20%20%7D%2C%0A%20%20polygonEnd%3A%20function%28%29%20%7B%0A%20%20%20%20areaStream%2EpolygonEnd%28%29%3B%0A%20%20%20%20boundsStream%2Epoint%20%3D%20boundsPoint%3B%0A%20%20%20%20boundsStream%2ElineStart%20%3D%20boundsLineStart%3B%0A%20%20%20%20boundsStream%2ElineEnd%20%3D%20boundsLineEnd%3B%0A%20%20%20%20if%20%28areaRingSum%20%3C%200%29%20lambda0%241%20%3D%20%2D%28lambda1%20%3D%20180%29%2C%20phi0%20%3D%20%2D%28phi1%20%3D%2090%29%3B%0A%20%20%20%20else%20if%20%28deltaSum%20%3E%20epsilon%242%29%20phi1%20%3D%2090%3B%0A%20%20%20%20else%20if%20%28deltaSum%20%3C%20%2Depsilon%242%29%20phi0%20%3D%20%2D90%3B%0A%20%20%20%20range%5B0%5D%20%3D%20lambda0%241%2C%20range%5B1%5D%20%3D%20lambda1%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20boundsPoint%28lambda%2C%20phi%29%20%7B%0A%20%20ranges%2Epush%28range%20%3D%20%5Blambda0%241%20%3D%20lambda%2C%20lambda1%20%3D%20lambda%5D%29%3B%0A%20%20if%20%28phi%20%3C%20phi0%29%20phi0%20%3D%20phi%3B%0A%20%20if%20%28phi%20%3E%20phi1%29%20phi1%20%3D%20phi%3B%0A%7D%0A%0Afunction%20linePoint%28lambda%2C%20phi%29%20%7B%0A%20%20var%20p%20%3D%20cartesian%28%5Blambda%20%2A%20radians%2C%20phi%20%2A%20radians%5D%29%3B%0A%20%20if%20%28p0%29%20%7B%0A%20%20%20%20var%20normal%20%3D%20cartesianCross%28p0%2C%20p%29%2C%0A%20%20%20%20%20%20%20%20equatorial%20%3D%20%5Bnormal%5B1%5D%2C%20%2Dnormal%5B0%5D%2C%200%5D%2C%0A%20%20%20%20%20%20%20%20inflection%20%3D%20cartesianCross%28equatorial%2C%20normal%29%3B%0A%20%20%20%20cartesianNormalizeInPlace%28inflection%29%3B%0A%20%20%20%20inflection%20%3D%20spherical%28inflection%29%3B%0A%20%20%20%20var%20delta%20%3D%20lambda%20%2D%20lambda2%2C%0A%20%20%20%20%20%20%20%20sign%24%241%20%3D%20delta%20%3E%200%20%3F%201%20%3A%20%2D1%2C%0A%20%20%20%20%20%20%20%20lambdai%20%3D%20inflection%5B0%5D%20%2A%20degrees%241%20%2A%20sign%24%241%2C%0A%20%20%20%20%20%20%20%20phii%2C%0A%20%20%20%20%20%20%20%20antimeridian%20%3D%20abs%28delta%29%20%3E%20180%3B%0A%20%20%20%20if%20%28antimeridian%20%5E%20%28sign%24%241%20%2A%20lambda2%20%3C%20lambdai%20%26%26%20lambdai%20%3C%20sign%24%241%20%2A%20lambda%29%29%20%7B%0A%20%20%20%20%20%20phii%20%3D%20inflection%5B1%5D%20%2A%20degrees%241%3B%0A%20%20%20%20%20%20if%20%28phii%20%3E%20phi1%29%20phi1%20%3D%20phii%3B%0A%20%20%20%20%7D%20else%20if%20%28lambdai%20%3D%20%28lambdai%20%2B%20360%29%20%25%20360%20%2D%20180%2C%20antimeridian%20%5E%20%28sign%24%241%20%2A%20lambda2%20%3C%20lambdai%20%26%26%20lambdai%20%3C%20sign%24%241%20%2A%20lambda%29%29%20%7B%0A%20%20%20%20%20%20phii%20%3D%20%2Dinflection%5B1%5D%20%2A%20degrees%241%3B%0A%20%20%20%20%20%20if%20%28phii%20%3C%20phi0%29%20phi0%20%3D%20phii%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28phi%20%3C%20phi0%29%20phi0%20%3D%20phi%3B%0A%20%20%20%20%20%20if%20%28phi%20%3E%20phi1%29%20phi1%20%3D%20phi%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28antimeridian%29%20%7B%0A%20%20%20%20%20%20if%20%28lambda%20%3C%20lambda2%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28angle%28lambda0%241%2C%20lambda%29%20%3E%20angle%28lambda0%241%2C%20lambda1%29%29%20lambda1%20%3D%20lambda%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28angle%28lambda%2C%20lambda1%29%20%3E%20angle%28lambda0%241%2C%20lambda1%29%29%20lambda0%241%20%3D%20lambda%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28lambda1%20%3E%3D%20lambda0%241%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28lambda%20%3C%20lambda0%241%29%20lambda0%241%20%3D%20lambda%3B%0A%20%20%20%20%20%20%20%20if%20%28lambda%20%3E%20lambda1%29%20lambda1%20%3D%20lambda%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28lambda%20%3E%20lambda2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28angle%28lambda0%241%2C%20lambda%29%20%3E%20angle%28lambda0%241%2C%20lambda1%29%29%20lambda1%20%3D%20lambda%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28angle%28lambda%2C%20lambda1%29%20%3E%20angle%28lambda0%241%2C%20lambda1%29%29%20lambda0%241%20%3D%20lambda%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20ranges%2Epush%28range%20%3D%20%5Blambda0%241%20%3D%20lambda%2C%20lambda1%20%3D%20lambda%5D%29%3B%0A%20%20%7D%0A%20%20if%20%28phi%20%3C%20phi0%29%20phi0%20%3D%20phi%3B%0A%20%20if%20%28phi%20%3E%20phi1%29%20phi1%20%3D%20phi%3B%0A%20%20p0%20%3D%20p%2C%20lambda2%20%3D%20lambda%3B%0A%7D%0A%0Afunction%20boundsLineStart%28%29%20%7B%0A%20%20boundsStream%2Epoint%20%3D%20linePoint%3B%0A%7D%0A%0Afunction%20boundsLineEnd%28%29%20%7B%0A%20%20range%5B0%5D%20%3D%20lambda0%241%2C%20range%5B1%5D%20%3D%20lambda1%3B%0A%20%20boundsStream%2Epoint%20%3D%20boundsPoint%3B%0A%20%20p0%20%3D%20null%3B%0A%7D%0A%0Afunction%20boundsRingPoint%28lambda%2C%20phi%29%20%7B%0A%20%20if%20%28p0%29%20%7B%0A%20%20%20%20var%20delta%20%3D%20lambda%20%2D%20lambda2%3B%0A%20%20%20%20deltaSum%2Eadd%28abs%28delta%29%20%3E%20180%20%3F%20delta%20%2B%20%28delta%20%3E%200%20%3F%20360%20%3A%20%2D360%29%20%3A%20delta%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20lambda00%241%20%3D%20lambda%2C%20phi00%241%20%3D%20phi%3B%0A%20%20%7D%0A%20%20areaStream%2Epoint%28lambda%2C%20phi%29%3B%0A%20%20linePoint%28lambda%2C%20phi%29%3B%0A%7D%0A%0Afunction%20boundsRingStart%28%29%20%7B%0A%20%20areaStream%2ElineStart%28%29%3B%0A%7D%0A%0Afunction%20boundsRingEnd%28%29%20%7B%0A%20%20boundsRingPoint%28lambda00%241%2C%20phi00%241%29%3B%0A%20%20areaStream%2ElineEnd%28%29%3B%0A%20%20if%20%28abs%28deltaSum%29%20%3E%20epsilon%242%29%20lambda0%241%20%3D%20%2D%28lambda1%20%3D%20180%29%3B%0A%20%20range%5B0%5D%20%3D%20lambda0%241%2C%20range%5B1%5D%20%3D%20lambda1%3B%0A%20%20p0%20%3D%20null%3B%0A%7D%0A%0A%2F%2F%20Finds%20the%20left%2Dright%20distance%20between%20two%20longitudes%2E%0A%2F%2F%20This%20is%20almost%20the%20same%20as%20%28lambda1%20%2D%20lambda0%20%2B%20360%C2%B0%29%20%25%20360%C2%B0%2C%20except%20that%20we%20want%0A%2F%2F%20the%20distance%20between%20%C2%B1180%C2%B0%20to%20be%20360%C2%B0%2E%0Afunction%20angle%28lambda0%2C%20lambda1%29%20%7B%0A%20%20return%20%28lambda1%20%2D%3D%20lambda0%29%20%3C%200%20%3F%20lambda1%20%2B%20360%20%3A%20lambda1%3B%0A%7D%0A%0Afunction%20rangeCompare%28a%2C%20b%29%20%7B%0A%20%20return%20a%5B0%5D%20%2D%20b%5B0%5D%3B%0A%7D%0A%0Afunction%20rangeContains%28range%2C%20x%29%20%7B%0A%20%20return%20range%5B0%5D%20%3C%3D%20range%5B1%5D%20%3F%20range%5B0%5D%20%3C%3D%20x%20%26%26%20x%20%3C%3D%20range%5B1%5D%20%3A%20x%20%3C%20range%5B0%5D%20%7C%7C%20range%5B1%5D%20%3C%20x%3B%0A%7D%0A%0Afunction%20bounds%28feature%29%20%7B%0A%20%20var%20i%2C%20n%2C%20a%2C%20b%2C%20merged%2C%20deltaMax%2C%20delta%3B%0A%0A%20%20phi1%20%3D%20lambda1%20%3D%20%2D%28lambda0%241%20%3D%20phi0%20%3D%20Infinity%29%3B%0A%20%20ranges%20%3D%20%5B%5D%3B%0A%20%20geoStream%28feature%2C%20boundsStream%29%3B%0A%0A%20%20%2F%2F%20First%2C%20sort%20ranges%20by%20their%20minimum%20longitudes%2E%0A%20%20if%20%28n%20%3D%20ranges%2Elength%29%20%7B%0A%20%20%20%20ranges%2Esort%28rangeCompare%29%3B%0A%0A%20%20%20%20%2F%2F%20Then%2C%20merge%20any%20ranges%20that%20overlap%2E%0A%20%20%20%20for%20%28i%20%3D%201%2C%20a%20%3D%20ranges%5B0%5D%2C%20merged%20%3D%20%5Ba%5D%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20b%20%3D%20ranges%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28rangeContains%28a%2C%20b%5B0%5D%29%20%7C%7C%20rangeContains%28a%2C%20b%5B1%5D%29%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28angle%28a%5B0%5D%2C%20b%5B1%5D%29%20%3E%20angle%28a%5B0%5D%2C%20a%5B1%5D%29%29%20a%5B1%5D%20%3D%20b%5B1%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28angle%28b%5B0%5D%2C%20a%5B1%5D%29%20%3E%20angle%28a%5B0%5D%2C%20a%5B1%5D%29%29%20a%5B0%5D%20%3D%20b%5B0%5D%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20merged%2Epush%28a%20%3D%20b%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Finally%2C%20find%20the%20largest%20gap%20between%20the%20merged%20ranges%2E%0A%20%20%20%20%2F%2F%20The%20final%20bounding%20box%20will%20be%20the%20inverse%20of%20this%20gap%2E%0A%20%20%20%20for%20%28deltaMax%20%3D%20%2DInfinity%2C%20n%20%3D%20merged%2Elength%20%2D%201%2C%20i%20%3D%200%2C%20a%20%3D%20merged%5Bn%5D%3B%20i%20%3C%3D%20n%3B%20a%20%3D%20b%2C%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20b%20%3D%20merged%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28%28delta%20%3D%20angle%28a%5B1%5D%2C%20b%5B0%5D%29%29%20%3E%20deltaMax%29%20deltaMax%20%3D%20delta%2C%20lambda0%241%20%3D%20b%5B0%5D%2C%20lambda1%20%3D%20a%5B1%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20ranges%20%3D%20range%20%3D%20null%3B%0A%0A%20%20return%20lambda0%241%20%3D%3D%3D%20Infinity%20%7C%7C%20phi0%20%3D%3D%3D%20Infinity%0A%20%20%20%20%20%20%3F%20%5B%5BNaN%2C%20NaN%5D%2C%20%5BNaN%2C%20NaN%5D%5D%0A%20%20%20%20%20%20%3A%20%5B%5Blambda0%241%2C%20phi0%5D%2C%20%5Blambda1%2C%20phi1%5D%5D%3B%0A%7D%0A%0Avar%20W0%2C%20W1%2C%0A%20%20%20%20X0%2C%20Y0%2C%20Z0%2C%0A%20%20%20%20X1%2C%20Y1%2C%20Z1%2C%0A%20%20%20%20X2%2C%20Y2%2C%20Z2%2C%0A%20%20%20%20lambda00%242%2C%20phi00%242%2C%20%2F%2F%20first%20point%0A%20%20%20%20x0%2C%20y0%2C%20z0%3B%20%2F%2F%20previous%20point%0A%0Avar%20centroidStream%20%3D%20%7B%0A%20%20sphere%3A%20noop%242%2C%0A%20%20point%3A%20centroidPoint%2C%0A%20%20lineStart%3A%20centroidLineStart%2C%0A%20%20lineEnd%3A%20centroidLineEnd%2C%0A%20%20polygonStart%3A%20function%28%29%20%7B%0A%20%20%20%20centroidStream%2ElineStart%20%3D%20centroidRingStart%3B%0A%20%20%20%20centroidStream%2ElineEnd%20%3D%20centroidRingEnd%3B%0A%20%20%7D%2C%0A%20%20polygonEnd%3A%20function%28%29%20%7B%0A%20%20%20%20centroidStream%2ElineStart%20%3D%20centroidLineStart%3B%0A%20%20%20%20centroidStream%2ElineEnd%20%3D%20centroidLineEnd%3B%0A%20%20%7D%0A%7D%3B%0A%0A%2F%2F%20Arithmetic%20mean%20of%20Cartesian%20vectors%2E%0Afunction%20centroidPoint%28lambda%2C%20phi%29%20%7B%0A%20%20lambda%20%2A%3D%20radians%2C%20phi%20%2A%3D%20radians%3B%0A%20%20var%20cosPhi%20%3D%20cos%241%28phi%29%3B%0A%20%20centroidPointCartesian%28cosPhi%20%2A%20cos%241%28lambda%29%2C%20cosPhi%20%2A%20sin%241%28lambda%29%2C%20sin%241%28phi%29%29%3B%0A%7D%0A%0Afunction%20centroidPointCartesian%28x%2C%20y%2C%20z%29%20%7B%0A%20%20%2B%2BW0%3B%0A%20%20X0%20%2B%3D%20%28x%20%2D%20X0%29%20%2F%20W0%3B%0A%20%20Y0%20%2B%3D%20%28y%20%2D%20Y0%29%20%2F%20W0%3B%0A%20%20Z0%20%2B%3D%20%28z%20%2D%20Z0%29%20%2F%20W0%3B%0A%7D%0A%0Afunction%20centroidLineStart%28%29%20%7B%0A%20%20centroidStream%2Epoint%20%3D%20centroidLinePointFirst%3B%0A%7D%0A%0Afunction%20centroidLinePointFirst%28lambda%2C%20phi%29%20%7B%0A%20%20lambda%20%2A%3D%20radians%2C%20phi%20%2A%3D%20radians%3B%0A%20%20var%20cosPhi%20%3D%20cos%241%28phi%29%3B%0A%20%20x0%20%3D%20cosPhi%20%2A%20cos%241%28lambda%29%3B%0A%20%20y0%20%3D%20cosPhi%20%2A%20sin%241%28lambda%29%3B%0A%20%20z0%20%3D%20sin%241%28phi%29%3B%0A%20%20centroidStream%2Epoint%20%3D%20centroidLinePoint%3B%0A%20%20centroidPointCartesian%28x0%2C%20y0%2C%20z0%29%3B%0A%7D%0A%0Afunction%20centroidLinePoint%28lambda%2C%20phi%29%20%7B%0A%20%20lambda%20%2A%3D%20radians%2C%20phi%20%2A%3D%20radians%3B%0A%20%20var%20cosPhi%20%3D%20cos%241%28phi%29%2C%0A%20%20%20%20%20%20x%20%3D%20cosPhi%20%2A%20cos%241%28lambda%29%2C%0A%20%20%20%20%20%20y%20%3D%20cosPhi%20%2A%20sin%241%28lambda%29%2C%0A%20%20%20%20%20%20z%20%3D%20sin%241%28phi%29%2C%0A%20%20%20%20%20%20w%20%3D%20atan2%28sqrt%28%28w%20%3D%20y0%20%2A%20z%20%2D%20z0%20%2A%20y%29%20%2A%20w%20%2B%20%28w%20%3D%20z0%20%2A%20x%20%2D%20x0%20%2A%20z%29%20%2A%20w%20%2B%20%28w%20%3D%20x0%20%2A%20y%20%2D%20y0%20%2A%20x%29%20%2A%20w%29%2C%20x0%20%2A%20x%20%2B%20y0%20%2A%20y%20%2B%20z0%20%2A%20z%29%3B%0A%20%20W1%20%2B%3D%20w%3B%0A%20%20X1%20%2B%3D%20w%20%2A%20%28x0%20%2B%20%28x0%20%3D%20x%29%29%3B%0A%20%20Y1%20%2B%3D%20w%20%2A%20%28y0%20%2B%20%28y0%20%3D%20y%29%29%3B%0A%20%20Z1%20%2B%3D%20w%20%2A%20%28z0%20%2B%20%28z0%20%3D%20z%29%29%3B%0A%20%20centroidPointCartesian%28x0%2C%20y0%2C%20z0%29%3B%0A%7D%0A%0Afunction%20centroidLineEnd%28%29%20%7B%0A%20%20centroidStream%2Epoint%20%3D%20centroidPoint%3B%0A%7D%0A%0A%2F%2F%20See%20J%2E%20E%2E%20Brock%2C%20The%20Inertia%20Tensor%20for%20a%20Spherical%20Triangle%2C%0A%2F%2F%20J%2E%20Applied%20Mechanics%2042%2C%20239%20%281975%29%2E%0Afunction%20centroidRingStart%28%29%20%7B%0A%20%20centroidStream%2Epoint%20%3D%20centroidRingPointFirst%3B%0A%7D%0A%0Afunction%20centroidRingEnd%28%29%20%7B%0A%20%20centroidRingPoint%28lambda00%242%2C%20phi00%242%29%3B%0A%20%20centroidStream%2Epoint%20%3D%20centroidPoint%3B%0A%7D%0A%0Afunction%20centroidRingPointFirst%28lambda%2C%20phi%29%20%7B%0A%20%20lambda00%242%20%3D%20lambda%2C%20phi00%242%20%3D%20phi%3B%0A%20%20lambda%20%2A%3D%20radians%2C%20phi%20%2A%3D%20radians%3B%0A%20%20centroidStream%2Epoint%20%3D%20centroidRingPoint%3B%0A%20%20var%20cosPhi%20%3D%20cos%241%28phi%29%3B%0A%20%20x0%20%3D%20cosPhi%20%2A%20cos%241%28lambda%29%3B%0A%20%20y0%20%3D%20cosPhi%20%2A%20sin%241%28lambda%29%3B%0A%20%20z0%20%3D%20sin%241%28phi%29%3B%0A%20%20centroidPointCartesian%28x0%2C%20y0%2C%20z0%29%3B%0A%7D%0A%0Afunction%20centroidRingPoint%28lambda%2C%20phi%29%20%7B%0A%20%20lambda%20%2A%3D%20radians%2C%20phi%20%2A%3D%20radians%3B%0A%20%20var%20cosPhi%20%3D%20cos%241%28phi%29%2C%0A%20%20%20%20%20%20x%20%3D%20cosPhi%20%2A%20cos%241%28lambda%29%2C%0A%20%20%20%20%20%20y%20%3D%20cosPhi%20%2A%20sin%241%28lambda%29%2C%0A%20%20%20%20%20%20z%20%3D%20sin%241%28phi%29%2C%0A%20%20%20%20%20%20cx%20%3D%20y0%20%2A%20z%20%2D%20z0%20%2A%20y%2C%0A%20%20%20%20%20%20cy%20%3D%20z0%20%2A%20x%20%2D%20x0%20%2A%20z%2C%0A%20%20%20%20%20%20cz%20%3D%20x0%20%2A%20y%20%2D%20y0%20%2A%20x%2C%0A%20%20%20%20%20%20m%20%3D%20sqrt%28cx%20%2A%20cx%20%2B%20cy%20%2A%20cy%20%2B%20cz%20%2A%20cz%29%2C%0A%20%20%20%20%20%20w%20%3D%20asin%28m%29%2C%20%2F%2F%20line%20weight%20%3D%20angle%0A%20%20%20%20%20%20v%20%3D%20m%20%26%26%20%2Dw%20%2F%20m%3B%20%2F%2F%20area%20weight%20multiplier%0A%20%20X2%20%2B%3D%20v%20%2A%20cx%3B%0A%20%20Y2%20%2B%3D%20v%20%2A%20cy%3B%0A%20%20Z2%20%2B%3D%20v%20%2A%20cz%3B%0A%20%20W1%20%2B%3D%20w%3B%0A%20%20X1%20%2B%3D%20w%20%2A%20%28x0%20%2B%20%28x0%20%3D%20x%29%29%3B%0A%20%20Y1%20%2B%3D%20w%20%2A%20%28y0%20%2B%20%28y0%20%3D%20y%29%29%3B%0A%20%20Z1%20%2B%3D%20w%20%2A%20%28z0%20%2B%20%28z0%20%3D%20z%29%29%3B%0A%20%20centroidPointCartesian%28x0%2C%20y0%2C%20z0%29%3B%0A%7D%0A%0Afunction%20centroid%28object%29%20%7B%0A%20%20W0%20%3D%20W1%20%3D%0A%20%20X0%20%3D%20Y0%20%3D%20Z0%20%3D%0A%20%20X1%20%3D%20Y1%20%3D%20Z1%20%3D%0A%20%20X2%20%3D%20Y2%20%3D%20Z2%20%3D%200%3B%0A%20%20geoStream%28object%2C%20centroidStream%29%3B%0A%0A%20%20var%20x%20%3D%20X2%2C%0A%20%20%20%20%20%20y%20%3D%20Y2%2C%0A%20%20%20%20%20%20z%20%3D%20Z2%2C%0A%20%20%20%20%20%20m%20%3D%20x%20%2A%20x%20%2B%20y%20%2A%20y%20%2B%20z%20%2A%20z%3B%0A%0A%20%20%2F%2F%20If%20the%20area%2Dweighted%20ccentroid%20is%20undefined%2C%20fall%20back%20to%20length%2Dweighted%20ccentroid%2E%0A%20%20if%20%28m%20%3C%20epsilon2%241%29%20%7B%0A%20%20%20%20x%20%3D%20X1%2C%20y%20%3D%20Y1%2C%20z%20%3D%20Z1%3B%0A%20%20%20%20%2F%2F%20If%20the%20feature%20has%20zero%20length%2C%20fall%20back%20to%20arithmetic%20mean%20of%20point%20vectors%2E%0A%20%20%20%20if%20%28W1%20%3C%20epsilon%242%29%20x%20%3D%20X0%2C%20y%20%3D%20Y0%2C%20z%20%3D%20Z0%3B%0A%20%20%20%20m%20%3D%20x%20%2A%20x%20%2B%20y%20%2A%20y%20%2B%20z%20%2A%20z%3B%0A%20%20%20%20%2F%2F%20If%20the%20feature%20still%20has%20an%20undefined%20ccentroid%2C%20then%20return%2E%0A%20%20%20%20if%20%28m%20%3C%20epsilon2%241%29%20return%20%5BNaN%2C%20NaN%5D%3B%0A%20%20%7D%0A%0A%20%20return%20%5Batan2%28y%2C%20x%29%20%2A%20degrees%241%2C%20asin%28z%20%2F%20sqrt%28m%29%29%20%2A%20degrees%241%5D%3B%0A%7D%0A%0Afunction%20constant%248%28x%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20compose%28a%2C%20b%29%20%7B%0A%0A%20%20function%20compose%28x%2C%20y%29%20%7B%0A%20%20%20%20return%20x%20%3D%20a%28x%2C%20y%29%2C%20b%28x%5B0%5D%2C%20x%5B1%5D%29%3B%0A%20%20%7D%0A%0A%20%20if%20%28a%2Einvert%20%26%26%20b%2Einvert%29%20compose%2Einvert%20%3D%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20return%20x%20%3D%20b%2Einvert%28x%2C%20y%29%2C%20x%20%26%26%20a%2Einvert%28x%5B0%5D%2C%20x%5B1%5D%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20compose%3B%0A%7D%0A%0Afunction%20rotationIdentity%28lambda%2C%20phi%29%20%7B%0A%20%20return%20%5Blambda%20%3E%20pi%243%20%3F%20lambda%20%2D%20tau%243%20%3A%20lambda%20%3C%20%2Dpi%243%20%3F%20lambda%20%2B%20tau%243%20%3A%20lambda%2C%20phi%5D%3B%0A%7D%0A%0ArotationIdentity%2Einvert%20%3D%20rotationIdentity%3B%0A%0Afunction%20rotateRadians%28deltaLambda%2C%20deltaPhi%2C%20deltaGamma%29%20%7B%0A%20%20return%20%28deltaLambda%20%25%3D%20tau%243%29%20%3F%20%28deltaPhi%20%7C%7C%20deltaGamma%20%3F%20compose%28rotationLambda%28deltaLambda%29%2C%20rotationPhiGamma%28deltaPhi%2C%20deltaGamma%29%29%0A%20%20%20%20%3A%20rotationLambda%28deltaLambda%29%29%0A%20%20%20%20%3A%20%28deltaPhi%20%7C%7C%20deltaGamma%20%3F%20rotationPhiGamma%28deltaPhi%2C%20deltaGamma%29%0A%20%20%20%20%3A%20rotationIdentity%29%3B%0A%7D%0A%0Afunction%20forwardRotationLambda%28deltaLambda%29%20%7B%0A%20%20return%20function%28lambda%2C%20phi%29%20%7B%0A%20%20%20%20return%20lambda%20%2B%3D%20deltaLambda%2C%20%5Blambda%20%3E%20pi%243%20%3F%20lambda%20%2D%20tau%243%20%3A%20lambda%20%3C%20%2Dpi%243%20%3F%20lambda%20%2B%20tau%243%20%3A%20lambda%2C%20phi%5D%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20rotationLambda%28deltaLambda%29%20%7B%0A%20%20var%20rotation%20%3D%20forwardRotationLambda%28deltaLambda%29%3B%0A%20%20rotation%2Einvert%20%3D%20forwardRotationLambda%28%2DdeltaLambda%29%3B%0A%20%20return%20rotation%3B%0A%7D%0A%0Afunction%20rotationPhiGamma%28deltaPhi%2C%20deltaGamma%29%20%7B%0A%20%20var%20cosDeltaPhi%20%3D%20cos%241%28deltaPhi%29%2C%0A%20%20%20%20%20%20sinDeltaPhi%20%3D%20sin%241%28deltaPhi%29%2C%0A%20%20%20%20%20%20cosDeltaGamma%20%3D%20cos%241%28deltaGamma%29%2C%0A%20%20%20%20%20%20sinDeltaGamma%20%3D%20sin%241%28deltaGamma%29%3B%0A%0A%20%20function%20rotation%28lambda%2C%20phi%29%20%7B%0A%20%20%20%20var%20cosPhi%20%3D%20cos%241%28phi%29%2C%0A%20%20%20%20%20%20%20%20x%20%3D%20cos%241%28lambda%29%20%2A%20cosPhi%2C%0A%20%20%20%20%20%20%20%20y%20%3D%20sin%241%28lambda%29%20%2A%20cosPhi%2C%0A%20%20%20%20%20%20%20%20z%20%3D%20sin%241%28phi%29%2C%0A%20%20%20%20%20%20%20%20k%20%3D%20z%20%2A%20cosDeltaPhi%20%2B%20x%20%2A%20sinDeltaPhi%3B%0A%20%20%20%20return%20%5B%0A%20%20%20%20%20%20atan2%28y%20%2A%20cosDeltaGamma%20%2D%20k%20%2A%20sinDeltaGamma%2C%20x%20%2A%20cosDeltaPhi%20%2D%20z%20%2A%20sinDeltaPhi%29%2C%0A%20%20%20%20%20%20asin%28k%20%2A%20cosDeltaGamma%20%2B%20y%20%2A%20sinDeltaGamma%29%0A%20%20%20%20%5D%3B%0A%20%20%7D%0A%0A%20%20rotation%2Einvert%20%3D%20function%28lambda%2C%20phi%29%20%7B%0A%20%20%20%20var%20cosPhi%20%3D%20cos%241%28phi%29%2C%0A%20%20%20%20%20%20%20%20x%20%3D%20cos%241%28lambda%29%20%2A%20cosPhi%2C%0A%20%20%20%20%20%20%20%20y%20%3D%20sin%241%28lambda%29%20%2A%20cosPhi%2C%0A%20%20%20%20%20%20%20%20z%20%3D%20sin%241%28phi%29%2C%0A%20%20%20%20%20%20%20%20k%20%3D%20z%20%2A%20cosDeltaGamma%20%2D%20y%20%2A%20sinDeltaGamma%3B%0A%20%20%20%20return%20%5B%0A%20%20%20%20%20%20atan2%28y%20%2A%20cosDeltaGamma%20%2B%20z%20%2A%20sinDeltaGamma%2C%20x%20%2A%20cosDeltaPhi%20%2B%20k%20%2A%20sinDeltaPhi%29%2C%0A%20%20%20%20%20%20asin%28k%20%2A%20cosDeltaPhi%20%2D%20x%20%2A%20sinDeltaPhi%29%0A%20%20%20%20%5D%3B%0A%20%20%7D%3B%0A%0A%20%20return%20rotation%3B%0A%7D%0A%0Afunction%20rotation%28rotate%29%20%7B%0A%20%20rotate%20%3D%20rotateRadians%28rotate%5B0%5D%20%2A%20radians%2C%20rotate%5B1%5D%20%2A%20radians%2C%20rotate%2Elength%20%3E%202%20%3F%20rotate%5B2%5D%20%2A%20radians%20%3A%200%29%3B%0A%0A%20%20function%20forward%28coordinates%29%20%7B%0A%20%20%20%20coordinates%20%3D%20rotate%28coordinates%5B0%5D%20%2A%20radians%2C%20coordinates%5B1%5D%20%2A%20radians%29%3B%0A%20%20%20%20return%20coordinates%5B0%5D%20%2A%3D%20degrees%241%2C%20coordinates%5B1%5D%20%2A%3D%20degrees%241%2C%20coordinates%3B%0A%20%20%7D%0A%0A%20%20forward%2Einvert%20%3D%20function%28coordinates%29%20%7B%0A%20%20%20%20coordinates%20%3D%20rotate%2Einvert%28coordinates%5B0%5D%20%2A%20radians%2C%20coordinates%5B1%5D%20%2A%20radians%29%3B%0A%20%20%20%20return%20coordinates%5B0%5D%20%2A%3D%20degrees%241%2C%20coordinates%5B1%5D%20%2A%3D%20degrees%241%2C%20coordinates%3B%0A%20%20%7D%3B%0A%0A%20%20return%20forward%3B%0A%7D%0A%0A%2F%2F%20Generates%20a%20circle%20centered%20at%20%5B0%C2%B0%2C%200%C2%B0%5D%2C%20with%20a%20given%20radius%20and%20precision%2E%0Afunction%20circleStream%28stream%2C%20radius%2C%20delta%2C%20direction%2C%20t0%2C%20t1%29%20%7B%0A%20%20if%20%28%21delta%29%20return%3B%0A%20%20var%20cosRadius%20%3D%20cos%241%28radius%29%2C%0A%20%20%20%20%20%20sinRadius%20%3D%20sin%241%28radius%29%2C%0A%20%20%20%20%20%20step%20%3D%20direction%20%2A%20delta%3B%0A%20%20if%20%28t0%20%3D%3D%20null%29%20%7B%0A%20%20%20%20t0%20%3D%20radius%20%2B%20direction%20%2A%20tau%243%3B%0A%20%20%20%20t1%20%3D%20radius%20%2D%20step%20%2F%202%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20t0%20%3D%20circleRadius%28cosRadius%2C%20t0%29%3B%0A%20%20%20%20t1%20%3D%20circleRadius%28cosRadius%2C%20t1%29%3B%0A%20%20%20%20if%20%28direction%20%3E%200%20%3F%20t0%20%3C%20t1%20%3A%20t0%20%3E%20t1%29%20t0%20%2B%3D%20direction%20%2A%20tau%243%3B%0A%20%20%7D%0A%20%20for%20%28var%20point%2C%20t%20%3D%20t0%3B%20direction%20%3E%200%20%3F%20t%20%3E%20t1%20%3A%20t%20%3C%20t1%3B%20t%20%2D%3D%20step%29%20%7B%0A%20%20%20%20point%20%3D%20spherical%28%5BcosRadius%2C%20%2DsinRadius%20%2A%20cos%241%28t%29%2C%20%2DsinRadius%20%2A%20sin%241%28t%29%5D%29%3B%0A%20%20%20%20stream%2Epoint%28point%5B0%5D%2C%20point%5B1%5D%29%3B%0A%20%20%7D%0A%7D%0A%0A%2F%2F%20Returns%20the%20signed%20angle%20of%20a%20cartesian%20point%20relative%20to%20%5BcosRadius%2C%200%2C%200%5D%2E%0Afunction%20circleRadius%28cosRadius%2C%20point%29%20%7B%0A%20%20point%20%3D%20cartesian%28point%29%2C%20point%5B0%5D%20%2D%3D%20cosRadius%3B%0A%20%20cartesianNormalizeInPlace%28point%29%3B%0A%20%20var%20radius%20%3D%20acos%28%2Dpoint%5B1%5D%29%3B%0A%20%20return%20%28%28%2Dpoint%5B2%5D%20%3C%200%20%3F%20%2Dradius%20%3A%20radius%29%20%2B%20tau%243%20%2D%20epsilon%242%29%20%25%20tau%243%3B%0A%7D%0A%0Afunction%20circle%28%29%20%7B%0A%20%20var%20center%20%3D%20constant%248%28%5B0%2C%200%5D%29%2C%0A%20%20%20%20%20%20radius%20%3D%20constant%248%2890%29%2C%0A%20%20%20%20%20%20precision%20%3D%20constant%248%286%29%2C%0A%20%20%20%20%20%20ring%2C%0A%20%20%20%20%20%20rotate%2C%0A%20%20%20%20%20%20stream%20%3D%20%7Bpoint%3A%20point%7D%3B%0A%0A%20%20function%20point%28x%2C%20y%29%20%7B%0A%20%20%20%20ring%2Epush%28x%20%3D%20rotate%28x%2C%20y%29%29%3B%0A%20%20%20%20x%5B0%5D%20%2A%3D%20degrees%241%2C%20x%5B1%5D%20%2A%3D%20degrees%241%3B%0A%20%20%7D%0A%0A%20%20function%20circle%28%29%20%7B%0A%20%20%20%20var%20c%20%3D%20center%2Eapply%28this%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20r%20%3D%20radius%2Eapply%28this%2C%20arguments%29%20%2A%20radians%2C%0A%20%20%20%20%20%20%20%20p%20%3D%20precision%2Eapply%28this%2C%20arguments%29%20%2A%20radians%3B%0A%20%20%20%20ring%20%3D%20%5B%5D%3B%0A%20%20%20%20rotate%20%3D%20rotateRadians%28%2Dc%5B0%5D%20%2A%20radians%2C%20%2Dc%5B1%5D%20%2A%20radians%2C%200%29%2Einvert%3B%0A%20%20%20%20circleStream%28stream%2C%20r%2C%20p%2C%201%29%3B%0A%20%20%20%20c%20%3D%20%7Btype%3A%20%22Polygon%22%2C%20coordinates%3A%20%5Bring%5D%7D%3B%0A%20%20%20%20ring%20%3D%20rotate%20%3D%20null%3B%0A%20%20%20%20return%20c%3B%0A%20%20%7D%0A%0A%20%20circle%2Ecenter%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28center%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%248%28%5B%2B%5F%5B0%5D%2C%20%2B%5F%5B1%5D%5D%29%2C%20circle%29%20%3A%20center%3B%0A%20%20%7D%3B%0A%0A%20%20circle%2Eradius%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28radius%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%248%28%2B%5F%29%2C%20circle%29%20%3A%20radius%3B%0A%20%20%7D%3B%0A%0A%20%20circle%2Eprecision%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28precision%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%248%28%2B%5F%29%2C%20circle%29%20%3A%20precision%3B%0A%20%20%7D%3B%0A%0A%20%20return%20circle%3B%0A%7D%0A%0Afunction%20clipBuffer%28%29%20%7B%0A%20%20var%20lines%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20line%3B%0A%20%20return%20%7B%0A%20%20%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20%20%20line%2Epush%28%5Bx%2C%20y%5D%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20lines%2Epush%28line%20%3D%20%5B%5D%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20lineEnd%3A%20noop%242%2C%0A%20%20%20%20rejoin%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28lines%2Elength%20%3E%201%29%20lines%2Epush%28lines%2Epop%28%29%2Econcat%28lines%2Eshift%28%29%29%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20result%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20result%20%3D%20lines%3B%0A%20%20%20%20%20%20lines%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20line%20%3D%20null%3B%0A%20%20%20%20%20%20return%20result%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20pointEqual%28a%2C%20b%29%20%7B%0A%20%20return%20abs%28a%5B0%5D%20%2D%20b%5B0%5D%29%20%3C%20epsilon%242%20%26%26%20abs%28a%5B1%5D%20%2D%20b%5B1%5D%29%20%3C%20epsilon%242%3B%0A%7D%0A%0Afunction%20Intersection%28point%2C%20points%2C%20other%2C%20entry%29%20%7B%0A%20%20this%2Ex%20%3D%20point%3B%0A%20%20this%2Ez%20%3D%20points%3B%0A%20%20this%2Eo%20%3D%20other%3B%20%2F%2F%20another%20intersection%0A%20%20this%2Ee%20%3D%20entry%3B%20%2F%2F%20is%20an%20entry%3F%0A%20%20this%2Ev%20%3D%20false%3B%20%2F%2F%20visited%0A%20%20this%2En%20%3D%20this%2Ep%20%3D%20null%3B%20%2F%2F%20next%20%26%20previous%0A%7D%0A%0A%2F%2F%20A%20generalized%20polygon%20clipping%20algorithm%3A%20given%20a%20polygon%20that%20has%20been%20cut%0A%2F%2F%20into%20its%20visible%20line%20segments%2C%20and%20rejoins%20the%20segments%20by%20interpolating%0A%2F%2F%20along%20the%20clip%20edge%2E%0Afunction%20clipRejoin%28segments%2C%20compareIntersection%2C%20startInside%2C%20interpolate%2C%20stream%29%20%7B%0A%20%20var%20subject%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20clip%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20n%3B%0A%0A%20%20segments%2EforEach%28function%28segment%29%20%7B%0A%20%20%20%20if%20%28%28n%20%3D%20segment%2Elength%20%2D%201%29%20%3C%3D%200%29%20return%3B%0A%20%20%20%20var%20n%2C%20p0%20%3D%20segment%5B0%5D%2C%20p1%20%3D%20segment%5Bn%5D%2C%20x%3B%0A%0A%20%20%20%20%2F%2F%20If%20the%20first%20and%20last%20points%20of%20a%20segment%20are%20coincident%2C%20then%20treat%20as%20a%0A%20%20%20%20%2F%2F%20closed%20ring%2E%20TODO%20if%20all%20rings%20are%20closed%2C%20then%20the%20winding%20order%20of%20the%0A%20%20%20%20%2F%2F%20exterior%20ring%20should%20be%20checked%2E%0A%20%20%20%20if%20%28pointEqual%28p0%2C%20p1%29%29%20%7B%0A%20%20%20%20%20%20stream%2ElineStart%28%29%3B%0A%20%20%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20stream%2Epoint%28%28p0%20%3D%20segment%5Bi%5D%29%5B0%5D%2C%20p0%5B1%5D%29%3B%0A%20%20%20%20%20%20stream%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20subject%2Epush%28x%20%3D%20new%20Intersection%28p0%2C%20segment%2C%20null%2C%20true%29%29%3B%0A%20%20%20%20clip%2Epush%28x%2Eo%20%3D%20new%20Intersection%28p0%2C%20null%2C%20x%2C%20false%29%29%3B%0A%20%20%20%20subject%2Epush%28x%20%3D%20new%20Intersection%28p1%2C%20segment%2C%20null%2C%20false%29%29%3B%0A%20%20%20%20clip%2Epush%28x%2Eo%20%3D%20new%20Intersection%28p1%2C%20null%2C%20x%2C%20true%29%29%3B%0A%20%20%7D%29%3B%0A%0A%20%20if%20%28%21subject%2Elength%29%20return%3B%0A%0A%20%20clip%2Esort%28compareIntersection%29%3B%0A%20%20link%241%28subject%29%3B%0A%20%20link%241%28clip%29%3B%0A%0A%20%20for%20%28i%20%3D%200%2C%20n%20%3D%20clip%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20clip%5Bi%5D%2Ee%20%3D%20startInside%20%3D%20%21startInside%3B%0A%20%20%7D%0A%0A%20%20var%20start%20%3D%20subject%5B0%5D%2C%0A%20%20%20%20%20%20points%2C%0A%20%20%20%20%20%20point%3B%0A%0A%20%20while%20%281%29%20%7B%0A%20%20%20%20%2F%2F%20Find%20first%20unvisited%20intersection%2E%0A%20%20%20%20var%20current%20%3D%20start%2C%0A%20%20%20%20%20%20%20%20isSubject%20%3D%20true%3B%0A%20%20%20%20while%20%28current%2Ev%29%20if%20%28%28current%20%3D%20current%2En%29%20%3D%3D%3D%20start%29%20return%3B%0A%20%20%20%20points%20%3D%20current%2Ez%3B%0A%20%20%20%20stream%2ElineStart%28%29%3B%0A%20%20%20%20do%20%7B%0A%20%20%20%20%20%20current%2Ev%20%3D%20current%2Eo%2Ev%20%3D%20true%3B%0A%20%20%20%20%20%20if%20%28current%2Ee%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28isSubject%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20for%20%28i%20%3D%200%2C%20n%20%3D%20points%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20stream%2Epoint%28%28point%20%3D%20points%5Bi%5D%29%5B0%5D%2C%20point%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20interpolate%28current%2Ex%2C%20current%2En%2Ex%2C%201%2C%20stream%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20current%20%3D%20current%2En%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28isSubject%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20points%20%3D%20current%2Ep%2Ez%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28i%20%3D%20points%2Elength%20%2D%201%3B%20i%20%3E%3D%200%3B%20%2D%2Di%29%20stream%2Epoint%28%28point%20%3D%20points%5Bi%5D%29%5B0%5D%2C%20point%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20interpolate%28current%2Ex%2C%20current%2Ep%2Ex%2C%20%2D1%2C%20stream%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20current%20%3D%20current%2Ep%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20current%20%3D%20current%2Eo%3B%0A%20%20%20%20%20%20points%20%3D%20current%2Ez%3B%0A%20%20%20%20%20%20isSubject%20%3D%20%21isSubject%3B%0A%20%20%20%20%7D%20while%20%28%21current%2Ev%29%3B%0A%20%20%20%20stream%2ElineEnd%28%29%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20link%241%28array%29%20%7B%0A%20%20if%20%28%21%28n%20%3D%20array%2Elength%29%29%20return%3B%0A%20%20var%20n%2C%0A%20%20%20%20%20%20i%20%3D%200%2C%0A%20%20%20%20%20%20a%20%3D%20array%5B0%5D%2C%0A%20%20%20%20%20%20b%3B%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20a%2En%20%3D%20b%20%3D%20array%5Bi%5D%3B%0A%20%20%20%20b%2Ep%20%3D%20a%3B%0A%20%20%20%20a%20%3D%20b%3B%0A%20%20%7D%0A%20%20a%2En%20%3D%20b%20%3D%20array%5B0%5D%3B%0A%20%20b%2Ep%20%3D%20a%3B%0A%7D%0A%0Avar%20sum%241%20%3D%20adder%28%29%3B%0A%0Afunction%20polygonContains%28polygon%2C%20point%29%20%7B%0A%20%20var%20lambda%20%3D%20point%5B0%5D%2C%0A%20%20%20%20%20%20phi%20%3D%20point%5B1%5D%2C%0A%20%20%20%20%20%20sinPhi%20%3D%20sin%241%28phi%29%2C%0A%20%20%20%20%20%20normal%20%3D%20%5Bsin%241%28lambda%29%2C%20%2Dcos%241%28lambda%29%2C%200%5D%2C%0A%20%20%20%20%20%20angle%20%3D%200%2C%0A%20%20%20%20%20%20winding%20%3D%200%3B%0A%0A%20%20sum%241%2Ereset%28%29%3B%0A%0A%20%20if%20%28sinPhi%20%3D%3D%3D%201%29%20phi%20%3D%20halfPi%242%20%2B%20epsilon%242%3B%0A%20%20else%20if%20%28sinPhi%20%3D%3D%3D%20%2D1%29%20phi%20%3D%20%2DhalfPi%242%20%2D%20epsilon%242%3B%0A%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20polygon%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28%21%28m%20%3D%20%28ring%20%3D%20polygon%5Bi%5D%29%2Elength%29%29%20continue%3B%0A%20%20%20%20var%20ring%2C%0A%20%20%20%20%20%20%20%20m%2C%0A%20%20%20%20%20%20%20%20point0%20%3D%20ring%5Bm%20%2D%201%5D%2C%0A%20%20%20%20%20%20%20%20lambda0%20%3D%20point0%5B0%5D%2C%0A%20%20%20%20%20%20%20%20phi0%20%3D%20point0%5B1%5D%20%2F%202%20%2B%20quarterPi%2C%0A%20%20%20%20%20%20%20%20sinPhi0%20%3D%20sin%241%28phi0%29%2C%0A%20%20%20%20%20%20%20%20cosPhi0%20%3D%20cos%241%28phi0%29%3B%0A%0A%20%20%20%20for%20%28var%20j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%2C%20lambda0%20%3D%20lambda1%2C%20sinPhi0%20%3D%20sinPhi1%2C%20cosPhi0%20%3D%20cosPhi1%2C%20point0%20%3D%20point1%29%20%7B%0A%20%20%20%20%20%20var%20point1%20%3D%20ring%5Bj%5D%2C%0A%20%20%20%20%20%20%20%20%20%20lambda1%20%3D%20point1%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20phi1%20%3D%20point1%5B1%5D%20%2F%202%20%2B%20quarterPi%2C%0A%20%20%20%20%20%20%20%20%20%20sinPhi1%20%3D%20sin%241%28phi1%29%2C%0A%20%20%20%20%20%20%20%20%20%20cosPhi1%20%3D%20cos%241%28phi1%29%2C%0A%20%20%20%20%20%20%20%20%20%20delta%20%3D%20lambda1%20%2D%20lambda0%2C%0A%20%20%20%20%20%20%20%20%20%20sign%24%241%20%3D%20delta%20%3E%3D%200%20%3F%201%20%3A%20%2D1%2C%0A%20%20%20%20%20%20%20%20%20%20absDelta%20%3D%20sign%24%241%20%2A%20delta%2C%0A%20%20%20%20%20%20%20%20%20%20antimeridian%20%3D%20absDelta%20%3E%20pi%243%2C%0A%20%20%20%20%20%20%20%20%20%20k%20%3D%20sinPhi0%20%2A%20sinPhi1%3B%0A%0A%20%20%20%20%20%20sum%241%2Eadd%28atan2%28k%20%2A%20sign%24%241%20%2A%20sin%241%28absDelta%29%2C%20cosPhi0%20%2A%20cosPhi1%20%2B%20k%20%2A%20cos%241%28absDelta%29%29%29%3B%0A%20%20%20%20%20%20angle%20%2B%3D%20antimeridian%20%3F%20delta%20%2B%20sign%24%241%20%2A%20tau%243%20%3A%20delta%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Are%20the%20longitudes%20either%20side%20of%20the%20point%E2%80%99s%20meridian%20%28lambda%29%2C%0A%20%20%20%20%20%20%2F%2F%20and%20are%20the%20latitudes%20smaller%20than%20the%20parallel%20%28phi%29%3F%0A%20%20%20%20%20%20if%20%28antimeridian%20%5E%20lambda0%20%3E%3D%20lambda%20%5E%20lambda1%20%3E%3D%20lambda%29%20%7B%0A%20%20%20%20%20%20%20%20var%20arc%20%3D%20cartesianCross%28cartesian%28point0%29%2C%20cartesian%28point1%29%29%3B%0A%20%20%20%20%20%20%20%20cartesianNormalizeInPlace%28arc%29%3B%0A%20%20%20%20%20%20%20%20var%20intersection%20%3D%20cartesianCross%28normal%2C%20arc%29%3B%0A%20%20%20%20%20%20%20%20cartesianNormalizeInPlace%28intersection%29%3B%0A%20%20%20%20%20%20%20%20var%20phiArc%20%3D%20%28antimeridian%20%5E%20delta%20%3E%3D%200%20%3F%20%2D1%20%3A%201%29%20%2A%20asin%28intersection%5B2%5D%29%3B%0A%20%20%20%20%20%20%20%20if%20%28phi%20%3E%20phiArc%20%7C%7C%20phi%20%3D%3D%3D%20phiArc%20%26%26%20%28arc%5B0%5D%20%7C%7C%20arc%5B1%5D%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20winding%20%2B%3D%20antimeridian%20%5E%20delta%20%3E%3D%200%20%3F%201%20%3A%20%2D1%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20First%2C%20determine%20whether%20the%20South%20pole%20is%20inside%20or%20outside%3A%0A%20%20%2F%2F%0A%20%20%2F%2F%20It%20is%20inside%20if%3A%0A%20%20%2F%2F%20%2A%20the%20polygon%20winds%20around%20it%20in%20a%20clockwise%20direction%2E%0A%20%20%2F%2F%20%2A%20the%20polygon%20does%20not%20%28cumulatively%29%20wind%20around%20it%2C%20but%20has%20a%20negative%0A%20%20%2F%2F%20%20%20%28counter%2Dclockwise%29%20area%2E%0A%20%20%2F%2F%0A%20%20%2F%2F%20Second%2C%20count%20the%20%28signed%29%20number%20of%20times%20a%20segment%20crosses%20a%20lambda%0A%20%20%2F%2F%20from%20the%20point%20to%20the%20South%20pole%2E%20%20If%20it%20is%20zero%2C%20then%20the%20point%20is%20the%0A%20%20%2F%2F%20same%20side%20as%20the%20South%20pole%2E%0A%0A%20%20return%20%28angle%20%3C%20%2Depsilon%242%20%7C%7C%20angle%20%3C%20epsilon%242%20%26%26%20sum%241%20%3C%20%2Depsilon%242%29%20%5E%20%28winding%20%26%201%29%3B%0A%7D%0A%0Afunction%20clip%28pointVisible%2C%20clipLine%2C%20interpolate%2C%20start%29%20%7B%0A%20%20return%20function%28sink%29%20%7B%0A%20%20%20%20var%20line%20%3D%20clipLine%28sink%29%2C%0A%20%20%20%20%20%20%20%20ringBuffer%20%3D%20clipBuffer%28%29%2C%0A%20%20%20%20%20%20%20%20ringSink%20%3D%20clipLine%28ringBuffer%29%2C%0A%20%20%20%20%20%20%20%20polygonStarted%20%3D%20false%2C%0A%20%20%20%20%20%20%20%20polygon%2C%0A%20%20%20%20%20%20%20%20segments%2C%0A%20%20%20%20%20%20%20%20ring%3B%0A%0A%20%20%20%20var%20clip%20%3D%20%7B%0A%20%20%20%20%20%20point%3A%20point%2C%0A%20%20%20%20%20%20lineStart%3A%20lineStart%2C%0A%20%20%20%20%20%20lineEnd%3A%20lineEnd%2C%0A%20%20%20%20%20%20polygonStart%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20clip%2Epoint%20%3D%20pointRing%3B%0A%20%20%20%20%20%20%20%20clip%2ElineStart%20%3D%20ringStart%3B%0A%20%20%20%20%20%20%20%20clip%2ElineEnd%20%3D%20ringEnd%3B%0A%20%20%20%20%20%20%20%20segments%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20polygon%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20polygonEnd%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20clip%2Epoint%20%3D%20point%3B%0A%20%20%20%20%20%20%20%20clip%2ElineStart%20%3D%20lineStart%3B%0A%20%20%20%20%20%20%20%20clip%2ElineEnd%20%3D%20lineEnd%3B%0A%20%20%20%20%20%20%20%20segments%20%3D%20merge%28segments%29%3B%0A%20%20%20%20%20%20%20%20var%20startInside%20%3D%20polygonContains%28polygon%2C%20start%29%3B%0A%20%20%20%20%20%20%20%20if%20%28segments%2Elength%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21polygonStarted%29%20sink%2EpolygonStart%28%29%2C%20polygonStarted%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20clipRejoin%28segments%2C%20compareIntersection%2C%20startInside%2C%20interpolate%2C%20sink%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28startInside%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21polygonStarted%29%20sink%2EpolygonStart%28%29%2C%20polygonStarted%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20sink%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20interpolate%28null%2C%20null%2C%201%2C%20sink%29%3B%0A%20%20%20%20%20%20%20%20%20%20sink%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28polygonStarted%29%20sink%2EpolygonEnd%28%29%2C%20polygonStarted%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20segments%20%3D%20polygon%20%3D%20null%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20sphere%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20sink%2EpolygonStart%28%29%3B%0A%20%20%20%20%20%20%20%20sink%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20interpolate%28null%2C%20null%2C%201%2C%20sink%29%3B%0A%20%20%20%20%20%20%20%20sink%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%20%20sink%2EpolygonEnd%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20point%28lambda%2C%20phi%29%20%7B%0A%20%20%20%20%20%20if%20%28pointVisible%28lambda%2C%20phi%29%29%20sink%2Epoint%28lambda%2C%20phi%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20pointLine%28lambda%2C%20phi%29%20%7B%0A%20%20%20%20%20%20line%2Epoint%28lambda%2C%20phi%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20lineStart%28%29%20%7B%0A%20%20%20%20%20%20clip%2Epoint%20%3D%20pointLine%3B%0A%20%20%20%20%20%20line%2ElineStart%28%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20lineEnd%28%29%20%7B%0A%20%20%20%20%20%20clip%2Epoint%20%3D%20point%3B%0A%20%20%20%20%20%20line%2ElineEnd%28%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20pointRing%28lambda%2C%20phi%29%20%7B%0A%20%20%20%20%20%20ring%2Epush%28%5Blambda%2C%20phi%5D%29%3B%0A%20%20%20%20%20%20ringSink%2Epoint%28lambda%2C%20phi%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ringStart%28%29%20%7B%0A%20%20%20%20%20%20ringSink%2ElineStart%28%29%3B%0A%20%20%20%20%20%20ring%20%3D%20%5B%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ringEnd%28%29%20%7B%0A%20%20%20%20%20%20pointRing%28ring%5B0%5D%5B0%5D%2C%20ring%5B0%5D%5B1%5D%29%3B%0A%20%20%20%20%20%20ringSink%2ElineEnd%28%29%3B%0A%0A%20%20%20%20%20%20var%20clean%20%3D%20ringSink%2Eclean%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20ringSegments%20%3D%20ringBuffer%2Eresult%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20i%2C%20n%20%3D%20ringSegments%2Elength%2C%20m%2C%0A%20%20%20%20%20%20%20%20%20%20segment%2C%0A%20%20%20%20%20%20%20%20%20%20point%3B%0A%0A%20%20%20%20%20%20ring%2Epop%28%29%3B%0A%20%20%20%20%20%20polygon%2Epush%28ring%29%3B%0A%20%20%20%20%20%20ring%20%3D%20null%3B%0A%0A%20%20%20%20%20%20if%20%28%21n%29%20return%3B%0A%0A%20%20%20%20%20%20%2F%2F%20No%20intersections%2E%0A%20%20%20%20%20%20if%20%28clean%20%26%201%29%20%7B%0A%20%20%20%20%20%20%20%20segment%20%3D%20ringSegments%5B0%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28%28m%20%3D%20segment%2Elength%20%2D%201%29%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21polygonStarted%29%20sink%2EpolygonStart%28%29%2C%20polygonStarted%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20sink%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20m%3B%20%2B%2Bi%29%20sink%2Epoint%28%28point%20%3D%20segment%5Bi%5D%29%5B0%5D%2C%20point%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20sink%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20Rejoin%20connected%20segments%2E%0A%20%20%20%20%20%20%2F%2F%20TODO%20reuse%20ringBuffer%2Erejoin%28%29%3F%0A%20%20%20%20%20%20if%20%28n%20%3E%201%20%26%26%20clean%20%26%202%29%20ringSegments%2Epush%28ringSegments%2Epop%28%29%2Econcat%28ringSegments%2Eshift%28%29%29%29%3B%0A%0A%20%20%20%20%20%20segments%2Epush%28ringSegments%2Efilter%28validSegment%29%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20clip%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20validSegment%28segment%29%20%7B%0A%20%20return%20segment%2Elength%20%3E%201%3B%0A%7D%0A%0A%2F%2F%20Intersections%20are%20sorted%20along%20the%20clip%20edge%2E%20For%20both%20antimeridian%20cutting%0A%2F%2F%20and%20circle%20clipping%2C%20the%20same%20comparison%20is%20used%2E%0Afunction%20compareIntersection%28a%2C%20b%29%20%7B%0A%20%20return%20%28%28a%20%3D%20a%2Ex%29%5B0%5D%20%3C%200%20%3F%20a%5B1%5D%20%2D%20halfPi%242%20%2D%20epsilon%242%20%3A%20halfPi%242%20%2D%20a%5B1%5D%29%0A%20%20%20%20%20%20%20%2D%20%28%28b%20%3D%20b%2Ex%29%5B0%5D%20%3C%200%20%3F%20b%5B1%5D%20%2D%20halfPi%242%20%2D%20epsilon%242%20%3A%20halfPi%242%20%2D%20b%5B1%5D%29%3B%0A%7D%0A%0Avar%20clipAntimeridian%20%3D%20clip%28%0A%20%20function%28%29%20%7B%20return%20true%3B%20%7D%2C%0A%20%20clipAntimeridianLine%2C%0A%20%20clipAntimeridianInterpolate%2C%0A%20%20%5B%2Dpi%243%2C%20%2DhalfPi%242%5D%0A%29%3B%0A%0A%2F%2F%20Takes%20a%20line%20and%20cuts%20into%20visible%20segments%2E%20Return%20values%3A%200%20%2D%20there%20were%0A%2F%2F%20intersections%20or%20the%20line%20was%20empty%3B%201%20%2D%20no%20intersections%3B%202%20%2D%20there%20were%0A%2F%2F%20intersections%2C%20and%20the%20first%20and%20last%20segments%20should%20be%20rejoined%2E%0Afunction%20clipAntimeridianLine%28stream%29%20%7B%0A%20%20var%20lambda0%20%3D%20NaN%2C%0A%20%20%20%20%20%20phi0%20%3D%20NaN%2C%0A%20%20%20%20%20%20sign0%20%3D%20NaN%2C%0A%20%20%20%20%20%20clean%3B%20%2F%2F%20no%20intersections%0A%0A%20%20return%20%7B%0A%20%20%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20stream%2ElineStart%28%29%3B%0A%20%20%20%20%20%20clean%20%3D%201%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20point%3A%20function%28lambda1%2C%20phi1%29%20%7B%0A%20%20%20%20%20%20var%20sign1%20%3D%20lambda1%20%3E%200%20%3F%20pi%243%20%3A%20%2Dpi%243%2C%0A%20%20%20%20%20%20%20%20%20%20delta%20%3D%20abs%28lambda1%20%2D%20lambda0%29%3B%0A%20%20%20%20%20%20if%20%28abs%28delta%20%2D%20pi%243%29%20%3C%20epsilon%242%29%20%7B%20%2F%2F%20line%20crosses%20a%20pole%0A%20%20%20%20%20%20%20%20stream%2Epoint%28lambda0%2C%20phi0%20%3D%20%28phi0%20%2B%20phi1%29%20%2F%202%20%3E%200%20%3F%20halfPi%242%20%3A%20%2DhalfPi%242%29%3B%0A%20%20%20%20%20%20%20%20stream%2Epoint%28sign0%2C%20phi0%29%3B%0A%20%20%20%20%20%20%20%20stream%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%20%20stream%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20stream%2Epoint%28sign1%2C%20phi0%29%3B%0A%20%20%20%20%20%20%20%20stream%2Epoint%28lambda1%2C%20phi0%29%3B%0A%20%20%20%20%20%20%20%20clean%20%3D%200%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28sign0%20%21%3D%3D%20sign1%20%26%26%20delta%20%3E%3D%20pi%243%29%20%7B%20%2F%2F%20line%20crosses%20antimeridian%0A%20%20%20%20%20%20%20%20if%20%28abs%28lambda0%20%2D%20sign0%29%20%3C%20epsilon%242%29%20lambda0%20%2D%3D%20sign0%20%2A%20epsilon%242%3B%20%2F%2F%20handle%20degeneracies%0A%20%20%20%20%20%20%20%20if%20%28abs%28lambda1%20%2D%20sign1%29%20%3C%20epsilon%242%29%20lambda1%20%2D%3D%20sign1%20%2A%20epsilon%242%3B%0A%20%20%20%20%20%20%20%20phi0%20%3D%20clipAntimeridianIntersect%28lambda0%2C%20phi0%2C%20lambda1%2C%20phi1%29%3B%0A%20%20%20%20%20%20%20%20stream%2Epoint%28sign0%2C%20phi0%29%3B%0A%20%20%20%20%20%20%20%20stream%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%20%20stream%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20stream%2Epoint%28sign1%2C%20phi0%29%3B%0A%20%20%20%20%20%20%20%20clean%20%3D%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20stream%2Epoint%28lambda0%20%3D%20lambda1%2C%20phi0%20%3D%20phi1%29%3B%0A%20%20%20%20%20%20sign0%20%3D%20sign1%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20stream%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20lambda0%20%3D%20phi0%20%3D%20NaN%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20clean%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20return%202%20%2D%20clean%3B%20%2F%2F%20if%20intersections%2C%20rejoin%20first%20and%20last%20segments%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20clipAntimeridianIntersect%28lambda0%2C%20phi0%2C%20lambda1%2C%20phi1%29%20%7B%0A%20%20var%20cosPhi0%2C%0A%20%20%20%20%20%20cosPhi1%2C%0A%20%20%20%20%20%20sinLambda0Lambda1%20%3D%20sin%241%28lambda0%20%2D%20lambda1%29%3B%0A%20%20return%20abs%28sinLambda0Lambda1%29%20%3E%20epsilon%242%0A%20%20%20%20%20%20%3F%20atan%28%28sin%241%28phi0%29%20%2A%20%28cosPhi1%20%3D%20cos%241%28phi1%29%29%20%2A%20sin%241%28lambda1%29%0A%20%20%20%20%20%20%20%20%20%20%2D%20sin%241%28phi1%29%20%2A%20%28cosPhi0%20%3D%20cos%241%28phi0%29%29%20%2A%20sin%241%28lambda0%29%29%0A%20%20%20%20%20%20%20%20%20%20%2F%20%28cosPhi0%20%2A%20cosPhi1%20%2A%20sinLambda0Lambda1%29%29%0A%20%20%20%20%20%20%3A%20%28phi0%20%2B%20phi1%29%20%2F%202%3B%0A%7D%0A%0Afunction%20clipAntimeridianInterpolate%28from%2C%20to%2C%20direction%2C%20stream%29%20%7B%0A%20%20var%20phi%3B%0A%20%20if%20%28from%20%3D%3D%20null%29%20%7B%0A%20%20%20%20phi%20%3D%20direction%20%2A%20halfPi%242%3B%0A%20%20%20%20stream%2Epoint%28%2Dpi%243%2C%20phi%29%3B%0A%20%20%20%20stream%2Epoint%280%2C%20phi%29%3B%0A%20%20%20%20stream%2Epoint%28pi%243%2C%20phi%29%3B%0A%20%20%20%20stream%2Epoint%28pi%243%2C%200%29%3B%0A%20%20%20%20stream%2Epoint%28pi%243%2C%20%2Dphi%29%3B%0A%20%20%20%20stream%2Epoint%280%2C%20%2Dphi%29%3B%0A%20%20%20%20stream%2Epoint%28%2Dpi%243%2C%20%2Dphi%29%3B%0A%20%20%20%20stream%2Epoint%28%2Dpi%243%2C%200%29%3B%0A%20%20%20%20stream%2Epoint%28%2Dpi%243%2C%20phi%29%3B%0A%20%20%7D%20else%20if%20%28abs%28from%5B0%5D%20%2D%20to%5B0%5D%29%20%3E%20epsilon%242%29%20%7B%0A%20%20%20%20var%20lambda%20%3D%20from%5B0%5D%20%3C%20to%5B0%5D%20%3F%20pi%243%20%3A%20%2Dpi%243%3B%0A%20%20%20%20phi%20%3D%20direction%20%2A%20lambda%20%2F%202%3B%0A%20%20%20%20stream%2Epoint%28%2Dlambda%2C%20phi%29%3B%0A%20%20%20%20stream%2Epoint%280%2C%20phi%29%3B%0A%20%20%20%20stream%2Epoint%28lambda%2C%20phi%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20stream%2Epoint%28to%5B0%5D%2C%20to%5B1%5D%29%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20clipCircle%28radius%29%20%7B%0A%20%20var%20cr%20%3D%20cos%241%28radius%29%2C%0A%20%20%20%20%20%20delta%20%3D%206%20%2A%20radians%2C%0A%20%20%20%20%20%20smallRadius%20%3D%20cr%20%3E%200%2C%0A%20%20%20%20%20%20notHemisphere%20%3D%20abs%28cr%29%20%3E%20epsilon%242%3B%20%2F%2F%20TODO%20optimise%20for%20this%20common%20case%0A%0A%20%20function%20interpolate%28from%2C%20to%2C%20direction%2C%20stream%29%20%7B%0A%20%20%20%20circleStream%28stream%2C%20radius%2C%20delta%2C%20direction%2C%20from%2C%20to%29%3B%0A%20%20%7D%0A%0A%20%20function%20visible%28lambda%2C%20phi%29%20%7B%0A%20%20%20%20return%20cos%241%28lambda%29%20%2A%20cos%241%28phi%29%20%3E%20cr%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Takes%20a%20line%20and%20cuts%20into%20visible%20segments%2E%20Return%20values%20used%20for%20polygon%0A%20%20%2F%2F%20clipping%3A%200%20%2D%20there%20were%20intersections%20or%20the%20line%20was%20empty%3B%201%20%2D%20no%0A%20%20%2F%2F%20intersections%202%20%2D%20there%20were%20intersections%2C%20and%20the%20first%20and%20last%20segments%0A%20%20%2F%2F%20should%20be%20rejoined%2E%0A%20%20function%20clipLine%28stream%29%20%7B%0A%20%20%20%20var%20point0%2C%20%2F%2F%20previous%20point%0A%20%20%20%20%20%20%20%20c0%2C%20%2F%2F%20code%20for%20previous%20point%0A%20%20%20%20%20%20%20%20v0%2C%20%2F%2F%20visibility%20of%20previous%20point%0A%20%20%20%20%20%20%20%20v00%2C%20%2F%2F%20visibility%20of%20first%20point%0A%20%20%20%20%20%20%20%20clean%3B%20%2F%2F%20no%20intersections%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20v00%20%3D%20v0%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20clean%20%3D%201%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20point%3A%20function%28lambda%2C%20phi%29%20%7B%0A%20%20%20%20%20%20%20%20var%20point1%20%3D%20%5Blambda%2C%20phi%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20point2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20v%20%3D%20visible%28lambda%2C%20phi%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20c%20%3D%20smallRadius%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3F%20v%20%3F%200%20%3A%20code%28lambda%2C%20phi%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20v%20%3F%20code%28lambda%20%2B%20%28lambda%20%3C%200%20%3F%20pi%243%20%3A%20%2Dpi%243%29%2C%20phi%29%20%3A%200%3B%0A%20%20%20%20%20%20%20%20if%20%28%21point0%20%26%26%20%28v00%20%3D%20v0%20%3D%20v%29%29%20stream%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20Handle%20degeneracies%2E%0A%20%20%20%20%20%20%20%20%2F%2F%20TODO%20ignore%20if%20not%20clipping%20polygons%2E%0A%20%20%20%20%20%20%20%20if%20%28v%20%21%3D%3D%20v0%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20point2%20%3D%20intersect%28point0%2C%20point1%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21point2%20%7C%7C%20pointEqual%28point0%2C%20point2%29%20%7C%7C%20pointEqual%28point1%2C%20point2%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20point1%5B0%5D%20%2B%3D%20epsilon%242%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20point1%5B1%5D%20%2B%3D%20epsilon%242%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20v%20%3D%20visible%28point1%5B0%5D%2C%20point1%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28v%20%21%3D%3D%20v0%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20clean%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28v%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20outside%20going%20in%0A%20%20%20%20%20%20%20%20%20%20%20%20stream%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20point2%20%3D%20intersect%28point1%2C%20point0%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20stream%2Epoint%28point2%5B0%5D%2C%20point2%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20inside%20going%20out%0A%20%20%20%20%20%20%20%20%20%20%20%20point2%20%3D%20intersect%28point0%2C%20point1%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20stream%2Epoint%28point2%5B0%5D%2C%20point2%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20stream%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20point0%20%3D%20point2%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28notHemisphere%20%26%26%20point0%20%26%26%20smallRadius%20%5E%20v%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20t%3B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20If%20the%20codes%20for%20two%20points%20are%20different%2C%20or%20are%20both%20zero%2C%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20and%20there%20this%20segment%20intersects%20with%20the%20small%20circle%2E%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21%28c%20%26%20c0%29%20%26%26%20%28t%20%3D%20intersect%28point1%2C%20point0%2C%20true%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20clean%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28smallRadius%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stream%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stream%2Epoint%28t%5B0%5D%5B0%5D%2C%20t%5B0%5D%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stream%2Epoint%28t%5B1%5D%5B0%5D%2C%20t%5B1%5D%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stream%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stream%2Epoint%28t%5B1%5D%5B0%5D%2C%20t%5B1%5D%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stream%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stream%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stream%2Epoint%28t%5B0%5D%5B0%5D%2C%20t%5B0%5D%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28v%20%26%26%20%28%21point0%20%7C%7C%20%21pointEqual%28point0%2C%20point1%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20stream%2Epoint%28point1%5B0%5D%2C%20point1%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20point0%20%3D%20point1%2C%20v0%20%3D%20v%2C%20c0%20%3D%20c%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28v0%29%20stream%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%20%20point0%20%3D%20null%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%2F%2F%20Rejoin%20first%20and%20last%20segments%20if%20there%20were%20intersections%20and%20the%20first%0A%20%20%20%20%20%20%2F%2F%20and%20last%20points%20were%20visible%2E%0A%20%20%20%20%20%20clean%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20return%20clean%20%7C%20%28%28v00%20%26%26%20v0%29%20%3C%3C%201%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Intersects%20the%20great%20circle%20between%20a%20and%20b%20with%20the%20clip%20circle%2E%0A%20%20function%20intersect%28a%2C%20b%2C%20two%29%20%7B%0A%20%20%20%20var%20pa%20%3D%20cartesian%28a%29%2C%0A%20%20%20%20%20%20%20%20pb%20%3D%20cartesian%28b%29%3B%0A%0A%20%20%20%20%2F%2F%20We%20have%20two%20planes%2C%20n1%2Ep%20%3D%20d1%20and%20n2%2Ep%20%3D%20d2%2E%0A%20%20%20%20%2F%2F%20Find%20intersection%20line%20p%28t%29%20%3D%20c1%20n1%20%2B%20c2%20n2%20%2B%20t%20%28n1%20%E2%A8%AF%20n2%29%2E%0A%20%20%20%20var%20n1%20%3D%20%5B1%2C%200%2C%200%5D%2C%20%2F%2F%20normal%0A%20%20%20%20%20%20%20%20n2%20%3D%20cartesianCross%28pa%2C%20pb%29%2C%0A%20%20%20%20%20%20%20%20n2n2%20%3D%20cartesianDot%28n2%2C%20n2%29%2C%0A%20%20%20%20%20%20%20%20n1n2%20%3D%20n2%5B0%5D%2C%20%2F%2F%20cartesianDot%28n1%2C%20n2%29%2C%0A%20%20%20%20%20%20%20%20determinant%20%3D%20n2n2%20%2D%20n1n2%20%2A%20n1n2%3B%0A%0A%20%20%20%20%2F%2F%20Two%20polar%20points%2E%0A%20%20%20%20if%20%28%21determinant%29%20return%20%21two%20%26%26%20a%3B%0A%0A%20%20%20%20var%20c1%20%3D%20%20cr%20%2A%20n2n2%20%2F%20determinant%2C%0A%20%20%20%20%20%20%20%20c2%20%3D%20%2Dcr%20%2A%20n1n2%20%2F%20determinant%2C%0A%20%20%20%20%20%20%20%20n1xn2%20%3D%20cartesianCross%28n1%2C%20n2%29%2C%0A%20%20%20%20%20%20%20%20A%20%3D%20cartesianScale%28n1%2C%20c1%29%2C%0A%20%20%20%20%20%20%20%20B%20%3D%20cartesianScale%28n2%2C%20c2%29%3B%0A%20%20%20%20cartesianAddInPlace%28A%2C%20B%29%3B%0A%0A%20%20%20%20%2F%2F%20Solve%20%7Cp%28t%29%7C%5E2%20%3D%201%2E%0A%20%20%20%20var%20u%20%3D%20n1xn2%2C%0A%20%20%20%20%20%20%20%20w%20%3D%20cartesianDot%28A%2C%20u%29%2C%0A%20%20%20%20%20%20%20%20uu%20%3D%20cartesianDot%28u%2C%20u%29%2C%0A%20%20%20%20%20%20%20%20t2%20%3D%20w%20%2A%20w%20%2D%20uu%20%2A%20%28cartesianDot%28A%2C%20A%29%20%2D%201%29%3B%0A%0A%20%20%20%20if%20%28t2%20%3C%200%29%20return%3B%0A%0A%20%20%20%20var%20t%20%3D%20sqrt%28t2%29%2C%0A%20%20%20%20%20%20%20%20q%20%3D%20cartesianScale%28u%2C%20%28%2Dw%20%2D%20t%29%20%2F%20uu%29%3B%0A%20%20%20%20cartesianAddInPlace%28q%2C%20A%29%3B%0A%20%20%20%20q%20%3D%20spherical%28q%29%3B%0A%0A%20%20%20%20if%20%28%21two%29%20return%20q%3B%0A%0A%20%20%20%20%2F%2F%20Two%20intersection%20points%2E%0A%20%20%20%20var%20lambda0%20%3D%20a%5B0%5D%2C%0A%20%20%20%20%20%20%20%20lambda1%20%3D%20b%5B0%5D%2C%0A%20%20%20%20%20%20%20%20phi0%20%3D%20a%5B1%5D%2C%0A%20%20%20%20%20%20%20%20phi1%20%3D%20b%5B1%5D%2C%0A%20%20%20%20%20%20%20%20z%3B%0A%0A%20%20%20%20if%20%28lambda1%20%3C%20lambda0%29%20z%20%3D%20lambda0%2C%20lambda0%20%3D%20lambda1%2C%20lambda1%20%3D%20z%3B%0A%0A%20%20%20%20var%20delta%20%3D%20lambda1%20%2D%20lambda0%2C%0A%20%20%20%20%20%20%20%20polar%20%3D%20abs%28delta%20%2D%20pi%243%29%20%3C%20epsilon%242%2C%0A%20%20%20%20%20%20%20%20meridian%20%3D%20polar%20%7C%7C%20delta%20%3C%20epsilon%242%3B%0A%0A%20%20%20%20if%20%28%21polar%20%26%26%20phi1%20%3C%20phi0%29%20z%20%3D%20phi0%2C%20phi0%20%3D%20phi1%2C%20phi1%20%3D%20z%3B%0A%0A%20%20%20%20%2F%2F%20Check%20that%20the%20first%20point%20is%20between%20a%20and%20b%2E%0A%20%20%20%20if%20%28meridian%0A%20%20%20%20%20%20%20%20%3F%20polar%0A%20%20%20%20%20%20%20%20%20%20%3F%20phi0%20%2B%20phi1%20%3E%200%20%5E%20q%5B1%5D%20%3C%20%28abs%28q%5B0%5D%20%2D%20lambda0%29%20%3C%20epsilon%242%20%3F%20phi0%20%3A%20phi1%29%0A%20%20%20%20%20%20%20%20%20%20%3A%20phi0%20%3C%3D%20q%5B1%5D%20%26%26%20q%5B1%5D%20%3C%3D%20phi1%0A%20%20%20%20%20%20%20%20%3A%20delta%20%3E%20pi%243%20%5E%20%28lambda0%20%3C%3D%20q%5B0%5D%20%26%26%20q%5B0%5D%20%3C%3D%20lambda1%29%29%20%7B%0A%20%20%20%20%20%20var%20q1%20%3D%20cartesianScale%28u%2C%20%28%2Dw%20%2B%20t%29%20%2F%20uu%29%3B%0A%20%20%20%20%20%20cartesianAddInPlace%28q1%2C%20A%29%3B%0A%20%20%20%20%20%20return%20%5Bq%2C%20spherical%28q1%29%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20Generates%20a%204%2Dbit%20vector%20representing%20the%20location%20of%20a%20point%20relative%20to%0A%20%20%2F%2F%20the%20small%20circle%27s%20bounding%20box%2E%0A%20%20function%20code%28lambda%2C%20phi%29%20%7B%0A%20%20%20%20var%20r%20%3D%20smallRadius%20%3F%20radius%20%3A%20pi%243%20%2D%20radius%2C%0A%20%20%20%20%20%20%20%20code%20%3D%200%3B%0A%20%20%20%20if%20%28lambda%20%3C%20%2Dr%29%20code%20%7C%3D%201%3B%20%2F%2F%20left%0A%20%20%20%20else%20if%20%28lambda%20%3E%20r%29%20code%20%7C%3D%202%3B%20%2F%2F%20right%0A%20%20%20%20if%20%28phi%20%3C%20%2Dr%29%20code%20%7C%3D%204%3B%20%2F%2F%20below%0A%20%20%20%20else%20if%20%28phi%20%3E%20r%29%20code%20%7C%3D%208%3B%20%2F%2F%20above%0A%20%20%20%20return%20code%3B%0A%20%20%7D%0A%0A%20%20return%20clip%28visible%2C%20clipLine%2C%20interpolate%2C%20smallRadius%20%3F%20%5B0%2C%20%2Dradius%5D%20%3A%20%5B%2Dpi%243%2C%20radius%20%2D%20pi%243%5D%29%3B%0A%7D%0A%0Afunction%20clipLine%28a%2C%20b%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20var%20ax%20%3D%20a%5B0%5D%2C%0A%20%20%20%20%20%20ay%20%3D%20a%5B1%5D%2C%0A%20%20%20%20%20%20bx%20%3D%20b%5B0%5D%2C%0A%20%20%20%20%20%20by%20%3D%20b%5B1%5D%2C%0A%20%20%20%20%20%20t0%20%3D%200%2C%0A%20%20%20%20%20%20t1%20%3D%201%2C%0A%20%20%20%20%20%20dx%20%3D%20bx%20%2D%20ax%2C%0A%20%20%20%20%20%20dy%20%3D%20by%20%2D%20ay%2C%0A%20%20%20%20%20%20r%3B%0A%0A%20%20r%20%3D%20x0%20%2D%20ax%3B%0A%20%20if%20%28%21dx%20%26%26%20r%20%3E%200%29%20return%3B%0A%20%20r%20%2F%3D%20dx%3B%0A%20%20if%20%28dx%20%3C%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3C%20t0%29%20return%3B%0A%20%20%20%20if%20%28r%20%3C%20t1%29%20t1%20%3D%20r%3B%0A%20%20%7D%20else%20if%20%28dx%20%3E%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3E%20t1%29%20return%3B%0A%20%20%20%20if%20%28r%20%3E%20t0%29%20t0%20%3D%20r%3B%0A%20%20%7D%0A%0A%20%20r%20%3D%20x1%20%2D%20ax%3B%0A%20%20if%20%28%21dx%20%26%26%20r%20%3C%200%29%20return%3B%0A%20%20r%20%2F%3D%20dx%3B%0A%20%20if%20%28dx%20%3C%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3E%20t1%29%20return%3B%0A%20%20%20%20if%20%28r%20%3E%20t0%29%20t0%20%3D%20r%3B%0A%20%20%7D%20else%20if%20%28dx%20%3E%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3C%20t0%29%20return%3B%0A%20%20%20%20if%20%28r%20%3C%20t1%29%20t1%20%3D%20r%3B%0A%20%20%7D%0A%0A%20%20r%20%3D%20y0%20%2D%20ay%3B%0A%20%20if%20%28%21dy%20%26%26%20r%20%3E%200%29%20return%3B%0A%20%20r%20%2F%3D%20dy%3B%0A%20%20if%20%28dy%20%3C%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3C%20t0%29%20return%3B%0A%20%20%20%20if%20%28r%20%3C%20t1%29%20t1%20%3D%20r%3B%0A%20%20%7D%20else%20if%20%28dy%20%3E%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3E%20t1%29%20return%3B%0A%20%20%20%20if%20%28r%20%3E%20t0%29%20t0%20%3D%20r%3B%0A%20%20%7D%0A%0A%20%20r%20%3D%20y1%20%2D%20ay%3B%0A%20%20if%20%28%21dy%20%26%26%20r%20%3C%200%29%20return%3B%0A%20%20r%20%2F%3D%20dy%3B%0A%20%20if%20%28dy%20%3C%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3E%20t1%29%20return%3B%0A%20%20%20%20if%20%28r%20%3E%20t0%29%20t0%20%3D%20r%3B%0A%20%20%7D%20else%20if%20%28dy%20%3E%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3C%20t0%29%20return%3B%0A%20%20%20%20if%20%28r%20%3C%20t1%29%20t1%20%3D%20r%3B%0A%20%20%7D%0A%0A%20%20if%20%28t0%20%3E%200%29%20a%5B0%5D%20%3D%20ax%20%2B%20t0%20%2A%20dx%2C%20a%5B1%5D%20%3D%20ay%20%2B%20t0%20%2A%20dy%3B%0A%20%20if%20%28t1%20%3C%201%29%20b%5B0%5D%20%3D%20ax%20%2B%20t1%20%2A%20dx%2C%20b%5B1%5D%20%3D%20ay%20%2B%20t1%20%2A%20dy%3B%0A%20%20return%20true%3B%0A%7D%0A%0Avar%20clipMax%20%3D%201e9%2C%20clipMin%20%3D%20%2DclipMax%3B%0A%0A%2F%2F%20TODO%20Use%20d3%2Dpolygon%E2%80%99s%20polygonContains%20here%20for%20the%20ring%20check%3F%0A%2F%2F%20TODO%20Eliminate%20duplicate%20buffering%20in%20clipBuffer%20and%20polygon%2Epush%3F%0A%0Afunction%20clipRectangle%28x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%0A%20%20function%20visible%28x%2C%20y%29%20%7B%0A%20%20%20%20return%20x0%20%3C%3D%20x%20%26%26%20x%20%3C%3D%20x1%20%26%26%20y0%20%3C%3D%20y%20%26%26%20y%20%3C%3D%20y1%3B%0A%20%20%7D%0A%0A%20%20function%20interpolate%28from%2C%20to%2C%20direction%2C%20stream%29%20%7B%0A%20%20%20%20var%20a%20%3D%200%2C%20a1%20%3D%200%3B%0A%20%20%20%20if%20%28from%20%3D%3D%20null%0A%20%20%20%20%20%20%20%20%7C%7C%20%28a%20%3D%20corner%28from%2C%20direction%29%29%20%21%3D%3D%20%28a1%20%3D%20corner%28to%2C%20direction%29%29%0A%20%20%20%20%20%20%20%20%7C%7C%20comparePoint%28from%2C%20to%29%20%3C%200%20%5E%20direction%20%3E%200%29%20%7B%0A%20%20%20%20%20%20do%20stream%2Epoint%28a%20%3D%3D%3D%200%20%7C%7C%20a%20%3D%3D%3D%203%20%3F%20x0%20%3A%20x1%2C%20a%20%3E%201%20%3F%20y1%20%3A%20y0%29%3B%0A%20%20%20%20%20%20while%20%28%28a%20%3D%20%28a%20%2B%20direction%20%2B%204%29%20%25%204%29%20%21%3D%3D%20a1%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20stream%2Epoint%28to%5B0%5D%2C%20to%5B1%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20corner%28p%2C%20direction%29%20%7B%0A%20%20%20%20return%20abs%28p%5B0%5D%20%2D%20x0%29%20%3C%20epsilon%242%20%3F%20direction%20%3E%200%20%3F%200%20%3A%203%0A%20%20%20%20%20%20%20%20%3A%20abs%28p%5B0%5D%20%2D%20x1%29%20%3C%20epsilon%242%20%3F%20direction%20%3E%200%20%3F%202%20%3A%201%0A%20%20%20%20%20%20%20%20%3A%20abs%28p%5B1%5D%20%2D%20y0%29%20%3C%20epsilon%242%20%3F%20direction%20%3E%200%20%3F%201%20%3A%200%0A%20%20%20%20%20%20%20%20%3A%20direction%20%3E%200%20%3F%203%20%3A%202%3B%20%2F%2F%20abs%28p%5B1%5D%20%2D%20y1%29%20%3C%20epsilon%0A%20%20%7D%0A%0A%20%20function%20compareIntersection%28a%2C%20b%29%20%7B%0A%20%20%20%20return%20comparePoint%28a%2Ex%2C%20b%2Ex%29%3B%0A%20%20%7D%0A%0A%20%20function%20comparePoint%28a%2C%20b%29%20%7B%0A%20%20%20%20var%20ca%20%3D%20corner%28a%2C%201%29%2C%0A%20%20%20%20%20%20%20%20cb%20%3D%20corner%28b%2C%201%29%3B%0A%20%20%20%20return%20ca%20%21%3D%3D%20cb%20%3F%20ca%20%2D%20cb%0A%20%20%20%20%20%20%20%20%3A%20ca%20%3D%3D%3D%200%20%3F%20b%5B1%5D%20%2D%20a%5B1%5D%0A%20%20%20%20%20%20%20%20%3A%20ca%20%3D%3D%3D%201%20%3F%20a%5B0%5D%20%2D%20b%5B0%5D%0A%20%20%20%20%20%20%20%20%3A%20ca%20%3D%3D%3D%202%20%3F%20a%5B1%5D%20%2D%20b%5B1%5D%0A%20%20%20%20%20%20%20%20%3A%20b%5B0%5D%20%2D%20a%5B0%5D%3B%0A%20%20%7D%0A%0A%20%20return%20function%28stream%29%20%7B%0A%20%20%20%20var%20activeStream%20%3D%20stream%2C%0A%20%20%20%20%20%20%20%20bufferStream%20%3D%20clipBuffer%28%29%2C%0A%20%20%20%20%20%20%20%20segments%2C%0A%20%20%20%20%20%20%20%20polygon%2C%0A%20%20%20%20%20%20%20%20ring%2C%0A%20%20%20%20%20%20%20%20x%5F%5F%2C%20y%5F%5F%2C%20v%5F%5F%2C%20%2F%2F%20first%20point%0A%20%20%20%20%20%20%20%20x%5F%2C%20y%5F%2C%20v%5F%2C%20%2F%2F%20previous%20point%0A%20%20%20%20%20%20%20%20first%2C%0A%20%20%20%20%20%20%20%20clean%3B%0A%0A%20%20%20%20var%20clipStream%20%3D%20%7B%0A%20%20%20%20%20%20point%3A%20point%2C%0A%20%20%20%20%20%20lineStart%3A%20lineStart%2C%0A%20%20%20%20%20%20lineEnd%3A%20lineEnd%2C%0A%20%20%20%20%20%20polygonStart%3A%20polygonStart%2C%0A%20%20%20%20%20%20polygonEnd%3A%20polygonEnd%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20point%28x%2C%20y%29%20%7B%0A%20%20%20%20%20%20if%20%28visible%28x%2C%20y%29%29%20activeStream%2Epoint%28x%2C%20y%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20polygonInside%28%29%20%7B%0A%20%20%20%20%20%20var%20winding%20%3D%200%3B%0A%0A%20%20%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20polygon%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28var%20ring%20%3D%20polygon%5Bi%5D%2C%20j%20%3D%201%2C%20m%20%3D%20ring%2Elength%2C%20point%20%3D%20ring%5B0%5D%2C%20a0%2C%20a1%2C%20b0%20%3D%20point%5B0%5D%2C%20b1%20%3D%20point%5B1%5D%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20a0%20%3D%20b0%2C%20a1%20%3D%20b1%2C%20point%20%3D%20ring%5Bj%5D%2C%20b0%20%3D%20point%5B0%5D%2C%20b1%20%3D%20point%5B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28a1%20%3C%3D%20y1%29%20%7B%20if%20%28b1%20%3E%20y1%20%26%26%20%28b0%20%2D%20a0%29%20%2A%20%28y1%20%2D%20a1%29%20%3E%20%28b1%20%2D%20a1%29%20%2A%20%28x0%20%2D%20a0%29%29%20%2B%2Bwinding%3B%20%7D%0A%20%20%20%20%20%20%20%20%20%20else%20%7B%20if%20%28b1%20%3C%3D%20y1%20%26%26%20%28b0%20%2D%20a0%29%20%2A%20%28y1%20%2D%20a1%29%20%3C%20%28b1%20%2D%20a1%29%20%2A%20%28x0%20%2D%20a0%29%29%20%2D%2Dwinding%3B%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20return%20winding%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Buffer%20geometry%20within%20a%20polygon%20and%20then%20clip%20it%20en%20masse%2E%0A%20%20%20%20function%20polygonStart%28%29%20%7B%0A%20%20%20%20%20%20activeStream%20%3D%20bufferStream%2C%20segments%20%3D%20%5B%5D%2C%20polygon%20%3D%20%5B%5D%2C%20clean%20%3D%20true%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20polygonEnd%28%29%20%7B%0A%20%20%20%20%20%20var%20startInside%20%3D%20polygonInside%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20cleanInside%20%3D%20clean%20%26%26%20startInside%2C%0A%20%20%20%20%20%20%20%20%20%20visible%20%3D%20%28segments%20%3D%20merge%28segments%29%29%2Elength%3B%0A%20%20%20%20%20%20if%20%28cleanInside%20%7C%7C%20visible%29%20%7B%0A%20%20%20%20%20%20%20%20stream%2EpolygonStart%28%29%3B%0A%20%20%20%20%20%20%20%20if%20%28cleanInside%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20stream%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20interpolate%28null%2C%20null%2C%201%2C%20stream%29%3B%0A%20%20%20%20%20%20%20%20%20%20stream%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28visible%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20clipRejoin%28segments%2C%20compareIntersection%2C%20startInside%2C%20interpolate%2C%20stream%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20stream%2EpolygonEnd%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20activeStream%20%3D%20stream%2C%20segments%20%3D%20polygon%20%3D%20ring%20%3D%20null%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20lineStart%28%29%20%7B%0A%20%20%20%20%20%20clipStream%2Epoint%20%3D%20linePoint%3B%0A%20%20%20%20%20%20if%20%28polygon%29%20polygon%2Epush%28ring%20%3D%20%5B%5D%29%3B%0A%20%20%20%20%20%20first%20%3D%20true%3B%0A%20%20%20%20%20%20v%5F%20%3D%20false%3B%0A%20%20%20%20%20%20x%5F%20%3D%20y%5F%20%3D%20NaN%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20TODO%20rather%20than%20special%2Dcase%20polygons%2C%20simply%20handle%20them%20separately%2E%0A%20%20%20%20%2F%2F%20Ideally%2C%20coincident%20intersection%20points%20should%20be%20jittered%20to%20avoid%0A%20%20%20%20%2F%2F%20clipping%20issues%2E%0A%20%20%20%20function%20lineEnd%28%29%20%7B%0A%20%20%20%20%20%20if%20%28segments%29%20%7B%0A%20%20%20%20%20%20%20%20linePoint%28x%5F%5F%2C%20y%5F%5F%29%3B%0A%20%20%20%20%20%20%20%20if%20%28v%5F%5F%20%26%26%20v%5F%29%20bufferStream%2Erejoin%28%29%3B%0A%20%20%20%20%20%20%20%20segments%2Epush%28bufferStream%2Eresult%28%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20clipStream%2Epoint%20%3D%20point%3B%0A%20%20%20%20%20%20if%20%28v%5F%29%20activeStream%2ElineEnd%28%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20linePoint%28x%2C%20y%29%20%7B%0A%20%20%20%20%20%20var%20v%20%3D%20visible%28x%2C%20y%29%3B%0A%20%20%20%20%20%20if%20%28polygon%29%20ring%2Epush%28%5Bx%2C%20y%5D%29%3B%0A%20%20%20%20%20%20if%20%28first%29%20%7B%0A%20%20%20%20%20%20%20%20x%5F%5F%20%3D%20x%2C%20y%5F%5F%20%3D%20y%2C%20v%5F%5F%20%3D%20v%3B%0A%20%20%20%20%20%20%20%20first%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20if%20%28v%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20activeStream%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20activeStream%2Epoint%28x%2C%20y%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28v%20%26%26%20v%5F%29%20activeStream%2Epoint%28x%2C%20y%29%3B%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20a%20%3D%20%5Bx%5F%20%3D%20Math%2Emax%28clipMin%2C%20Math%2Emin%28clipMax%2C%20x%5F%29%29%2C%20y%5F%20%3D%20Math%2Emax%28clipMin%2C%20Math%2Emin%28clipMax%2C%20y%5F%29%29%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20b%20%3D%20%5Bx%20%3D%20Math%2Emax%28clipMin%2C%20Math%2Emin%28clipMax%2C%20x%29%29%2C%20y%20%3D%20Math%2Emax%28clipMin%2C%20Math%2Emin%28clipMax%2C%20y%29%29%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28clipLine%28a%2C%20b%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21v%5F%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20activeStream%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20activeStream%2Epoint%28a%5B0%5D%2C%20a%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20activeStream%2Epoint%28b%5B0%5D%2C%20b%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21v%29%20activeStream%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20clean%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28v%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20activeStream%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20activeStream%2Epoint%28x%2C%20y%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20clean%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20x%5F%20%3D%20x%2C%20y%5F%20%3D%20y%2C%20v%5F%20%3D%20v%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20clipStream%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20extent%241%28%29%20%7B%0A%20%20var%20x0%20%3D%200%2C%0A%20%20%20%20%20%20y0%20%3D%200%2C%0A%20%20%20%20%20%20x1%20%3D%20960%2C%0A%20%20%20%20%20%20y1%20%3D%20500%2C%0A%20%20%20%20%20%20cache%2C%0A%20%20%20%20%20%20cacheStream%2C%0A%20%20%20%20%20%20clip%3B%0A%0A%20%20return%20clip%20%3D%20%7B%0A%20%20%20%20stream%3A%20function%28stream%29%20%7B%0A%20%20%20%20%20%20return%20cache%20%26%26%20cacheStream%20%3D%3D%3D%20stream%20%3F%20cache%20%3A%20cache%20%3D%20clipRectangle%28x0%2C%20y0%2C%20x1%2C%20y1%29%28cacheStream%20%3D%20stream%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20extent%3A%20function%28%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3F%20%28x0%20%3D%20%2B%5F%5B0%5D%5B0%5D%2C%20y0%20%3D%20%2B%5F%5B0%5D%5B1%5D%2C%20x1%20%3D%20%2B%5F%5B1%5D%5B0%5D%2C%20y1%20%3D%20%2B%5F%5B1%5D%5B1%5D%2C%20cache%20%3D%20cacheStream%20%3D%20null%2C%20clip%29%20%3A%20%5B%5Bx0%2C%20y0%5D%2C%20%5Bx1%2C%20y1%5D%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0A%0Avar%20lengthSum%20%3D%20adder%28%29%2C%0A%20%20%20%20lambda0%242%2C%0A%20%20%20%20sinPhi0%241%2C%0A%20%20%20%20cosPhi0%241%3B%0A%0Avar%20lengthStream%20%3D%20%7B%0A%20%20sphere%3A%20noop%242%2C%0A%20%20point%3A%20noop%242%2C%0A%20%20lineStart%3A%20lengthLineStart%2C%0A%20%20lineEnd%3A%20noop%242%2C%0A%20%20polygonStart%3A%20noop%242%2C%0A%20%20polygonEnd%3A%20noop%242%0A%7D%3B%0A%0Afunction%20lengthLineStart%28%29%20%7B%0A%20%20lengthStream%2Epoint%20%3D%20lengthPointFirst%3B%0A%20%20lengthStream%2ElineEnd%20%3D%20lengthLineEnd%3B%0A%7D%0A%0Afunction%20lengthLineEnd%28%29%20%7B%0A%20%20lengthStream%2Epoint%20%3D%20lengthStream%2ElineEnd%20%3D%20noop%242%3B%0A%7D%0A%0Afunction%20lengthPointFirst%28lambda%2C%20phi%29%20%7B%0A%20%20lambda%20%2A%3D%20radians%2C%20phi%20%2A%3D%20radians%3B%0A%20%20lambda0%242%20%3D%20lambda%2C%20sinPhi0%241%20%3D%20sin%241%28phi%29%2C%20cosPhi0%241%20%3D%20cos%241%28phi%29%3B%0A%20%20lengthStream%2Epoint%20%3D%20lengthPoint%3B%0A%7D%0A%0Afunction%20lengthPoint%28lambda%2C%20phi%29%20%7B%0A%20%20lambda%20%2A%3D%20radians%2C%20phi%20%2A%3D%20radians%3B%0A%20%20var%20sinPhi%20%3D%20sin%241%28phi%29%2C%0A%20%20%20%20%20%20cosPhi%20%3D%20cos%241%28phi%29%2C%0A%20%20%20%20%20%20delta%20%3D%20abs%28lambda%20%2D%20lambda0%242%29%2C%0A%20%20%20%20%20%20cosDelta%20%3D%20cos%241%28delta%29%2C%0A%20%20%20%20%20%20sinDelta%20%3D%20sin%241%28delta%29%2C%0A%20%20%20%20%20%20x%20%3D%20cosPhi%20%2A%20sinDelta%2C%0A%20%20%20%20%20%20y%20%3D%20cosPhi0%241%20%2A%20sinPhi%20%2D%20sinPhi0%241%20%2A%20cosPhi%20%2A%20cosDelta%2C%0A%20%20%20%20%20%20z%20%3D%20sinPhi0%241%20%2A%20sinPhi%20%2B%20cosPhi0%241%20%2A%20cosPhi%20%2A%20cosDelta%3B%0A%20%20lengthSum%2Eadd%28atan2%28sqrt%28x%20%2A%20x%20%2B%20y%20%2A%20y%29%2C%20z%29%29%3B%0A%20%20lambda0%242%20%3D%20lambda%2C%20sinPhi0%241%20%3D%20sinPhi%2C%20cosPhi0%241%20%3D%20cosPhi%3B%0A%7D%0A%0Afunction%20length%241%28object%29%20%7B%0A%20%20lengthSum%2Ereset%28%29%3B%0A%20%20geoStream%28object%2C%20lengthStream%29%3B%0A%20%20return%20%2BlengthSum%3B%0A%7D%0A%0Avar%20coordinates%20%3D%20%5Bnull%2C%20null%5D%2C%0A%20%20%20%20object%241%20%3D%20%7Btype%3A%20%22LineString%22%2C%20coordinates%3A%20coordinates%7D%3B%0A%0Afunction%20distance%28a%2C%20b%29%20%7B%0A%20%20coordinates%5B0%5D%20%3D%20a%3B%0A%20%20coordinates%5B1%5D%20%3D%20b%3B%0A%20%20return%20length%241%28object%241%29%3B%0A%7D%0A%0Avar%20containsObjectType%20%3D%20%7B%0A%20%20Feature%3A%20function%28object%2C%20point%29%20%7B%0A%20%20%20%20return%20containsGeometry%28object%2Egeometry%2C%20point%29%3B%0A%20%20%7D%2C%0A%20%20FeatureCollection%3A%20function%28object%2C%20point%29%20%7B%0A%20%20%20%20var%20features%20%3D%20object%2Efeatures%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20features%2Elength%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20if%20%28containsGeometry%28features%5Bi%5D%2Egeometry%2C%20point%29%29%20return%20true%3B%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20containsGeometryType%20%3D%20%7B%0A%20%20Sphere%3A%20function%28%29%20%7B%0A%20%20%20%20return%20true%3B%0A%20%20%7D%2C%0A%20%20Point%3A%20function%28object%2C%20point%29%20%7B%0A%20%20%20%20return%20containsPoint%28object%2Ecoordinates%2C%20point%29%3B%0A%20%20%7D%2C%0A%20%20MultiPoint%3A%20function%28object%2C%20point%29%20%7B%0A%20%20%20%20var%20coordinates%20%3D%20object%2Ecoordinates%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20coordinates%2Elength%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20if%20%28containsPoint%28coordinates%5Bi%5D%2C%20point%29%29%20return%20true%3B%0A%20%20%20%20return%20false%3B%0A%20%20%7D%2C%0A%20%20LineString%3A%20function%28object%2C%20point%29%20%7B%0A%20%20%20%20return%20containsLine%28object%2Ecoordinates%2C%20point%29%3B%0A%20%20%7D%2C%0A%20%20MultiLineString%3A%20function%28object%2C%20point%29%20%7B%0A%20%20%20%20var%20coordinates%20%3D%20object%2Ecoordinates%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20coordinates%2Elength%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20if%20%28containsLine%28coordinates%5Bi%5D%2C%20point%29%29%20return%20true%3B%0A%20%20%20%20return%20false%3B%0A%20%20%7D%2C%0A%20%20Polygon%3A%20function%28object%2C%20point%29%20%7B%0A%20%20%20%20return%20containsPolygon%28object%2Ecoordinates%2C%20point%29%3B%0A%20%20%7D%2C%0A%20%20MultiPolygon%3A%20function%28object%2C%20point%29%20%7B%0A%20%20%20%20var%20coordinates%20%3D%20object%2Ecoordinates%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20coordinates%2Elength%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20if%20%28containsPolygon%28coordinates%5Bi%5D%2C%20point%29%29%20return%20true%3B%0A%20%20%20%20return%20false%3B%0A%20%20%7D%2C%0A%20%20GeometryCollection%3A%20function%28object%2C%20point%29%20%7B%0A%20%20%20%20var%20geometries%20%3D%20object%2Egeometries%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20geometries%2Elength%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20if%20%28containsGeometry%28geometries%5Bi%5D%2C%20point%29%29%20return%20true%3B%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20containsGeometry%28geometry%2C%20point%29%20%7B%0A%20%20return%20geometry%20%26%26%20containsGeometryType%2EhasOwnProperty%28geometry%2Etype%29%0A%20%20%20%20%20%20%3F%20containsGeometryType%5Bgeometry%2Etype%5D%28geometry%2C%20point%29%0A%20%20%20%20%20%20%3A%20false%3B%0A%7D%0A%0Afunction%20containsPoint%28coordinates%2C%20point%29%20%7B%0A%20%20return%20distance%28coordinates%2C%20point%29%20%3D%3D%3D%200%3B%0A%7D%0A%0Afunction%20containsLine%28coordinates%2C%20point%29%20%7B%0A%20%20var%20ab%20%3D%20distance%28coordinates%5B0%5D%2C%20coordinates%5B1%5D%29%2C%0A%20%20%20%20%20%20ao%20%3D%20distance%28coordinates%5B0%5D%2C%20point%29%2C%0A%20%20%20%20%20%20ob%20%3D%20distance%28point%2C%20coordinates%5B1%5D%29%3B%0A%20%20return%20ao%20%2B%20ob%20%3C%3D%20ab%20%2B%20epsilon%242%3B%0A%7D%0A%0Afunction%20containsPolygon%28coordinates%2C%20point%29%20%7B%0A%20%20return%20%21%21polygonContains%28coordinates%2Emap%28ringRadians%29%2C%20pointRadians%28point%29%29%3B%0A%7D%0A%0Afunction%20ringRadians%28ring%29%20%7B%0A%20%20return%20ring%20%3D%20ring%2Emap%28pointRadians%29%2C%20ring%2Epop%28%29%2C%20ring%3B%0A%7D%0A%0Afunction%20pointRadians%28point%29%20%7B%0A%20%20return%20%5Bpoint%5B0%5D%20%2A%20radians%2C%20point%5B1%5D%20%2A%20radians%5D%3B%0A%7D%0A%0Afunction%20contains%241%28object%2C%20point%29%20%7B%0A%20%20return%20%28object%20%26%26%20containsObjectType%2EhasOwnProperty%28object%2Etype%29%0A%20%20%20%20%20%20%3F%20containsObjectType%5Bobject%2Etype%5D%0A%20%20%20%20%20%20%3A%20containsGeometry%29%28object%2C%20point%29%3B%0A%7D%0A%0Afunction%20graticuleX%28y0%2C%20y1%2C%20dy%29%20%7B%0A%20%20var%20y%20%3D%20sequence%28y0%2C%20y1%20%2D%20epsilon%242%2C%20dy%29%2Econcat%28y1%29%3B%0A%20%20return%20function%28x%29%20%7B%20return%20y%2Emap%28function%28y%29%20%7B%20return%20%5Bx%2C%20y%5D%3B%20%7D%29%3B%20%7D%3B%0A%7D%0A%0Afunction%20graticuleY%28x0%2C%20x1%2C%20dx%29%20%7B%0A%20%20var%20x%20%3D%20sequence%28x0%2C%20x1%20%2D%20epsilon%242%2C%20dx%29%2Econcat%28x1%29%3B%0A%20%20return%20function%28y%29%20%7B%20return%20x%2Emap%28function%28x%29%20%7B%20return%20%5Bx%2C%20y%5D%3B%20%7D%29%3B%20%7D%3B%0A%7D%0A%0Afunction%20graticule%28%29%20%7B%0A%20%20var%20x1%2C%20x0%2C%20X1%2C%20X0%2C%0A%20%20%20%20%20%20y1%2C%20y0%2C%20Y1%2C%20Y0%2C%0A%20%20%20%20%20%20dx%20%3D%2010%2C%20dy%20%3D%20dx%2C%20DX%20%3D%2090%2C%20DY%20%3D%20360%2C%0A%20%20%20%20%20%20x%2C%20y%2C%20X%2C%20Y%2C%0A%20%20%20%20%20%20precision%20%3D%202%2E5%3B%0A%0A%20%20function%20graticule%28%29%20%7B%0A%20%20%20%20return%20%7Btype%3A%20%22MultiLineString%22%2C%20coordinates%3A%20lines%28%29%7D%3B%0A%20%20%7D%0A%0A%20%20function%20lines%28%29%20%7B%0A%20%20%20%20return%20sequence%28ceil%28X0%20%2F%20DX%29%20%2A%20DX%2C%20X1%2C%20DX%29%2Emap%28X%29%0A%20%20%20%20%20%20%20%20%2Econcat%28sequence%28ceil%28Y0%20%2F%20DY%29%20%2A%20DY%2C%20Y1%2C%20DY%29%2Emap%28Y%29%29%0A%20%20%20%20%20%20%20%20%2Econcat%28sequence%28ceil%28x0%20%2F%20dx%29%20%2A%20dx%2C%20x1%2C%20dx%29%2Efilter%28function%28x%29%20%7B%20return%20abs%28x%20%25%20DX%29%20%3E%20epsilon%242%3B%20%7D%29%2Emap%28x%29%29%0A%20%20%20%20%20%20%20%20%2Econcat%28sequence%28ceil%28y0%20%2F%20dy%29%20%2A%20dy%2C%20y1%2C%20dy%29%2Efilter%28function%28y%29%20%7B%20return%20abs%28y%20%25%20DY%29%20%3E%20epsilon%242%3B%20%7D%29%2Emap%28y%29%29%3B%0A%20%20%7D%0A%0A%20%20graticule%2Elines%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20lines%28%29%2Emap%28function%28coordinates%29%20%7B%20return%20%7Btype%3A%20%22LineString%22%2C%20coordinates%3A%20coordinates%7D%3B%20%7D%29%3B%0A%20%20%7D%3B%0A%0A%20%20graticule%2Eoutline%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20type%3A%20%22Polygon%22%2C%0A%20%20%20%20%20%20coordinates%3A%20%5B%0A%20%20%20%20%20%20%20%20X%28X0%29%2Econcat%28%0A%20%20%20%20%20%20%20%20Y%28Y1%29%2Eslice%281%29%2C%0A%20%20%20%20%20%20%20%20X%28X1%29%2Ereverse%28%29%2Eslice%281%29%2C%0A%20%20%20%20%20%20%20%20Y%28Y0%29%2Ereverse%28%29%2Eslice%281%29%29%0A%20%20%20%20%20%20%5D%0A%20%20%20%20%7D%3B%0A%20%20%7D%3B%0A%0A%20%20graticule%2Eextent%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20graticule%2EextentMinor%28%29%3B%0A%20%20%20%20return%20graticule%2EextentMajor%28%5F%29%2EextentMinor%28%5F%29%3B%0A%20%20%7D%3B%0A%0A%20%20graticule%2EextentMajor%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20%5B%5BX0%2C%20Y0%5D%2C%20%5BX1%2C%20Y1%5D%5D%3B%0A%20%20%20%20X0%20%3D%20%2B%5F%5B0%5D%5B0%5D%2C%20X1%20%3D%20%2B%5F%5B1%5D%5B0%5D%3B%0A%20%20%20%20Y0%20%3D%20%2B%5F%5B0%5D%5B1%5D%2C%20Y1%20%3D%20%2B%5F%5B1%5D%5B1%5D%3B%0A%20%20%20%20if%20%28X0%20%3E%20X1%29%20%5F%20%3D%20X0%2C%20X0%20%3D%20X1%2C%20X1%20%3D%20%5F%3B%0A%20%20%20%20if%20%28Y0%20%3E%20Y1%29%20%5F%20%3D%20Y0%2C%20Y0%20%3D%20Y1%2C%20Y1%20%3D%20%5F%3B%0A%20%20%20%20return%20graticule%2Eprecision%28precision%29%3B%0A%20%20%7D%3B%0A%0A%20%20graticule%2EextentMinor%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20%5B%5Bx0%2C%20y0%5D%2C%20%5Bx1%2C%20y1%5D%5D%3B%0A%20%20%20%20x0%20%3D%20%2B%5F%5B0%5D%5B0%5D%2C%20x1%20%3D%20%2B%5F%5B1%5D%5B0%5D%3B%0A%20%20%20%20y0%20%3D%20%2B%5F%5B0%5D%5B1%5D%2C%20y1%20%3D%20%2B%5F%5B1%5D%5B1%5D%3B%0A%20%20%20%20if%20%28x0%20%3E%20x1%29%20%5F%20%3D%20x0%2C%20x0%20%3D%20x1%2C%20x1%20%3D%20%5F%3B%0A%20%20%20%20if%20%28y0%20%3E%20y1%29%20%5F%20%3D%20y0%2C%20y0%20%3D%20y1%2C%20y1%20%3D%20%5F%3B%0A%20%20%20%20return%20graticule%2Eprecision%28precision%29%3B%0A%20%20%7D%3B%0A%0A%20%20graticule%2Estep%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20graticule%2EstepMinor%28%29%3B%0A%20%20%20%20return%20graticule%2EstepMajor%28%5F%29%2EstepMinor%28%5F%29%3B%0A%20%20%7D%3B%0A%0A%20%20graticule%2EstepMajor%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20%5BDX%2C%20DY%5D%3B%0A%20%20%20%20DX%20%3D%20%2B%5F%5B0%5D%2C%20DY%20%3D%20%2B%5F%5B1%5D%3B%0A%20%20%20%20return%20graticule%3B%0A%20%20%7D%3B%0A%0A%20%20graticule%2EstepMinor%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20%5Bdx%2C%20dy%5D%3B%0A%20%20%20%20dx%20%3D%20%2B%5F%5B0%5D%2C%20dy%20%3D%20%2B%5F%5B1%5D%3B%0A%20%20%20%20return%20graticule%3B%0A%20%20%7D%3B%0A%0A%20%20graticule%2Eprecision%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20precision%3B%0A%20%20%20%20precision%20%3D%20%2B%5F%3B%0A%20%20%20%20x%20%3D%20graticuleX%28y0%2C%20y1%2C%2090%29%3B%0A%20%20%20%20y%20%3D%20graticuleY%28x0%2C%20x1%2C%20precision%29%3B%0A%20%20%20%20X%20%3D%20graticuleX%28Y0%2C%20Y1%2C%2090%29%3B%0A%20%20%20%20Y%20%3D%20graticuleY%28X0%2C%20X1%2C%20precision%29%3B%0A%20%20%20%20return%20graticule%3B%0A%20%20%7D%3B%0A%0A%20%20return%20graticule%0A%20%20%20%20%20%20%2EextentMajor%28%5B%5B%2D180%2C%20%2D90%20%2B%20epsilon%242%5D%2C%20%5B180%2C%2090%20%2D%20epsilon%242%5D%5D%29%0A%20%20%20%20%20%20%2EextentMinor%28%5B%5B%2D180%2C%20%2D80%20%2D%20epsilon%242%5D%2C%20%5B180%2C%2080%20%2B%20epsilon%242%5D%5D%29%3B%0A%7D%0A%0Afunction%20graticule10%28%29%20%7B%0A%20%20return%20graticule%28%29%28%29%3B%0A%7D%0A%0Afunction%20interpolate%241%28a%2C%20b%29%20%7B%0A%20%20var%20x0%20%3D%20a%5B0%5D%20%2A%20radians%2C%0A%20%20%20%20%20%20y0%20%3D%20a%5B1%5D%20%2A%20radians%2C%0A%20%20%20%20%20%20x1%20%3D%20b%5B0%5D%20%2A%20radians%2C%0A%20%20%20%20%20%20y1%20%3D%20b%5B1%5D%20%2A%20radians%2C%0A%20%20%20%20%20%20cy0%20%3D%20cos%241%28y0%29%2C%0A%20%20%20%20%20%20sy0%20%3D%20sin%241%28y0%29%2C%0A%20%20%20%20%20%20cy1%20%3D%20cos%241%28y1%29%2C%0A%20%20%20%20%20%20sy1%20%3D%20sin%241%28y1%29%2C%0A%20%20%20%20%20%20kx0%20%3D%20cy0%20%2A%20cos%241%28x0%29%2C%0A%20%20%20%20%20%20ky0%20%3D%20cy0%20%2A%20sin%241%28x0%29%2C%0A%20%20%20%20%20%20kx1%20%3D%20cy1%20%2A%20cos%241%28x1%29%2C%0A%20%20%20%20%20%20ky1%20%3D%20cy1%20%2A%20sin%241%28x1%29%2C%0A%20%20%20%20%20%20d%20%3D%202%20%2A%20asin%28sqrt%28haversin%28y1%20%2D%20y0%29%20%2B%20cy0%20%2A%20cy1%20%2A%20haversin%28x1%20%2D%20x0%29%29%29%2C%0A%20%20%20%20%20%20k%20%3D%20sin%241%28d%29%3B%0A%0A%20%20var%20interpolate%20%3D%20d%20%3F%20function%28t%29%20%7B%0A%20%20%20%20var%20B%20%3D%20sin%241%28t%20%2A%3D%20d%29%20%2F%20k%2C%0A%20%20%20%20%20%20%20%20A%20%3D%20sin%241%28d%20%2D%20t%29%20%2F%20k%2C%0A%20%20%20%20%20%20%20%20x%20%3D%20A%20%2A%20kx0%20%2B%20B%20%2A%20kx1%2C%0A%20%20%20%20%20%20%20%20y%20%3D%20A%20%2A%20ky0%20%2B%20B%20%2A%20ky1%2C%0A%20%20%20%20%20%20%20%20z%20%3D%20A%20%2A%20sy0%20%2B%20B%20%2A%20sy1%3B%0A%20%20%20%20return%20%5B%0A%20%20%20%20%20%20atan2%28y%2C%20x%29%20%2A%20degrees%241%2C%0A%20%20%20%20%20%20atan2%28z%2C%20sqrt%28x%20%2A%20x%20%2B%20y%20%2A%20y%29%29%20%2A%20degrees%241%0A%20%20%20%20%5D%3B%0A%20%20%7D%20%3A%20function%28%29%20%7B%0A%20%20%20%20return%20%5Bx0%20%2A%20degrees%241%2C%20y0%20%2A%20degrees%241%5D%3B%0A%20%20%7D%3B%0A%0A%20%20interpolate%2Edistance%20%3D%20d%3B%0A%0A%20%20return%20interpolate%3B%0A%7D%0A%0Afunction%20identity%244%28x%29%20%7B%0A%20%20return%20x%3B%0A%7D%0A%0Avar%20areaSum%241%20%3D%20adder%28%29%2C%0A%20%20%20%20areaRingSum%241%20%3D%20adder%28%29%2C%0A%20%20%20%20x00%2C%0A%20%20%20%20y00%2C%0A%20%20%20%20x0%241%2C%0A%20%20%20%20y0%241%3B%0A%0Avar%20areaStream%241%20%3D%20%7B%0A%20%20point%3A%20noop%242%2C%0A%20%20lineStart%3A%20noop%242%2C%0A%20%20lineEnd%3A%20noop%242%2C%0A%20%20polygonStart%3A%20function%28%29%20%7B%0A%20%20%20%20areaStream%241%2ElineStart%20%3D%20areaRingStart%241%3B%0A%20%20%20%20areaStream%241%2ElineEnd%20%3D%20areaRingEnd%241%3B%0A%20%20%7D%2C%0A%20%20polygonEnd%3A%20function%28%29%20%7B%0A%20%20%20%20areaStream%241%2ElineStart%20%3D%20areaStream%241%2ElineEnd%20%3D%20areaStream%241%2Epoint%20%3D%20noop%242%3B%0A%20%20%20%20areaSum%241%2Eadd%28abs%28areaRingSum%241%29%29%3B%0A%20%20%20%20areaRingSum%241%2Ereset%28%29%3B%0A%20%20%7D%2C%0A%20%20result%3A%20function%28%29%20%7B%0A%20%20%20%20var%20area%20%3D%20areaSum%241%20%2F%202%3B%0A%20%20%20%20areaSum%241%2Ereset%28%29%3B%0A%20%20%20%20return%20area%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20areaRingStart%241%28%29%20%7B%0A%20%20areaStream%241%2Epoint%20%3D%20areaPointFirst%241%3B%0A%7D%0A%0Afunction%20areaPointFirst%241%28x%2C%20y%29%20%7B%0A%20%20areaStream%241%2Epoint%20%3D%20areaPoint%241%3B%0A%20%20x00%20%3D%20x0%241%20%3D%20x%2C%20y00%20%3D%20y0%241%20%3D%20y%3B%0A%7D%0A%0Afunction%20areaPoint%241%28x%2C%20y%29%20%7B%0A%20%20areaRingSum%241%2Eadd%28y0%241%20%2A%20x%20%2D%20x0%241%20%2A%20y%29%3B%0A%20%20x0%241%20%3D%20x%2C%20y0%241%20%3D%20y%3B%0A%7D%0A%0Afunction%20areaRingEnd%241%28%29%20%7B%0A%20%20areaPoint%241%28x00%2C%20y00%29%3B%0A%7D%0A%0Avar%20x0%242%20%3D%20Infinity%2C%0A%20%20%20%20y0%242%20%3D%20x0%242%2C%0A%20%20%20%20x1%20%3D%20%2Dx0%242%2C%0A%20%20%20%20y1%20%3D%20x1%3B%0A%0Avar%20boundsStream%241%20%3D%20%7B%0A%20%20point%3A%20boundsPoint%241%2C%0A%20%20lineStart%3A%20noop%242%2C%0A%20%20lineEnd%3A%20noop%242%2C%0A%20%20polygonStart%3A%20noop%242%2C%0A%20%20polygonEnd%3A%20noop%242%2C%0A%20%20result%3A%20function%28%29%20%7B%0A%20%20%20%20var%20bounds%20%3D%20%5B%5Bx0%242%2C%20y0%242%5D%2C%20%5Bx1%2C%20y1%5D%5D%3B%0A%20%20%20%20x1%20%3D%20y1%20%3D%20%2D%28y0%242%20%3D%20x0%242%20%3D%20Infinity%29%3B%0A%20%20%20%20return%20bounds%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20boundsPoint%241%28x%2C%20y%29%20%7B%0A%20%20if%20%28x%20%3C%20x0%242%29%20x0%242%20%3D%20x%3B%0A%20%20if%20%28x%20%3E%20x1%29%20x1%20%3D%20x%3B%0A%20%20if%20%28y%20%3C%20y0%242%29%20y0%242%20%3D%20y%3B%0A%20%20if%20%28y%20%3E%20y1%29%20y1%20%3D%20y%3B%0A%7D%0A%0A%2F%2F%20TODO%20Enforce%20positive%20area%20for%20exterior%2C%20negative%20area%20for%20interior%3F%0A%0Avar%20X0%241%20%3D%200%2C%0A%20%20%20%20Y0%241%20%3D%200%2C%0A%20%20%20%20Z0%241%20%3D%200%2C%0A%20%20%20%20X1%241%20%3D%200%2C%0A%20%20%20%20Y1%241%20%3D%200%2C%0A%20%20%20%20Z1%241%20%3D%200%2C%0A%20%20%20%20X2%241%20%3D%200%2C%0A%20%20%20%20Y2%241%20%3D%200%2C%0A%20%20%20%20Z2%241%20%3D%200%2C%0A%20%20%20%20x00%241%2C%0A%20%20%20%20y00%241%2C%0A%20%20%20%20x0%243%2C%0A%20%20%20%20y0%243%3B%0A%0Avar%20centroidStream%241%20%3D%20%7B%0A%20%20point%3A%20centroidPoint%241%2C%0A%20%20lineStart%3A%20centroidLineStart%241%2C%0A%20%20lineEnd%3A%20centroidLineEnd%241%2C%0A%20%20polygonStart%3A%20function%28%29%20%7B%0A%20%20%20%20centroidStream%241%2ElineStart%20%3D%20centroidRingStart%241%3B%0A%20%20%20%20centroidStream%241%2ElineEnd%20%3D%20centroidRingEnd%241%3B%0A%20%20%7D%2C%0A%20%20polygonEnd%3A%20function%28%29%20%7B%0A%20%20%20%20centroidStream%241%2Epoint%20%3D%20centroidPoint%241%3B%0A%20%20%20%20centroidStream%241%2ElineStart%20%3D%20centroidLineStart%241%3B%0A%20%20%20%20centroidStream%241%2ElineEnd%20%3D%20centroidLineEnd%241%3B%0A%20%20%7D%2C%0A%20%20result%3A%20function%28%29%20%7B%0A%20%20%20%20var%20centroid%20%3D%20Z2%241%20%3F%20%5BX2%241%20%2F%20Z2%241%2C%20Y2%241%20%2F%20Z2%241%5D%0A%20%20%20%20%20%20%20%20%3A%20Z1%241%20%3F%20%5BX1%241%20%2F%20Z1%241%2C%20Y1%241%20%2F%20Z1%241%5D%0A%20%20%20%20%20%20%20%20%3A%20Z0%241%20%3F%20%5BX0%241%20%2F%20Z0%241%2C%20Y0%241%20%2F%20Z0%241%5D%0A%20%20%20%20%20%20%20%20%3A%20%5BNaN%2C%20NaN%5D%3B%0A%20%20%20%20X0%241%20%3D%20Y0%241%20%3D%20Z0%241%20%3D%0A%20%20%20%20X1%241%20%3D%20Y1%241%20%3D%20Z1%241%20%3D%0A%20%20%20%20X2%241%20%3D%20Y2%241%20%3D%20Z2%241%20%3D%200%3B%0A%20%20%20%20return%20centroid%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20centroidPoint%241%28x%2C%20y%29%20%7B%0A%20%20X0%241%20%2B%3D%20x%3B%0A%20%20Y0%241%20%2B%3D%20y%3B%0A%20%20%2B%2BZ0%241%3B%0A%7D%0A%0Afunction%20centroidLineStart%241%28%29%20%7B%0A%20%20centroidStream%241%2Epoint%20%3D%20centroidPointFirstLine%3B%0A%7D%0A%0Afunction%20centroidPointFirstLine%28x%2C%20y%29%20%7B%0A%20%20centroidStream%241%2Epoint%20%3D%20centroidPointLine%3B%0A%20%20centroidPoint%241%28x0%243%20%3D%20x%2C%20y0%243%20%3D%20y%29%3B%0A%7D%0A%0Afunction%20centroidPointLine%28x%2C%20y%29%20%7B%0A%20%20var%20dx%20%3D%20x%20%2D%20x0%243%2C%20dy%20%3D%20y%20%2D%20y0%243%2C%20z%20%3D%20sqrt%28dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%29%3B%0A%20%20X1%241%20%2B%3D%20z%20%2A%20%28x0%243%20%2B%20x%29%20%2F%202%3B%0A%20%20Y1%241%20%2B%3D%20z%20%2A%20%28y0%243%20%2B%20y%29%20%2F%202%3B%0A%20%20Z1%241%20%2B%3D%20z%3B%0A%20%20centroidPoint%241%28x0%243%20%3D%20x%2C%20y0%243%20%3D%20y%29%3B%0A%7D%0A%0Afunction%20centroidLineEnd%241%28%29%20%7B%0A%20%20centroidStream%241%2Epoint%20%3D%20centroidPoint%241%3B%0A%7D%0A%0Afunction%20centroidRingStart%241%28%29%20%7B%0A%20%20centroidStream%241%2Epoint%20%3D%20centroidPointFirstRing%3B%0A%7D%0A%0Afunction%20centroidRingEnd%241%28%29%20%7B%0A%20%20centroidPointRing%28x00%241%2C%20y00%241%29%3B%0A%7D%0A%0Afunction%20centroidPointFirstRing%28x%2C%20y%29%20%7B%0A%20%20centroidStream%241%2Epoint%20%3D%20centroidPointRing%3B%0A%20%20centroidPoint%241%28x00%241%20%3D%20x0%243%20%3D%20x%2C%20y00%241%20%3D%20y0%243%20%3D%20y%29%3B%0A%7D%0A%0Afunction%20centroidPointRing%28x%2C%20y%29%20%7B%0A%20%20var%20dx%20%3D%20x%20%2D%20x0%243%2C%0A%20%20%20%20%20%20dy%20%3D%20y%20%2D%20y0%243%2C%0A%20%20%20%20%20%20z%20%3D%20sqrt%28dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%29%3B%0A%0A%20%20X1%241%20%2B%3D%20z%20%2A%20%28x0%243%20%2B%20x%29%20%2F%202%3B%0A%20%20Y1%241%20%2B%3D%20z%20%2A%20%28y0%243%20%2B%20y%29%20%2F%202%3B%0A%20%20Z1%241%20%2B%3D%20z%3B%0A%0A%20%20z%20%3D%20y0%243%20%2A%20x%20%2D%20x0%243%20%2A%20y%3B%0A%20%20X2%241%20%2B%3D%20z%20%2A%20%28x0%243%20%2B%20x%29%3B%0A%20%20Y2%241%20%2B%3D%20z%20%2A%20%28y0%243%20%2B%20y%29%3B%0A%20%20Z2%241%20%2B%3D%20z%20%2A%203%3B%0A%20%20centroidPoint%241%28x0%243%20%3D%20x%2C%20y0%243%20%3D%20y%29%3B%0A%7D%0A%0Afunction%20PathContext%28context%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%7D%0A%0APathContext%2Eprototype%20%3D%20%7B%0A%20%20%5Fradius%3A%204%2E5%2C%0A%20%20pointRadius%3A%20function%28%5F%29%20%7B%0A%20%20%20%20return%20this%2E%5Fradius%20%3D%20%5F%2C%20this%3B%0A%20%20%7D%2C%0A%20%20polygonStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20polygonEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20if%20%28this%2E%5Fline%20%3D%3D%3D%200%29%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20this%2E%5Fpoint%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2EmoveTo%28x%2C%20y%29%3B%0A%20%20%20%20%20%20%20%20this%2E%5Fpoint%20%3D%201%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20case%201%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2ElineTo%28x%2C%20y%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20default%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2EmoveTo%28x%20%2B%20this%2E%5Fradius%2C%20y%29%3B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2Earc%28x%2C%20y%2C%20this%2E%5Fradius%2C%200%2C%20tau%243%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20result%3A%20noop%242%0A%7D%3B%0A%0Avar%20lengthSum%241%20%3D%20adder%28%29%2C%0A%20%20%20%20lengthRing%2C%0A%20%20%20%20x00%242%2C%0A%20%20%20%20y00%242%2C%0A%20%20%20%20x0%244%2C%0A%20%20%20%20y0%244%3B%0A%0Avar%20lengthStream%241%20%3D%20%7B%0A%20%20point%3A%20noop%242%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20lengthStream%241%2Epoint%20%3D%20lengthPointFirst%241%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20if%20%28lengthRing%29%20lengthPoint%241%28x00%242%2C%20y00%242%29%3B%0A%20%20%20%20lengthStream%241%2Epoint%20%3D%20noop%242%3B%0A%20%20%7D%2C%0A%20%20polygonStart%3A%20function%28%29%20%7B%0A%20%20%20%20lengthRing%20%3D%20true%3B%0A%20%20%7D%2C%0A%20%20polygonEnd%3A%20function%28%29%20%7B%0A%20%20%20%20lengthRing%20%3D%20null%3B%0A%20%20%7D%2C%0A%20%20result%3A%20function%28%29%20%7B%0A%20%20%20%20var%20length%20%3D%20%2BlengthSum%241%3B%0A%20%20%20%20lengthSum%241%2Ereset%28%29%3B%0A%20%20%20%20return%20length%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20lengthPointFirst%241%28x%2C%20y%29%20%7B%0A%20%20lengthStream%241%2Epoint%20%3D%20lengthPoint%241%3B%0A%20%20x00%242%20%3D%20x0%244%20%3D%20x%2C%20y00%242%20%3D%20y0%244%20%3D%20y%3B%0A%7D%0A%0Afunction%20lengthPoint%241%28x%2C%20y%29%20%7B%0A%20%20x0%244%20%2D%3D%20x%2C%20y0%244%20%2D%3D%20y%3B%0A%20%20lengthSum%241%2Eadd%28sqrt%28x0%244%20%2A%20x0%244%20%2B%20y0%244%20%2A%20y0%244%29%29%3B%0A%20%20x0%244%20%3D%20x%2C%20y0%244%20%3D%20y%3B%0A%7D%0A%0Afunction%20PathString%28%29%20%7B%0A%20%20this%2E%5Fstring%20%3D%20%5B%5D%3B%0A%7D%0A%0APathString%2Eprototype%20%3D%20%7B%0A%20%20%5Fradius%3A%204%2E5%2C%0A%20%20%5Fcircle%3A%20circle%241%284%2E5%29%2C%0A%20%20pointRadius%3A%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%28%5F%20%3D%20%2B%5F%29%20%21%3D%3D%20this%2E%5Fradius%29%20this%2E%5Fradius%20%3D%20%5F%2C%20this%2E%5Fcircle%20%3D%20null%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%2C%0A%20%20polygonStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20polygonEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20if%20%28this%2E%5Fline%20%3D%3D%3D%200%29%20this%2E%5Fstring%2Epush%28%22Z%22%29%3B%0A%20%20%20%20this%2E%5Fpoint%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2E%5Fstring%2Epush%28%22M%22%2C%20x%2C%20%22%2C%22%2C%20y%29%3B%0A%20%20%20%20%20%20%20%20this%2E%5Fpoint%20%3D%201%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20case%201%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2E%5Fstring%2Epush%28%22L%22%2C%20x%2C%20%22%2C%22%2C%20y%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20default%3A%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this%2E%5Fcircle%20%3D%3D%20null%29%20this%2E%5Fcircle%20%3D%20circle%241%28this%2E%5Fradius%29%3B%0A%20%20%20%20%20%20%20%20this%2E%5Fstring%2Epush%28%22M%22%2C%20x%2C%20%22%2C%22%2C%20y%2C%20this%2E%5Fcircle%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20result%3A%20function%28%29%20%7B%0A%20%20%20%20if%20%28this%2E%5Fstring%2Elength%29%20%7B%0A%20%20%20%20%20%20var%20result%20%3D%20this%2E%5Fstring%2Ejoin%28%22%22%29%3B%0A%20%20%20%20%20%20this%2E%5Fstring%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20return%20result%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20circle%241%28radius%29%20%7B%0A%20%20return%20%22m0%2C%22%20%2B%20radius%0A%20%20%20%20%20%20%2B%20%22a%22%20%2B%20radius%20%2B%20%22%2C%22%20%2B%20radius%20%2B%20%22%200%201%2C1%200%2C%22%20%2B%20%2D2%20%2A%20radius%0A%20%20%20%20%20%20%2B%20%22a%22%20%2B%20radius%20%2B%20%22%2C%22%20%2B%20radius%20%2B%20%22%200%201%2C1%200%2C%22%20%2B%202%20%2A%20radius%0A%20%20%20%20%20%20%2B%20%22z%22%3B%0A%7D%0A%0Afunction%20index%241%28projection%2C%20context%29%20%7B%0A%20%20var%20pointRadius%20%3D%204%2E5%2C%0A%20%20%20%20%20%20projectionStream%2C%0A%20%20%20%20%20%20contextStream%3B%0A%0A%20%20function%20path%28object%29%20%7B%0A%20%20%20%20if%20%28object%29%20%7B%0A%20%20%20%20%20%20if%20%28typeof%20pointRadius%20%3D%3D%3D%20%22function%22%29%20contextStream%2EpointRadius%28%2BpointRadius%2Eapply%28this%2C%20arguments%29%29%3B%0A%20%20%20%20%20%20geoStream%28object%2C%20projectionStream%28contextStream%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20contextStream%2Eresult%28%29%3B%0A%20%20%7D%0A%0A%20%20path%2Earea%20%3D%20function%28object%29%20%7B%0A%20%20%20%20geoStream%28object%2C%20projectionStream%28areaStream%241%29%29%3B%0A%20%20%20%20return%20areaStream%241%2Eresult%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20path%2Emeasure%20%3D%20function%28object%29%20%7B%0A%20%20%20%20geoStream%28object%2C%20projectionStream%28lengthStream%241%29%29%3B%0A%20%20%20%20return%20lengthStream%241%2Eresult%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20path%2Ebounds%20%3D%20function%28object%29%20%7B%0A%20%20%20%20geoStream%28object%2C%20projectionStream%28boundsStream%241%29%29%3B%0A%20%20%20%20return%20boundsStream%241%2Eresult%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20path%2Ecentroid%20%3D%20function%28object%29%20%7B%0A%20%20%20%20geoStream%28object%2C%20projectionStream%28centroidStream%241%29%29%3B%0A%20%20%20%20return%20centroidStream%241%2Eresult%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20path%2Eprojection%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28projectionStream%20%3D%20%5F%20%3D%3D%20null%20%3F%20%28projection%20%3D%20null%2C%20identity%244%29%20%3A%20%28projection%20%3D%20%5F%29%2Estream%2C%20path%29%20%3A%20projection%3B%0A%20%20%7D%3B%0A%0A%20%20path%2Econtext%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20context%3B%0A%20%20%20%20contextStream%20%3D%20%5F%20%3D%3D%20null%20%3F%20%28context%20%3D%20null%2C%20new%20PathString%29%20%3A%20new%20PathContext%28context%20%3D%20%5F%29%3B%0A%20%20%20%20if%20%28typeof%20pointRadius%20%21%3D%3D%20%22function%22%29%20contextStream%2EpointRadius%28pointRadius%29%3B%0A%20%20%20%20return%20path%3B%0A%20%20%7D%3B%0A%0A%20%20path%2EpointRadius%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20pointRadius%3B%0A%20%20%20%20pointRadius%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20%28contextStream%2EpointRadius%28%2B%5F%29%2C%20%2B%5F%29%3B%0A%20%20%20%20return%20path%3B%0A%20%20%7D%3B%0A%0A%20%20return%20path%2Eprojection%28projection%29%2Econtext%28context%29%3B%0A%7D%0A%0Afunction%20transform%28methods%29%20%7B%0A%20%20return%20%7B%0A%20%20%20%20stream%3A%20transformer%28methods%29%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20transformer%28methods%29%20%7B%0A%20%20return%20function%28stream%29%20%7B%0A%20%20%20%20var%20s%20%3D%20new%20TransformStream%3B%0A%20%20%20%20for%20%28var%20key%20in%20methods%29%20s%5Bkey%5D%20%3D%20methods%5Bkey%5D%3B%0A%20%20%20%20s%2Estream%20%3D%20stream%3B%0A%20%20%20%20return%20s%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20TransformStream%28%29%20%7B%7D%0A%0ATransformStream%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20TransformStream%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%20this%2Estream%2Epoint%28x%2C%20y%29%3B%20%7D%2C%0A%20%20sphere%3A%20function%28%29%20%7B%20this%2Estream%2Esphere%28%29%3B%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%20this%2Estream%2ElineStart%28%29%3B%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%20this%2Estream%2ElineEnd%28%29%3B%20%7D%2C%0A%20%20polygonStart%3A%20function%28%29%20%7B%20this%2Estream%2EpolygonStart%28%29%3B%20%7D%2C%0A%20%20polygonEnd%3A%20function%28%29%20%7B%20this%2Estream%2EpolygonEnd%28%29%3B%20%7D%0A%7D%3B%0A%0Afunction%20fit%28projection%2C%20fitBounds%2C%20object%29%20%7B%0A%20%20var%20clip%20%3D%20projection%2EclipExtent%20%26%26%20projection%2EclipExtent%28%29%3B%0A%20%20projection%2Escale%28150%29%2Etranslate%28%5B0%2C%200%5D%29%3B%0A%20%20if%20%28clip%20%21%3D%20null%29%20projection%2EclipExtent%28null%29%3B%0A%20%20geoStream%28object%2C%20projection%2Estream%28boundsStream%241%29%29%3B%0A%20%20fitBounds%28boundsStream%241%2Eresult%28%29%29%3B%0A%20%20if%20%28clip%20%21%3D%20null%29%20projection%2EclipExtent%28clip%29%3B%0A%20%20return%20projection%3B%0A%7D%0A%0Afunction%20fitExtent%28projection%2C%20extent%2C%20object%29%20%7B%0A%20%20return%20fit%28projection%2C%20function%28b%29%20%7B%0A%20%20%20%20var%20w%20%3D%20extent%5B1%5D%5B0%5D%20%2D%20extent%5B0%5D%5B0%5D%2C%0A%20%20%20%20%20%20%20%20h%20%3D%20extent%5B1%5D%5B1%5D%20%2D%20extent%5B0%5D%5B1%5D%2C%0A%20%20%20%20%20%20%20%20k%20%3D%20Math%2Emin%28w%20%2F%20%28b%5B1%5D%5B0%5D%20%2D%20b%5B0%5D%5B0%5D%29%2C%20h%20%2F%20%28b%5B1%5D%5B1%5D%20%2D%20b%5B0%5D%5B1%5D%29%29%2C%0A%20%20%20%20%20%20%20%20x%20%3D%20%2Bextent%5B0%5D%5B0%5D%20%2B%20%28w%20%2D%20k%20%2A%20%28b%5B1%5D%5B0%5D%20%2B%20b%5B0%5D%5B0%5D%29%29%20%2F%202%2C%0A%20%20%20%20%20%20%20%20y%20%3D%20%2Bextent%5B0%5D%5B1%5D%20%2B%20%28h%20%2D%20k%20%2A%20%28b%5B1%5D%5B1%5D%20%2B%20b%5B0%5D%5B1%5D%29%29%20%2F%202%3B%0A%20%20%20%20projection%2Escale%28150%20%2A%20k%29%2Etranslate%28%5Bx%2C%20y%5D%29%3B%0A%20%20%7D%2C%20object%29%3B%0A%7D%0A%0Afunction%20fitSize%28projection%2C%20size%2C%20object%29%20%7B%0A%20%20return%20fitExtent%28projection%2C%20%5B%5B0%2C%200%5D%2C%20size%5D%2C%20object%29%3B%0A%7D%0A%0Afunction%20fitWidth%28projection%2C%20width%2C%20object%29%20%7B%0A%20%20return%20fit%28projection%2C%20function%28b%29%20%7B%0A%20%20%20%20var%20w%20%3D%20%2Bwidth%2C%0A%20%20%20%20%20%20%20%20k%20%3D%20w%20%2F%20%28b%5B1%5D%5B0%5D%20%2D%20b%5B0%5D%5B0%5D%29%2C%0A%20%20%20%20%20%20%20%20x%20%3D%20%28w%20%2D%20k%20%2A%20%28b%5B1%5D%5B0%5D%20%2B%20b%5B0%5D%5B0%5D%29%29%20%2F%202%2C%0A%20%20%20%20%20%20%20%20y%20%3D%20%2Dk%20%2A%20b%5B0%5D%5B1%5D%3B%0A%20%20%20%20projection%2Escale%28150%20%2A%20k%29%2Etranslate%28%5Bx%2C%20y%5D%29%3B%0A%20%20%7D%2C%20object%29%3B%0A%7D%0A%0Afunction%20fitHeight%28projection%2C%20height%2C%20object%29%20%7B%0A%20%20return%20fit%28projection%2C%20function%28b%29%20%7B%0A%20%20%20%20var%20h%20%3D%20%2Bheight%2C%0A%20%20%20%20%20%20%20%20k%20%3D%20h%20%2F%20%28b%5B1%5D%5B1%5D%20%2D%20b%5B0%5D%5B1%5D%29%2C%0A%20%20%20%20%20%20%20%20x%20%3D%20%2Dk%20%2A%20b%5B0%5D%5B0%5D%2C%0A%20%20%20%20%20%20%20%20y%20%3D%20%28h%20%2D%20k%20%2A%20%28b%5B1%5D%5B1%5D%20%2B%20b%5B0%5D%5B1%5D%29%29%20%2F%202%3B%0A%20%20%20%20projection%2Escale%28150%20%2A%20k%29%2Etranslate%28%5Bx%2C%20y%5D%29%3B%0A%20%20%7D%2C%20object%29%3B%0A%7D%0A%0Avar%20maxDepth%20%3D%2016%2C%20%2F%2F%20maximum%20depth%20of%20subdivision%0A%20%20%20%20cosMinDistance%20%3D%20cos%241%2830%20%2A%20radians%29%3B%20%2F%2F%20cos%28minimum%20angular%20distance%29%0A%0Afunction%20resample%28project%2C%20delta2%29%20%7B%0A%20%20return%20%2Bdelta2%20%3F%20resample%241%28project%2C%20delta2%29%20%3A%20resampleNone%28project%29%3B%0A%7D%0A%0Afunction%20resampleNone%28project%29%20%7B%0A%20%20return%20transformer%28%7B%0A%20%20%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20%20%20x%20%3D%20project%28x%2C%20y%29%3B%0A%20%20%20%20%20%20this%2Estream%2Epoint%28x%5B0%5D%2C%20x%5B1%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%3B%0A%7D%0A%0Afunction%20resample%241%28project%2C%20delta2%29%20%7B%0A%0A%20%20function%20resampleLineTo%28x0%2C%20y0%2C%20lambda0%2C%20a0%2C%20b0%2C%20c0%2C%20x1%2C%20y1%2C%20lambda1%2C%20a1%2C%20b1%2C%20c1%2C%20depth%2C%20stream%29%20%7B%0A%20%20%20%20var%20dx%20%3D%20x1%20%2D%20x0%2C%0A%20%20%20%20%20%20%20%20dy%20%3D%20y1%20%2D%20y0%2C%0A%20%20%20%20%20%20%20%20d2%20%3D%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%3B%0A%20%20%20%20if%20%28d2%20%3E%204%20%2A%20delta2%20%26%26%20depth%2D%2D%29%20%7B%0A%20%20%20%20%20%20var%20a%20%3D%20a0%20%2B%20a1%2C%0A%20%20%20%20%20%20%20%20%20%20b%20%3D%20b0%20%2B%20b1%2C%0A%20%20%20%20%20%20%20%20%20%20c%20%3D%20c0%20%2B%20c1%2C%0A%20%20%20%20%20%20%20%20%20%20m%20%3D%20sqrt%28a%20%2A%20a%20%2B%20b%20%2A%20b%20%2B%20c%20%2A%20c%29%2C%0A%20%20%20%20%20%20%20%20%20%20phi2%20%3D%20asin%28c%20%2F%3D%20m%29%2C%0A%20%20%20%20%20%20%20%20%20%20lambda2%20%3D%20abs%28abs%28c%29%20%2D%201%29%20%3C%20epsilon%242%20%7C%7C%20abs%28lambda0%20%2D%20lambda1%29%20%3C%20epsilon%242%20%3F%20%28lambda0%20%2B%20lambda1%29%20%2F%202%20%3A%20atan2%28b%2C%20a%29%2C%0A%20%20%20%20%20%20%20%20%20%20p%20%3D%20project%28lambda2%2C%20phi2%29%2C%0A%20%20%20%20%20%20%20%20%20%20x2%20%3D%20p%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%20p%5B1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20dx2%20%3D%20x2%20%2D%20x0%2C%0A%20%20%20%20%20%20%20%20%20%20dy2%20%3D%20y2%20%2D%20y0%2C%0A%20%20%20%20%20%20%20%20%20%20dz%20%3D%20dy%20%2A%20dx2%20%2D%20dx%20%2A%20dy2%3B%0A%20%20%20%20%20%20if%20%28dz%20%2A%20dz%20%2F%20d2%20%3E%20delta2%20%2F%2F%20perpendicular%20projected%20distance%0A%20%20%20%20%20%20%20%20%20%20%7C%7C%20abs%28%28dx%20%2A%20dx2%20%2B%20dy%20%2A%20dy2%29%20%2F%20d2%20%2D%200%2E5%29%20%3E%200%2E3%20%2F%2F%20midpoint%20close%20to%20an%20end%0A%20%20%20%20%20%20%20%20%20%20%7C%7C%20a0%20%2A%20a1%20%2B%20b0%20%2A%20b1%20%2B%20c0%20%2A%20c1%20%3C%20cosMinDistance%29%20%7B%20%2F%2F%20angular%20distance%0A%20%20%20%20%20%20%20%20resampleLineTo%28x0%2C%20y0%2C%20lambda0%2C%20a0%2C%20b0%2C%20c0%2C%20x2%2C%20y2%2C%20lambda2%2C%20a%20%2F%3D%20m%2C%20b%20%2F%3D%20m%2C%20c%2C%20depth%2C%20stream%29%3B%0A%20%20%20%20%20%20%20%20stream%2Epoint%28x2%2C%20y2%29%3B%0A%20%20%20%20%20%20%20%20resampleLineTo%28x2%2C%20y2%2C%20lambda2%2C%20a%2C%20b%2C%20c%2C%20x1%2C%20y1%2C%20lambda1%2C%20a1%2C%20b1%2C%20c1%2C%20depth%2C%20stream%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20function%28stream%29%20%7B%0A%20%20%20%20var%20lambda00%2C%20x00%2C%20y00%2C%20a00%2C%20b00%2C%20c00%2C%20%2F%2F%20first%20point%0A%20%20%20%20%20%20%20%20lambda0%2C%20x0%2C%20y0%2C%20a0%2C%20b0%2C%20c0%3B%20%2F%2F%20previous%20point%0A%0A%20%20%20%20var%20resampleStream%20%3D%20%7B%0A%20%20%20%20%20%20point%3A%20point%2C%0A%20%20%20%20%20%20lineStart%3A%20lineStart%2C%0A%20%20%20%20%20%20lineEnd%3A%20lineEnd%2C%0A%20%20%20%20%20%20polygonStart%3A%20function%28%29%20%7B%20stream%2EpolygonStart%28%29%3B%20resampleStream%2ElineStart%20%3D%20ringStart%3B%20%7D%2C%0A%20%20%20%20%20%20polygonEnd%3A%20function%28%29%20%7B%20stream%2EpolygonEnd%28%29%3B%20resampleStream%2ElineStart%20%3D%20lineStart%3B%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20point%28x%2C%20y%29%20%7B%0A%20%20%20%20%20%20x%20%3D%20project%28x%2C%20y%29%3B%0A%20%20%20%20%20%20stream%2Epoint%28x%5B0%5D%2C%20x%5B1%5D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20lineStart%28%29%20%7B%0A%20%20%20%20%20%20x0%20%3D%20NaN%3B%0A%20%20%20%20%20%20resampleStream%2Epoint%20%3D%20linePoint%3B%0A%20%20%20%20%20%20stream%2ElineStart%28%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20linePoint%28lambda%2C%20phi%29%20%7B%0A%20%20%20%20%20%20var%20c%20%3D%20cartesian%28%5Blambda%2C%20phi%5D%29%2C%20p%20%3D%20project%28lambda%2C%20phi%29%3B%0A%20%20%20%20%20%20resampleLineTo%28x0%2C%20y0%2C%20lambda0%2C%20a0%2C%20b0%2C%20c0%2C%20x0%20%3D%20p%5B0%5D%2C%20y0%20%3D%20p%5B1%5D%2C%20lambda0%20%3D%20lambda%2C%20a0%20%3D%20c%5B0%5D%2C%20b0%20%3D%20c%5B1%5D%2C%20c0%20%3D%20c%5B2%5D%2C%20maxDepth%2C%20stream%29%3B%0A%20%20%20%20%20%20stream%2Epoint%28x0%2C%20y0%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20lineEnd%28%29%20%7B%0A%20%20%20%20%20%20resampleStream%2Epoint%20%3D%20point%3B%0A%20%20%20%20%20%20stream%2ElineEnd%28%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ringStart%28%29%20%7B%0A%20%20%20%20%20%20lineStart%28%29%3B%0A%20%20%20%20%20%20resampleStream%2Epoint%20%3D%20ringPoint%3B%0A%20%20%20%20%20%20resampleStream%2ElineEnd%20%3D%20ringEnd%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ringPoint%28lambda%2C%20phi%29%20%7B%0A%20%20%20%20%20%20linePoint%28lambda00%20%3D%20lambda%2C%20phi%29%2C%20x00%20%3D%20x0%2C%20y00%20%3D%20y0%2C%20a00%20%3D%20a0%2C%20b00%20%3D%20b0%2C%20c00%20%3D%20c0%3B%0A%20%20%20%20%20%20resampleStream%2Epoint%20%3D%20linePoint%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ringEnd%28%29%20%7B%0A%20%20%20%20%20%20resampleLineTo%28x0%2C%20y0%2C%20lambda0%2C%20a0%2C%20b0%2C%20c0%2C%20x00%2C%20y00%2C%20lambda00%2C%20a00%2C%20b00%2C%20c00%2C%20maxDepth%2C%20stream%29%3B%0A%20%20%20%20%20%20resampleStream%2ElineEnd%20%3D%20lineEnd%3B%0A%20%20%20%20%20%20lineEnd%28%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20resampleStream%3B%0A%20%20%7D%3B%0A%7D%0A%0Avar%20transformRadians%20%3D%20transformer%28%7B%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20this%2Estream%2Epoint%28x%20%2A%20radians%2C%20y%20%2A%20radians%29%3B%0A%20%20%7D%0A%7D%29%3B%0A%0Afunction%20transformRotate%28rotate%29%20%7B%0A%20%20return%20transformer%28%7B%0A%20%20%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20%20%20var%20r%20%3D%20rotate%28x%2C%20y%29%3B%0A%20%20%20%20%20%20return%20this%2Estream%2Epoint%28r%5B0%5D%2C%20r%5B1%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%3B%0A%7D%0A%0Afunction%20scaleTranslate%28k%2C%20dx%2C%20dy%29%20%7B%0A%20%20function%20transform%24%241%28x%2C%20y%29%20%7B%0A%20%20%20%20return%20%5Bdx%20%2B%20k%20%2A%20x%2C%20dy%20%2D%20k%20%2A%20y%5D%3B%0A%20%20%7D%0A%20%20transform%24%241%2Einvert%20%3D%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20return%20%5B%28x%20%2D%20dx%29%20%2F%20k%2C%20%28dy%20%2D%20y%29%20%2F%20k%5D%3B%0A%20%20%7D%3B%0A%20%20return%20transform%24%241%3B%0A%7D%0A%0Afunction%20scaleTranslateRotate%28k%2C%20dx%2C%20dy%2C%20alpha%29%20%7B%0A%20%20var%20cosAlpha%20%3D%20cos%241%28alpha%29%2C%0A%20%20%20%20%20%20sinAlpha%20%3D%20sin%241%28alpha%29%2C%0A%20%20%20%20%20%20a%20%3D%20cosAlpha%20%2A%20k%2C%0A%20%20%20%20%20%20b%20%3D%20sinAlpha%20%2A%20k%2C%0A%20%20%20%20%20%20ai%20%3D%20cosAlpha%20%2F%20k%2C%0A%20%20%20%20%20%20bi%20%3D%20sinAlpha%20%2F%20k%2C%0A%20%20%20%20%20%20ci%20%3D%20%28sinAlpha%20%2A%20dy%20%2D%20cosAlpha%20%2A%20dx%29%20%2F%20k%2C%0A%20%20%20%20%20%20fi%20%3D%20%28sinAlpha%20%2A%20dx%20%2B%20cosAlpha%20%2A%20dy%29%20%2F%20k%3B%0A%20%20function%20transform%24%241%28x%2C%20y%29%20%7B%0A%20%20%20%20return%20%5Ba%20%2A%20x%20%2D%20b%20%2A%20y%20%2B%20dx%2C%20dy%20%2D%20b%20%2A%20x%20%2D%20a%20%2A%20y%5D%3B%0A%20%20%7D%0A%20%20transform%24%241%2Einvert%20%3D%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20return%20%5Bai%20%2A%20x%20%2D%20bi%20%2A%20y%20%2B%20ci%2C%20fi%20%2D%20bi%20%2A%20x%20%2D%20ai%20%2A%20y%5D%3B%0A%20%20%7D%3B%0A%20%20return%20transform%24%241%3B%0A%7D%0A%0Afunction%20projection%28project%29%20%7B%0A%20%20return%20projectionMutator%28function%28%29%20%7B%20return%20project%3B%20%7D%29%28%29%3B%0A%7D%0A%0Afunction%20projectionMutator%28projectAt%29%20%7B%0A%20%20var%20project%2C%0A%20%20%20%20%20%20k%20%3D%20150%2C%20%2F%2F%20scale%0A%20%20%20%20%20%20x%20%3D%20480%2C%20y%20%3D%20250%2C%20%2F%2F%20translate%0A%20%20%20%20%20%20lambda%20%3D%200%2C%20phi%20%3D%200%2C%20%2F%2F%20center%0A%20%20%20%20%20%20deltaLambda%20%3D%200%2C%20deltaPhi%20%3D%200%2C%20deltaGamma%20%3D%200%2C%20rotate%2C%20%2F%2F%20pre%2Drotate%0A%20%20%20%20%20%20alpha%20%3D%200%2C%20%2F%2F%20post%2Drotate%0A%20%20%20%20%20%20theta%20%3D%20null%2C%20preclip%20%3D%20clipAntimeridian%2C%20%2F%2F%20pre%2Dclip%20angle%0A%20%20%20%20%20%20x0%20%3D%20null%2C%20y0%2C%20x1%2C%20y1%2C%20postclip%20%3D%20identity%244%2C%20%2F%2F%20post%2Dclip%20extent%0A%20%20%20%20%20%20delta2%20%3D%200%2E5%2C%20%2F%2F%20precision%0A%20%20%20%20%20%20projectResample%2C%0A%20%20%20%20%20%20projectTransform%2C%0A%20%20%20%20%20%20projectRotateTransform%2C%0A%20%20%20%20%20%20cache%2C%0A%20%20%20%20%20%20cacheStream%3B%0A%0A%20%20function%20projection%28point%29%20%7B%0A%20%20%20%20return%20projectRotateTransform%28point%5B0%5D%20%2A%20radians%2C%20point%5B1%5D%20%2A%20radians%29%3B%0A%20%20%7D%0A%0A%20%20function%20invert%28point%29%20%7B%0A%20%20%20%20point%20%3D%20projectRotateTransform%2Einvert%28point%5B0%5D%2C%20point%5B1%5D%29%3B%0A%20%20%20%20return%20point%20%26%26%20%5Bpoint%5B0%5D%20%2A%20degrees%241%2C%20point%5B1%5D%20%2A%20degrees%241%5D%3B%0A%20%20%7D%0A%0A%20%20projection%2Estream%20%3D%20function%28stream%29%20%7B%0A%20%20%20%20return%20cache%20%26%26%20cacheStream%20%3D%3D%3D%20stream%20%3F%20cache%20%3A%20cache%20%3D%20transformRadians%28transformRotate%28rotate%29%28preclip%28projectResample%28postclip%28cacheStream%20%3D%20stream%29%29%29%29%29%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2Epreclip%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28preclip%20%3D%20%5F%2C%20theta%20%3D%20undefined%2C%20reset%28%29%29%20%3A%20preclip%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2Epostclip%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28postclip%20%3D%20%5F%2C%20x0%20%3D%20y0%20%3D%20x1%20%3D%20y1%20%3D%20null%2C%20reset%28%29%29%20%3A%20postclip%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2EclipAngle%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28preclip%20%3D%20%2B%5F%20%3F%20clipCircle%28theta%20%3D%20%5F%20%2A%20radians%29%20%3A%20%28theta%20%3D%20null%2C%20clipAntimeridian%29%2C%20reset%28%29%29%20%3A%20theta%20%2A%20degrees%241%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2EclipExtent%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28postclip%20%3D%20%5F%20%3D%3D%20null%20%3F%20%28x0%20%3D%20y0%20%3D%20x1%20%3D%20y1%20%3D%20null%2C%20identity%244%29%20%3A%20clipRectangle%28x0%20%3D%20%2B%5F%5B0%5D%5B0%5D%2C%20y0%20%3D%20%2B%5F%5B0%5D%5B1%5D%2C%20x1%20%3D%20%2B%5F%5B1%5D%5B0%5D%2C%20y1%20%3D%20%2B%5F%5B1%5D%5B1%5D%29%2C%20reset%28%29%29%20%3A%20x0%20%3D%3D%20null%20%3F%20null%20%3A%20%5B%5Bx0%2C%20y0%5D%2C%20%5Bx1%2C%20y1%5D%5D%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2Escale%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28k%20%3D%20%2B%5F%2C%20recenter%28%29%29%20%3A%20k%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2Etranslate%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28x%20%3D%20%2B%5F%5B0%5D%2C%20y%20%3D%20%2B%5F%5B1%5D%2C%20recenter%28%29%29%20%3A%20%5Bx%2C%20y%5D%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2Ecenter%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28lambda%20%3D%20%5F%5B0%5D%20%25%20360%20%2A%20radians%2C%20phi%20%3D%20%5F%5B1%5D%20%25%20360%20%2A%20radians%2C%20recenter%28%29%29%20%3A%20%5Blambda%20%2A%20degrees%241%2C%20phi%20%2A%20degrees%241%5D%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2Erotate%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28deltaLambda%20%3D%20%5F%5B0%5D%20%25%20360%20%2A%20radians%2C%20deltaPhi%20%3D%20%5F%5B1%5D%20%25%20360%20%2A%20radians%2C%20deltaGamma%20%3D%20%5F%2Elength%20%3E%202%20%3F%20%5F%5B2%5D%20%25%20360%20%2A%20radians%20%3A%200%2C%20recenter%28%29%29%20%3A%20%5BdeltaLambda%20%2A%20degrees%241%2C%20deltaPhi%20%2A%20degrees%241%2C%20deltaGamma%20%2A%20degrees%241%5D%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2Eangle%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28alpha%20%3D%20%5F%20%25%20360%20%2A%20radians%2C%20recenter%28%29%29%20%3A%20alpha%20%2A%20degrees%241%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2Eprecision%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28projectResample%20%3D%20resample%28projectTransform%2C%20delta2%20%3D%20%5F%20%2A%20%5F%29%2C%20reset%28%29%29%20%3A%20sqrt%28delta2%29%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2EfitExtent%20%3D%20function%28extent%2C%20object%29%20%7B%0A%20%20%20%20return%20fitExtent%28projection%2C%20extent%2C%20object%29%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2EfitSize%20%3D%20function%28size%2C%20object%29%20%7B%0A%20%20%20%20return%20fitSize%28projection%2C%20size%2C%20object%29%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2EfitWidth%20%3D%20function%28width%2C%20object%29%20%7B%0A%20%20%20%20return%20fitWidth%28projection%2C%20width%2C%20object%29%3B%0A%20%20%7D%3B%0A%0A%20%20projection%2EfitHeight%20%3D%20function%28height%2C%20object%29%20%7B%0A%20%20%20%20return%20fitHeight%28projection%2C%20height%2C%20object%29%3B%0A%20%20%7D%3B%0A%0A%20%20function%20recenter%28%29%20%7B%0A%20%20%20%20var%20center%20%3D%20scaleTranslateRotate%28k%2C%200%2C%200%2C%20alpha%29%2Eapply%28null%2C%20project%28lambda%2C%20phi%29%29%2C%0A%20%20%20%20%20%20%20%20transform%24%241%20%3D%20%28alpha%20%3F%20scaleTranslateRotate%20%3A%20scaleTranslate%29%28k%2C%20x%20%2D%20center%5B0%5D%2C%20y%20%2D%20center%5B1%5D%2C%20alpha%29%3B%0A%20%20%20%20rotate%20%3D%20rotateRadians%28deltaLambda%2C%20deltaPhi%2C%20deltaGamma%29%3B%0A%20%20%20%20projectTransform%20%3D%20compose%28project%2C%20transform%24%241%29%3B%0A%20%20%20%20projectRotateTransform%20%3D%20compose%28rotate%2C%20projectTransform%29%3B%0A%20%20%20%20projectResample%20%3D%20resample%28projectTransform%2C%20delta2%29%3B%0A%20%20%20%20return%20reset%28%29%3B%0A%20%20%7D%0A%0A%20%20function%20reset%28%29%20%7B%0A%20%20%20%20cache%20%3D%20cacheStream%20%3D%20null%3B%0A%20%20%20%20return%20projection%3B%0A%20%20%7D%0A%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20project%20%3D%20projectAt%2Eapply%28this%2C%20arguments%29%3B%0A%20%20%20%20projection%2Einvert%20%3D%20project%2Einvert%20%26%26%20invert%3B%0A%20%20%20%20return%20recenter%28%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20conicProjection%28projectAt%29%20%7B%0A%20%20var%20phi0%20%3D%200%2C%0A%20%20%20%20%20%20phi1%20%3D%20pi%243%20%2F%203%2C%0A%20%20%20%20%20%20m%20%3D%20projectionMutator%28projectAt%29%2C%0A%20%20%20%20%20%20p%20%3D%20m%28phi0%2C%20phi1%29%3B%0A%0A%20%20p%2Eparallels%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20m%28phi0%20%3D%20%5F%5B0%5D%20%2A%20radians%2C%20phi1%20%3D%20%5F%5B1%5D%20%2A%20radians%29%20%3A%20%5Bphi0%20%2A%20degrees%241%2C%20phi1%20%2A%20degrees%241%5D%3B%0A%20%20%7D%3B%0A%0A%20%20return%20p%3B%0A%7D%0A%0Afunction%20cylindricalEqualAreaRaw%28phi0%29%20%7B%0A%20%20var%20cosPhi0%20%3D%20cos%241%28phi0%29%3B%0A%0A%20%20function%20forward%28lambda%2C%20phi%29%20%7B%0A%20%20%20%20return%20%5Blambda%20%2A%20cosPhi0%2C%20sin%241%28phi%29%20%2F%20cosPhi0%5D%3B%0A%20%20%7D%0A%0A%20%20forward%2Einvert%20%3D%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20return%20%5Bx%20%2F%20cosPhi0%2C%20asin%28y%20%2A%20cosPhi0%29%5D%3B%0A%20%20%7D%3B%0A%0A%20%20return%20forward%3B%0A%7D%0A%0Afunction%20conicEqualAreaRaw%28y0%2C%20y1%29%20%7B%0A%20%20var%20sy0%20%3D%20sin%241%28y0%29%2C%20n%20%3D%20%28sy0%20%2B%20sin%241%28y1%29%29%20%2F%202%3B%0A%0A%20%20%2F%2F%20Are%20the%20parallels%20symmetrical%20around%20the%20Equator%3F%0A%20%20if%20%28abs%28n%29%20%3C%20epsilon%242%29%20return%20cylindricalEqualAreaRaw%28y0%29%3B%0A%0A%20%20var%20c%20%3D%201%20%2B%20sy0%20%2A%20%282%20%2A%20n%20%2D%20sy0%29%2C%20r0%20%3D%20sqrt%28c%29%20%2F%20n%3B%0A%0A%20%20function%20project%28x%2C%20y%29%20%7B%0A%20%20%20%20var%20r%20%3D%20sqrt%28c%20%2D%202%20%2A%20n%20%2A%20sin%241%28y%29%29%20%2F%20n%3B%0A%20%20%20%20return%20%5Br%20%2A%20sin%241%28x%20%2A%3D%20n%29%2C%20r0%20%2D%20r%20%2A%20cos%241%28x%29%5D%3B%0A%20%20%7D%0A%0A%20%20project%2Einvert%20%3D%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20var%20r0y%20%3D%20r0%20%2D%20y%3B%0A%20%20%20%20return%20%5Batan2%28x%2C%20abs%28r0y%29%29%20%2F%20n%20%2A%20sign%28r0y%29%2C%20asin%28%28c%20%2D%20%28x%20%2A%20x%20%2B%20r0y%20%2A%20r0y%29%20%2A%20n%20%2A%20n%29%20%2F%20%282%20%2A%20n%29%29%5D%3B%0A%20%20%7D%3B%0A%0A%20%20return%20project%3B%0A%7D%0A%0Afunction%20conicEqualArea%28%29%20%7B%0A%20%20return%20conicProjection%28conicEqualAreaRaw%29%0A%20%20%20%20%20%20%2Escale%28155%2E424%29%0A%20%20%20%20%20%20%2Ecenter%28%5B0%2C%2033%2E6442%5D%29%3B%0A%7D%0A%0Afunction%20albers%28%29%20%7B%0A%20%20return%20conicEqualArea%28%29%0A%20%20%20%20%20%20%2Eparallels%28%5B29%2E5%2C%2045%2E5%5D%29%0A%20%20%20%20%20%20%2Escale%281070%29%0A%20%20%20%20%20%20%2Etranslate%28%5B480%2C%20250%5D%29%0A%20%20%20%20%20%20%2Erotate%28%5B96%2C%200%5D%29%0A%20%20%20%20%20%20%2Ecenter%28%5B%2D0%2E6%2C%2038%2E7%5D%29%3B%0A%7D%0A%0A%2F%2F%20The%20projections%20must%20have%20mutually%20exclusive%20clip%20regions%20on%20the%20sphere%2C%0A%2F%2F%20as%20this%20will%20avoid%20emitting%20interleaving%20lines%20and%20polygons%2E%0Afunction%20multiplex%28streams%29%20%7B%0A%20%20var%20n%20%3D%20streams%2Elength%3B%0A%20%20return%20%7B%0A%20%20%20%20point%3A%20function%28x%2C%20y%29%20%7B%20var%20i%20%3D%20%2D1%3B%20while%20%28%2B%2Bi%20%3C%20n%29%20streams%5Bi%5D%2Epoint%28x%2C%20y%29%3B%20%7D%2C%0A%20%20%20%20sphere%3A%20function%28%29%20%7B%20var%20i%20%3D%20%2D1%3B%20while%20%28%2B%2Bi%20%3C%20n%29%20streams%5Bi%5D%2Esphere%28%29%3B%20%7D%2C%0A%20%20%20%20lineStart%3A%20function%28%29%20%7B%20var%20i%20%3D%20%2D1%3B%20while%20%28%2B%2Bi%20%3C%20n%29%20streams%5Bi%5D%2ElineStart%28%29%3B%20%7D%2C%0A%20%20%20%20lineEnd%3A%20function%28%29%20%7B%20var%20i%20%3D%20%2D1%3B%20while%20%28%2B%2Bi%20%3C%20n%29%20streams%5Bi%5D%2ElineEnd%28%29%3B%20%7D%2C%0A%20%20%20%20polygonStart%3A%20function%28%29%20%7B%20var%20i%20%3D%20%2D1%3B%20while%20%28%2B%2Bi%20%3C%20n%29%20streams%5Bi%5D%2EpolygonStart%28%29%3B%20%7D%2C%0A%20%20%20%20polygonEnd%3A%20function%28%29%20%7B%20var%20i%20%3D%20%2D1%3B%20while%20%28%2B%2Bi%20%3C%20n%29%20streams%5Bi%5D%2EpolygonEnd%28%29%3B%20%7D%0A%20%20%7D%3B%0A%7D%0A%0A%2F%2F%20A%20composite%20projection%20for%20the%20United%20States%2C%20configured%20by%20default%20for%0A%2F%2F%20960%C3%97500%2E%20The%20projection%20also%20works%20quite%20well%20at%20960%C3%97600%20if%20you%20change%20the%0A%2F%2F%20scale%20to%201285%20and%20adjust%20the%20translate%20accordingly%2E%20The%20set%20of%20standard%0A%2F%2F%20parallels%20for%20each%20region%20comes%20from%20USGS%2C%20which%20is%20published%20here%3A%0A%2F%2F%20http%3A%2F%2Fegsc%2Eusgs%2Egov%2Fisb%2Fpubs%2FMapProjections%2Fprojections%2Ehtml%23albers%0Afunction%20albersUsa%28%29%20%7B%0A%20%20var%20cache%2C%0A%20%20%20%20%20%20cacheStream%2C%0A%20%20%20%20%20%20lower48%20%3D%20albers%28%29%2C%20lower48Point%2C%0A%20%20%20%20%20%20alaska%20%3D%20conicEqualArea%28%29%2Erotate%28%5B154%2C%200%5D%29%2Ecenter%28%5B%2D2%2C%2058%2E5%5D%29%2Eparallels%28%5B55%2C%2065%5D%29%2C%20alaskaPoint%2C%20%2F%2F%20EPSG%3A3338%0A%20%20%20%20%20%20hawaii%20%3D%20conicEqualArea%28%29%2Erotate%28%5B157%2C%200%5D%29%2Ecenter%28%5B%2D3%2C%2019%2E9%5D%29%2Eparallels%28%5B8%2C%2018%5D%29%2C%20hawaiiPoint%2C%20%2F%2F%20ESRI%3A102007%0A%20%20%20%20%20%20point%2C%20pointStream%20%3D%20%7Bpoint%3A%20function%28x%2C%20y%29%20%7B%20point%20%3D%20%5Bx%2C%20y%5D%3B%20%7D%7D%3B%0A%0A%20%20function%20albersUsa%28coordinates%29%20%7B%0A%20%20%20%20var%20x%20%3D%20coordinates%5B0%5D%2C%20y%20%3D%20coordinates%5B1%5D%3B%0A%20%20%20%20return%20point%20%3D%20null%2C%20%28lower48Point%2Epoint%28x%2C%20y%29%2C%20point%29%0A%20%20%20%20%20%20%20%20%7C%7C%20%28alaskaPoint%2Epoint%28x%2C%20y%29%2C%20point%29%0A%20%20%20%20%20%20%20%20%7C%7C%20%28hawaiiPoint%2Epoint%28x%2C%20y%29%2C%20point%29%3B%0A%20%20%7D%0A%0A%20%20albersUsa%2Einvert%20%3D%20function%28coordinates%29%20%7B%0A%20%20%20%20var%20k%20%3D%20lower48%2Escale%28%29%2C%0A%20%20%20%20%20%20%20%20t%20%3D%20lower48%2Etranslate%28%29%2C%0A%20%20%20%20%20%20%20%20x%20%3D%20%28coordinates%5B0%5D%20%2D%20t%5B0%5D%29%20%2F%20k%2C%0A%20%20%20%20%20%20%20%20y%20%3D%20%28coordinates%5B1%5D%20%2D%20t%5B1%5D%29%20%2F%20k%3B%0A%20%20%20%20return%20%28y%20%3E%3D%200%2E120%20%26%26%20y%20%3C%200%2E234%20%26%26%20x%20%3E%3D%20%2D0%2E425%20%26%26%20x%20%3C%20%2D0%2E214%20%3F%20alaska%0A%20%20%20%20%20%20%20%20%3A%20y%20%3E%3D%200%2E166%20%26%26%20y%20%3C%200%2E234%20%26%26%20x%20%3E%3D%20%2D0%2E214%20%26%26%20x%20%3C%20%2D0%2E115%20%3F%20hawaii%0A%20%20%20%20%20%20%20%20%3A%20lower48%29%2Einvert%28coordinates%29%3B%0A%20%20%7D%3B%0A%0A%20%20albersUsa%2Estream%20%3D%20function%28stream%29%20%7B%0A%20%20%20%20return%20cache%20%26%26%20cacheStream%20%3D%3D%3D%20stream%20%3F%20cache%20%3A%20cache%20%3D%20multiplex%28%5Blower48%2Estream%28cacheStream%20%3D%20stream%29%2C%20alaska%2Estream%28stream%29%2C%20hawaii%2Estream%28stream%29%5D%29%3B%0A%20%20%7D%3B%0A%0A%20%20albersUsa%2Eprecision%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20lower48%2Eprecision%28%29%3B%0A%20%20%20%20lower48%2Eprecision%28%5F%29%2C%20alaska%2Eprecision%28%5F%29%2C%20hawaii%2Eprecision%28%5F%29%3B%0A%20%20%20%20return%20reset%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20albersUsa%2Escale%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20lower48%2Escale%28%29%3B%0A%20%20%20%20lower48%2Escale%28%5F%29%2C%20alaska%2Escale%28%5F%20%2A%200%2E35%29%2C%20hawaii%2Escale%28%5F%29%3B%0A%20%20%20%20return%20albersUsa%2Etranslate%28lower48%2Etranslate%28%29%29%3B%0A%20%20%7D%3B%0A%0A%20%20albersUsa%2Etranslate%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20lower48%2Etranslate%28%29%3B%0A%20%20%20%20var%20k%20%3D%20lower48%2Escale%28%29%2C%20x%20%3D%20%2B%5F%5B0%5D%2C%20y%20%3D%20%2B%5F%5B1%5D%3B%0A%0A%20%20%20%20lower48Point%20%3D%20lower48%0A%20%20%20%20%20%20%20%20%2Etranslate%28%5F%29%0A%20%20%20%20%20%20%20%20%2EclipExtent%28%5B%5Bx%20%2D%200%2E455%20%2A%20k%2C%20y%20%2D%200%2E238%20%2A%20k%5D%2C%20%5Bx%20%2B%200%2E455%20%2A%20k%2C%20y%20%2B%200%2E238%20%2A%20k%5D%5D%29%0A%20%20%20%20%20%20%20%20%2Estream%28pointStream%29%3B%0A%0A%20%20%20%20alaskaPoint%20%3D%20alaska%0A%20%20%20%20%20%20%20%20%2Etranslate%28%5Bx%20%2D%200%2E307%20%2A%20k%2C%20y%20%2B%200%2E201%20%2A%20k%5D%29%0A%20%20%20%20%20%20%20%20%2EclipExtent%28%5B%5Bx%20%2D%200%2E425%20%2A%20k%20%2B%20epsilon%242%2C%20y%20%2B%200%2E120%20%2A%20k%20%2B%20epsilon%242%5D%2C%20%5Bx%20%2D%200%2E214%20%2A%20k%20%2D%20epsilon%242%2C%20y%20%2B%200%2E234%20%2A%20k%20%2D%20epsilon%242%5D%5D%29%0A%20%20%20%20%20%20%20%20%2Estream%28pointStream%29%3B%0A%0A%20%20%20%20hawaiiPoint%20%3D%20hawaii%0A%20%20%20%20%20%20%20%20%2Etranslate%28%5Bx%20%2D%200%2E205%20%2A%20k%2C%20y%20%2B%200%2E212%20%2A%20k%5D%29%0A%20%20%20%20%20%20%20%20%2EclipExtent%28%5B%5Bx%20%2D%200%2E214%20%2A%20k%20%2B%20epsilon%242%2C%20y%20%2B%200%2E166%20%2A%20k%20%2B%20epsilon%242%5D%2C%20%5Bx%20%2D%200%2E115%20%2A%20k%20%2D%20epsilon%242%2C%20y%20%2B%200%2E234%20%2A%20k%20%2D%20epsilon%242%5D%5D%29%0A%20%20%20%20%20%20%20%20%2Estream%28pointStream%29%3B%0A%0A%20%20%20%20return%20reset%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20albersUsa%2EfitExtent%20%3D%20function%28extent%2C%20object%29%20%7B%0A%20%20%20%20return%20fitExtent%28albersUsa%2C%20extent%2C%20object%29%3B%0A%20%20%7D%3B%0A%0A%20%20albersUsa%2EfitSize%20%3D%20function%28size%2C%20object%29%20%7B%0A%20%20%20%20return%20fitSize%28albersUsa%2C%20size%2C%20object%29%3B%0A%20%20%7D%3B%0A%0A%20%20albersUsa%2EfitWidth%20%3D%20function%28width%2C%20object%29%20%7B%0A%20%20%20%20return%20fitWidth%28albersUsa%2C%20width%2C%20object%29%3B%0A%20%20%7D%3B%0A%0A%20%20albersUsa%2EfitHeight%20%3D%20function%28height%2C%20object%29%20%7B%0A%20%20%20%20return%20fitHeight%28albersUsa%2C%20height%2C%20object%29%3B%0A%20%20%7D%3B%0A%0A%20%20function%20reset%28%29%20%7B%0A%20%20%20%20cache%20%3D%20cacheStream%20%3D%20null%3B%0A%20%20%20%20return%20albersUsa%3B%0A%20%20%7D%0A%0A%20%20return%20albersUsa%2Escale%281070%29%3B%0A%7D%0A%0Afunction%20azimuthalRaw%28scale%29%20%7B%0A%20%20return%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20var%20cx%20%3D%20cos%241%28x%29%2C%0A%20%20%20%20%20%20%20%20cy%20%3D%20cos%241%28y%29%2C%0A%20%20%20%20%20%20%20%20k%20%3D%20scale%28cx%20%2A%20cy%29%3B%0A%20%20%20%20return%20%5B%0A%20%20%20%20%20%20k%20%2A%20cy%20%2A%20sin%241%28x%29%2C%0A%20%20%20%20%20%20k%20%2A%20sin%241%28y%29%0A%20%20%20%20%5D%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20azimuthalInvert%28angle%29%20%7B%0A%20%20return%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20var%20z%20%3D%20sqrt%28x%20%2A%20x%20%2B%20y%20%2A%20y%29%2C%0A%20%20%20%20%20%20%20%20c%20%3D%20angle%28z%29%2C%0A%20%20%20%20%20%20%20%20sc%20%3D%20sin%241%28c%29%2C%0A%20%20%20%20%20%20%20%20cc%20%3D%20cos%241%28c%29%3B%0A%20%20%20%20return%20%5B%0A%20%20%20%20%20%20atan2%28x%20%2A%20sc%2C%20z%20%2A%20cc%29%2C%0A%20%20%20%20%20%20asin%28z%20%26%26%20y%20%2A%20sc%20%2F%20z%29%0A%20%20%20%20%5D%3B%0A%20%20%7D%0A%7D%0A%0Avar%20azimuthalEqualAreaRaw%20%3D%20azimuthalRaw%28function%28cxcy%29%20%7B%0A%20%20return%20sqrt%282%20%2F%20%281%20%2B%20cxcy%29%29%3B%0A%7D%29%3B%0A%0AazimuthalEqualAreaRaw%2Einvert%20%3D%20azimuthalInvert%28function%28z%29%20%7B%0A%20%20return%202%20%2A%20asin%28z%20%2F%202%29%3B%0A%7D%29%3B%0A%0Afunction%20azimuthalEqualArea%28%29%20%7B%0A%20%20return%20projection%28azimuthalEqualAreaRaw%29%0A%20%20%20%20%20%20%2Escale%28124%2E75%29%0A%20%20%20%20%20%20%2EclipAngle%28180%20%2D%201e%2D3%29%3B%0A%7D%0A%0Avar%20azimuthalEquidistantRaw%20%3D%20azimuthalRaw%28function%28c%29%20%7B%0A%20%20return%20%28c%20%3D%20acos%28c%29%29%20%26%26%20c%20%2F%20sin%241%28c%29%3B%0A%7D%29%3B%0A%0AazimuthalEquidistantRaw%2Einvert%20%3D%20azimuthalInvert%28function%28z%29%20%7B%0A%20%20return%20z%3B%0A%7D%29%3B%0A%0Afunction%20azimuthalEquidistant%28%29%20%7B%0A%20%20return%20projection%28azimuthalEquidistantRaw%29%0A%20%20%20%20%20%20%2Escale%2879%2E4188%29%0A%20%20%20%20%20%20%2EclipAngle%28180%20%2D%201e%2D3%29%3B%0A%7D%0A%0Afunction%20mercatorRaw%28lambda%2C%20phi%29%20%7B%0A%20%20return%20%5Blambda%2C%20log%28tan%28%28halfPi%242%20%2B%20phi%29%20%2F%202%29%29%5D%3B%0A%7D%0A%0AmercatorRaw%2Einvert%20%3D%20function%28x%2C%20y%29%20%7B%0A%20%20return%20%5Bx%2C%202%20%2A%20atan%28exp%28y%29%29%20%2D%20halfPi%242%5D%3B%0A%7D%3B%0A%0Afunction%20mercator%28%29%20%7B%0A%20%20return%20mercatorProjection%28mercatorRaw%29%0A%20%20%20%20%20%20%2Escale%28961%20%2F%20tau%243%29%3B%0A%7D%0A%0Afunction%20mercatorProjection%28project%29%20%7B%0A%20%20var%20m%20%3D%20projection%28project%29%2C%0A%20%20%20%20%20%20center%20%3D%20m%2Ecenter%2C%0A%20%20%20%20%20%20scale%20%3D%20m%2Escale%2C%0A%20%20%20%20%20%20translate%20%3D%20m%2Etranslate%2C%0A%20%20%20%20%20%20clipExtent%20%3D%20m%2EclipExtent%2C%0A%20%20%20%20%20%20x0%20%3D%20null%2C%20y0%2C%20x1%2C%20y1%3B%20%2F%2F%20clip%20extent%0A%0A%20%20m%2Escale%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28scale%28%5F%29%2C%20reclip%28%29%29%20%3A%20scale%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20m%2Etranslate%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28translate%28%5F%29%2C%20reclip%28%29%29%20%3A%20translate%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20m%2Ecenter%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28center%28%5F%29%2C%20reclip%28%29%29%20%3A%20center%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20m%2EclipExtent%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28%5F%20%3D%3D%20null%20%3F%20x0%20%3D%20y0%20%3D%20x1%20%3D%20y1%20%3D%20null%20%3A%20%28x0%20%3D%20%2B%5F%5B0%5D%5B0%5D%2C%20y0%20%3D%20%2B%5F%5B0%5D%5B1%5D%2C%20x1%20%3D%20%2B%5F%5B1%5D%5B0%5D%2C%20y1%20%3D%20%2B%5F%5B1%5D%5B1%5D%29%2C%20reclip%28%29%29%20%3A%20x0%20%3D%3D%20null%20%3F%20null%20%3A%20%5B%5Bx0%2C%20y0%5D%2C%20%5Bx1%2C%20y1%5D%5D%3B%0A%20%20%7D%3B%0A%0A%20%20function%20reclip%28%29%20%7B%0A%20%20%20%20var%20k%20%3D%20pi%243%20%2A%20scale%28%29%2C%0A%20%20%20%20%20%20%20%20t%20%3D%20m%28rotation%28m%2Erotate%28%29%29%2Einvert%28%5B0%2C%200%5D%29%29%3B%0A%20%20%20%20return%20clipExtent%28x0%20%3D%3D%20null%0A%20%20%20%20%20%20%20%20%3F%20%5B%5Bt%5B0%5D%20%2D%20k%2C%20t%5B1%5D%20%2D%20k%5D%2C%20%5Bt%5B0%5D%20%2B%20k%2C%20t%5B1%5D%20%2B%20k%5D%5D%20%3A%20project%20%3D%3D%3D%20mercatorRaw%0A%20%20%20%20%20%20%20%20%3F%20%5B%5BMath%2Emax%28t%5B0%5D%20%2D%20k%2C%20x0%29%2C%20y0%5D%2C%20%5BMath%2Emin%28t%5B0%5D%20%2B%20k%2C%20x1%29%2C%20y1%5D%5D%0A%20%20%20%20%20%20%20%20%3A%20%5B%5Bx0%2C%20Math%2Emax%28t%5B1%5D%20%2D%20k%2C%20y0%29%5D%2C%20%5Bx1%2C%20Math%2Emin%28t%5B1%5D%20%2B%20k%2C%20y1%29%5D%5D%29%3B%0A%20%20%7D%0A%0A%20%20return%20reclip%28%29%3B%0A%7D%0A%0Afunction%20tany%28y%29%20%7B%0A%20%20return%20tan%28%28halfPi%242%20%2B%20y%29%20%2F%202%29%3B%0A%7D%0A%0Afunction%20conicConformalRaw%28y0%2C%20y1%29%20%7B%0A%20%20var%20cy0%20%3D%20cos%241%28y0%29%2C%0A%20%20%20%20%20%20n%20%3D%20y0%20%3D%3D%3D%20y1%20%3F%20sin%241%28y0%29%20%3A%20log%28cy0%20%2F%20cos%241%28y1%29%29%20%2F%20log%28tany%28y1%29%20%2F%20tany%28y0%29%29%2C%0A%20%20%20%20%20%20f%20%3D%20cy0%20%2A%20pow%28tany%28y0%29%2C%20n%29%20%2F%20n%3B%0A%0A%20%20if%20%28%21n%29%20return%20mercatorRaw%3B%0A%0A%20%20function%20project%28x%2C%20y%29%20%7B%0A%20%20%20%20if%20%28f%20%3E%200%29%20%7B%20if%20%28y%20%3C%20%2DhalfPi%242%20%2B%20epsilon%242%29%20y%20%3D%20%2DhalfPi%242%20%2B%20epsilon%242%3B%20%7D%0A%20%20%20%20else%20%7B%20if%20%28y%20%3E%20halfPi%242%20%2D%20epsilon%242%29%20y%20%3D%20halfPi%242%20%2D%20epsilon%242%3B%20%7D%0A%20%20%20%20var%20r%20%3D%20f%20%2F%20pow%28tany%28y%29%2C%20n%29%3B%0A%20%20%20%20return%20%5Br%20%2A%20sin%241%28n%20%2A%20x%29%2C%20f%20%2D%20r%20%2A%20cos%241%28n%20%2A%20x%29%5D%3B%0A%20%20%7D%0A%0A%20%20project%2Einvert%20%3D%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20var%20fy%20%3D%20f%20%2D%20y%2C%20r%20%3D%20sign%28n%29%20%2A%20sqrt%28x%20%2A%20x%20%2B%20fy%20%2A%20fy%29%3B%0A%20%20%20%20return%20%5Batan2%28x%2C%20abs%28fy%29%29%20%2F%20n%20%2A%20sign%28fy%29%2C%202%20%2A%20atan%28pow%28f%20%2F%20r%2C%201%20%2F%20n%29%29%20%2D%20halfPi%242%5D%3B%0A%20%20%7D%3B%0A%0A%20%20return%20project%3B%0A%7D%0A%0Afunction%20conicConformal%28%29%20%7B%0A%20%20return%20conicProjection%28conicConformalRaw%29%0A%20%20%20%20%20%20%2Escale%28109%2E5%29%0A%20%20%20%20%20%20%2Eparallels%28%5B30%2C%2030%5D%29%3B%0A%7D%0A%0Afunction%20equirectangularRaw%28lambda%2C%20phi%29%20%7B%0A%20%20return%20%5Blambda%2C%20phi%5D%3B%0A%7D%0A%0AequirectangularRaw%2Einvert%20%3D%20equirectangularRaw%3B%0A%0Afunction%20equirectangular%28%29%20%7B%0A%20%20return%20projection%28equirectangularRaw%29%0A%20%20%20%20%20%20%2Escale%28152%2E63%29%3B%0A%7D%0A%0Afunction%20conicEquidistantRaw%28y0%2C%20y1%29%20%7B%0A%20%20var%20cy0%20%3D%20cos%241%28y0%29%2C%0A%20%20%20%20%20%20n%20%3D%20y0%20%3D%3D%3D%20y1%20%3F%20sin%241%28y0%29%20%3A%20%28cy0%20%2D%20cos%241%28y1%29%29%20%2F%20%28y1%20%2D%20y0%29%2C%0A%20%20%20%20%20%20g%20%3D%20cy0%20%2F%20n%20%2B%20y0%3B%0A%0A%20%20if%20%28abs%28n%29%20%3C%20epsilon%242%29%20return%20equirectangularRaw%3B%0A%0A%20%20function%20project%28x%2C%20y%29%20%7B%0A%20%20%20%20var%20gy%20%3D%20g%20%2D%20y%2C%20nx%20%3D%20n%20%2A%20x%3B%0A%20%20%20%20return%20%5Bgy%20%2A%20sin%241%28nx%29%2C%20g%20%2D%20gy%20%2A%20cos%241%28nx%29%5D%3B%0A%20%20%7D%0A%0A%20%20project%2Einvert%20%3D%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20var%20gy%20%3D%20g%20%2D%20y%3B%0A%20%20%20%20return%20%5Batan2%28x%2C%20abs%28gy%29%29%20%2F%20n%20%2A%20sign%28gy%29%2C%20g%20%2D%20sign%28n%29%20%2A%20sqrt%28x%20%2A%20x%20%2B%20gy%20%2A%20gy%29%5D%3B%0A%20%20%7D%3B%0A%0A%20%20return%20project%3B%0A%7D%0A%0Afunction%20conicEquidistant%28%29%20%7B%0A%20%20return%20conicProjection%28conicEquidistantRaw%29%0A%20%20%20%20%20%20%2Escale%28131%2E154%29%0A%20%20%20%20%20%20%2Ecenter%28%5B0%2C%2013%2E9389%5D%29%3B%0A%7D%0A%0Afunction%20gnomonicRaw%28x%2C%20y%29%20%7B%0A%20%20var%20cy%20%3D%20cos%241%28y%29%2C%20k%20%3D%20cos%241%28x%29%20%2A%20cy%3B%0A%20%20return%20%5Bcy%20%2A%20sin%241%28x%29%20%2F%20k%2C%20sin%241%28y%29%20%2F%20k%5D%3B%0A%7D%0A%0AgnomonicRaw%2Einvert%20%3D%20azimuthalInvert%28atan%29%3B%0A%0Afunction%20gnomonic%28%29%20%7B%0A%20%20return%20projection%28gnomonicRaw%29%0A%20%20%20%20%20%20%2Escale%28144%2E049%29%0A%20%20%20%20%20%20%2EclipAngle%2860%29%3B%0A%7D%0A%0Afunction%20scaleTranslate%241%28kx%2C%20ky%2C%20tx%2C%20ty%29%20%7B%0A%20%20return%20kx%20%3D%3D%3D%201%20%26%26%20ky%20%3D%3D%3D%201%20%26%26%20tx%20%3D%3D%3D%200%20%26%26%20ty%20%3D%3D%3D%200%20%3F%20identity%244%20%3A%20transformer%28%7B%0A%20%20%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20%20%20this%2Estream%2Epoint%28x%20%2A%20kx%20%2B%20tx%2C%20y%20%2A%20ky%20%2B%20ty%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%3B%0A%7D%0A%0Afunction%20identity%245%28%29%20%7B%0A%20%20var%20k%20%3D%201%2C%20tx%20%3D%200%2C%20ty%20%3D%200%2C%20sx%20%3D%201%2C%20sy%20%3D%201%2C%20transform%24%241%20%3D%20identity%244%2C%20%2F%2F%20scale%2C%20translate%20and%20reflect%0A%20%20%20%20%20%20x0%20%3D%20null%2C%20y0%2C%20x1%2C%20y1%2C%20%2F%2F%20clip%20extent%0A%20%20%20%20%20%20postclip%20%3D%20identity%244%2C%0A%20%20%20%20%20%20cache%2C%0A%20%20%20%20%20%20cacheStream%2C%0A%20%20%20%20%20%20projection%3B%0A%0A%20%20function%20reset%28%29%20%7B%0A%20%20%20%20cache%20%3D%20cacheStream%20%3D%20null%3B%0A%20%20%20%20return%20projection%3B%0A%20%20%7D%0A%0A%20%20return%20projection%20%3D%20%7B%0A%20%20%20%20stream%3A%20function%28stream%29%20%7B%0A%20%20%20%20%20%20return%20cache%20%26%26%20cacheStream%20%3D%3D%3D%20stream%20%3F%20cache%20%3A%20cache%20%3D%20transform%24%241%28postclip%28cacheStream%20%3D%20stream%29%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20postclip%3A%20function%28%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3F%20%28postclip%20%3D%20%5F%2C%20x0%20%3D%20y0%20%3D%20x1%20%3D%20y1%20%3D%20null%2C%20reset%28%29%29%20%3A%20postclip%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20clipExtent%3A%20function%28%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3F%20%28postclip%20%3D%20%5F%20%3D%3D%20null%20%3F%20%28x0%20%3D%20y0%20%3D%20x1%20%3D%20y1%20%3D%20null%2C%20identity%244%29%20%3A%20clipRectangle%28x0%20%3D%20%2B%5F%5B0%5D%5B0%5D%2C%20y0%20%3D%20%2B%5F%5B0%5D%5B1%5D%2C%20x1%20%3D%20%2B%5F%5B1%5D%5B0%5D%2C%20y1%20%3D%20%2B%5F%5B1%5D%5B1%5D%29%2C%20reset%28%29%29%20%3A%20x0%20%3D%3D%20null%20%3F%20null%20%3A%20%5B%5Bx0%2C%20y0%5D%2C%20%5Bx1%2C%20y1%5D%5D%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20scale%3A%20function%28%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3F%20%28transform%24%241%20%3D%20scaleTranslate%241%28%28k%20%3D%20%2B%5F%29%20%2A%20sx%2C%20k%20%2A%20sy%2C%20tx%2C%20ty%29%2C%20reset%28%29%29%20%3A%20k%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20translate%3A%20function%28%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3F%20%28transform%24%241%20%3D%20scaleTranslate%241%28k%20%2A%20sx%2C%20k%20%2A%20sy%2C%20tx%20%3D%20%2B%5F%5B0%5D%2C%20ty%20%3D%20%2B%5F%5B1%5D%29%2C%20reset%28%29%29%20%3A%20%5Btx%2C%20ty%5D%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20reflectX%3A%20function%28%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3F%20%28transform%24%241%20%3D%20scaleTranslate%241%28k%20%2A%20%28sx%20%3D%20%5F%20%3F%20%2D1%20%3A%201%29%2C%20k%20%2A%20sy%2C%20tx%2C%20ty%29%2C%20reset%28%29%29%20%3A%20sx%20%3C%200%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20reflectY%3A%20function%28%5F%29%20%7B%0A%20%20%20%20%20%20return%20arguments%2Elength%20%3F%20%28transform%24%241%20%3D%20scaleTranslate%241%28k%20%2A%20sx%2C%20k%20%2A%20%28sy%20%3D%20%5F%20%3F%20%2D1%20%3A%201%29%2C%20tx%2C%20ty%29%2C%20reset%28%29%29%20%3A%20sy%20%3C%200%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20fitExtent%3A%20function%28extent%2C%20object%29%20%7B%0A%20%20%20%20%20%20return%20fitExtent%28projection%2C%20extent%2C%20object%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20fitSize%3A%20function%28size%2C%20object%29%20%7B%0A%20%20%20%20%20%20return%20fitSize%28projection%2C%20size%2C%20object%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20fitWidth%3A%20function%28width%2C%20object%29%20%7B%0A%20%20%20%20%20%20return%20fitWidth%28projection%2C%20width%2C%20object%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20fitHeight%3A%20function%28height%2C%20object%29%20%7B%0A%20%20%20%20%20%20return%20fitHeight%28projection%2C%20height%2C%20object%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20naturalEarth1Raw%28lambda%2C%20phi%29%20%7B%0A%20%20var%20phi2%20%3D%20phi%20%2A%20phi%2C%20phi4%20%3D%20phi2%20%2A%20phi2%3B%0A%20%20return%20%5B%0A%20%20%20%20lambda%20%2A%20%280%2E8707%20%2D%200%2E131979%20%2A%20phi2%20%2B%20phi4%20%2A%20%28%2D0%2E013791%20%2B%20phi4%20%2A%20%280%2E003971%20%2A%20phi2%20%2D%200%2E001529%20%2A%20phi4%29%29%29%2C%0A%20%20%20%20phi%20%2A%20%281%2E007226%20%2B%20phi2%20%2A%20%280%2E015085%20%2B%20phi4%20%2A%20%28%2D0%2E044475%20%2B%200%2E028874%20%2A%20phi2%20%2D%200%2E005916%20%2A%20phi4%29%29%29%0A%20%20%5D%3B%0A%7D%0A%0AnaturalEarth1Raw%2Einvert%20%3D%20function%28x%2C%20y%29%20%7B%0A%20%20var%20phi%20%3D%20y%2C%20i%20%3D%2025%2C%20delta%3B%0A%20%20do%20%7B%0A%20%20%20%20var%20phi2%20%3D%20phi%20%2A%20phi%2C%20phi4%20%3D%20phi2%20%2A%20phi2%3B%0A%20%20%20%20phi%20%2D%3D%20delta%20%3D%20%28phi%20%2A%20%281%2E007226%20%2B%20phi2%20%2A%20%280%2E015085%20%2B%20phi4%20%2A%20%28%2D0%2E044475%20%2B%200%2E028874%20%2A%20phi2%20%2D%200%2E005916%20%2A%20phi4%29%29%29%20%2D%20y%29%20%2F%0A%20%20%20%20%20%20%20%20%281%2E007226%20%2B%20phi2%20%2A%20%280%2E015085%20%2A%203%20%2B%20phi4%20%2A%20%28%2D0%2E044475%20%2A%207%20%2B%200%2E028874%20%2A%209%20%2A%20phi2%20%2D%200%2E005916%20%2A%2011%20%2A%20phi4%29%29%29%3B%0A%20%20%7D%20while%20%28abs%28delta%29%20%3E%20epsilon%242%20%26%26%20%2D%2Di%20%3E%200%29%3B%0A%20%20return%20%5B%0A%20%20%20%20x%20%2F%20%280%2E8707%20%2B%20%28phi2%20%3D%20phi%20%2A%20phi%29%20%2A%20%28%2D0%2E131979%20%2B%20phi2%20%2A%20%28%2D0%2E013791%20%2B%20phi2%20%2A%20phi2%20%2A%20phi2%20%2A%20%280%2E003971%20%2D%200%2E001529%20%2A%20phi2%29%29%29%29%2C%0A%20%20%20%20phi%0A%20%20%5D%3B%0A%7D%3B%0A%0Afunction%20naturalEarth1%28%29%20%7B%0A%20%20return%20projection%28naturalEarth1Raw%29%0A%20%20%20%20%20%20%2Escale%28175%2E295%29%3B%0A%7D%0A%0Afunction%20orthographicRaw%28x%2C%20y%29%20%7B%0A%20%20return%20%5Bcos%241%28y%29%20%2A%20sin%241%28x%29%2C%20sin%241%28y%29%5D%3B%0A%7D%0A%0AorthographicRaw%2Einvert%20%3D%20azimuthalInvert%28asin%29%3B%0A%0Afunction%20orthographic%28%29%20%7B%0A%20%20return%20projection%28orthographicRaw%29%0A%20%20%20%20%20%20%2Escale%28249%2E5%29%0A%20%20%20%20%20%20%2EclipAngle%2890%20%2B%20epsilon%242%29%3B%0A%7D%0A%0Afunction%20stereographicRaw%28x%2C%20y%29%20%7B%0A%20%20var%20cy%20%3D%20cos%241%28y%29%2C%20k%20%3D%201%20%2B%20cos%241%28x%29%20%2A%20cy%3B%0A%20%20return%20%5Bcy%20%2A%20sin%241%28x%29%20%2F%20k%2C%20sin%241%28y%29%20%2F%20k%5D%3B%0A%7D%0A%0AstereographicRaw%2Einvert%20%3D%20azimuthalInvert%28function%28z%29%20%7B%0A%20%20return%202%20%2A%20atan%28z%29%3B%0A%7D%29%3B%0A%0Afunction%20stereographic%28%29%20%7B%0A%20%20return%20projection%28stereographicRaw%29%0A%20%20%20%20%20%20%2Escale%28250%29%0A%20%20%20%20%20%20%2EclipAngle%28142%29%3B%0A%7D%0A%0Afunction%20transverseMercatorRaw%28lambda%2C%20phi%29%20%7B%0A%20%20return%20%5Blog%28tan%28%28halfPi%242%20%2B%20phi%29%20%2F%202%29%29%2C%20%2Dlambda%5D%3B%0A%7D%0A%0AtransverseMercatorRaw%2Einvert%20%3D%20function%28x%2C%20y%29%20%7B%0A%20%20return%20%5B%2Dy%2C%202%20%2A%20atan%28exp%28x%29%29%20%2D%20halfPi%242%5D%3B%0A%7D%3B%0A%0Afunction%20transverseMercator%28%29%20%7B%0A%20%20var%20m%20%3D%20mercatorProjection%28transverseMercatorRaw%29%2C%0A%20%20%20%20%20%20center%20%3D%20m%2Ecenter%2C%0A%20%20%20%20%20%20rotate%20%3D%20m%2Erotate%3B%0A%0A%20%20m%2Ecenter%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20center%28%5B%2D%5F%5B1%5D%2C%20%5F%5B0%5D%5D%29%20%3A%20%28%5F%20%3D%20center%28%29%2C%20%5B%5F%5B1%5D%2C%20%2D%5F%5B0%5D%5D%29%3B%0A%20%20%7D%3B%0A%0A%20%20m%2Erotate%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20rotate%28%5B%5F%5B0%5D%2C%20%5F%5B1%5D%2C%20%5F%2Elength%20%3E%202%20%3F%20%5F%5B2%5D%20%2B%2090%20%3A%2090%5D%29%20%3A%20%28%5F%20%3D%20rotate%28%29%2C%20%5B%5F%5B0%5D%2C%20%5F%5B1%5D%2C%20%5F%5B2%5D%20%2D%2090%5D%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20rotate%28%5B0%2C%200%2C%2090%5D%29%0A%20%20%20%20%20%20%2Escale%28159%2E155%29%3B%0A%7D%0A%0Afunction%20defaultSeparation%28a%2C%20b%29%20%7B%0A%20%20return%20a%2Eparent%20%3D%3D%3D%20b%2Eparent%20%3F%201%20%3A%202%3B%0A%7D%0A%0Afunction%20meanX%28children%29%20%7B%0A%20%20return%20children%2Ereduce%28meanXReduce%2C%200%29%20%2F%20children%2Elength%3B%0A%7D%0A%0Afunction%20meanXReduce%28x%2C%20c%29%20%7B%0A%20%20return%20x%20%2B%20c%2Ex%3B%0A%7D%0A%0Afunction%20maxY%28children%29%20%7B%0A%20%20return%201%20%2B%20children%2Ereduce%28maxYReduce%2C%200%29%3B%0A%7D%0A%0Afunction%20maxYReduce%28y%2C%20c%29%20%7B%0A%20%20return%20Math%2Emax%28y%2C%20c%2Ey%29%3B%0A%7D%0A%0Afunction%20leafLeft%28node%29%20%7B%0A%20%20var%20children%3B%0A%20%20while%20%28children%20%3D%20node%2Echildren%29%20node%20%3D%20children%5B0%5D%3B%0A%20%20return%20node%3B%0A%7D%0A%0Afunction%20leafRight%28node%29%20%7B%0A%20%20var%20children%3B%0A%20%20while%20%28children%20%3D%20node%2Echildren%29%20node%20%3D%20children%5Bchildren%2Elength%20%2D%201%5D%3B%0A%20%20return%20node%3B%0A%7D%0A%0Afunction%20cluster%28%29%20%7B%0A%20%20var%20separation%20%3D%20defaultSeparation%2C%0A%20%20%20%20%20%20dx%20%3D%201%2C%0A%20%20%20%20%20%20dy%20%3D%201%2C%0A%20%20%20%20%20%20nodeSize%20%3D%20false%3B%0A%0A%20%20function%20cluster%28root%29%20%7B%0A%20%20%20%20var%20previousNode%2C%0A%20%20%20%20%20%20%20%20x%20%3D%200%3B%0A%0A%20%20%20%20%2F%2F%20First%20walk%2C%20computing%20the%20initial%20x%20%26%20y%20values%2E%0A%20%20%20%20root%2EeachAfter%28function%28node%29%20%7B%0A%20%20%20%20%20%20var%20children%20%3D%20node%2Echildren%3B%0A%20%20%20%20%20%20if%20%28children%29%20%7B%0A%20%20%20%20%20%20%20%20node%2Ex%20%3D%20meanX%28children%29%3B%0A%20%20%20%20%20%20%20%20node%2Ey%20%3D%20maxY%28children%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%2Ex%20%3D%20previousNode%20%3F%20x%20%2B%3D%20separation%28node%2C%20previousNode%29%20%3A%200%3B%0A%20%20%20%20%20%20%20%20node%2Ey%20%3D%200%3B%0A%20%20%20%20%20%20%20%20previousNode%20%3D%20node%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20var%20left%20%3D%20leafLeft%28root%29%2C%0A%20%20%20%20%20%20%20%20right%20%3D%20leafRight%28root%29%2C%0A%20%20%20%20%20%20%20%20x0%20%3D%20left%2Ex%20%2D%20separation%28left%2C%20right%29%20%2F%202%2C%0A%20%20%20%20%20%20%20%20x1%20%3D%20right%2Ex%20%2B%20separation%28right%2C%20left%29%20%2F%202%3B%0A%0A%20%20%20%20%2F%2F%20Second%20walk%2C%20normalizing%20x%20%26%20y%20to%20the%20desired%20size%2E%0A%20%20%20%20return%20root%2EeachAfter%28nodeSize%20%3F%20function%28node%29%20%7B%0A%20%20%20%20%20%20node%2Ex%20%3D%20%28node%2Ex%20%2D%20root%2Ex%29%20%2A%20dx%3B%0A%20%20%20%20%20%20node%2Ey%20%3D%20%28root%2Ey%20%2D%20node%2Ey%29%20%2A%20dy%3B%0A%20%20%20%20%7D%20%3A%20function%28node%29%20%7B%0A%20%20%20%20%20%20node%2Ex%20%3D%20%28node%2Ex%20%2D%20x0%29%20%2F%20%28x1%20%2D%20x0%29%20%2A%20dx%3B%0A%20%20%20%20%20%20node%2Ey%20%3D%20%281%20%2D%20%28root%2Ey%20%3F%20node%2Ey%20%2F%20root%2Ey%20%3A%201%29%29%20%2A%20dy%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%0A%20%20cluster%2Eseparation%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28separation%20%3D%20x%2C%20cluster%29%20%3A%20separation%3B%0A%20%20%7D%3B%0A%0A%20%20cluster%2Esize%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28nodeSize%20%3D%20false%2C%20dx%20%3D%20%2Bx%5B0%5D%2C%20dy%20%3D%20%2Bx%5B1%5D%2C%20cluster%29%20%3A%20%28nodeSize%20%3F%20null%20%3A%20%5Bdx%2C%20dy%5D%29%3B%0A%20%20%7D%3B%0A%0A%20%20cluster%2EnodeSize%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28nodeSize%20%3D%20true%2C%20dx%20%3D%20%2Bx%5B0%5D%2C%20dy%20%3D%20%2Bx%5B1%5D%2C%20cluster%29%20%3A%20%28nodeSize%20%3F%20%5Bdx%2C%20dy%5D%20%3A%20null%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20cluster%3B%0A%7D%0A%0Afunction%20count%28node%29%20%7B%0A%20%20var%20sum%20%3D%200%2C%0A%20%20%20%20%20%20children%20%3D%20node%2Echildren%2C%0A%20%20%20%20%20%20i%20%3D%20children%20%26%26%20children%2Elength%3B%0A%20%20if%20%28%21i%29%20sum%20%3D%201%3B%0A%20%20else%20while%20%28%2D%2Di%20%3E%3D%200%29%20sum%20%2B%3D%20children%5Bi%5D%2Evalue%3B%0A%20%20node%2Evalue%20%3D%20sum%3B%0A%7D%0A%0Afunction%20node%5Fcount%28%29%20%7B%0A%20%20return%20this%2EeachAfter%28count%29%3B%0A%7D%0A%0Afunction%20node%5Feach%28callback%29%20%7B%0A%20%20var%20node%20%3D%20this%2C%20current%2C%20next%20%3D%20%5Bnode%5D%2C%20children%2C%20i%2C%20n%3B%0A%20%20do%20%7B%0A%20%20%20%20current%20%3D%20next%2Ereverse%28%29%2C%20next%20%3D%20%5B%5D%3B%0A%20%20%20%20while%20%28node%20%3D%20current%2Epop%28%29%29%20%7B%0A%20%20%20%20%20%20callback%28node%29%2C%20children%20%3D%20node%2Echildren%3B%0A%20%20%20%20%20%20if%20%28children%29%20for%20%28i%20%3D%200%2C%20n%20%3D%20children%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20next%2Epush%28children%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%20while%20%28next%2Elength%29%3B%0A%20%20return%20this%3B%0A%7D%0A%0Afunction%20node%5FeachBefore%28callback%29%20%7B%0A%20%20var%20node%20%3D%20this%2C%20nodes%20%3D%20%5Bnode%5D%2C%20children%2C%20i%3B%0A%20%20while%20%28node%20%3D%20nodes%2Epop%28%29%29%20%7B%0A%20%20%20%20callback%28node%29%2C%20children%20%3D%20node%2Echildren%3B%0A%20%20%20%20if%20%28children%29%20for%20%28i%20%3D%20children%2Elength%20%2D%201%3B%20i%20%3E%3D%200%3B%20%2D%2Di%29%20%7B%0A%20%20%20%20%20%20nodes%2Epush%28children%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0Afunction%20node%5FeachAfter%28callback%29%20%7B%0A%20%20var%20node%20%3D%20this%2C%20nodes%20%3D%20%5Bnode%5D%2C%20next%20%3D%20%5B%5D%2C%20children%2C%20i%2C%20n%3B%0A%20%20while%20%28node%20%3D%20nodes%2Epop%28%29%29%20%7B%0A%20%20%20%20next%2Epush%28node%29%2C%20children%20%3D%20node%2Echildren%3B%0A%20%20%20%20if%20%28children%29%20for%20%28i%20%3D%200%2C%20n%20%3D%20children%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20nodes%2Epush%28children%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20while%20%28node%20%3D%20next%2Epop%28%29%29%20%7B%0A%20%20%20%20callback%28node%29%3B%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0Afunction%20node%5Fsum%28value%29%20%7B%0A%20%20return%20this%2EeachAfter%28function%28node%29%20%7B%0A%20%20%20%20var%20sum%20%3D%20%2Bvalue%28node%2Edata%29%20%7C%7C%200%2C%0A%20%20%20%20%20%20%20%20children%20%3D%20node%2Echildren%2C%0A%20%20%20%20%20%20%20%20i%20%3D%20children%20%26%26%20children%2Elength%3B%0A%20%20%20%20while%20%28%2D%2Di%20%3E%3D%200%29%20sum%20%2B%3D%20children%5Bi%5D%2Evalue%3B%0A%20%20%20%20node%2Evalue%20%3D%20sum%3B%0A%20%20%7D%29%3B%0A%7D%0A%0Afunction%20node%5Fsort%28compare%29%20%7B%0A%20%20return%20this%2EeachBefore%28function%28node%29%20%7B%0A%20%20%20%20if%20%28node%2Echildren%29%20%7B%0A%20%20%20%20%20%20node%2Echildren%2Esort%28compare%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%3B%0A%7D%0A%0Afunction%20node%5Fpath%28end%29%20%7B%0A%20%20var%20start%20%3D%20this%2C%0A%20%20%20%20%20%20ancestor%20%3D%20leastCommonAncestor%28start%2C%20end%29%2C%0A%20%20%20%20%20%20nodes%20%3D%20%5Bstart%5D%3B%0A%20%20while%20%28start%20%21%3D%3D%20ancestor%29%20%7B%0A%20%20%20%20start%20%3D%20start%2Eparent%3B%0A%20%20%20%20nodes%2Epush%28start%29%3B%0A%20%20%7D%0A%20%20var%20k%20%3D%20nodes%2Elength%3B%0A%20%20while%20%28end%20%21%3D%3D%20ancestor%29%20%7B%0A%20%20%20%20nodes%2Esplice%28k%2C%200%2C%20end%29%3B%0A%20%20%20%20end%20%3D%20end%2Eparent%3B%0A%20%20%7D%0A%20%20return%20nodes%3B%0A%7D%0A%0Afunction%20leastCommonAncestor%28a%2C%20b%29%20%7B%0A%20%20if%20%28a%20%3D%3D%3D%20b%29%20return%20a%3B%0A%20%20var%20aNodes%20%3D%20a%2Eancestors%28%29%2C%0A%20%20%20%20%20%20bNodes%20%3D%20b%2Eancestors%28%29%2C%0A%20%20%20%20%20%20c%20%3D%20null%3B%0A%20%20a%20%3D%20aNodes%2Epop%28%29%3B%0A%20%20b%20%3D%20bNodes%2Epop%28%29%3B%0A%20%20while%20%28a%20%3D%3D%3D%20b%29%20%7B%0A%20%20%20%20c%20%3D%20a%3B%0A%20%20%20%20a%20%3D%20aNodes%2Epop%28%29%3B%0A%20%20%20%20b%20%3D%20bNodes%2Epop%28%29%3B%0A%20%20%7D%0A%20%20return%20c%3B%0A%7D%0A%0Afunction%20node%5Fancestors%28%29%20%7B%0A%20%20var%20node%20%3D%20this%2C%20nodes%20%3D%20%5Bnode%5D%3B%0A%20%20while%20%28node%20%3D%20node%2Eparent%29%20%7B%0A%20%20%20%20nodes%2Epush%28node%29%3B%0A%20%20%7D%0A%20%20return%20nodes%3B%0A%7D%0A%0Afunction%20node%5Fdescendants%28%29%20%7B%0A%20%20var%20nodes%20%3D%20%5B%5D%3B%0A%20%20this%2Eeach%28function%28node%29%20%7B%0A%20%20%20%20nodes%2Epush%28node%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20nodes%3B%0A%7D%0A%0Afunction%20node%5Fleaves%28%29%20%7B%0A%20%20var%20leaves%20%3D%20%5B%5D%3B%0A%20%20this%2EeachBefore%28function%28node%29%20%7B%0A%20%20%20%20if%20%28%21node%2Echildren%29%20%7B%0A%20%20%20%20%20%20leaves%2Epush%28node%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%3B%0A%20%20return%20leaves%3B%0A%7D%0A%0Afunction%20node%5Flinks%28%29%20%7B%0A%20%20var%20root%20%3D%20this%2C%20links%20%3D%20%5B%5D%3B%0A%20%20root%2Eeach%28function%28node%29%20%7B%0A%20%20%20%20if%20%28node%20%21%3D%3D%20root%29%20%7B%20%2F%2F%20Don%E2%80%99t%20include%20the%20root%E2%80%99s%20parent%2C%20if%20any%2E%0A%20%20%20%20%20%20links%2Epush%28%7Bsource%3A%20node%2Eparent%2C%20target%3A%20node%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%3B%0A%20%20return%20links%3B%0A%7D%0A%0Afunction%20hierarchy%28data%2C%20children%29%20%7B%0A%20%20var%20root%20%3D%20new%20Node%28data%29%2C%0A%20%20%20%20%20%20valued%20%3D%20%2Bdata%2Evalue%20%26%26%20%28root%2Evalue%20%3D%20data%2Evalue%29%2C%0A%20%20%20%20%20%20node%2C%0A%20%20%20%20%20%20nodes%20%3D%20%5Broot%5D%2C%0A%20%20%20%20%20%20child%2C%0A%20%20%20%20%20%20childs%2C%0A%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20n%3B%0A%0A%20%20if%20%28children%20%3D%3D%20null%29%20children%20%3D%20defaultChildren%3B%0A%0A%20%20while%20%28node%20%3D%20nodes%2Epop%28%29%29%20%7B%0A%20%20%20%20if%20%28valued%29%20node%2Evalue%20%3D%20%2Bnode%2Edata%2Evalue%3B%0A%20%20%20%20if%20%28%28childs%20%3D%20children%28node%2Edata%29%29%20%26%26%20%28n%20%3D%20childs%2Elength%29%29%20%7B%0A%20%20%20%20%20%20node%2Echildren%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20%20%20for%20%28i%20%3D%20n%20%2D%201%3B%20i%20%3E%3D%200%3B%20%2D%2Di%29%20%7B%0A%20%20%20%20%20%20%20%20nodes%2Epush%28child%20%3D%20node%2Echildren%5Bi%5D%20%3D%20new%20Node%28childs%5Bi%5D%29%29%3B%0A%20%20%20%20%20%20%20%20child%2Eparent%20%3D%20node%3B%0A%20%20%20%20%20%20%20%20child%2Edepth%20%3D%20node%2Edepth%20%2B%201%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20root%2EeachBefore%28computeHeight%29%3B%0A%7D%0A%0Afunction%20node%5Fcopy%28%29%20%7B%0A%20%20return%20hierarchy%28this%29%2EeachBefore%28copyData%29%3B%0A%7D%0A%0Afunction%20defaultChildren%28d%29%20%7B%0A%20%20return%20d%2Echildren%3B%0A%7D%0A%0Afunction%20copyData%28node%29%20%7B%0A%20%20node%2Edata%20%3D%20node%2Edata%2Edata%3B%0A%7D%0A%0Afunction%20computeHeight%28node%29%20%7B%0A%20%20var%20height%20%3D%200%3B%0A%20%20do%20node%2Eheight%20%3D%20height%3B%0A%20%20while%20%28%28node%20%3D%20node%2Eparent%29%20%26%26%20%28node%2Eheight%20%3C%20%2B%2Bheight%29%29%3B%0A%7D%0A%0Afunction%20Node%28data%29%20%7B%0A%20%20this%2Edata%20%3D%20data%3B%0A%20%20this%2Edepth%20%3D%0A%20%20this%2Eheight%20%3D%200%3B%0A%20%20this%2Eparent%20%3D%20null%3B%0A%7D%0A%0ANode%2Eprototype%20%3D%20hierarchy%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20Node%2C%0A%20%20count%3A%20node%5Fcount%2C%0A%20%20each%3A%20node%5Feach%2C%0A%20%20eachAfter%3A%20node%5FeachAfter%2C%0A%20%20eachBefore%3A%20node%5FeachBefore%2C%0A%20%20sum%3A%20node%5Fsum%2C%0A%20%20sort%3A%20node%5Fsort%2C%0A%20%20path%3A%20node%5Fpath%2C%0A%20%20ancestors%3A%20node%5Fancestors%2C%0A%20%20descendants%3A%20node%5Fdescendants%2C%0A%20%20leaves%3A%20node%5Fleaves%2C%0A%20%20links%3A%20node%5Flinks%2C%0A%20%20copy%3A%20node%5Fcopy%0A%7D%3B%0A%0Avar%20slice%244%20%3D%20Array%2Eprototype%2Eslice%3B%0A%0Afunction%20shuffle%241%28array%29%20%7B%0A%20%20var%20m%20%3D%20array%2Elength%2C%0A%20%20%20%20%20%20t%2C%0A%20%20%20%20%20%20i%3B%0A%0A%20%20while%20%28m%29%20%7B%0A%20%20%20%20i%20%3D%20Math%2Erandom%28%29%20%2A%20m%2D%2D%20%7C%200%3B%0A%20%20%20%20t%20%3D%20array%5Bm%5D%3B%0A%20%20%20%20array%5Bm%5D%20%3D%20array%5Bi%5D%3B%0A%20%20%20%20array%5Bi%5D%20%3D%20t%3B%0A%20%20%7D%0A%0A%20%20return%20array%3B%0A%7D%0A%0Afunction%20enclose%28circles%29%20%7B%0A%20%20var%20i%20%3D%200%2C%20n%20%3D%20%28circles%20%3D%20shuffle%241%28slice%244%2Ecall%28circles%29%29%29%2Elength%2C%20B%20%3D%20%5B%5D%2C%20p%2C%20e%3B%0A%0A%20%20while%20%28i%20%3C%20n%29%20%7B%0A%20%20%20%20p%20%3D%20circles%5Bi%5D%3B%0A%20%20%20%20if%20%28e%20%26%26%20enclosesWeak%28e%2C%20p%29%29%20%2B%2Bi%3B%0A%20%20%20%20else%20e%20%3D%20encloseBasis%28B%20%3D%20extendBasis%28B%2C%20p%29%29%2C%20i%20%3D%200%3B%0A%20%20%7D%0A%0A%20%20return%20e%3B%0A%7D%0A%0Afunction%20extendBasis%28B%2C%20p%29%20%7B%0A%20%20var%20i%2C%20j%3B%0A%0A%20%20if%20%28enclosesWeakAll%28p%2C%20B%29%29%20return%20%5Bp%5D%3B%0A%0A%20%20%2F%2F%20If%20we%20get%20here%20then%20B%20must%20have%20at%20least%20one%20element%2E%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20B%2Elength%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28enclosesNot%28p%2C%20B%5Bi%5D%29%0A%20%20%20%20%20%20%20%20%26%26%20enclosesWeakAll%28encloseBasis2%28B%5Bi%5D%2C%20p%29%2C%20B%29%29%20%7B%0A%20%20%20%20%20%20return%20%5BB%5Bi%5D%2C%20p%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20If%20we%20get%20here%20then%20B%20must%20have%20at%20least%20two%20elements%2E%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20B%2Elength%20%2D%201%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20for%20%28j%20%3D%20i%20%2B%201%3B%20j%20%3C%20B%2Elength%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20if%20%28enclosesNot%28encloseBasis2%28B%5Bi%5D%2C%20B%5Bj%5D%29%2C%20p%29%0A%20%20%20%20%20%20%20%20%20%20%26%26%20enclosesNot%28encloseBasis2%28B%5Bi%5D%2C%20p%29%2C%20B%5Bj%5D%29%0A%20%20%20%20%20%20%20%20%20%20%26%26%20enclosesNot%28encloseBasis2%28B%5Bj%5D%2C%20p%29%2C%20B%5Bi%5D%29%0A%20%20%20%20%20%20%20%20%20%20%26%26%20enclosesWeakAll%28encloseBasis3%28B%5Bi%5D%2C%20B%5Bj%5D%2C%20p%29%2C%20B%29%29%20%7B%0A%20%20%20%20%20%20%20%20return%20%5BB%5Bi%5D%2C%20B%5Bj%5D%2C%20p%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20If%20we%20get%20here%20then%20something%20is%20very%20wrong%2E%0A%20%20throw%20new%20Error%3B%0A%7D%0A%0Afunction%20enclosesNot%28a%2C%20b%29%20%7B%0A%20%20var%20dr%20%3D%20a%2Er%20%2D%20b%2Er%2C%20dx%20%3D%20b%2Ex%20%2D%20a%2Ex%2C%20dy%20%3D%20b%2Ey%20%2D%20a%2Ey%3B%0A%20%20return%20dr%20%3C%200%20%7C%7C%20dr%20%2A%20dr%20%3C%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%3B%0A%7D%0A%0Afunction%20enclosesWeak%28a%2C%20b%29%20%7B%0A%20%20var%20dr%20%3D%20a%2Er%20%2D%20b%2Er%20%2B%201e%2D6%2C%20dx%20%3D%20b%2Ex%20%2D%20a%2Ex%2C%20dy%20%3D%20b%2Ey%20%2D%20a%2Ey%3B%0A%20%20return%20dr%20%3E%200%20%26%26%20dr%20%2A%20dr%20%3E%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%3B%0A%7D%0A%0Afunction%20enclosesWeakAll%28a%2C%20B%29%20%7B%0A%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20B%2Elength%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28%21enclosesWeak%28a%2C%20B%5Bi%5D%29%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20true%3B%0A%7D%0A%0Afunction%20encloseBasis%28B%29%20%7B%0A%20%20switch%20%28B%2Elength%29%20%7B%0A%20%20%20%20case%201%3A%20return%20encloseBasis1%28B%5B0%5D%29%3B%0A%20%20%20%20case%202%3A%20return%20encloseBasis2%28B%5B0%5D%2C%20B%5B1%5D%29%3B%0A%20%20%20%20case%203%3A%20return%20encloseBasis3%28B%5B0%5D%2C%20B%5B1%5D%2C%20B%5B2%5D%29%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20encloseBasis1%28a%29%20%7B%0A%20%20return%20%7B%0A%20%20%20%20x%3A%20a%2Ex%2C%0A%20%20%20%20y%3A%20a%2Ey%2C%0A%20%20%20%20r%3A%20a%2Er%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20encloseBasis2%28a%2C%20b%29%20%7B%0A%20%20var%20x1%20%3D%20a%2Ex%2C%20y1%20%3D%20a%2Ey%2C%20r1%20%3D%20a%2Er%2C%0A%20%20%20%20%20%20x2%20%3D%20b%2Ex%2C%20y2%20%3D%20b%2Ey%2C%20r2%20%3D%20b%2Er%2C%0A%20%20%20%20%20%20x21%20%3D%20x2%20%2D%20x1%2C%20y21%20%3D%20y2%20%2D%20y1%2C%20r21%20%3D%20r2%20%2D%20r1%2C%0A%20%20%20%20%20%20l%20%3D%20Math%2Esqrt%28x21%20%2A%20x21%20%2B%20y21%20%2A%20y21%29%3B%0A%20%20return%20%7B%0A%20%20%20%20x%3A%20%28x1%20%2B%20x2%20%2B%20x21%20%2F%20l%20%2A%20r21%29%20%2F%202%2C%0A%20%20%20%20y%3A%20%28y1%20%2B%20y2%20%2B%20y21%20%2F%20l%20%2A%20r21%29%20%2F%202%2C%0A%20%20%20%20r%3A%20%28l%20%2B%20r1%20%2B%20r2%29%20%2F%202%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20encloseBasis3%28a%2C%20b%2C%20c%29%20%7B%0A%20%20var%20x1%20%3D%20a%2Ex%2C%20y1%20%3D%20a%2Ey%2C%20r1%20%3D%20a%2Er%2C%0A%20%20%20%20%20%20x2%20%3D%20b%2Ex%2C%20y2%20%3D%20b%2Ey%2C%20r2%20%3D%20b%2Er%2C%0A%20%20%20%20%20%20x3%20%3D%20c%2Ex%2C%20y3%20%3D%20c%2Ey%2C%20r3%20%3D%20c%2Er%2C%0A%20%20%20%20%20%20a2%20%3D%20x1%20%2D%20x2%2C%0A%20%20%20%20%20%20a3%20%3D%20x1%20%2D%20x3%2C%0A%20%20%20%20%20%20b2%20%3D%20y1%20%2D%20y2%2C%0A%20%20%20%20%20%20b3%20%3D%20y1%20%2D%20y3%2C%0A%20%20%20%20%20%20c2%20%3D%20r2%20%2D%20r1%2C%0A%20%20%20%20%20%20c3%20%3D%20r3%20%2D%20r1%2C%0A%20%20%20%20%20%20d1%20%3D%20x1%20%2A%20x1%20%2B%20y1%20%2A%20y1%20%2D%20r1%20%2A%20r1%2C%0A%20%20%20%20%20%20d2%20%3D%20d1%20%2D%20x2%20%2A%20x2%20%2D%20y2%20%2A%20y2%20%2B%20r2%20%2A%20r2%2C%0A%20%20%20%20%20%20d3%20%3D%20d1%20%2D%20x3%20%2A%20x3%20%2D%20y3%20%2A%20y3%20%2B%20r3%20%2A%20r3%2C%0A%20%20%20%20%20%20ab%20%3D%20a3%20%2A%20b2%20%2D%20a2%20%2A%20b3%2C%0A%20%20%20%20%20%20xa%20%3D%20%28b2%20%2A%20d3%20%2D%20b3%20%2A%20d2%29%20%2F%20%28ab%20%2A%202%29%20%2D%20x1%2C%0A%20%20%20%20%20%20xb%20%3D%20%28b3%20%2A%20c2%20%2D%20b2%20%2A%20c3%29%20%2F%20ab%2C%0A%20%20%20%20%20%20ya%20%3D%20%28a3%20%2A%20d2%20%2D%20a2%20%2A%20d3%29%20%2F%20%28ab%20%2A%202%29%20%2D%20y1%2C%0A%20%20%20%20%20%20yb%20%3D%20%28a2%20%2A%20c3%20%2D%20a3%20%2A%20c2%29%20%2F%20ab%2C%0A%20%20%20%20%20%20A%20%3D%20xb%20%2A%20xb%20%2B%20yb%20%2A%20yb%20%2D%201%2C%0A%20%20%20%20%20%20B%20%3D%202%20%2A%20%28r1%20%2B%20xa%20%2A%20xb%20%2B%20ya%20%2A%20yb%29%2C%0A%20%20%20%20%20%20C%20%3D%20xa%20%2A%20xa%20%2B%20ya%20%2A%20ya%20%2D%20r1%20%2A%20r1%2C%0A%20%20%20%20%20%20r%20%3D%20%2D%28A%20%3F%20%28B%20%2B%20Math%2Esqrt%28B%20%2A%20B%20%2D%204%20%2A%20A%20%2A%20C%29%29%20%2F%20%282%20%2A%20A%29%20%3A%20C%20%2F%20B%29%3B%0A%20%20return%20%7B%0A%20%20%20%20x%3A%20x1%20%2B%20xa%20%2B%20xb%20%2A%20r%2C%0A%20%20%20%20y%3A%20y1%20%2B%20ya%20%2B%20yb%20%2A%20r%2C%0A%20%20%20%20r%3A%20r%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20place%28b%2C%20a%2C%20c%29%20%7B%0A%20%20var%20dx%20%3D%20b%2Ex%20%2D%20a%2Ex%2C%20x%2C%20a2%2C%0A%20%20%20%20%20%20dy%20%3D%20b%2Ey%20%2D%20a%2Ey%2C%20y%2C%20b2%2C%0A%20%20%20%20%20%20d2%20%3D%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%3B%0A%20%20if%20%28d2%29%20%7B%0A%20%20%20%20a2%20%3D%20a%2Er%20%2B%20c%2Er%2C%20a2%20%2A%3D%20a2%3B%0A%20%20%20%20b2%20%3D%20b%2Er%20%2B%20c%2Er%2C%20b2%20%2A%3D%20b2%3B%0A%20%20%20%20if%20%28a2%20%3E%20b2%29%20%7B%0A%20%20%20%20%20%20x%20%3D%20%28d2%20%2B%20b2%20%2D%20a2%29%20%2F%20%282%20%2A%20d2%29%3B%0A%20%20%20%20%20%20y%20%3D%20Math%2Esqrt%28Math%2Emax%280%2C%20b2%20%2F%20d2%20%2D%20x%20%2A%20x%29%29%3B%0A%20%20%20%20%20%20c%2Ex%20%3D%20b%2Ex%20%2D%20x%20%2A%20dx%20%2D%20y%20%2A%20dy%3B%0A%20%20%20%20%20%20c%2Ey%20%3D%20b%2Ey%20%2D%20x%20%2A%20dy%20%2B%20y%20%2A%20dx%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20x%20%3D%20%28d2%20%2B%20a2%20%2D%20b2%29%20%2F%20%282%20%2A%20d2%29%3B%0A%20%20%20%20%20%20y%20%3D%20Math%2Esqrt%28Math%2Emax%280%2C%20a2%20%2F%20d2%20%2D%20x%20%2A%20x%29%29%3B%0A%20%20%20%20%20%20c%2Ex%20%3D%20a%2Ex%20%2B%20x%20%2A%20dx%20%2D%20y%20%2A%20dy%3B%0A%20%20%20%20%20%20c%2Ey%20%3D%20a%2Ey%20%2B%20x%20%2A%20dy%20%2B%20y%20%2A%20dx%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20c%2Ex%20%3D%20a%2Ex%20%2B%20c%2Er%3B%0A%20%20%20%20c%2Ey%20%3D%20a%2Ey%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20intersects%28a%2C%20b%29%20%7B%0A%20%20var%20dr%20%3D%20a%2Er%20%2B%20b%2Er%20%2D%201e%2D6%2C%20dx%20%3D%20b%2Ex%20%2D%20a%2Ex%2C%20dy%20%3D%20b%2Ey%20%2D%20a%2Ey%3B%0A%20%20return%20dr%20%3E%200%20%26%26%20dr%20%2A%20dr%20%3E%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%3B%0A%7D%0A%0Afunction%20score%28node%29%20%7B%0A%20%20var%20a%20%3D%20node%2E%5F%2C%0A%20%20%20%20%20%20b%20%3D%20node%2Enext%2E%5F%2C%0A%20%20%20%20%20%20ab%20%3D%20a%2Er%20%2B%20b%2Er%2C%0A%20%20%20%20%20%20dx%20%3D%20%28a%2Ex%20%2A%20b%2Er%20%2B%20b%2Ex%20%2A%20a%2Er%29%20%2F%20ab%2C%0A%20%20%20%20%20%20dy%20%3D%20%28a%2Ey%20%2A%20b%2Er%20%2B%20b%2Ey%20%2A%20a%2Er%29%20%2F%20ab%3B%0A%20%20return%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%3B%0A%7D%0A%0Afunction%20Node%241%28circle%29%20%7B%0A%20%20this%2E%5F%20%3D%20circle%3B%0A%20%20this%2Enext%20%3D%20null%3B%0A%20%20this%2Eprevious%20%3D%20null%3B%0A%7D%0A%0Afunction%20packEnclose%28circles%29%20%7B%0A%20%20if%20%28%21%28n%20%3D%20circles%2Elength%29%29%20return%200%3B%0A%0A%20%20var%20a%2C%20b%2C%20c%2C%20n%2C%20aa%2C%20ca%2C%20i%2C%20j%2C%20k%2C%20sj%2C%20sk%3B%0A%0A%20%20%2F%2F%20Place%20the%20first%20circle%2E%0A%20%20a%20%3D%20circles%5B0%5D%2C%20a%2Ex%20%3D%200%2C%20a%2Ey%20%3D%200%3B%0A%20%20if%20%28%21%28n%20%3E%201%29%29%20return%20a%2Er%3B%0A%0A%20%20%2F%2F%20Place%20the%20second%20circle%2E%0A%20%20b%20%3D%20circles%5B1%5D%2C%20a%2Ex%20%3D%20%2Db%2Er%2C%20b%2Ex%20%3D%20a%2Er%2C%20b%2Ey%20%3D%200%3B%0A%20%20if%20%28%21%28n%20%3E%202%29%29%20return%20a%2Er%20%2B%20b%2Er%3B%0A%0A%20%20%2F%2F%20Place%20the%20third%20circle%2E%0A%20%20place%28b%2C%20a%2C%20c%20%3D%20circles%5B2%5D%29%3B%0A%0A%20%20%2F%2F%20Initialize%20the%20front%2Dchain%20using%20the%20first%20three%20circles%20a%2C%20b%20and%20c%2E%0A%20%20a%20%3D%20new%20Node%241%28a%29%2C%20b%20%3D%20new%20Node%241%28b%29%2C%20c%20%3D%20new%20Node%241%28c%29%3B%0A%20%20a%2Enext%20%3D%20c%2Eprevious%20%3D%20b%3B%0A%20%20b%2Enext%20%3D%20a%2Eprevious%20%3D%20c%3B%0A%20%20c%2Enext%20%3D%20b%2Eprevious%20%3D%20a%3B%0A%0A%20%20%2F%2F%20Attempt%20to%20place%20each%20remaining%20circle%E2%80%A6%0A%20%20pack%3A%20for%20%28i%20%3D%203%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20place%28a%2E%5F%2C%20b%2E%5F%2C%20c%20%3D%20circles%5Bi%5D%29%2C%20c%20%3D%20new%20Node%241%28c%29%3B%0A%0A%20%20%20%20%2F%2F%20Find%20the%20closest%20intersecting%20circle%20on%20the%20front%2Dchain%2C%20if%20any%2E%0A%20%20%20%20%2F%2F%20%E2%80%9CCloseness%E2%80%9D%20is%20determined%20by%20linear%20distance%20along%20the%20front%2Dchain%2E%0A%20%20%20%20%2F%2F%20%E2%80%9CAhead%E2%80%9D%20or%20%E2%80%9Cbehind%E2%80%9D%20is%20likewise%20determined%20by%20linear%20distance%2E%0A%20%20%20%20j%20%3D%20b%2Enext%2C%20k%20%3D%20a%2Eprevious%2C%20sj%20%3D%20b%2E%5F%2Er%2C%20sk%20%3D%20a%2E%5F%2Er%3B%0A%20%20%20%20do%20%7B%0A%20%20%20%20%20%20if%20%28sj%20%3C%3D%20sk%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28intersects%28j%2E%5F%2C%20c%2E%5F%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20b%20%3D%20j%2C%20a%2Enext%20%3D%20b%2C%20b%2Eprevious%20%3D%20a%2C%20%2D%2Di%3B%0A%20%20%20%20%20%20%20%20%20%20continue%20pack%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20sj%20%2B%3D%20j%2E%5F%2Er%2C%20j%20%3D%20j%2Enext%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28intersects%28k%2E%5F%2C%20c%2E%5F%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20a%20%3D%20k%2C%20a%2Enext%20%3D%20b%2C%20b%2Eprevious%20%3D%20a%2C%20%2D%2Di%3B%0A%20%20%20%20%20%20%20%20%20%20continue%20pack%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20sk%20%2B%3D%20k%2E%5F%2Er%2C%20k%20%3D%20k%2Eprevious%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20while%20%28j%20%21%3D%3D%20k%2Enext%29%3B%0A%0A%20%20%20%20%2F%2F%20Success%21%20Insert%20the%20new%20circle%20c%20between%20a%20and%20b%2E%0A%20%20%20%20c%2Eprevious%20%3D%20a%2C%20c%2Enext%20%3D%20b%2C%20a%2Enext%20%3D%20b%2Eprevious%20%3D%20b%20%3D%20c%3B%0A%0A%20%20%20%20%2F%2F%20Compute%20the%20new%20closest%20circle%20pair%20to%20the%20centroid%2E%0A%20%20%20%20aa%20%3D%20score%28a%29%3B%0A%20%20%20%20while%20%28%28c%20%3D%20c%2Enext%29%20%21%3D%3D%20b%29%20%7B%0A%20%20%20%20%20%20if%20%28%28ca%20%3D%20score%28c%29%29%20%3C%20aa%29%20%7B%0A%20%20%20%20%20%20%20%20a%20%3D%20c%2C%20aa%20%3D%20ca%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20b%20%3D%20a%2Enext%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Compute%20the%20enclosing%20circle%20of%20the%20front%20chain%2E%0A%20%20a%20%3D%20%5Bb%2E%5F%5D%2C%20c%20%3D%20b%3B%20while%20%28%28c%20%3D%20c%2Enext%29%20%21%3D%3D%20b%29%20a%2Epush%28c%2E%5F%29%3B%20c%20%3D%20enclose%28a%29%3B%0A%0A%20%20%2F%2F%20Translate%20the%20circles%20to%20put%20the%20enclosing%20circle%20around%20the%20origin%2E%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20a%20%3D%20circles%5Bi%5D%2C%20a%2Ex%20%2D%3D%20c%2Ex%2C%20a%2Ey%20%2D%3D%20c%2Ey%3B%0A%0A%20%20return%20c%2Er%3B%0A%7D%0A%0Afunction%20siblings%28circles%29%20%7B%0A%20%20packEnclose%28circles%29%3B%0A%20%20return%20circles%3B%0A%7D%0A%0Afunction%20optional%28f%29%20%7B%0A%20%20return%20f%20%3D%3D%20null%20%3F%20null%20%3A%20required%28f%29%3B%0A%7D%0A%0Afunction%20required%28f%29%20%7B%0A%20%20if%20%28typeof%20f%20%21%3D%3D%20%22function%22%29%20throw%20new%20Error%3B%0A%20%20return%20f%3B%0A%7D%0A%0Afunction%20constantZero%28%29%20%7B%0A%20%20return%200%3B%0A%7D%0A%0Afunction%20constant%249%28x%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20defaultRadius%241%28d%29%20%7B%0A%20%20return%20Math%2Esqrt%28d%2Evalue%29%3B%0A%7D%0A%0Afunction%20index%242%28%29%20%7B%0A%20%20var%20radius%20%3D%20null%2C%0A%20%20%20%20%20%20dx%20%3D%201%2C%0A%20%20%20%20%20%20dy%20%3D%201%2C%0A%20%20%20%20%20%20padding%20%3D%20constantZero%3B%0A%0A%20%20function%20pack%28root%29%20%7B%0A%20%20%20%20root%2Ex%20%3D%20dx%20%2F%202%2C%20root%2Ey%20%3D%20dy%20%2F%202%3B%0A%20%20%20%20if%20%28radius%29%20%7B%0A%20%20%20%20%20%20root%2EeachBefore%28radiusLeaf%28radius%29%29%0A%20%20%20%20%20%20%20%20%20%20%2EeachAfter%28packChildren%28padding%2C%200%2E5%29%29%0A%20%20%20%20%20%20%20%20%20%20%2EeachBefore%28translateChild%281%29%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20root%2EeachBefore%28radiusLeaf%28defaultRadius%241%29%29%0A%20%20%20%20%20%20%20%20%20%20%2EeachAfter%28packChildren%28constantZero%2C%201%29%29%0A%20%20%20%20%20%20%20%20%20%20%2EeachAfter%28packChildren%28padding%2C%20root%2Er%20%2F%20Math%2Emin%28dx%2C%20dy%29%29%29%0A%20%20%20%20%20%20%20%20%20%20%2EeachBefore%28translateChild%28Math%2Emin%28dx%2C%20dy%29%20%2F%20%282%20%2A%20root%2Er%29%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20root%3B%0A%20%20%7D%0A%0A%20%20pack%2Eradius%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28radius%20%3D%20optional%28x%29%2C%20pack%29%20%3A%20radius%3B%0A%20%20%7D%3B%0A%0A%20%20pack%2Esize%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28dx%20%3D%20%2Bx%5B0%5D%2C%20dy%20%3D%20%2Bx%5B1%5D%2C%20pack%29%20%3A%20%5Bdx%2C%20dy%5D%3B%0A%20%20%7D%3B%0A%0A%20%20pack%2Epadding%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28padding%20%3D%20typeof%20x%20%3D%3D%3D%20%22function%22%20%3F%20x%20%3A%20constant%249%28%2Bx%29%2C%20pack%29%20%3A%20padding%3B%0A%20%20%7D%3B%0A%0A%20%20return%20pack%3B%0A%7D%0A%0Afunction%20radiusLeaf%28radius%29%20%7B%0A%20%20return%20function%28node%29%20%7B%0A%20%20%20%20if%20%28%21node%2Echildren%29%20%7B%0A%20%20%20%20%20%20node%2Er%20%3D%20Math%2Emax%280%2C%20%2Bradius%28node%29%20%7C%7C%200%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20packChildren%28padding%2C%20k%29%20%7B%0A%20%20return%20function%28node%29%20%7B%0A%20%20%20%20if%20%28children%20%3D%20node%2Echildren%29%20%7B%0A%20%20%20%20%20%20var%20children%2C%0A%20%20%20%20%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20%20%20%20%20n%20%3D%20children%2Elength%2C%0A%20%20%20%20%20%20%20%20%20%20r%20%3D%20padding%28node%29%20%2A%20k%20%7C%7C%200%2C%0A%20%20%20%20%20%20%20%20%20%20e%3B%0A%0A%20%20%20%20%20%20if%20%28r%29%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20children%5Bi%5D%2Er%20%2B%3D%20r%3B%0A%20%20%20%20%20%20e%20%3D%20packEnclose%28children%29%3B%0A%20%20%20%20%20%20if%20%28r%29%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20children%5Bi%5D%2Er%20%2D%3D%20r%3B%0A%20%20%20%20%20%20node%2Er%20%3D%20e%20%2B%20r%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20translateChild%28k%29%20%7B%0A%20%20return%20function%28node%29%20%7B%0A%20%20%20%20var%20parent%20%3D%20node%2Eparent%3B%0A%20%20%20%20node%2Er%20%2A%3D%20k%3B%0A%20%20%20%20if%20%28parent%29%20%7B%0A%20%20%20%20%20%20node%2Ex%20%3D%20parent%2Ex%20%2B%20k%20%2A%20node%2Ex%3B%0A%20%20%20%20%20%20node%2Ey%20%3D%20parent%2Ey%20%2B%20k%20%2A%20node%2Ey%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20roundNode%28node%29%20%7B%0A%20%20node%2Ex0%20%3D%20Math%2Eround%28node%2Ex0%29%3B%0A%20%20node%2Ey0%20%3D%20Math%2Eround%28node%2Ey0%29%3B%0A%20%20node%2Ex1%20%3D%20Math%2Eround%28node%2Ex1%29%3B%0A%20%20node%2Ey1%20%3D%20Math%2Eround%28node%2Ey1%29%3B%0A%7D%0A%0Afunction%20treemapDice%28parent%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20var%20nodes%20%3D%20parent%2Echildren%2C%0A%20%20%20%20%20%20node%2C%0A%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20n%20%3D%20nodes%2Elength%2C%0A%20%20%20%20%20%20k%20%3D%20parent%2Evalue%20%26%26%20%28x1%20%2D%20x0%29%20%2F%20parent%2Evalue%3B%0A%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20node%20%3D%20nodes%5Bi%5D%2C%20node%2Ey0%20%3D%20y0%2C%20node%2Ey1%20%3D%20y1%3B%0A%20%20%20%20node%2Ex0%20%3D%20x0%2C%20node%2Ex1%20%3D%20x0%20%2B%3D%20node%2Evalue%20%2A%20k%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20partition%28%29%20%7B%0A%20%20var%20dx%20%3D%201%2C%0A%20%20%20%20%20%20dy%20%3D%201%2C%0A%20%20%20%20%20%20padding%20%3D%200%2C%0A%20%20%20%20%20%20round%20%3D%20false%3B%0A%0A%20%20function%20partition%28root%29%20%7B%0A%20%20%20%20var%20n%20%3D%20root%2Eheight%20%2B%201%3B%0A%20%20%20%20root%2Ex0%20%3D%0A%20%20%20%20root%2Ey0%20%3D%20padding%3B%0A%20%20%20%20root%2Ex1%20%3D%20dx%3B%0A%20%20%20%20root%2Ey1%20%3D%20dy%20%2F%20n%3B%0A%20%20%20%20root%2EeachBefore%28positionNode%28dy%2C%20n%29%29%3B%0A%20%20%20%20if%20%28round%29%20root%2EeachBefore%28roundNode%29%3B%0A%20%20%20%20return%20root%3B%0A%20%20%7D%0A%0A%20%20function%20positionNode%28dy%2C%20n%29%20%7B%0A%20%20%20%20return%20function%28node%29%20%7B%0A%20%20%20%20%20%20if%20%28node%2Echildren%29%20%7B%0A%20%20%20%20%20%20%20%20treemapDice%28node%2C%20node%2Ex0%2C%20dy%20%2A%20%28node%2Edepth%20%2B%201%29%20%2F%20n%2C%20node%2Ex1%2C%20dy%20%2A%20%28node%2Edepth%20%2B%202%29%20%2F%20n%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20x0%20%3D%20node%2Ex0%2C%0A%20%20%20%20%20%20%20%20%20%20y0%20%3D%20node%2Ey0%2C%0A%20%20%20%20%20%20%20%20%20%20x1%20%3D%20node%2Ex1%20%2D%20padding%2C%0A%20%20%20%20%20%20%20%20%20%20y1%20%3D%20node%2Ey1%20%2D%20padding%3B%0A%20%20%20%20%20%20if%20%28x1%20%3C%20x0%29%20x0%20%3D%20x1%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%3B%0A%20%20%20%20%20%20if%20%28y1%20%3C%20y0%29%20y0%20%3D%20y1%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%3B%0A%20%20%20%20%20%20node%2Ex0%20%3D%20x0%3B%0A%20%20%20%20%20%20node%2Ey0%20%3D%20y0%3B%0A%20%20%20%20%20%20node%2Ex1%20%3D%20x1%3B%0A%20%20%20%20%20%20node%2Ey1%20%3D%20y1%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20partition%2Eround%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28round%20%3D%20%21%21x%2C%20partition%29%20%3A%20round%3B%0A%20%20%7D%3B%0A%0A%20%20partition%2Esize%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28dx%20%3D%20%2Bx%5B0%5D%2C%20dy%20%3D%20%2Bx%5B1%5D%2C%20partition%29%20%3A%20%5Bdx%2C%20dy%5D%3B%0A%20%20%7D%3B%0A%0A%20%20partition%2Epadding%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28padding%20%3D%20%2Bx%2C%20partition%29%20%3A%20padding%3B%0A%20%20%7D%3B%0A%0A%20%20return%20partition%3B%0A%7D%0A%0Avar%20keyPrefix%241%20%3D%20%22%24%22%2C%20%2F%2F%20Protect%20against%20keys%20like%20%E2%80%9C%5F%5Fproto%5F%5F%E2%80%9D%2E%0A%20%20%20%20preroot%20%3D%20%7Bdepth%3A%20%2D1%7D%2C%0A%20%20%20%20ambiguous%20%3D%20%7B%7D%3B%0A%0Afunction%20defaultId%28d%29%20%7B%0A%20%20return%20d%2Eid%3B%0A%7D%0A%0Afunction%20defaultParentId%28d%29%20%7B%0A%20%20return%20d%2EparentId%3B%0A%7D%0A%0Afunction%20stratify%28%29%20%7B%0A%20%20var%20id%20%3D%20defaultId%2C%0A%20%20%20%20%20%20parentId%20%3D%20defaultParentId%3B%0A%0A%20%20function%20stratify%28data%29%20%7B%0A%20%20%20%20var%20d%2C%0A%20%20%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20data%2Elength%2C%0A%20%20%20%20%20%20%20%20root%2C%0A%20%20%20%20%20%20%20%20parent%2C%0A%20%20%20%20%20%20%20%20node%2C%0A%20%20%20%20%20%20%20%20nodes%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20%20%20nodeId%2C%0A%20%20%20%20%20%20%20%20nodeKey%2C%0A%20%20%20%20%20%20%20%20nodeByKey%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20d%20%3D%20data%5Bi%5D%2C%20node%20%3D%20nodes%5Bi%5D%20%3D%20new%20Node%28d%29%3B%0A%20%20%20%20%20%20if%20%28%28nodeId%20%3D%20id%28d%2C%20i%2C%20data%29%29%20%21%3D%20null%20%26%26%20%28nodeId%20%2B%3D%20%22%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20nodeKey%20%3D%20keyPrefix%241%20%2B%20%28node%2Eid%20%3D%20nodeId%29%3B%0A%20%20%20%20%20%20%20%20nodeByKey%5BnodeKey%5D%20%3D%20nodeKey%20in%20nodeByKey%20%3F%20ambiguous%20%3A%20node%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%2C%20nodeId%20%3D%20parentId%28data%5Bi%5D%2C%20i%2C%20data%29%3B%0A%20%20%20%20%20%20if%20%28nodeId%20%3D%3D%20null%20%7C%7C%20%21%28nodeId%20%2B%3D%20%22%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28root%29%20throw%20new%20Error%28%22multiple%20roots%22%29%3B%0A%20%20%20%20%20%20%20%20root%20%3D%20node%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20parent%20%3D%20nodeByKey%5BkeyPrefix%241%20%2B%20nodeId%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28%21parent%29%20throw%20new%20Error%28%22missing%3A%20%22%20%2B%20nodeId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28parent%20%3D%3D%3D%20ambiguous%29%20throw%20new%20Error%28%22ambiguous%3A%20%22%20%2B%20nodeId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28parent%2Echildren%29%20parent%2Echildren%2Epush%28node%29%3B%0A%20%20%20%20%20%20%20%20else%20parent%2Echildren%20%3D%20%5Bnode%5D%3B%0A%20%20%20%20%20%20%20%20node%2Eparent%20%3D%20parent%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28%21root%29%20throw%20new%20Error%28%22no%20root%22%29%3B%0A%20%20%20%20root%2Eparent%20%3D%20preroot%3B%0A%20%20%20%20root%2EeachBefore%28function%28node%29%20%7B%20node%2Edepth%20%3D%20node%2Eparent%2Edepth%20%2B%201%3B%20%2D%2Dn%3B%20%7D%29%2EeachBefore%28computeHeight%29%3B%0A%20%20%20%20root%2Eparent%20%3D%20null%3B%0A%20%20%20%20if%20%28n%20%3E%200%29%20throw%20new%20Error%28%22cycle%22%29%3B%0A%0A%20%20%20%20return%20root%3B%0A%20%20%7D%0A%0A%20%20stratify%2Eid%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28id%20%3D%20required%28x%29%2C%20stratify%29%20%3A%20id%3B%0A%20%20%7D%3B%0A%0A%20%20stratify%2EparentId%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28parentId%20%3D%20required%28x%29%2C%20stratify%29%20%3A%20parentId%3B%0A%20%20%7D%3B%0A%0A%20%20return%20stratify%3B%0A%7D%0A%0Afunction%20defaultSeparation%241%28a%2C%20b%29%20%7B%0A%20%20return%20a%2Eparent%20%3D%3D%3D%20b%2Eparent%20%3F%201%20%3A%202%3B%0A%7D%0A%0A%2F%2F%20function%20radialSeparation%28a%2C%20b%29%20%7B%0A%2F%2F%20%20%20return%20%28a%2Eparent%20%3D%3D%3D%20b%2Eparent%20%3F%201%20%3A%202%29%20%2F%20a%2Edepth%3B%0A%2F%2F%20%7D%0A%0A%2F%2F%20This%20function%20is%20used%20to%20traverse%20the%20left%20contour%20of%20a%20subtree%20%28or%0A%2F%2F%20subforest%29%2E%20It%20returns%20the%20successor%20of%20v%20on%20this%20contour%2E%20This%20successor%20is%0A%2F%2F%20either%20given%20by%20the%20leftmost%20child%20of%20v%20or%20by%20the%20thread%20of%20v%2E%20The%20function%0A%2F%2F%20returns%20null%20if%20and%20only%20if%20v%20is%20on%20the%20highest%20level%20of%20its%20subtree%2E%0Afunction%20nextLeft%28v%29%20%7B%0A%20%20var%20children%20%3D%20v%2Echildren%3B%0A%20%20return%20children%20%3F%20children%5B0%5D%20%3A%20v%2Et%3B%0A%7D%0A%0A%2F%2F%20This%20function%20works%20analogously%20to%20nextLeft%2E%0Afunction%20nextRight%28v%29%20%7B%0A%20%20var%20children%20%3D%20v%2Echildren%3B%0A%20%20return%20children%20%3F%20children%5Bchildren%2Elength%20%2D%201%5D%20%3A%20v%2Et%3B%0A%7D%0A%0A%2F%2F%20Shifts%20the%20current%20subtree%20rooted%20at%20w%2B%2E%20This%20is%20done%20by%20increasing%0A%2F%2F%20prelim%28w%2B%29%20and%20mod%28w%2B%29%20by%20shift%2E%0Afunction%20moveSubtree%28wm%2C%20wp%2C%20shift%29%20%7B%0A%20%20var%20change%20%3D%20shift%20%2F%20%28wp%2Ei%20%2D%20wm%2Ei%29%3B%0A%20%20wp%2Ec%20%2D%3D%20change%3B%0A%20%20wp%2Es%20%2B%3D%20shift%3B%0A%20%20wm%2Ec%20%2B%3D%20change%3B%0A%20%20wp%2Ez%20%2B%3D%20shift%3B%0A%20%20wp%2Em%20%2B%3D%20shift%3B%0A%7D%0A%0A%2F%2F%20All%20other%20shifts%2C%20applied%20to%20the%20smaller%20subtrees%20between%20w%2D%20and%20w%2B%2C%20are%0A%2F%2F%20performed%20by%20this%20function%2E%20To%20prepare%20the%20shifts%2C%20we%20have%20to%20adjust%0A%2F%2F%20change%28w%2B%29%2C%20shift%28w%2B%29%2C%20and%20change%28w%2D%29%2E%0Afunction%20executeShifts%28v%29%20%7B%0A%20%20var%20shift%20%3D%200%2C%0A%20%20%20%20%20%20change%20%3D%200%2C%0A%20%20%20%20%20%20children%20%3D%20v%2Echildren%2C%0A%20%20%20%20%20%20i%20%3D%20children%2Elength%2C%0A%20%20%20%20%20%20w%3B%0A%20%20while%20%28%2D%2Di%20%3E%3D%200%29%20%7B%0A%20%20%20%20w%20%3D%20children%5Bi%5D%3B%0A%20%20%20%20w%2Ez%20%2B%3D%20shift%3B%0A%20%20%20%20w%2Em%20%2B%3D%20shift%3B%0A%20%20%20%20shift%20%2B%3D%20w%2Es%20%2B%20%28change%20%2B%3D%20w%2Ec%29%3B%0A%20%20%7D%0A%7D%0A%0A%2F%2F%20If%20vi%2D%E2%80%99s%20ancestor%20is%20a%20sibling%20of%20v%2C%20returns%20vi%2D%E2%80%99s%20ancestor%2E%20Otherwise%2C%0A%2F%2F%20returns%20the%20specified%20%28default%29%20ancestor%2E%0Afunction%20nextAncestor%28vim%2C%20v%2C%20ancestor%29%20%7B%0A%20%20return%20vim%2Ea%2Eparent%20%3D%3D%3D%20v%2Eparent%20%3F%20vim%2Ea%20%3A%20ancestor%3B%0A%7D%0A%0Afunction%20TreeNode%28node%2C%20i%29%20%7B%0A%20%20this%2E%5F%20%3D%20node%3B%0A%20%20this%2Eparent%20%3D%20null%3B%0A%20%20this%2Echildren%20%3D%20null%3B%0A%20%20this%2EA%20%3D%20null%3B%20%2F%2F%20default%20ancestor%0A%20%20this%2Ea%20%3D%20this%3B%20%2F%2F%20ancestor%0A%20%20this%2Ez%20%3D%200%3B%20%2F%2F%20prelim%0A%20%20this%2Em%20%3D%200%3B%20%2F%2F%20mod%0A%20%20this%2Ec%20%3D%200%3B%20%2F%2F%20change%0A%20%20this%2Es%20%3D%200%3B%20%2F%2F%20shift%0A%20%20this%2Et%20%3D%20null%3B%20%2F%2F%20thread%0A%20%20this%2Ei%20%3D%20i%3B%20%2F%2F%20number%0A%7D%0A%0ATreeNode%2Eprototype%20%3D%20Object%2Ecreate%28Node%2Eprototype%29%3B%0A%0Afunction%20treeRoot%28root%29%20%7B%0A%20%20var%20tree%20%3D%20new%20TreeNode%28root%2C%200%29%2C%0A%20%20%20%20%20%20node%2C%0A%20%20%20%20%20%20nodes%20%3D%20%5Btree%5D%2C%0A%20%20%20%20%20%20child%2C%0A%20%20%20%20%20%20children%2C%0A%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20n%3B%0A%0A%20%20while%20%28node%20%3D%20nodes%2Epop%28%29%29%20%7B%0A%20%20%20%20if%20%28children%20%3D%20node%2E%5F%2Echildren%29%20%7B%0A%20%20%20%20%20%20node%2Echildren%20%3D%20new%20Array%28n%20%3D%20children%2Elength%29%3B%0A%20%20%20%20%20%20for%20%28i%20%3D%20n%20%2D%201%3B%20i%20%3E%3D%200%3B%20%2D%2Di%29%20%7B%0A%20%20%20%20%20%20%20%20nodes%2Epush%28child%20%3D%20node%2Echildren%5Bi%5D%20%3D%20new%20TreeNode%28children%5Bi%5D%2C%20i%29%29%3B%0A%20%20%20%20%20%20%20%20child%2Eparent%20%3D%20node%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%28tree%2Eparent%20%3D%20new%20TreeNode%28null%2C%200%29%29%2Echildren%20%3D%20%5Btree%5D%3B%0A%20%20return%20tree%3B%0A%7D%0A%0A%2F%2F%20Node%2Dlink%20tree%20diagram%20using%20the%20Reingold%2DTilford%20%22tidy%22%20algorithm%0Afunction%20tree%28%29%20%7B%0A%20%20var%20separation%20%3D%20defaultSeparation%241%2C%0A%20%20%20%20%20%20dx%20%3D%201%2C%0A%20%20%20%20%20%20dy%20%3D%201%2C%0A%20%20%20%20%20%20nodeSize%20%3D%20null%3B%0A%0A%20%20function%20tree%28root%29%20%7B%0A%20%20%20%20var%20t%20%3D%20treeRoot%28root%29%3B%0A%0A%20%20%20%20%2F%2F%20Compute%20the%20layout%20using%20Buchheim%20et%20al%2E%E2%80%99s%20algorithm%2E%0A%20%20%20%20t%2EeachAfter%28firstWalk%29%2C%20t%2Eparent%2Em%20%3D%20%2Dt%2Ez%3B%0A%20%20%20%20t%2EeachBefore%28secondWalk%29%3B%0A%0A%20%20%20%20%2F%2F%20If%20a%20fixed%20node%20size%20is%20specified%2C%20scale%20x%20and%20y%2E%0A%20%20%20%20if%20%28nodeSize%29%20root%2EeachBefore%28sizeNode%29%3B%0A%0A%20%20%20%20%2F%2F%20If%20a%20fixed%20tree%20size%20is%20specified%2C%20scale%20x%20and%20y%20based%20on%20the%20extent%2E%0A%20%20%20%20%2F%2F%20Compute%20the%20left%2Dmost%2C%20right%2Dmost%2C%20and%20depth%2Dmost%20nodes%20for%20extents%2E%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20var%20left%20%3D%20root%2C%0A%20%20%20%20%20%20%20%20%20%20right%20%3D%20root%2C%0A%20%20%20%20%20%20%20%20%20%20bottom%20%3D%20root%3B%0A%20%20%20%20%20%20root%2EeachBefore%28function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28node%2Ex%20%3C%20left%2Ex%29%20left%20%3D%20node%3B%0A%20%20%20%20%20%20%20%20if%20%28node%2Ex%20%3E%20right%2Ex%29%20right%20%3D%20node%3B%0A%20%20%20%20%20%20%20%20if%20%28node%2Edepth%20%3E%20bottom%2Edepth%29%20bottom%20%3D%20node%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20var%20s%20%3D%20left%20%3D%3D%3D%20right%20%3F%201%20%3A%20separation%28left%2C%20right%29%20%2F%202%2C%0A%20%20%20%20%20%20%20%20%20%20tx%20%3D%20s%20%2D%20left%2Ex%2C%0A%20%20%20%20%20%20%20%20%20%20kx%20%3D%20dx%20%2F%20%28right%2Ex%20%2B%20s%20%2B%20tx%29%2C%0A%20%20%20%20%20%20%20%20%20%20ky%20%3D%20dy%20%2F%20%28bottom%2Edepth%20%7C%7C%201%29%3B%0A%20%20%20%20%20%20root%2EeachBefore%28function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20node%2Ex%20%3D%20%28node%2Ex%20%2B%20tx%29%20%2A%20kx%3B%0A%20%20%20%20%20%20%20%20node%2Ey%20%3D%20node%2Edepth%20%2A%20ky%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20root%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Computes%20a%20preliminary%20x%2Dcoordinate%20for%20v%2E%20Before%20that%2C%20FIRST%20WALK%20is%0A%20%20%2F%2F%20applied%20recursively%20to%20the%20children%20of%20v%2C%20as%20well%20as%20the%20function%0A%20%20%2F%2F%20APPORTION%2E%20After%20spacing%20out%20the%20children%20by%20calling%20EXECUTE%20SHIFTS%2C%20the%0A%20%20%2F%2F%20node%20v%20is%20placed%20to%20the%20midpoint%20of%20its%20outermost%20children%2E%0A%20%20function%20firstWalk%28v%29%20%7B%0A%20%20%20%20var%20children%20%3D%20v%2Echildren%2C%0A%20%20%20%20%20%20%20%20siblings%20%3D%20v%2Eparent%2Echildren%2C%0A%20%20%20%20%20%20%20%20w%20%3D%20v%2Ei%20%3F%20siblings%5Bv%2Ei%20%2D%201%5D%20%3A%20null%3B%0A%20%20%20%20if%20%28children%29%20%7B%0A%20%20%20%20%20%20executeShifts%28v%29%3B%0A%20%20%20%20%20%20var%20midpoint%20%3D%20%28children%5B0%5D%2Ez%20%2B%20children%5Bchildren%2Elength%20%2D%201%5D%2Ez%29%20%2F%202%3B%0A%20%20%20%20%20%20if%20%28w%29%20%7B%0A%20%20%20%20%20%20%20%20v%2Ez%20%3D%20w%2Ez%20%2B%20separation%28v%2E%5F%2C%20w%2E%5F%29%3B%0A%20%20%20%20%20%20%20%20v%2Em%20%3D%20v%2Ez%20%2D%20midpoint%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20v%2Ez%20%3D%20midpoint%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28w%29%20%7B%0A%20%20%20%20%20%20v%2Ez%20%3D%20w%2Ez%20%2B%20separation%28v%2E%5F%2C%20w%2E%5F%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20v%2Eparent%2EA%20%3D%20apportion%28v%2C%20w%2C%20v%2Eparent%2EA%20%7C%7C%20siblings%5B0%5D%29%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Computes%20all%20real%20x%2Dcoordinates%20by%20summing%20up%20the%20modifiers%20recursively%2E%0A%20%20function%20secondWalk%28v%29%20%7B%0A%20%20%20%20v%2E%5F%2Ex%20%3D%20v%2Ez%20%2B%20v%2Eparent%2Em%3B%0A%20%20%20%20v%2Em%20%2B%3D%20v%2Eparent%2Em%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20The%20core%20of%20the%20algorithm%2E%20Here%2C%20a%20new%20subtree%20is%20combined%20with%20the%0A%20%20%2F%2F%20previous%20subtrees%2E%20Threads%20are%20used%20to%20traverse%20the%20inside%20and%20outside%0A%20%20%2F%2F%20contours%20of%20the%20left%20and%20right%20subtree%20up%20to%20the%20highest%20common%20level%2E%20The%0A%20%20%2F%2F%20vertices%20used%20for%20the%20traversals%20are%20vi%2B%2C%20vi%2D%2C%20vo%2D%2C%20and%20vo%2B%2C%20where%20the%0A%20%20%2F%2F%20superscript%20o%20means%20outside%20and%20i%20means%20inside%2C%20the%20subscript%20%2D%20means%20left%0A%20%20%2F%2F%20subtree%20and%20%2B%20means%20right%20subtree%2E%20For%20summing%20up%20the%20modifiers%20along%20the%0A%20%20%2F%2F%20contour%2C%20we%20use%20respective%20variables%20si%2B%2C%20si%2D%2C%20so%2D%2C%20and%20so%2B%2E%20Whenever%20two%0A%20%20%2F%2F%20nodes%20of%20the%20inside%20contours%20conflict%2C%20we%20compute%20the%20left%20one%20of%20the%0A%20%20%2F%2F%20greatest%20uncommon%20ancestors%20using%20the%20function%20ANCESTOR%20and%20call%20MOVE%0A%20%20%2F%2F%20SUBTREE%20to%20shift%20the%20subtree%20and%20prepare%20the%20shifts%20of%20smaller%20subtrees%2E%0A%20%20%2F%2F%20Finally%2C%20we%20add%20a%20new%20thread%20%28if%20necessary%29%2E%0A%20%20function%20apportion%28v%2C%20w%2C%20ancestor%29%20%7B%0A%20%20%20%20if%20%28w%29%20%7B%0A%20%20%20%20%20%20var%20vip%20%3D%20v%2C%0A%20%20%20%20%20%20%20%20%20%20vop%20%3D%20v%2C%0A%20%20%20%20%20%20%20%20%20%20vim%20%3D%20w%2C%0A%20%20%20%20%20%20%20%20%20%20vom%20%3D%20vip%2Eparent%2Echildren%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20sip%20%3D%20vip%2Em%2C%0A%20%20%20%20%20%20%20%20%20%20sop%20%3D%20vop%2Em%2C%0A%20%20%20%20%20%20%20%20%20%20sim%20%3D%20vim%2Em%2C%0A%20%20%20%20%20%20%20%20%20%20som%20%3D%20vom%2Em%2C%0A%20%20%20%20%20%20%20%20%20%20shift%3B%0A%20%20%20%20%20%20while%20%28vim%20%3D%20nextRight%28vim%29%2C%20vip%20%3D%20nextLeft%28vip%29%2C%20vim%20%26%26%20vip%29%20%7B%0A%20%20%20%20%20%20%20%20vom%20%3D%20nextLeft%28vom%29%3B%0A%20%20%20%20%20%20%20%20vop%20%3D%20nextRight%28vop%29%3B%0A%20%20%20%20%20%20%20%20vop%2Ea%20%3D%20v%3B%0A%20%20%20%20%20%20%20%20shift%20%3D%20vim%2Ez%20%2B%20sim%20%2D%20vip%2Ez%20%2D%20sip%20%2B%20separation%28vim%2E%5F%2C%20vip%2E%5F%29%3B%0A%20%20%20%20%20%20%20%20if%20%28shift%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20moveSubtree%28nextAncestor%28vim%2C%20v%2C%20ancestor%29%2C%20v%2C%20shift%29%3B%0A%20%20%20%20%20%20%20%20%20%20sip%20%2B%3D%20shift%3B%0A%20%20%20%20%20%20%20%20%20%20sop%20%2B%3D%20shift%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20sim%20%2B%3D%20vim%2Em%3B%0A%20%20%20%20%20%20%20%20sip%20%2B%3D%20vip%2Em%3B%0A%20%20%20%20%20%20%20%20som%20%2B%3D%20vom%2Em%3B%0A%20%20%20%20%20%20%20%20sop%20%2B%3D%20vop%2Em%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28vim%20%26%26%20%21nextRight%28vop%29%29%20%7B%0A%20%20%20%20%20%20%20%20vop%2Et%20%3D%20vim%3B%0A%20%20%20%20%20%20%20%20vop%2Em%20%2B%3D%20sim%20%2D%20sop%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28vip%20%26%26%20%21nextLeft%28vom%29%29%20%7B%0A%20%20%20%20%20%20%20%20vom%2Et%20%3D%20vip%3B%0A%20%20%20%20%20%20%20%20vom%2Em%20%2B%3D%20sip%20%2D%20som%3B%0A%20%20%20%20%20%20%20%20ancestor%20%3D%20v%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20ancestor%3B%0A%20%20%7D%0A%0A%20%20function%20sizeNode%28node%29%20%7B%0A%20%20%20%20node%2Ex%20%2A%3D%20dx%3B%0A%20%20%20%20node%2Ey%20%3D%20node%2Edepth%20%2A%20dy%3B%0A%20%20%7D%0A%0A%20%20tree%2Eseparation%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28separation%20%3D%20x%2C%20tree%29%20%3A%20separation%3B%0A%20%20%7D%3B%0A%0A%20%20tree%2Esize%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28nodeSize%20%3D%20false%2C%20dx%20%3D%20%2Bx%5B0%5D%2C%20dy%20%3D%20%2Bx%5B1%5D%2C%20tree%29%20%3A%20%28nodeSize%20%3F%20null%20%3A%20%5Bdx%2C%20dy%5D%29%3B%0A%20%20%7D%3B%0A%0A%20%20tree%2EnodeSize%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28nodeSize%20%3D%20true%2C%20dx%20%3D%20%2Bx%5B0%5D%2C%20dy%20%3D%20%2Bx%5B1%5D%2C%20tree%29%20%3A%20%28nodeSize%20%3F%20%5Bdx%2C%20dy%5D%20%3A%20null%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20tree%3B%0A%7D%0A%0Afunction%20treemapSlice%28parent%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20var%20nodes%20%3D%20parent%2Echildren%2C%0A%20%20%20%20%20%20node%2C%0A%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20n%20%3D%20nodes%2Elength%2C%0A%20%20%20%20%20%20k%20%3D%20parent%2Evalue%20%26%26%20%28y1%20%2D%20y0%29%20%2F%20parent%2Evalue%3B%0A%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20node%20%3D%20nodes%5Bi%5D%2C%20node%2Ex0%20%3D%20x0%2C%20node%2Ex1%20%3D%20x1%3B%0A%20%20%20%20node%2Ey0%20%3D%20y0%2C%20node%2Ey1%20%3D%20y0%20%2B%3D%20node%2Evalue%20%2A%20k%3B%0A%20%20%7D%0A%7D%0A%0Avar%20phi%20%3D%20%281%20%2B%20Math%2Esqrt%285%29%29%20%2F%202%3B%0A%0Afunction%20squarifyRatio%28ratio%2C%20parent%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20var%20rows%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20nodes%20%3D%20parent%2Echildren%2C%0A%20%20%20%20%20%20row%2C%0A%20%20%20%20%20%20nodeValue%2C%0A%20%20%20%20%20%20i0%20%3D%200%2C%0A%20%20%20%20%20%20i1%20%3D%200%2C%0A%20%20%20%20%20%20n%20%3D%20nodes%2Elength%2C%0A%20%20%20%20%20%20dx%2C%20dy%2C%0A%20%20%20%20%20%20value%20%3D%20parent%2Evalue%2C%0A%20%20%20%20%20%20sumValue%2C%0A%20%20%20%20%20%20minValue%2C%0A%20%20%20%20%20%20maxValue%2C%0A%20%20%20%20%20%20newRatio%2C%0A%20%20%20%20%20%20minRatio%2C%0A%20%20%20%20%20%20alpha%2C%0A%20%20%20%20%20%20beta%3B%0A%0A%20%20while%20%28i0%20%3C%20n%29%20%7B%0A%20%20%20%20dx%20%3D%20x1%20%2D%20x0%2C%20dy%20%3D%20y1%20%2D%20y0%3B%0A%0A%20%20%20%20%2F%2F%20Find%20the%20next%20non%2Dempty%20node%2E%0A%20%20%20%20do%20sumValue%20%3D%20nodes%5Bi1%2B%2B%5D%2Evalue%3B%20while%20%28%21sumValue%20%26%26%20i1%20%3C%20n%29%3B%0A%20%20%20%20minValue%20%3D%20maxValue%20%3D%20sumValue%3B%0A%20%20%20%20alpha%20%3D%20Math%2Emax%28dy%20%2F%20dx%2C%20dx%20%2F%20dy%29%20%2F%20%28value%20%2A%20ratio%29%3B%0A%20%20%20%20beta%20%3D%20sumValue%20%2A%20sumValue%20%2A%20alpha%3B%0A%20%20%20%20minRatio%20%3D%20Math%2Emax%28maxValue%20%2F%20beta%2C%20beta%20%2F%20minValue%29%3B%0A%0A%20%20%20%20%2F%2F%20Keep%20adding%20nodes%20while%20the%20aspect%20ratio%20maintains%20or%20improves%2E%0A%20%20%20%20for%20%28%3B%20i1%20%3C%20n%3B%20%2B%2Bi1%29%20%7B%0A%20%20%20%20%20%20sumValue%20%2B%3D%20nodeValue%20%3D%20nodes%5Bi1%5D%2Evalue%3B%0A%20%20%20%20%20%20if%20%28nodeValue%20%3C%20minValue%29%20minValue%20%3D%20nodeValue%3B%0A%20%20%20%20%20%20if%20%28nodeValue%20%3E%20maxValue%29%20maxValue%20%3D%20nodeValue%3B%0A%20%20%20%20%20%20beta%20%3D%20sumValue%20%2A%20sumValue%20%2A%20alpha%3B%0A%20%20%20%20%20%20newRatio%20%3D%20Math%2Emax%28maxValue%20%2F%20beta%2C%20beta%20%2F%20minValue%29%3B%0A%20%20%20%20%20%20if%20%28newRatio%20%3E%20minRatio%29%20%7B%20sumValue%20%2D%3D%20nodeValue%3B%20break%3B%20%7D%0A%20%20%20%20%20%20minRatio%20%3D%20newRatio%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Position%20and%20record%20the%20row%20orientation%2E%0A%20%20%20%20rows%2Epush%28row%20%3D%20%7Bvalue%3A%20sumValue%2C%20dice%3A%20dx%20%3C%20dy%2C%20children%3A%20nodes%2Eslice%28i0%2C%20i1%29%7D%29%3B%0A%20%20%20%20if%20%28row%2Edice%29%20treemapDice%28row%2C%20x0%2C%20y0%2C%20x1%2C%20value%20%3F%20y0%20%2B%3D%20dy%20%2A%20sumValue%20%2F%20value%20%3A%20y1%29%3B%0A%20%20%20%20else%20treemapSlice%28row%2C%20x0%2C%20y0%2C%20value%20%3F%20x0%20%2B%3D%20dx%20%2A%20sumValue%20%2F%20value%20%3A%20x1%2C%20y1%29%3B%0A%20%20%20%20value%20%2D%3D%20sumValue%2C%20i0%20%3D%20i1%3B%0A%20%20%7D%0A%0A%20%20return%20rows%3B%0A%7D%0A%0Avar%20squarify%20%3D%20%28function%20custom%28ratio%29%20%7B%0A%0A%20%20function%20squarify%28parent%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20%20%20squarifyRatio%28ratio%2C%20parent%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%3B%0A%20%20%7D%0A%0A%20%20squarify%2Eratio%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20custom%28%28x%20%3D%20%2Bx%29%20%3E%201%20%3F%20x%20%3A%201%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20squarify%3B%0A%7D%29%28phi%29%3B%0A%0Afunction%20index%243%28%29%20%7B%0A%20%20var%20tile%20%3D%20squarify%2C%0A%20%20%20%20%20%20round%20%3D%20false%2C%0A%20%20%20%20%20%20dx%20%3D%201%2C%0A%20%20%20%20%20%20dy%20%3D%201%2C%0A%20%20%20%20%20%20paddingStack%20%3D%20%5B0%5D%2C%0A%20%20%20%20%20%20paddingInner%20%3D%20constantZero%2C%0A%20%20%20%20%20%20paddingTop%20%3D%20constantZero%2C%0A%20%20%20%20%20%20paddingRight%20%3D%20constantZero%2C%0A%20%20%20%20%20%20paddingBottom%20%3D%20constantZero%2C%0A%20%20%20%20%20%20paddingLeft%20%3D%20constantZero%3B%0A%0A%20%20function%20treemap%28root%29%20%7B%0A%20%20%20%20root%2Ex0%20%3D%0A%20%20%20%20root%2Ey0%20%3D%200%3B%0A%20%20%20%20root%2Ex1%20%3D%20dx%3B%0A%20%20%20%20root%2Ey1%20%3D%20dy%3B%0A%20%20%20%20root%2EeachBefore%28positionNode%29%3B%0A%20%20%20%20paddingStack%20%3D%20%5B0%5D%3B%0A%20%20%20%20if%20%28round%29%20root%2EeachBefore%28roundNode%29%3B%0A%20%20%20%20return%20root%3B%0A%20%20%7D%0A%0A%20%20function%20positionNode%28node%29%20%7B%0A%20%20%20%20var%20p%20%3D%20paddingStack%5Bnode%2Edepth%5D%2C%0A%20%20%20%20%20%20%20%20x0%20%3D%20node%2Ex0%20%2B%20p%2C%0A%20%20%20%20%20%20%20%20y0%20%3D%20node%2Ey0%20%2B%20p%2C%0A%20%20%20%20%20%20%20%20x1%20%3D%20node%2Ex1%20%2D%20p%2C%0A%20%20%20%20%20%20%20%20y1%20%3D%20node%2Ey1%20%2D%20p%3B%0A%20%20%20%20if%20%28x1%20%3C%20x0%29%20x0%20%3D%20x1%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%3B%0A%20%20%20%20if%20%28y1%20%3C%20y0%29%20y0%20%3D%20y1%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%3B%0A%20%20%20%20node%2Ex0%20%3D%20x0%3B%0A%20%20%20%20node%2Ey0%20%3D%20y0%3B%0A%20%20%20%20node%2Ex1%20%3D%20x1%3B%0A%20%20%20%20node%2Ey1%20%3D%20y1%3B%0A%20%20%20%20if%20%28node%2Echildren%29%20%7B%0A%20%20%20%20%20%20p%20%3D%20paddingStack%5Bnode%2Edepth%20%2B%201%5D%20%3D%20paddingInner%28node%29%20%2F%202%3B%0A%20%20%20%20%20%20x0%20%2B%3D%20paddingLeft%28node%29%20%2D%20p%3B%0A%20%20%20%20%20%20y0%20%2B%3D%20paddingTop%28node%29%20%2D%20p%3B%0A%20%20%20%20%20%20x1%20%2D%3D%20paddingRight%28node%29%20%2D%20p%3B%0A%20%20%20%20%20%20y1%20%2D%3D%20paddingBottom%28node%29%20%2D%20p%3B%0A%20%20%20%20%20%20if%20%28x1%20%3C%20x0%29%20x0%20%3D%20x1%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%3B%0A%20%20%20%20%20%20if%20%28y1%20%3C%20y0%29%20y0%20%3D%20y1%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%3B%0A%20%20%20%20%20%20tile%28node%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20treemap%2Eround%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28round%20%3D%20%21%21x%2C%20treemap%29%20%3A%20round%3B%0A%20%20%7D%3B%0A%0A%20%20treemap%2Esize%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28dx%20%3D%20%2Bx%5B0%5D%2C%20dy%20%3D%20%2Bx%5B1%5D%2C%20treemap%29%20%3A%20%5Bdx%2C%20dy%5D%3B%0A%20%20%7D%3B%0A%0A%20%20treemap%2Etile%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28tile%20%3D%20required%28x%29%2C%20treemap%29%20%3A%20tile%3B%0A%20%20%7D%3B%0A%0A%20%20treemap%2Epadding%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20treemap%2EpaddingInner%28x%29%2EpaddingOuter%28x%29%20%3A%20treemap%2EpaddingInner%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20treemap%2EpaddingInner%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28paddingInner%20%3D%20typeof%20x%20%3D%3D%3D%20%22function%22%20%3F%20x%20%3A%20constant%249%28%2Bx%29%2C%20treemap%29%20%3A%20paddingInner%3B%0A%20%20%7D%3B%0A%0A%20%20treemap%2EpaddingOuter%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20treemap%2EpaddingTop%28x%29%2EpaddingRight%28x%29%2EpaddingBottom%28x%29%2EpaddingLeft%28x%29%20%3A%20treemap%2EpaddingTop%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20treemap%2EpaddingTop%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28paddingTop%20%3D%20typeof%20x%20%3D%3D%3D%20%22function%22%20%3F%20x%20%3A%20constant%249%28%2Bx%29%2C%20treemap%29%20%3A%20paddingTop%3B%0A%20%20%7D%3B%0A%0A%20%20treemap%2EpaddingRight%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28paddingRight%20%3D%20typeof%20x%20%3D%3D%3D%20%22function%22%20%3F%20x%20%3A%20constant%249%28%2Bx%29%2C%20treemap%29%20%3A%20paddingRight%3B%0A%20%20%7D%3B%0A%0A%20%20treemap%2EpaddingBottom%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28paddingBottom%20%3D%20typeof%20x%20%3D%3D%3D%20%22function%22%20%3F%20x%20%3A%20constant%249%28%2Bx%29%2C%20treemap%29%20%3A%20paddingBottom%3B%0A%20%20%7D%3B%0A%0A%20%20treemap%2EpaddingLeft%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28paddingLeft%20%3D%20typeof%20x%20%3D%3D%3D%20%22function%22%20%3F%20x%20%3A%20constant%249%28%2Bx%29%2C%20treemap%29%20%3A%20paddingLeft%3B%0A%20%20%7D%3B%0A%0A%20%20return%20treemap%3B%0A%7D%0A%0Afunction%20binary%28parent%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20var%20nodes%20%3D%20parent%2Echildren%2C%0A%20%20%20%20%20%20i%2C%20n%20%3D%20nodes%2Elength%2C%0A%20%20%20%20%20%20sum%2C%20sums%20%3D%20new%20Array%28n%20%2B%201%29%3B%0A%0A%20%20for%20%28sums%5B0%5D%20%3D%20sum%20%3D%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20sums%5Bi%20%2B%201%5D%20%3D%20sum%20%2B%3D%20nodes%5Bi%5D%2Evalue%3B%0A%20%20%7D%0A%0A%20%20partition%280%2C%20n%2C%20parent%2Evalue%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%3B%0A%0A%20%20function%20partition%28i%2C%20j%2C%20value%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20%20%20if%20%28i%20%3E%3D%20j%20%2D%201%29%20%7B%0A%20%20%20%20%20%20var%20node%20%3D%20nodes%5Bi%5D%3B%0A%20%20%20%20%20%20node%2Ex0%20%3D%20x0%2C%20node%2Ey0%20%3D%20y0%3B%0A%20%20%20%20%20%20node%2Ex1%20%3D%20x1%2C%20node%2Ey1%20%3D%20y1%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20valueOffset%20%3D%20sums%5Bi%5D%2C%0A%20%20%20%20%20%20%20%20valueTarget%20%3D%20%28value%20%2F%202%29%20%2B%20valueOffset%2C%0A%20%20%20%20%20%20%20%20k%20%3D%20i%20%2B%201%2C%0A%20%20%20%20%20%20%20%20hi%20%3D%20j%20%2D%201%3B%0A%0A%20%20%20%20while%20%28k%20%3C%20hi%29%20%7B%0A%20%20%20%20%20%20var%20mid%20%3D%20k%20%2B%20hi%20%3E%3E%3E%201%3B%0A%20%20%20%20%20%20if%20%28sums%5Bmid%5D%20%3C%20valueTarget%29%20k%20%3D%20mid%20%2B%201%3B%0A%20%20%20%20%20%20else%20hi%20%3D%20mid%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28%28valueTarget%20%2D%20sums%5Bk%20%2D%201%5D%29%20%3C%20%28sums%5Bk%5D%20%2D%20valueTarget%29%20%26%26%20i%20%2B%201%20%3C%20k%29%20%2D%2Dk%3B%0A%0A%20%20%20%20var%20valueLeft%20%3D%20sums%5Bk%5D%20%2D%20valueOffset%2C%0A%20%20%20%20%20%20%20%20valueRight%20%3D%20value%20%2D%20valueLeft%3B%0A%0A%20%20%20%20if%20%28%28x1%20%2D%20x0%29%20%3E%20%28y1%20%2D%20y0%29%29%20%7B%0A%20%20%20%20%20%20var%20xk%20%3D%20%28x0%20%2A%20valueRight%20%2B%20x1%20%2A%20valueLeft%29%20%2F%20value%3B%0A%20%20%20%20%20%20partition%28i%2C%20k%2C%20valueLeft%2C%20x0%2C%20y0%2C%20xk%2C%20y1%29%3B%0A%20%20%20%20%20%20partition%28k%2C%20j%2C%20valueRight%2C%20xk%2C%20y0%2C%20x1%2C%20y1%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20var%20yk%20%3D%20%28y0%20%2A%20valueRight%20%2B%20y1%20%2A%20valueLeft%29%20%2F%20value%3B%0A%20%20%20%20%20%20partition%28i%2C%20k%2C%20valueLeft%2C%20x0%2C%20y0%2C%20x1%2C%20yk%29%3B%0A%20%20%20%20%20%20partition%28k%2C%20j%2C%20valueRight%2C%20x0%2C%20yk%2C%20x1%2C%20y1%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Afunction%20sliceDice%28parent%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20%28parent%2Edepth%20%26%201%20%3F%20treemapSlice%20%3A%20treemapDice%29%28parent%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%3B%0A%7D%0A%0Avar%20resquarify%20%3D%20%28function%20custom%28ratio%29%20%7B%0A%0A%20%20function%20resquarify%28parent%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20%20%20if%20%28%28rows%20%3D%20parent%2E%5Fsquarify%29%20%26%26%20%28rows%2Eratio%20%3D%3D%3D%20ratio%29%29%20%7B%0A%20%20%20%20%20%20var%20rows%2C%0A%20%20%20%20%20%20%20%20%20%20row%2C%0A%20%20%20%20%20%20%20%20%20%20nodes%2C%0A%20%20%20%20%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20%20%20%20%20j%20%3D%20%2D1%2C%0A%20%20%20%20%20%20%20%20%20%20n%2C%0A%20%20%20%20%20%20%20%20%20%20m%20%3D%20rows%2Elength%2C%0A%20%20%20%20%20%20%20%20%20%20value%20%3D%20parent%2Evalue%3B%0A%0A%20%20%20%20%20%20while%20%28%2B%2Bj%20%3C%20m%29%20%7B%0A%20%20%20%20%20%20%20%20row%20%3D%20rows%5Bj%5D%2C%20nodes%20%3D%20row%2Echildren%3B%0A%20%20%20%20%20%20%20%20for%20%28i%20%3D%20row%2Evalue%20%3D%200%2C%20n%20%3D%20nodes%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20row%2Evalue%20%2B%3D%20nodes%5Bi%5D%2Evalue%3B%0A%20%20%20%20%20%20%20%20if%20%28row%2Edice%29%20treemapDice%28row%2C%20x0%2C%20y0%2C%20x1%2C%20y0%20%2B%3D%20%28y1%20%2D%20y0%29%20%2A%20row%2Evalue%20%2F%20value%29%3B%0A%20%20%20%20%20%20%20%20else%20treemapSlice%28row%2C%20x0%2C%20y0%2C%20x0%20%2B%3D%20%28x1%20%2D%20x0%29%20%2A%20row%2Evalue%20%2F%20value%2C%20y1%29%3B%0A%20%20%20%20%20%20%20%20value%20%2D%3D%20row%2Evalue%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20parent%2E%5Fsquarify%20%3D%20rows%20%3D%20squarifyRatio%28ratio%2C%20parent%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%3B%0A%20%20%20%20%20%20rows%2Eratio%20%3D%20ratio%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20resquarify%2Eratio%20%3D%20function%28x%29%20%7B%0A%20%20%20%20return%20custom%28%28x%20%3D%20%2Bx%29%20%3E%201%20%3F%20x%20%3A%201%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20resquarify%3B%0A%7D%29%28phi%29%3B%0A%0Afunction%20area%242%28polygon%29%20%7B%0A%20%20var%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20n%20%3D%20polygon%2Elength%2C%0A%20%20%20%20%20%20a%2C%0A%20%20%20%20%20%20b%20%3D%20polygon%5Bn%20%2D%201%5D%2C%0A%20%20%20%20%20%20area%20%3D%200%3B%0A%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20a%20%3D%20b%3B%0A%20%20%20%20b%20%3D%20polygon%5Bi%5D%3B%0A%20%20%20%20area%20%2B%3D%20a%5B1%5D%20%2A%20b%5B0%5D%20%2D%20a%5B0%5D%20%2A%20b%5B1%5D%3B%0A%20%20%7D%0A%0A%20%20return%20area%20%2F%202%3B%0A%7D%0A%0Afunction%20centroid%241%28polygon%29%20%7B%0A%20%20var%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20n%20%3D%20polygon%2Elength%2C%0A%20%20%20%20%20%20x%20%3D%200%2C%0A%20%20%20%20%20%20y%20%3D%200%2C%0A%20%20%20%20%20%20a%2C%0A%20%20%20%20%20%20b%20%3D%20polygon%5Bn%20%2D%201%5D%2C%0A%20%20%20%20%20%20c%2C%0A%20%20%20%20%20%20k%20%3D%200%3B%0A%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20a%20%3D%20b%3B%0A%20%20%20%20b%20%3D%20polygon%5Bi%5D%3B%0A%20%20%20%20k%20%2B%3D%20c%20%3D%20a%5B0%5D%20%2A%20b%5B1%5D%20%2D%20b%5B0%5D%20%2A%20a%5B1%5D%3B%0A%20%20%20%20x%20%2B%3D%20%28a%5B0%5D%20%2B%20b%5B0%5D%29%20%2A%20c%3B%0A%20%20%20%20y%20%2B%3D%20%28a%5B1%5D%20%2B%20b%5B1%5D%29%20%2A%20c%3B%0A%20%20%7D%0A%0A%20%20return%20k%20%2A%3D%203%2C%20%5Bx%20%2F%20k%2C%20y%20%2F%20k%5D%3B%0A%7D%0A%0A%2F%2F%20Returns%20the%202D%20cross%20product%20of%20AB%20and%20AC%20vectors%2C%20i%2Ee%2E%2C%20the%20z%2Dcomponent%20of%0A%2F%2F%20the%203D%20cross%20product%20in%20a%20quadrant%20I%20Cartesian%20coordinate%20system%20%28%2Bx%20is%0A%2F%2F%20right%2C%20%2By%20is%20up%29%2E%20Returns%20a%20positive%20value%20if%20ABC%20is%20counter%2Dclockwise%2C%0A%2F%2F%20negative%20if%20clockwise%2C%20and%20zero%20if%20the%20points%20are%20collinear%2E%0Afunction%20cross%241%28a%2C%20b%2C%20c%29%20%7B%0A%20%20return%20%28b%5B0%5D%20%2D%20a%5B0%5D%29%20%2A%20%28c%5B1%5D%20%2D%20a%5B1%5D%29%20%2D%20%28b%5B1%5D%20%2D%20a%5B1%5D%29%20%2A%20%28c%5B0%5D%20%2D%20a%5B0%5D%29%3B%0A%7D%0A%0Afunction%20lexicographicOrder%28a%2C%20b%29%20%7B%0A%20%20return%20a%5B0%5D%20%2D%20b%5B0%5D%20%7C%7C%20a%5B1%5D%20%2D%20b%5B1%5D%3B%0A%7D%0A%0A%2F%2F%20Computes%20the%20upper%20convex%20hull%20per%20the%20monotone%20chain%20algorithm%2E%0A%2F%2F%20Assumes%20points%2Elength%20%3E%3D%203%2C%20is%20sorted%20by%20x%2C%20unique%20in%20y%2E%0A%2F%2F%20Returns%20an%20array%20of%20indices%20into%20points%20in%20left%2Dto%2Dright%20order%2E%0Afunction%20computeUpperHullIndexes%28points%29%20%7B%0A%20%20var%20n%20%3D%20points%2Elength%2C%0A%20%20%20%20%20%20indexes%20%3D%20%5B0%2C%201%5D%2C%0A%20%20%20%20%20%20size%20%3D%202%3B%0A%0A%20%20for%20%28var%20i%20%3D%202%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20while%20%28size%20%3E%201%20%26%26%20cross%241%28points%5Bindexes%5Bsize%20%2D%202%5D%5D%2C%20points%5Bindexes%5Bsize%20%2D%201%5D%5D%2C%20points%5Bi%5D%29%20%3C%3D%200%29%20%2D%2Dsize%3B%0A%20%20%20%20indexes%5Bsize%2B%2B%5D%20%3D%20i%3B%0A%20%20%7D%0A%0A%20%20return%20indexes%2Eslice%280%2C%20size%29%3B%20%2F%2F%20remove%20popped%20points%0A%7D%0A%0Afunction%20hull%28points%29%20%7B%0A%20%20if%20%28%28n%20%3D%20points%2Elength%29%20%3C%203%29%20return%20null%3B%0A%0A%20%20var%20i%2C%0A%20%20%20%20%20%20n%2C%0A%20%20%20%20%20%20sortedPoints%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20flippedPoints%20%3D%20new%20Array%28n%29%3B%0A%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20sortedPoints%5Bi%5D%20%3D%20%5B%2Bpoints%5Bi%5D%5B0%5D%2C%20%2Bpoints%5Bi%5D%5B1%5D%2C%20i%5D%3B%0A%20%20sortedPoints%2Esort%28lexicographicOrder%29%3B%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20flippedPoints%5Bi%5D%20%3D%20%5BsortedPoints%5Bi%5D%5B0%5D%2C%20%2DsortedPoints%5Bi%5D%5B1%5D%5D%3B%0A%0A%20%20var%20upperIndexes%20%3D%20computeUpperHullIndexes%28sortedPoints%29%2C%0A%20%20%20%20%20%20lowerIndexes%20%3D%20computeUpperHullIndexes%28flippedPoints%29%3B%0A%0A%20%20%2F%2F%20Construct%20the%20hull%20polygon%2C%20removing%20possible%20duplicate%20endpoints%2E%0A%20%20var%20skipLeft%20%3D%20lowerIndexes%5B0%5D%20%3D%3D%3D%20upperIndexes%5B0%5D%2C%0A%20%20%20%20%20%20skipRight%20%3D%20lowerIndexes%5BlowerIndexes%2Elength%20%2D%201%5D%20%3D%3D%3D%20upperIndexes%5BupperIndexes%2Elength%20%2D%201%5D%2C%0A%20%20%20%20%20%20hull%20%3D%20%5B%5D%3B%0A%0A%20%20%2F%2F%20Add%20upper%20hull%20in%20right%2Dto%2Dl%20order%2E%0A%20%20%2F%2F%20Then%20add%20lower%20hull%20in%20left%2Dto%2Dright%20order%2E%0A%20%20for%20%28i%20%3D%20upperIndexes%2Elength%20%2D%201%3B%20i%20%3E%3D%200%3B%20%2D%2Di%29%20hull%2Epush%28points%5BsortedPoints%5BupperIndexes%5Bi%5D%5D%5B2%5D%5D%29%3B%0A%20%20for%20%28i%20%3D%20%2BskipLeft%3B%20i%20%3C%20lowerIndexes%2Elength%20%2D%20skipRight%3B%20%2B%2Bi%29%20hull%2Epush%28points%5BsortedPoints%5BlowerIndexes%5Bi%5D%5D%5B2%5D%5D%29%3B%0A%0A%20%20return%20hull%3B%0A%7D%0A%0Afunction%20contains%242%28polygon%2C%20point%29%20%7B%0A%20%20var%20n%20%3D%20polygon%2Elength%2C%0A%20%20%20%20%20%20p%20%3D%20polygon%5Bn%20%2D%201%5D%2C%0A%20%20%20%20%20%20x%20%3D%20point%5B0%5D%2C%20y%20%3D%20point%5B1%5D%2C%0A%20%20%20%20%20%20x0%20%3D%20p%5B0%5D%2C%20y0%20%3D%20p%5B1%5D%2C%0A%20%20%20%20%20%20x1%2C%20y1%2C%0A%20%20%20%20%20%20inside%20%3D%20false%3B%0A%0A%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20p%20%3D%20polygon%5Bi%5D%2C%20x1%20%3D%20p%5B0%5D%2C%20y1%20%3D%20p%5B1%5D%3B%0A%20%20%20%20if%20%28%28%28y1%20%3E%20y%29%20%21%3D%3D%20%28y0%20%3E%20y%29%29%20%26%26%20%28x%20%3C%20%28x0%20%2D%20x1%29%20%2A%20%28y%20%2D%20y1%29%20%2F%20%28y0%20%2D%20y1%29%20%2B%20x1%29%29%20inside%20%3D%20%21inside%3B%0A%20%20%20%20x0%20%3D%20x1%2C%20y0%20%3D%20y1%3B%0A%20%20%7D%0A%0A%20%20return%20inside%3B%0A%7D%0A%0Afunction%20length%242%28polygon%29%20%7B%0A%20%20var%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20n%20%3D%20polygon%2Elength%2C%0A%20%20%20%20%20%20b%20%3D%20polygon%5Bn%20%2D%201%5D%2C%0A%20%20%20%20%20%20xa%2C%0A%20%20%20%20%20%20ya%2C%0A%20%20%20%20%20%20xb%20%3D%20b%5B0%5D%2C%0A%20%20%20%20%20%20yb%20%3D%20b%5B1%5D%2C%0A%20%20%20%20%20%20perimeter%20%3D%200%3B%0A%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20xa%20%3D%20xb%3B%0A%20%20%20%20ya%20%3D%20yb%3B%0A%20%20%20%20b%20%3D%20polygon%5Bi%5D%3B%0A%20%20%20%20xb%20%3D%20b%5B0%5D%3B%0A%20%20%20%20yb%20%3D%20b%5B1%5D%3B%0A%20%20%20%20xa%20%2D%3D%20xb%3B%0A%20%20%20%20ya%20%2D%3D%20yb%3B%0A%20%20%20%20perimeter%20%2B%3D%20Math%2Esqrt%28xa%20%2A%20xa%20%2B%20ya%20%2A%20ya%29%3B%0A%20%20%7D%0A%0A%20%20return%20perimeter%3B%0A%7D%0A%0Afunction%20defaultSource%241%28%29%20%7B%0A%20%20return%20Math%2Erandom%28%29%3B%0A%7D%0A%0Avar%20uniform%20%3D%20%28function%20sourceRandomUniform%28source%29%20%7B%0A%20%20function%20randomUniform%28min%2C%20max%29%20%7B%0A%20%20%20%20min%20%3D%20min%20%3D%3D%20null%20%3F%200%20%3A%20%2Bmin%3B%0A%20%20%20%20max%20%3D%20max%20%3D%3D%20null%20%3F%201%20%3A%20%2Bmax%3B%0A%20%20%20%20if%20%28arguments%2Elength%20%3D%3D%3D%201%29%20max%20%3D%20min%2C%20min%20%3D%200%3B%0A%20%20%20%20else%20max%20%2D%3D%20min%3B%0A%20%20%20%20return%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20source%28%29%20%2A%20max%20%2B%20min%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20randomUniform%2Esource%20%3D%20sourceRandomUniform%3B%0A%0A%20%20return%20randomUniform%3B%0A%7D%29%28defaultSource%241%29%3B%0A%0Avar%20normal%20%3D%20%28function%20sourceRandomNormal%28source%29%20%7B%0A%20%20function%20randomNormal%28mu%2C%20sigma%29%20%7B%0A%20%20%20%20var%20x%2C%20r%3B%0A%20%20%20%20mu%20%3D%20mu%20%3D%3D%20null%20%3F%200%20%3A%20%2Bmu%3B%0A%20%20%20%20sigma%20%3D%20sigma%20%3D%3D%20null%20%3F%201%20%3A%20%2Bsigma%3B%0A%20%20%20%20return%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20y%3B%0A%0A%20%20%20%20%20%20%2F%2F%20If%20available%2C%20use%20the%20second%20previously%2Dgenerated%20uniform%20random%2E%0A%20%20%20%20%20%20if%20%28x%20%21%3D%20null%29%20y%20%3D%20x%2C%20x%20%3D%20null%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Otherwise%2C%20generate%20a%20new%20x%20and%20y%2E%0A%20%20%20%20%20%20else%20do%20%7B%0A%20%20%20%20%20%20%20%20x%20%3D%20source%28%29%20%2A%202%20%2D%201%3B%0A%20%20%20%20%20%20%20%20y%20%3D%20source%28%29%20%2A%202%20%2D%201%3B%0A%20%20%20%20%20%20%20%20r%20%3D%20x%20%2A%20x%20%2B%20y%20%2A%20y%3B%0A%20%20%20%20%20%20%7D%20while%20%28%21r%20%7C%7C%20r%20%3E%201%29%3B%0A%0A%20%20%20%20%20%20return%20mu%20%2B%20sigma%20%2A%20y%20%2A%20Math%2Esqrt%28%2D2%20%2A%20Math%2Elog%28r%29%20%2F%20r%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20randomNormal%2Esource%20%3D%20sourceRandomNormal%3B%0A%0A%20%20return%20randomNormal%3B%0A%7D%29%28defaultSource%241%29%3B%0A%0Avar%20logNormal%20%3D%20%28function%20sourceRandomLogNormal%28source%29%20%7B%0A%20%20function%20randomLogNormal%28%29%20%7B%0A%20%20%20%20var%20randomNormal%20%3D%20normal%2Esource%28source%29%2Eapply%28this%2C%20arguments%29%3B%0A%20%20%20%20return%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20Math%2Eexp%28randomNormal%28%29%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20randomLogNormal%2Esource%20%3D%20sourceRandomLogNormal%3B%0A%0A%20%20return%20randomLogNormal%3B%0A%7D%29%28defaultSource%241%29%3B%0A%0Avar%20irwinHall%20%3D%20%28function%20sourceRandomIrwinHall%28source%29%20%7B%0A%20%20function%20randomIrwinHall%28n%29%20%7B%0A%20%20%20%20return%20function%28%29%20%7B%0A%20%20%20%20%20%20for%20%28var%20sum%20%3D%200%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20sum%20%2B%3D%20source%28%29%3B%0A%20%20%20%20%20%20return%20sum%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20randomIrwinHall%2Esource%20%3D%20sourceRandomIrwinHall%3B%0A%0A%20%20return%20randomIrwinHall%3B%0A%7D%29%28defaultSource%241%29%3B%0A%0Avar%20bates%20%3D%20%28function%20sourceRandomBates%28source%29%20%7B%0A%20%20function%20randomBates%28n%29%20%7B%0A%20%20%20%20var%20randomIrwinHall%20%3D%20irwinHall%2Esource%28source%29%28n%29%3B%0A%20%20%20%20return%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20randomIrwinHall%28%29%20%2F%20n%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20randomBates%2Esource%20%3D%20sourceRandomBates%3B%0A%0A%20%20return%20randomBates%3B%0A%7D%29%28defaultSource%241%29%3B%0A%0Avar%20exponential%241%20%3D%20%28function%20sourceRandomExponential%28source%29%20%7B%0A%20%20function%20randomExponential%28lambda%29%20%7B%0A%20%20%20%20return%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20%2DMath%2Elog%281%20%2D%20source%28%29%29%20%2F%20lambda%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20randomExponential%2Esource%20%3D%20sourceRandomExponential%3B%0A%0A%20%20return%20randomExponential%3B%0A%7D%29%28defaultSource%241%29%3B%0A%0Avar%20array%243%20%3D%20Array%2Eprototype%3B%0A%0Avar%20map%242%20%3D%20array%243%2Emap%3B%0Avar%20slice%245%20%3D%20array%243%2Eslice%3B%0A%0Avar%20implicit%20%3D%20%7Bname%3A%20%22implicit%22%7D%3B%0A%0Afunction%20ordinal%28range%29%20%7B%0A%20%20var%20index%20%3D%20map%241%28%29%2C%0A%20%20%20%20%20%20domain%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20unknown%20%3D%20implicit%3B%0A%0A%20%20range%20%3D%20range%20%3D%3D%20null%20%3F%20%5B%5D%20%3A%20slice%245%2Ecall%28range%29%3B%0A%0A%20%20function%20scale%28d%29%20%7B%0A%20%20%20%20var%20key%20%3D%20d%20%2B%20%22%22%2C%20i%20%3D%20index%2Eget%28key%29%3B%0A%20%20%20%20if%20%28%21i%29%20%7B%0A%20%20%20%20%20%20if%20%28unknown%20%21%3D%3D%20implicit%29%20return%20unknown%3B%0A%20%20%20%20%20%20index%2Eset%28key%2C%20i%20%3D%20domain%2Epush%28d%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20range%5B%28i%20%2D%201%29%20%25%20range%2Elength%5D%3B%0A%20%20%7D%0A%0A%20%20scale%2Edomain%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20domain%2Eslice%28%29%3B%0A%20%20%20%20domain%20%3D%20%5B%5D%2C%20index%20%3D%20map%241%28%29%3B%0A%20%20%20%20var%20i%20%3D%20%2D1%2C%20n%20%3D%20%5F%2Elength%2C%20d%2C%20key%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20if%20%28%21index%2Ehas%28key%20%3D%20%28d%20%3D%20%5F%5Bi%5D%29%20%2B%20%22%22%29%29%20index%2Eset%28key%2C%20domain%2Epush%28d%29%29%3B%0A%20%20%20%20return%20scale%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Erange%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28range%20%3D%20slice%245%2Ecall%28%5F%29%2C%20scale%29%20%3A%20range%2Eslice%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Eunknown%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28unknown%20%3D%20%5F%2C%20scale%29%20%3A%20unknown%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Ecopy%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20ordinal%28%29%0A%20%20%20%20%20%20%20%20%2Edomain%28domain%29%0A%20%20%20%20%20%20%20%20%2Erange%28range%29%0A%20%20%20%20%20%20%20%20%2Eunknown%28unknown%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20scale%3B%0A%7D%0A%0Afunction%20band%28%29%20%7B%0A%20%20var%20scale%20%3D%20ordinal%28%29%2Eunknown%28undefined%29%2C%0A%20%20%20%20%20%20domain%20%3D%20scale%2Edomain%2C%0A%20%20%20%20%20%20ordinalRange%20%3D%20scale%2Erange%2C%0A%20%20%20%20%20%20range%24%241%20%3D%20%5B0%2C%201%5D%2C%0A%20%20%20%20%20%20step%2C%0A%20%20%20%20%20%20bandwidth%2C%0A%20%20%20%20%20%20round%20%3D%20false%2C%0A%20%20%20%20%20%20paddingInner%20%3D%200%2C%0A%20%20%20%20%20%20paddingOuter%20%3D%200%2C%0A%20%20%20%20%20%20align%20%3D%200%2E5%3B%0A%0A%20%20delete%20scale%2Eunknown%3B%0A%0A%20%20function%20rescale%28%29%20%7B%0A%20%20%20%20var%20n%20%3D%20domain%28%29%2Elength%2C%0A%20%20%20%20%20%20%20%20reverse%20%3D%20range%24%241%5B1%5D%20%3C%20range%24%241%5B0%5D%2C%0A%20%20%20%20%20%20%20%20start%20%3D%20range%24%241%5Breverse%20%2D%200%5D%2C%0A%20%20%20%20%20%20%20%20stop%20%3D%20range%24%241%5B1%20%2D%20reverse%5D%3B%0A%20%20%20%20step%20%3D%20%28stop%20%2D%20start%29%20%2F%20Math%2Emax%281%2C%20n%20%2D%20paddingInner%20%2B%20paddingOuter%20%2A%202%29%3B%0A%20%20%20%20if%20%28round%29%20step%20%3D%20Math%2Efloor%28step%29%3B%0A%20%20%20%20start%20%2B%3D%20%28stop%20%2D%20start%20%2D%20step%20%2A%20%28n%20%2D%20paddingInner%29%29%20%2A%20align%3B%0A%20%20%20%20bandwidth%20%3D%20step%20%2A%20%281%20%2D%20paddingInner%29%3B%0A%20%20%20%20if%20%28round%29%20start%20%3D%20Math%2Eround%28start%29%2C%20bandwidth%20%3D%20Math%2Eround%28bandwidth%29%3B%0A%20%20%20%20var%20values%20%3D%20sequence%28n%29%2Emap%28function%28i%29%20%7B%20return%20start%20%2B%20step%20%2A%20i%3B%20%7D%29%3B%0A%20%20%20%20return%20ordinalRange%28reverse%20%3F%20values%2Ereverse%28%29%20%3A%20values%29%3B%0A%20%20%7D%0A%0A%20%20scale%2Edomain%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28domain%28%5F%29%2C%20rescale%28%29%29%20%3A%20domain%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Erange%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28range%24%241%20%3D%20%5B%2B%5F%5B0%5D%2C%20%2B%5F%5B1%5D%5D%2C%20rescale%28%29%29%20%3A%20range%24%241%2Eslice%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2ErangeRound%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20range%24%241%20%3D%20%5B%2B%5F%5B0%5D%2C%20%2B%5F%5B1%5D%5D%2C%20round%20%3D%20true%2C%20rescale%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Ebandwidth%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20bandwidth%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Estep%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20step%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Eround%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28round%20%3D%20%21%21%5F%2C%20rescale%28%29%29%20%3A%20round%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Epadding%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28paddingInner%20%3D%20paddingOuter%20%3D%20Math%2Emax%280%2C%20Math%2Emin%281%2C%20%5F%29%29%2C%20rescale%28%29%29%20%3A%20paddingInner%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2EpaddingInner%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28paddingInner%20%3D%20Math%2Emax%280%2C%20Math%2Emin%281%2C%20%5F%29%29%2C%20rescale%28%29%29%20%3A%20paddingInner%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2EpaddingOuter%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28paddingOuter%20%3D%20Math%2Emax%280%2C%20Math%2Emin%281%2C%20%5F%29%29%2C%20rescale%28%29%29%20%3A%20paddingOuter%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Ealign%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28align%20%3D%20Math%2Emax%280%2C%20Math%2Emin%281%2C%20%5F%29%29%2C%20rescale%28%29%29%20%3A%20align%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Ecopy%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20band%28%29%0A%20%20%20%20%20%20%20%20%2Edomain%28domain%28%29%29%0A%20%20%20%20%20%20%20%20%2Erange%28range%24%241%29%0A%20%20%20%20%20%20%20%20%2Eround%28round%29%0A%20%20%20%20%20%20%20%20%2EpaddingInner%28paddingInner%29%0A%20%20%20%20%20%20%20%20%2EpaddingOuter%28paddingOuter%29%0A%20%20%20%20%20%20%20%20%2Ealign%28align%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20rescale%28%29%3B%0A%7D%0A%0Afunction%20pointish%28scale%29%20%7B%0A%20%20var%20copy%20%3D%20scale%2Ecopy%3B%0A%0A%20%20scale%2Epadding%20%3D%20scale%2EpaddingOuter%3B%0A%20%20delete%20scale%2EpaddingInner%3B%0A%20%20delete%20scale%2EpaddingOuter%3B%0A%0A%20%20scale%2Ecopy%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20pointish%28copy%28%29%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20scale%3B%0A%7D%0A%0Afunction%20point%241%28%29%20%7B%0A%20%20return%20pointish%28band%28%29%2EpaddingInner%281%29%29%3B%0A%7D%0A%0Afunction%20constant%2410%28x%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20number%242%28x%29%20%7B%0A%20%20return%20%2Bx%3B%0A%7D%0A%0Avar%20unit%20%3D%20%5B0%2C%201%5D%3B%0A%0Afunction%20deinterpolateLinear%28a%2C%20b%29%20%7B%0A%20%20return%20%28b%20%2D%3D%20%28a%20%3D%20%2Ba%29%29%0A%20%20%20%20%20%20%3F%20function%28x%29%20%7B%20return%20%28x%20%2D%20a%29%20%2F%20b%3B%20%7D%0A%20%20%20%20%20%20%3A%20constant%2410%28b%29%3B%0A%7D%0A%0Afunction%20deinterpolateClamp%28deinterpolate%29%20%7B%0A%20%20return%20function%28a%2C%20b%29%20%7B%0A%20%20%20%20var%20d%20%3D%20deinterpolate%28a%20%3D%20%2Ba%2C%20b%20%3D%20%2Bb%29%3B%0A%20%20%20%20return%20function%28x%29%20%7B%20return%20x%20%3C%3D%20a%20%3F%200%20%3A%20x%20%3E%3D%20b%20%3F%201%20%3A%20d%28x%29%3B%20%7D%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20reinterpolateClamp%28reinterpolate%24%241%29%20%7B%0A%20%20return%20function%28a%2C%20b%29%20%7B%0A%20%20%20%20var%20r%20%3D%20reinterpolate%24%241%28a%20%3D%20%2Ba%2C%20b%20%3D%20%2Bb%29%3B%0A%20%20%20%20return%20function%28t%29%20%7B%20return%20t%20%3C%3D%200%20%3F%20a%20%3A%20t%20%3E%3D%201%20%3F%20b%20%3A%20r%28t%29%3B%20%7D%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20bimap%28domain%2C%20range%2C%20deinterpolate%2C%20reinterpolate%24%241%29%20%7B%0A%20%20var%20d0%20%3D%20domain%5B0%5D%2C%20d1%20%3D%20domain%5B1%5D%2C%20r0%20%3D%20range%5B0%5D%2C%20r1%20%3D%20range%5B1%5D%3B%0A%20%20if%20%28d1%20%3C%20d0%29%20d0%20%3D%20deinterpolate%28d1%2C%20d0%29%2C%20r0%20%3D%20reinterpolate%24%241%28r1%2C%20r0%29%3B%0A%20%20else%20d0%20%3D%20deinterpolate%28d0%2C%20d1%29%2C%20r0%20%3D%20reinterpolate%24%241%28r0%2C%20r1%29%3B%0A%20%20return%20function%28x%29%20%7B%20return%20r0%28d0%28x%29%29%3B%20%7D%3B%0A%7D%0A%0Afunction%20polymap%28domain%2C%20range%2C%20deinterpolate%2C%20reinterpolate%24%241%29%20%7B%0A%20%20var%20j%20%3D%20Math%2Emin%28domain%2Elength%2C%20range%2Elength%29%20%2D%201%2C%0A%20%20%20%20%20%20d%20%3D%20new%20Array%28j%29%2C%0A%20%20%20%20%20%20r%20%3D%20new%20Array%28j%29%2C%0A%20%20%20%20%20%20i%20%3D%20%2D1%3B%0A%0A%20%20%2F%2F%20Reverse%20descending%20domains%2E%0A%20%20if%20%28domain%5Bj%5D%20%3C%20domain%5B0%5D%29%20%7B%0A%20%20%20%20domain%20%3D%20domain%2Eslice%28%29%2Ereverse%28%29%3B%0A%20%20%20%20range%20%3D%20range%2Eslice%28%29%2Ereverse%28%29%3B%0A%20%20%7D%0A%0A%20%20while%20%28%2B%2Bi%20%3C%20j%29%20%7B%0A%20%20%20%20d%5Bi%5D%20%3D%20deinterpolate%28domain%5Bi%5D%2C%20domain%5Bi%20%2B%201%5D%29%3B%0A%20%20%20%20r%5Bi%5D%20%3D%20reinterpolate%24%241%28range%5Bi%5D%2C%20range%5Bi%20%2B%201%5D%29%3B%0A%20%20%7D%0A%0A%20%20return%20function%28x%29%20%7B%0A%20%20%20%20var%20i%20%3D%20bisectRight%28domain%2C%20x%2C%201%2C%20j%29%20%2D%201%3B%0A%20%20%20%20return%20r%5Bi%5D%28d%5Bi%5D%28x%29%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20copy%28source%2C%20target%29%20%7B%0A%20%20return%20target%0A%20%20%20%20%20%20%2Edomain%28source%2Edomain%28%29%29%0A%20%20%20%20%20%20%2Erange%28source%2Erange%28%29%29%0A%20%20%20%20%20%20%2Einterpolate%28source%2Einterpolate%28%29%29%0A%20%20%20%20%20%20%2Eclamp%28source%2Eclamp%28%29%29%3B%0A%7D%0A%0A%2F%2F%20deinterpolate%28a%2C%20b%29%28x%29%20takes%20a%20domain%20value%20x%20in%20%5Ba%2Cb%5D%20and%20returns%20the%20corresponding%20parameter%20t%20in%20%5B0%2C1%5D%2E%0A%2F%2F%20reinterpolate%28a%2C%20b%29%28t%29%20takes%20a%20parameter%20t%20in%20%5B0%2C1%5D%20and%20returns%20the%20corresponding%20domain%20value%20x%20in%20%5Ba%2Cb%5D%2E%0Afunction%20continuous%28deinterpolate%2C%20reinterpolate%24%241%29%20%7B%0A%20%20var%20domain%20%3D%20unit%2C%0A%20%20%20%20%20%20range%20%3D%20unit%2C%0A%20%20%20%20%20%20interpolate%24%241%20%3D%20interpolateValue%2C%0A%20%20%20%20%20%20clamp%20%3D%20false%2C%0A%20%20%20%20%20%20piecewise%2C%0A%20%20%20%20%20%20output%2C%0A%20%20%20%20%20%20input%3B%0A%0A%20%20function%20rescale%28%29%20%7B%0A%20%20%20%20piecewise%20%3D%20Math%2Emin%28domain%2Elength%2C%20range%2Elength%29%20%3E%202%20%3F%20polymap%20%3A%20bimap%3B%0A%20%20%20%20output%20%3D%20input%20%3D%20null%3B%0A%20%20%20%20return%20scale%3B%0A%20%20%7D%0A%0A%20%20function%20scale%28x%29%20%7B%0A%20%20%20%20return%20%28output%20%7C%7C%20%28output%20%3D%20piecewise%28domain%2C%20range%2C%20clamp%20%3F%20deinterpolateClamp%28deinterpolate%29%20%3A%20deinterpolate%2C%20interpolate%24%241%29%29%29%28%2Bx%29%3B%0A%20%20%7D%0A%0A%20%20scale%2Einvert%20%3D%20function%28y%29%20%7B%0A%20%20%20%20return%20%28input%20%7C%7C%20%28input%20%3D%20piecewise%28range%2C%20domain%2C%20deinterpolateLinear%2C%20clamp%20%3F%20reinterpolateClamp%28reinterpolate%24%241%29%20%3A%20reinterpolate%24%241%29%29%29%28%2By%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Edomain%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28domain%20%3D%20map%242%2Ecall%28%5F%2C%20number%242%29%2C%20rescale%28%29%29%20%3A%20domain%2Eslice%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Erange%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28range%20%3D%20slice%245%2Ecall%28%5F%29%2C%20rescale%28%29%29%20%3A%20range%2Eslice%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2ErangeRound%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20range%20%3D%20slice%245%2Ecall%28%5F%29%2C%20interpolate%24%241%20%3D%20interpolateRound%2C%20rescale%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Eclamp%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28clamp%20%3D%20%21%21%5F%2C%20rescale%28%29%29%20%3A%20clamp%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Einterpolate%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28interpolate%24%241%20%3D%20%5F%2C%20rescale%28%29%29%20%3A%20interpolate%24%241%3B%0A%20%20%7D%3B%0A%0A%20%20return%20rescale%28%29%3B%0A%7D%0A%0Afunction%20tickFormat%28domain%2C%20count%2C%20specifier%29%20%7B%0A%20%20var%20start%20%3D%20domain%5B0%5D%2C%0A%20%20%20%20%20%20stop%20%3D%20domain%5Bdomain%2Elength%20%2D%201%5D%2C%0A%20%20%20%20%20%20step%20%3D%20tickStep%28start%2C%20stop%2C%20count%20%3D%3D%20null%20%3F%2010%20%3A%20count%29%2C%0A%20%20%20%20%20%20precision%3B%0A%20%20specifier%20%3D%20formatSpecifier%28specifier%20%3D%3D%20null%20%3F%20%22%2Cf%22%20%3A%20specifier%29%3B%0A%20%20switch%20%28specifier%2Etype%29%20%7B%0A%20%20%20%20case%20%22s%22%3A%20%7B%0A%20%20%20%20%20%20var%20value%20%3D%20Math%2Emax%28Math%2Eabs%28start%29%2C%20Math%2Eabs%28stop%29%29%3B%0A%20%20%20%20%20%20if%20%28specifier%2Eprecision%20%3D%3D%20null%20%26%26%20%21isNaN%28precision%20%3D%20precisionPrefix%28step%2C%20value%29%29%29%20specifier%2Eprecision%20%3D%20precision%3B%0A%20%20%20%20%20%20return%20exports%2EformatPrefix%28specifier%2C%20value%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20case%20%22%22%3A%0A%20%20%20%20case%20%22e%22%3A%0A%20%20%20%20case%20%22g%22%3A%0A%20%20%20%20case%20%22p%22%3A%0A%20%20%20%20case%20%22r%22%3A%20%7B%0A%20%20%20%20%20%20if%20%28specifier%2Eprecision%20%3D%3D%20null%20%26%26%20%21isNaN%28precision%20%3D%20precisionRound%28step%2C%20Math%2Emax%28Math%2Eabs%28start%29%2C%20Math%2Eabs%28stop%29%29%29%29%29%20specifier%2Eprecision%20%3D%20precision%20%2D%20%28specifier%2Etype%20%3D%3D%3D%20%22e%22%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20case%20%22f%22%3A%0A%20%20%20%20case%20%22%25%22%3A%20%7B%0A%20%20%20%20%20%20if%20%28specifier%2Eprecision%20%3D%3D%20null%20%26%26%20%21isNaN%28precision%20%3D%20precisionFixed%28step%29%29%29%20specifier%2Eprecision%20%3D%20precision%20%2D%20%28specifier%2Etype%20%3D%3D%3D%20%22%25%22%29%20%2A%202%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20exports%2Eformat%28specifier%29%3B%0A%7D%0A%0Afunction%20linearish%28scale%29%20%7B%0A%20%20var%20domain%20%3D%20scale%2Edomain%3B%0A%0A%20%20scale%2Eticks%20%3D%20function%28count%29%20%7B%0A%20%20%20%20var%20d%20%3D%20domain%28%29%3B%0A%20%20%20%20return%20ticks%28d%5B0%5D%2C%20d%5Bd%2Elength%20%2D%201%5D%2C%20count%20%3D%3D%20null%20%3F%2010%20%3A%20count%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2EtickFormat%20%3D%20function%28count%2C%20specifier%29%20%7B%0A%20%20%20%20return%20tickFormat%28domain%28%29%2C%20count%2C%20specifier%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Enice%20%3D%20function%28count%29%20%7B%0A%20%20%20%20if%20%28count%20%3D%3D%20null%29%20count%20%3D%2010%3B%0A%0A%20%20%20%20var%20d%20%3D%20domain%28%29%2C%0A%20%20%20%20%20%20%20%20i0%20%3D%200%2C%0A%20%20%20%20%20%20%20%20i1%20%3D%20d%2Elength%20%2D%201%2C%0A%20%20%20%20%20%20%20%20start%20%3D%20d%5Bi0%5D%2C%0A%20%20%20%20%20%20%20%20stop%20%3D%20d%5Bi1%5D%2C%0A%20%20%20%20%20%20%20%20step%3B%0A%0A%20%20%20%20if%20%28stop%20%3C%20start%29%20%7B%0A%20%20%20%20%20%20step%20%3D%20start%2C%20start%20%3D%20stop%2C%20stop%20%3D%20step%3B%0A%20%20%20%20%20%20step%20%3D%20i0%2C%20i0%20%3D%20i1%2C%20i1%20%3D%20step%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20step%20%3D%20tickIncrement%28start%2C%20stop%2C%20count%29%3B%0A%0A%20%20%20%20if%20%28step%20%3E%200%29%20%7B%0A%20%20%20%20%20%20start%20%3D%20Math%2Efloor%28start%20%2F%20step%29%20%2A%20step%3B%0A%20%20%20%20%20%20stop%20%3D%20Math%2Eceil%28stop%20%2F%20step%29%20%2A%20step%3B%0A%20%20%20%20%20%20step%20%3D%20tickIncrement%28start%2C%20stop%2C%20count%29%3B%0A%20%20%20%20%7D%20else%20if%20%28step%20%3C%200%29%20%7B%0A%20%20%20%20%20%20start%20%3D%20Math%2Eceil%28start%20%2A%20step%29%20%2F%20step%3B%0A%20%20%20%20%20%20stop%20%3D%20Math%2Efloor%28stop%20%2A%20step%29%20%2F%20step%3B%0A%20%20%20%20%20%20step%20%3D%20tickIncrement%28start%2C%20stop%2C%20count%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28step%20%3E%200%29%20%7B%0A%20%20%20%20%20%20d%5Bi0%5D%20%3D%20Math%2Efloor%28start%20%2F%20step%29%20%2A%20step%3B%0A%20%20%20%20%20%20d%5Bi1%5D%20%3D%20Math%2Eceil%28stop%20%2F%20step%29%20%2A%20step%3B%0A%20%20%20%20%20%20domain%28d%29%3B%0A%20%20%20%20%7D%20else%20if%20%28step%20%3C%200%29%20%7B%0A%20%20%20%20%20%20d%5Bi0%5D%20%3D%20Math%2Eceil%28start%20%2A%20step%29%20%2F%20step%3B%0A%20%20%20%20%20%20d%5Bi1%5D%20%3D%20Math%2Efloor%28stop%20%2A%20step%29%20%2F%20step%3B%0A%20%20%20%20%20%20domain%28d%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20scale%3B%0A%20%20%7D%3B%0A%0A%20%20return%20scale%3B%0A%7D%0A%0Afunction%20linear%242%28%29%20%7B%0A%20%20var%20scale%20%3D%20continuous%28deinterpolateLinear%2C%20reinterpolate%29%3B%0A%0A%20%20scale%2Ecopy%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20copy%28scale%2C%20linear%242%28%29%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20linearish%28scale%29%3B%0A%7D%0A%0Afunction%20identity%246%28%29%20%7B%0A%20%20var%20domain%20%3D%20%5B0%2C%201%5D%3B%0A%0A%20%20function%20scale%28x%29%20%7B%0A%20%20%20%20return%20%2Bx%3B%0A%20%20%7D%0A%0A%20%20scale%2Einvert%20%3D%20scale%3B%0A%0A%20%20scale%2Edomain%20%3D%20scale%2Erange%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28domain%20%3D%20map%242%2Ecall%28%5F%2C%20number%242%29%2C%20scale%29%20%3A%20domain%2Eslice%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Ecopy%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20identity%246%28%29%2Edomain%28domain%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20linearish%28scale%29%3B%0A%7D%0A%0Afunction%20nice%28domain%2C%20interval%29%20%7B%0A%20%20domain%20%3D%20domain%2Eslice%28%29%3B%0A%0A%20%20var%20i0%20%3D%200%2C%0A%20%20%20%20%20%20i1%20%3D%20domain%2Elength%20%2D%201%2C%0A%20%20%20%20%20%20x0%20%3D%20domain%5Bi0%5D%2C%0A%20%20%20%20%20%20x1%20%3D%20domain%5Bi1%5D%2C%0A%20%20%20%20%20%20t%3B%0A%0A%20%20if%20%28x1%20%3C%20x0%29%20%7B%0A%20%20%20%20t%20%3D%20i0%2C%20i0%20%3D%20i1%2C%20i1%20%3D%20t%3B%0A%20%20%20%20t%20%3D%20x0%2C%20x0%20%3D%20x1%2C%20x1%20%3D%20t%3B%0A%20%20%7D%0A%0A%20%20domain%5Bi0%5D%20%3D%20interval%2Efloor%28x0%29%3B%0A%20%20domain%5Bi1%5D%20%3D%20interval%2Eceil%28x1%29%3B%0A%20%20return%20domain%3B%0A%7D%0A%0Afunction%20deinterpolate%28a%2C%20b%29%20%7B%0A%20%20return%20%28b%20%3D%20Math%2Elog%28b%20%2F%20a%29%29%0A%20%20%20%20%20%20%3F%20function%28x%29%20%7B%20return%20Math%2Elog%28x%20%2F%20a%29%20%2F%20b%3B%20%7D%0A%20%20%20%20%20%20%3A%20constant%2410%28b%29%3B%0A%7D%0A%0Afunction%20reinterpolate%241%28a%2C%20b%29%20%7B%0A%20%20return%20a%20%3C%200%0A%20%20%20%20%20%20%3F%20function%28t%29%20%7B%20return%20%2DMath%2Epow%28%2Db%2C%20t%29%20%2A%20Math%2Epow%28%2Da%2C%201%20%2D%20t%29%3B%20%7D%0A%20%20%20%20%20%20%3A%20function%28t%29%20%7B%20return%20Math%2Epow%28b%2C%20t%29%20%2A%20Math%2Epow%28a%2C%201%20%2D%20t%29%3B%20%7D%3B%0A%7D%0A%0Afunction%20pow10%28x%29%20%7B%0A%20%20return%20isFinite%28x%29%20%3F%20%2B%28%221e%22%20%2B%20x%29%20%3A%20x%20%3C%200%20%3F%200%20%3A%20x%3B%0A%7D%0A%0Afunction%20powp%28base%29%20%7B%0A%20%20return%20base%20%3D%3D%3D%2010%20%3F%20pow10%0A%20%20%20%20%20%20%3A%20base%20%3D%3D%3D%20Math%2EE%20%3F%20Math%2Eexp%0A%20%20%20%20%20%20%3A%20function%28x%29%20%7B%20return%20Math%2Epow%28base%2C%20x%29%3B%20%7D%3B%0A%7D%0A%0Afunction%20logp%28base%29%20%7B%0A%20%20return%20base%20%3D%3D%3D%20Math%2EE%20%3F%20Math%2Elog%0A%20%20%20%20%20%20%3A%20base%20%3D%3D%3D%2010%20%26%26%20Math%2Elog10%0A%20%20%20%20%20%20%7C%7C%20base%20%3D%3D%3D%202%20%26%26%20Math%2Elog2%0A%20%20%20%20%20%20%7C%7C%20%28base%20%3D%20Math%2Elog%28base%29%2C%20function%28x%29%20%7B%20return%20Math%2Elog%28x%29%20%2F%20base%3B%20%7D%29%3B%0A%7D%0A%0Afunction%20reflect%28f%29%20%7B%0A%20%20return%20function%28x%29%20%7B%0A%20%20%20%20return%20%2Df%28%2Dx%29%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20log%241%28%29%20%7B%0A%20%20var%20scale%20%3D%20continuous%28deinterpolate%2C%20reinterpolate%241%29%2Edomain%28%5B1%2C%2010%5D%29%2C%0A%20%20%20%20%20%20domain%20%3D%20scale%2Edomain%2C%0A%20%20%20%20%20%20base%20%3D%2010%2C%0A%20%20%20%20%20%20logs%20%3D%20logp%2810%29%2C%0A%20%20%20%20%20%20pows%20%3D%20powp%2810%29%3B%0A%0A%20%20function%20rescale%28%29%20%7B%0A%20%20%20%20logs%20%3D%20logp%28base%29%2C%20pows%20%3D%20powp%28base%29%3B%0A%20%20%20%20if%20%28domain%28%29%5B0%5D%20%3C%200%29%20logs%20%3D%20reflect%28logs%29%2C%20pows%20%3D%20reflect%28pows%29%3B%0A%20%20%20%20return%20scale%3B%0A%20%20%7D%0A%0A%20%20scale%2Ebase%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28base%20%3D%20%2B%5F%2C%20rescale%28%29%29%20%3A%20base%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Edomain%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28domain%28%5F%29%2C%20rescale%28%29%29%20%3A%20domain%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Eticks%20%3D%20function%28count%29%20%7B%0A%20%20%20%20var%20d%20%3D%20domain%28%29%2C%0A%20%20%20%20%20%20%20%20u%20%3D%20d%5B0%5D%2C%0A%20%20%20%20%20%20%20%20v%20%3D%20d%5Bd%2Elength%20%2D%201%5D%2C%0A%20%20%20%20%20%20%20%20r%3B%0A%0A%20%20%20%20if%20%28r%20%3D%20v%20%3C%20u%29%20i%20%3D%20u%2C%20u%20%3D%20v%2C%20v%20%3D%20i%3B%0A%0A%20%20%20%20var%20i%20%3D%20logs%28u%29%2C%0A%20%20%20%20%20%20%20%20j%20%3D%20logs%28v%29%2C%0A%20%20%20%20%20%20%20%20p%2C%0A%20%20%20%20%20%20%20%20k%2C%0A%20%20%20%20%20%20%20%20t%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20count%20%3D%3D%20null%20%3F%2010%20%3A%20%2Bcount%2C%0A%20%20%20%20%20%20%20%20z%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20if%20%28%21%28base%20%25%201%29%20%26%26%20j%20%2D%20i%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20i%20%3D%20Math%2Eround%28i%29%20%2D%201%2C%20j%20%3D%20Math%2Eround%28j%29%20%2B%201%3B%0A%20%20%20%20%20%20if%20%28u%20%3E%200%29%20for%20%28%3B%20i%20%3C%20j%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28k%20%3D%201%2C%20p%20%3D%20pows%28i%29%3B%20k%20%3C%20base%3B%20%2B%2Bk%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20t%20%3D%20p%20%2A%20k%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3C%20u%29%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3E%20v%29%20break%3B%0A%20%20%20%20%20%20%20%20%20%20z%2Epush%28t%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20for%20%28%3B%20i%20%3C%20j%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28k%20%3D%20base%20%2D%201%2C%20p%20%3D%20pows%28i%29%3B%20k%20%3E%3D%201%3B%20%2D%2Dk%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20t%20%3D%20p%20%2A%20k%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3C%20u%29%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3E%20v%29%20break%3B%0A%20%20%20%20%20%20%20%20%20%20z%2Epush%28t%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20z%20%3D%20ticks%28i%2C%20j%2C%20Math%2Emin%28j%20%2D%20i%2C%20n%29%29%2Emap%28pows%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20r%20%3F%20z%2Ereverse%28%29%20%3A%20z%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2EtickFormat%20%3D%20function%28count%2C%20specifier%29%20%7B%0A%20%20%20%20if%20%28specifier%20%3D%3D%20null%29%20specifier%20%3D%20base%20%3D%3D%3D%2010%20%3F%20%22%2E0e%22%20%3A%20%22%2C%22%3B%0A%20%20%20%20if%20%28typeof%20specifier%20%21%3D%3D%20%22function%22%29%20specifier%20%3D%20exports%2Eformat%28specifier%29%3B%0A%20%20%20%20if%20%28count%20%3D%3D%3D%20Infinity%29%20return%20specifier%3B%0A%20%20%20%20if%20%28count%20%3D%3D%20null%29%20count%20%3D%2010%3B%0A%20%20%20%20var%20k%20%3D%20Math%2Emax%281%2C%20base%20%2A%20count%20%2F%20scale%2Eticks%28%29%2Elength%29%3B%20%2F%2F%20TODO%20fast%20estimate%3F%0A%20%20%20%20return%20function%28d%29%20%7B%0A%20%20%20%20%20%20var%20i%20%3D%20d%20%2F%20pows%28Math%2Eround%28logs%28d%29%29%29%3B%0A%20%20%20%20%20%20if%20%28i%20%2A%20base%20%3C%20base%20%2D%200%2E5%29%20i%20%2A%3D%20base%3B%0A%20%20%20%20%20%20return%20i%20%3C%3D%20k%20%3F%20specifier%28d%29%20%3A%20%22%22%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Enice%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20domain%28nice%28domain%28%29%2C%20%7B%0A%20%20%20%20%20%20floor%3A%20function%28x%29%20%7B%20return%20pows%28Math%2Efloor%28logs%28x%29%29%29%3B%20%7D%2C%0A%20%20%20%20%20%20ceil%3A%20function%28x%29%20%7B%20return%20pows%28Math%2Eceil%28logs%28x%29%29%29%3B%20%7D%0A%20%20%20%20%7D%29%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Ecopy%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20copy%28scale%2C%20log%241%28%29%2Ebase%28base%29%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20scale%3B%0A%7D%0A%0Afunction%20raise%241%28x%2C%20exponent%29%20%7B%0A%20%20return%20x%20%3C%200%20%3F%20%2DMath%2Epow%28%2Dx%2C%20exponent%29%20%3A%20Math%2Epow%28x%2C%20exponent%29%3B%0A%7D%0A%0Afunction%20pow%241%28%29%20%7B%0A%20%20var%20exponent%20%3D%201%2C%0A%20%20%20%20%20%20scale%20%3D%20continuous%28deinterpolate%2C%20reinterpolate%29%2C%0A%20%20%20%20%20%20domain%20%3D%20scale%2Edomain%3B%0A%0A%20%20function%20deinterpolate%28a%2C%20b%29%20%7B%0A%20%20%20%20return%20%28b%20%3D%20raise%241%28b%2C%20exponent%29%20%2D%20%28a%20%3D%20raise%241%28a%2C%20exponent%29%29%29%0A%20%20%20%20%20%20%20%20%3F%20function%28x%29%20%7B%20return%20%28raise%241%28x%2C%20exponent%29%20%2D%20a%29%20%2F%20b%3B%20%7D%0A%20%20%20%20%20%20%20%20%3A%20constant%2410%28b%29%3B%0A%20%20%7D%0A%0A%20%20function%20reinterpolate%28a%2C%20b%29%20%7B%0A%20%20%20%20b%20%3D%20raise%241%28b%2C%20exponent%29%20%2D%20%28a%20%3D%20raise%241%28a%2C%20exponent%29%29%3B%0A%20%20%20%20return%20function%28t%29%20%7B%20return%20raise%241%28a%20%2B%20b%20%2A%20t%2C%201%20%2F%20exponent%29%3B%20%7D%3B%0A%20%20%7D%0A%0A%20%20scale%2Eexponent%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28exponent%20%3D%20%2B%5F%2C%20domain%28domain%28%29%29%29%20%3A%20exponent%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Ecopy%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20copy%28scale%2C%20pow%241%28%29%2Eexponent%28exponent%29%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20linearish%28scale%29%3B%0A%7D%0A%0Afunction%20sqrt%241%28%29%20%7B%0A%20%20return%20pow%241%28%29%2Eexponent%280%2E5%29%3B%0A%7D%0A%0Afunction%20quantile%24%241%28%29%20%7B%0A%20%20var%20domain%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20range%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20thresholds%20%3D%20%5B%5D%3B%0A%0A%20%20function%20rescale%28%29%20%7B%0A%20%20%20%20var%20i%20%3D%200%2C%20n%20%3D%20Math%2Emax%281%2C%20range%2Elength%29%3B%0A%20%20%20%20thresholds%20%3D%20new%20Array%28n%20%2D%201%29%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20thresholds%5Bi%20%2D%201%5D%20%3D%20threshold%28domain%2C%20i%20%2F%20n%29%3B%0A%20%20%20%20return%20scale%3B%0A%20%20%7D%0A%0A%20%20function%20scale%28x%29%20%7B%0A%20%20%20%20if%20%28%21isNaN%28x%20%3D%20%2Bx%29%29%20return%20range%5BbisectRight%28thresholds%2C%20x%29%5D%3B%0A%20%20%7D%0A%0A%20%20scale%2EinvertExtent%20%3D%20function%28y%29%20%7B%0A%20%20%20%20var%20i%20%3D%20range%2EindexOf%28y%29%3B%0A%20%20%20%20return%20i%20%3C%200%20%3F%20%5BNaN%2C%20NaN%5D%20%3A%20%5B%0A%20%20%20%20%20%20i%20%3E%200%20%3F%20thresholds%5Bi%20%2D%201%5D%20%3A%20domain%5B0%5D%2C%0A%20%20%20%20%20%20i%20%3C%20thresholds%2Elength%20%3F%20thresholds%5Bi%5D%20%3A%20domain%5Bdomain%2Elength%20%2D%201%5D%0A%20%20%20%20%5D%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Edomain%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20if%20%28%21arguments%2Elength%29%20return%20domain%2Eslice%28%29%3B%0A%20%20%20%20domain%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20%5F%2Elength%2C%20d%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20if%20%28d%20%3D%20%5F%5Bi%5D%2C%20d%20%21%3D%20null%20%26%26%20%21isNaN%28d%20%3D%20%2Bd%29%29%20domain%2Epush%28d%29%3B%0A%20%20%20%20domain%2Esort%28ascending%29%3B%0A%20%20%20%20return%20rescale%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Erange%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28range%20%3D%20slice%245%2Ecall%28%5F%29%2C%20rescale%28%29%29%20%3A%20range%2Eslice%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Equantiles%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20thresholds%2Eslice%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Ecopy%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20quantile%24%241%28%29%0A%20%20%20%20%20%20%20%20%2Edomain%28domain%29%0A%20%20%20%20%20%20%20%20%2Erange%28range%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20scale%3B%0A%7D%0A%0Afunction%20quantize%241%28%29%20%7B%0A%20%20var%20x0%20%3D%200%2C%0A%20%20%20%20%20%20x1%20%3D%201%2C%0A%20%20%20%20%20%20n%20%3D%201%2C%0A%20%20%20%20%20%20domain%20%3D%20%5B0%2E5%5D%2C%0A%20%20%20%20%20%20range%20%3D%20%5B0%2C%201%5D%3B%0A%0A%20%20function%20scale%28x%29%20%7B%0A%20%20%20%20if%20%28x%20%3C%3D%20x%29%20return%20range%5BbisectRight%28domain%2C%20x%2C%200%2C%20n%29%5D%3B%0A%20%20%7D%0A%0A%20%20function%20rescale%28%29%20%7B%0A%20%20%20%20var%20i%20%3D%20%2D1%3B%0A%20%20%20%20domain%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20domain%5Bi%5D%20%3D%20%28%28i%20%2B%201%29%20%2A%20x1%20%2D%20%28i%20%2D%20n%29%20%2A%20x0%29%20%2F%20%28n%20%2B%201%29%3B%0A%20%20%20%20return%20scale%3B%0A%20%20%7D%0A%0A%20%20scale%2Edomain%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28x0%20%3D%20%2B%5F%5B0%5D%2C%20x1%20%3D%20%2B%5F%5B1%5D%2C%20rescale%28%29%29%20%3A%20%5Bx0%2C%20x1%5D%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Erange%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28n%20%3D%20%28range%20%3D%20slice%245%2Ecall%28%5F%29%29%2Elength%20%2D%201%2C%20rescale%28%29%29%20%3A%20range%2Eslice%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2EinvertExtent%20%3D%20function%28y%29%20%7B%0A%20%20%20%20var%20i%20%3D%20range%2EindexOf%28y%29%3B%0A%20%20%20%20return%20i%20%3C%200%20%3F%20%5BNaN%2C%20NaN%5D%0A%20%20%20%20%20%20%20%20%3A%20i%20%3C%201%20%3F%20%5Bx0%2C%20domain%5B0%5D%5D%0A%20%20%20%20%20%20%20%20%3A%20i%20%3E%3D%20n%20%3F%20%5Bdomain%5Bn%20%2D%201%5D%2C%20x1%5D%0A%20%20%20%20%20%20%20%20%3A%20%5Bdomain%5Bi%20%2D%201%5D%2C%20domain%5Bi%5D%5D%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Ecopy%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20quantize%241%28%29%0A%20%20%20%20%20%20%20%20%2Edomain%28%5Bx0%2C%20x1%5D%29%0A%20%20%20%20%20%20%20%20%2Erange%28range%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20linearish%28scale%29%3B%0A%7D%0A%0Afunction%20threshold%241%28%29%20%7B%0A%20%20var%20domain%20%3D%20%5B0%2E5%5D%2C%0A%20%20%20%20%20%20range%20%3D%20%5B0%2C%201%5D%2C%0A%20%20%20%20%20%20n%20%3D%201%3B%0A%0A%20%20function%20scale%28x%29%20%7B%0A%20%20%20%20if%20%28x%20%3C%3D%20x%29%20return%20range%5BbisectRight%28domain%2C%20x%2C%200%2C%20n%29%5D%3B%0A%20%20%7D%0A%0A%20%20scale%2Edomain%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28domain%20%3D%20slice%245%2Ecall%28%5F%29%2C%20n%20%3D%20Math%2Emin%28domain%2Elength%2C%20range%2Elength%20%2D%201%29%2C%20scale%29%20%3A%20domain%2Eslice%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Erange%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28range%20%3D%20slice%245%2Ecall%28%5F%29%2C%20n%20%3D%20Math%2Emin%28domain%2Elength%2C%20range%2Elength%20%2D%201%29%2C%20scale%29%20%3A%20range%2Eslice%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2EinvertExtent%20%3D%20function%28y%29%20%7B%0A%20%20%20%20var%20i%20%3D%20range%2EindexOf%28y%29%3B%0A%20%20%20%20return%20%5Bdomain%5Bi%20%2D%201%5D%2C%20domain%5Bi%5D%5D%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Ecopy%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20threshold%241%28%29%0A%20%20%20%20%20%20%20%20%2Edomain%28domain%29%0A%20%20%20%20%20%20%20%20%2Erange%28range%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20scale%3B%0A%7D%0A%0Avar%20t0%241%20%3D%20new%20Date%2C%0A%20%20%20%20t1%241%20%3D%20new%20Date%3B%0A%0Afunction%20newInterval%28floori%2C%20offseti%2C%20count%2C%20field%29%20%7B%0A%0A%20%20function%20interval%28date%29%20%7B%0A%20%20%20%20return%20floori%28date%20%3D%20new%20Date%28%2Bdate%29%29%2C%20date%3B%0A%20%20%7D%0A%0A%20%20interval%2Efloor%20%3D%20interval%3B%0A%0A%20%20interval%2Eceil%20%3D%20function%28date%29%20%7B%0A%20%20%20%20return%20floori%28date%20%3D%20new%20Date%28date%20%2D%201%29%29%2C%20offseti%28date%2C%201%29%2C%20floori%28date%29%2C%20date%3B%0A%20%20%7D%3B%0A%0A%20%20interval%2Eround%20%3D%20function%28date%29%20%7B%0A%20%20%20%20var%20d0%20%3D%20interval%28date%29%2C%0A%20%20%20%20%20%20%20%20d1%20%3D%20interval%2Eceil%28date%29%3B%0A%20%20%20%20return%20date%20%2D%20d0%20%3C%20d1%20%2D%20date%20%3F%20d0%20%3A%20d1%3B%0A%20%20%7D%3B%0A%0A%20%20interval%2Eoffset%20%3D%20function%28date%2C%20step%29%20%7B%0A%20%20%20%20return%20offseti%28date%20%3D%20new%20Date%28%2Bdate%29%2C%20step%20%3D%3D%20null%20%3F%201%20%3A%20Math%2Efloor%28step%29%29%2C%20date%3B%0A%20%20%7D%3B%0A%0A%20%20interval%2Erange%20%3D%20function%28start%2C%20stop%2C%20step%29%20%7B%0A%20%20%20%20var%20range%20%3D%20%5B%5D%2C%20previous%3B%0A%20%20%20%20start%20%3D%20interval%2Eceil%28start%29%3B%0A%20%20%20%20step%20%3D%20step%20%3D%3D%20null%20%3F%201%20%3A%20Math%2Efloor%28step%29%3B%0A%20%20%20%20if%20%28%21%28start%20%3C%20stop%29%20%7C%7C%20%21%28step%20%3E%200%29%29%20return%20range%3B%20%2F%2F%20also%20handles%20Invalid%20Date%0A%20%20%20%20do%20range%2Epush%28previous%20%3D%20new%20Date%28%2Bstart%29%29%2C%20offseti%28start%2C%20step%29%2C%20floori%28start%29%3B%0A%20%20%20%20while%20%28previous%20%3C%20start%20%26%26%20start%20%3C%20stop%29%3B%0A%20%20%20%20return%20range%3B%0A%20%20%7D%3B%0A%0A%20%20interval%2Efilter%20%3D%20function%28test%29%20%7B%0A%20%20%20%20return%20newInterval%28function%28date%29%20%7B%0A%20%20%20%20%20%20if%20%28date%20%3E%3D%20date%29%20while%20%28floori%28date%29%2C%20%21test%28date%29%29%20date%2EsetTime%28date%20%2D%201%29%3B%0A%20%20%20%20%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20%20%20%20%20if%20%28date%20%3E%3D%20date%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28step%20%3C%200%29%20while%20%28%2B%2Bstep%20%3C%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20while%20%28offseti%28date%2C%20%2D1%29%2C%20%21test%28date%29%29%20%7B%7D%20%2F%2F%20eslint%2Ddisable%2Dline%20no%2Dempty%0A%20%20%20%20%20%20%20%20%7D%20else%20while%20%28%2D%2Dstep%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20while%20%28offseti%28date%2C%20%2B1%29%2C%20%21test%28date%29%29%20%7B%7D%20%2F%2F%20eslint%2Ddisable%2Dline%20no%2Dempty%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%3B%0A%0A%20%20if%20%28count%29%20%7B%0A%20%20%20%20interval%2Ecount%20%3D%20function%28start%2C%20end%29%20%7B%0A%20%20%20%20%20%20t0%241%2EsetTime%28%2Bstart%29%2C%20t1%241%2EsetTime%28%2Bend%29%3B%0A%20%20%20%20%20%20floori%28t0%241%29%2C%20floori%28t1%241%29%3B%0A%20%20%20%20%20%20return%20Math%2Efloor%28count%28t0%241%2C%20t1%241%29%29%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20interval%2Eevery%20%3D%20function%28step%29%20%7B%0A%20%20%20%20%20%20step%20%3D%20Math%2Efloor%28step%29%3B%0A%20%20%20%20%20%20return%20%21isFinite%28step%29%20%7C%7C%20%21%28step%20%3E%200%29%20%3F%20null%0A%20%20%20%20%20%20%20%20%20%20%3A%20%21%28step%20%3E%201%29%20%3F%20interval%0A%20%20%20%20%20%20%20%20%20%20%3A%20interval%2Efilter%28field%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3F%20function%28d%29%20%7B%20return%20field%28d%29%20%25%20step%20%3D%3D%3D%200%3B%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20function%28d%29%20%7B%20return%20interval%2Ecount%280%2C%20d%29%20%25%20step%20%3D%3D%3D%200%3B%20%7D%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20return%20interval%3B%0A%7D%0A%0Avar%20millisecond%20%3D%20newInterval%28function%28%29%20%7B%0A%20%20%2F%2F%20noop%0A%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20date%2EsetTime%28%2Bdate%20%2B%20step%29%3B%0A%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20return%20end%20%2D%20start%3B%0A%7D%29%3B%0A%0A%2F%2F%20An%20optimized%20implementation%20for%20this%20simple%20case%2E%0Amillisecond%2Eevery%20%3D%20function%28k%29%20%7B%0A%20%20k%20%3D%20Math%2Efloor%28k%29%3B%0A%20%20if%20%28%21isFinite%28k%29%20%7C%7C%20%21%28k%20%3E%200%29%29%20return%20null%3B%0A%20%20if%20%28%21%28k%20%3E%201%29%29%20return%20millisecond%3B%0A%20%20return%20newInterval%28function%28date%29%20%7B%0A%20%20%20%20date%2EsetTime%28Math%2Efloor%28date%20%2F%20k%29%20%2A%20k%29%3B%0A%20%20%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20%20%20date%2EsetTime%28%2Bdate%20%2B%20step%20%2A%20k%29%3B%0A%20%20%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20%20%20return%20%28end%20%2D%20start%29%20%2F%20k%3B%0A%20%20%7D%29%3B%0A%7D%3B%0Avar%20milliseconds%20%3D%20millisecond%2Erange%3B%0A%0Avar%20durationSecond%20%3D%201e3%3B%0Avar%20durationMinute%20%3D%206e4%3B%0Avar%20durationHour%20%3D%2036e5%3B%0Avar%20durationDay%20%3D%20864e5%3B%0Avar%20durationWeek%20%3D%206048e5%3B%0A%0Avar%20second%20%3D%20newInterval%28function%28date%29%20%7B%0A%20%20date%2EsetTime%28Math%2Efloor%28date%20%2F%20durationSecond%29%20%2A%20durationSecond%29%3B%0A%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20date%2EsetTime%28%2Bdate%20%2B%20step%20%2A%20durationSecond%29%3B%0A%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20return%20%28end%20%2D%20start%29%20%2F%20durationSecond%3B%0A%7D%2C%20function%28date%29%20%7B%0A%20%20return%20date%2EgetUTCSeconds%28%29%3B%0A%7D%29%3B%0Avar%20seconds%20%3D%20second%2Erange%3B%0A%0Avar%20minute%20%3D%20newInterval%28function%28date%29%20%7B%0A%20%20date%2EsetTime%28Math%2Efloor%28date%20%2F%20durationMinute%29%20%2A%20durationMinute%29%3B%0A%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20date%2EsetTime%28%2Bdate%20%2B%20step%20%2A%20durationMinute%29%3B%0A%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20return%20%28end%20%2D%20start%29%20%2F%20durationMinute%3B%0A%7D%2C%20function%28date%29%20%7B%0A%20%20return%20date%2EgetMinutes%28%29%3B%0A%7D%29%3B%0Avar%20minutes%20%3D%20minute%2Erange%3B%0A%0Avar%20hour%20%3D%20newInterval%28function%28date%29%20%7B%0A%20%20var%20offset%20%3D%20date%2EgetTimezoneOffset%28%29%20%2A%20durationMinute%20%25%20durationHour%3B%0A%20%20if%20%28offset%20%3C%200%29%20offset%20%2B%3D%20durationHour%3B%0A%20%20date%2EsetTime%28Math%2Efloor%28%28%2Bdate%20%2D%20offset%29%20%2F%20durationHour%29%20%2A%20durationHour%20%2B%20offset%29%3B%0A%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20date%2EsetTime%28%2Bdate%20%2B%20step%20%2A%20durationHour%29%3B%0A%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20return%20%28end%20%2D%20start%29%20%2F%20durationHour%3B%0A%7D%2C%20function%28date%29%20%7B%0A%20%20return%20date%2EgetHours%28%29%3B%0A%7D%29%3B%0Avar%20hours%20%3D%20hour%2Erange%3B%0A%0Avar%20day%20%3D%20newInterval%28function%28date%29%20%7B%0A%20%20date%2EsetHours%280%2C%200%2C%200%2C%200%29%3B%0A%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20date%2EsetDate%28date%2EgetDate%28%29%20%2B%20step%29%3B%0A%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20return%20%28end%20%2D%20start%20%2D%20%28end%2EgetTimezoneOffset%28%29%20%2D%20start%2EgetTimezoneOffset%28%29%29%20%2A%20durationMinute%29%20%2F%20durationDay%3B%0A%7D%2C%20function%28date%29%20%7B%0A%20%20return%20date%2EgetDate%28%29%20%2D%201%3B%0A%7D%29%3B%0Avar%20days%20%3D%20day%2Erange%3B%0A%0Afunction%20weekday%28i%29%20%7B%0A%20%20return%20newInterval%28function%28date%29%20%7B%0A%20%20%20%20date%2EsetDate%28date%2EgetDate%28%29%20%2D%20%28date%2EgetDay%28%29%20%2B%207%20%2D%20i%29%20%25%207%29%3B%0A%20%20%20%20date%2EsetHours%280%2C%200%2C%200%2C%200%29%3B%0A%20%20%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20%20%20date%2EsetDate%28date%2EgetDate%28%29%20%2B%20step%20%2A%207%29%3B%0A%20%20%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20%20%20return%20%28end%20%2D%20start%20%2D%20%28end%2EgetTimezoneOffset%28%29%20%2D%20start%2EgetTimezoneOffset%28%29%29%20%2A%20durationMinute%29%20%2F%20durationWeek%3B%0A%20%20%7D%29%3B%0A%7D%0A%0Avar%20sunday%20%3D%20weekday%280%29%3B%0Avar%20monday%20%3D%20weekday%281%29%3B%0Avar%20tuesday%20%3D%20weekday%282%29%3B%0Avar%20wednesday%20%3D%20weekday%283%29%3B%0Avar%20thursday%20%3D%20weekday%284%29%3B%0Avar%20friday%20%3D%20weekday%285%29%3B%0Avar%20saturday%20%3D%20weekday%286%29%3B%0A%0Avar%20sundays%20%3D%20sunday%2Erange%3B%0Avar%20mondays%20%3D%20monday%2Erange%3B%0Avar%20tuesdays%20%3D%20tuesday%2Erange%3B%0Avar%20wednesdays%20%3D%20wednesday%2Erange%3B%0Avar%20thursdays%20%3D%20thursday%2Erange%3B%0Avar%20fridays%20%3D%20friday%2Erange%3B%0Avar%20saturdays%20%3D%20saturday%2Erange%3B%0A%0Avar%20month%20%3D%20newInterval%28function%28date%29%20%7B%0A%20%20date%2EsetDate%281%29%3B%0A%20%20date%2EsetHours%280%2C%200%2C%200%2C%200%29%3B%0A%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20date%2EsetMonth%28date%2EgetMonth%28%29%20%2B%20step%29%3B%0A%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20return%20end%2EgetMonth%28%29%20%2D%20start%2EgetMonth%28%29%20%2B%20%28end%2EgetFullYear%28%29%20%2D%20start%2EgetFullYear%28%29%29%20%2A%2012%3B%0A%7D%2C%20function%28date%29%20%7B%0A%20%20return%20date%2EgetMonth%28%29%3B%0A%7D%29%3B%0Avar%20months%20%3D%20month%2Erange%3B%0A%0Avar%20year%20%3D%20newInterval%28function%28date%29%20%7B%0A%20%20date%2EsetMonth%280%2C%201%29%3B%0A%20%20date%2EsetHours%280%2C%200%2C%200%2C%200%29%3B%0A%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20date%2EsetFullYear%28date%2EgetFullYear%28%29%20%2B%20step%29%3B%0A%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20return%20end%2EgetFullYear%28%29%20%2D%20start%2EgetFullYear%28%29%3B%0A%7D%2C%20function%28date%29%20%7B%0A%20%20return%20date%2EgetFullYear%28%29%3B%0A%7D%29%3B%0A%0A%2F%2F%20An%20optimized%20implementation%20for%20this%20simple%20case%2E%0Ayear%2Eevery%20%3D%20function%28k%29%20%7B%0A%20%20return%20%21isFinite%28k%20%3D%20Math%2Efloor%28k%29%29%20%7C%7C%20%21%28k%20%3E%200%29%20%3F%20null%20%3A%20newInterval%28function%28date%29%20%7B%0A%20%20%20%20date%2EsetFullYear%28Math%2Efloor%28date%2EgetFullYear%28%29%20%2F%20k%29%20%2A%20k%29%3B%0A%20%20%20%20date%2EsetMonth%280%2C%201%29%3B%0A%20%20%20%20date%2EsetHours%280%2C%200%2C%200%2C%200%29%3B%0A%20%20%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20%20%20date%2EsetFullYear%28date%2EgetFullYear%28%29%20%2B%20step%20%2A%20k%29%3B%0A%20%20%7D%29%3B%0A%7D%3B%0Avar%20years%20%3D%20year%2Erange%3B%0A%0Avar%20utcMinute%20%3D%20newInterval%28function%28date%29%20%7B%0A%20%20date%2EsetUTCSeconds%280%2C%200%29%3B%0A%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20date%2EsetTime%28%2Bdate%20%2B%20step%20%2A%20durationMinute%29%3B%0A%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20return%20%28end%20%2D%20start%29%20%2F%20durationMinute%3B%0A%7D%2C%20function%28date%29%20%7B%0A%20%20return%20date%2EgetUTCMinutes%28%29%3B%0A%7D%29%3B%0Avar%20utcMinutes%20%3D%20utcMinute%2Erange%3B%0A%0Avar%20utcHour%20%3D%20newInterval%28function%28date%29%20%7B%0A%20%20date%2EsetUTCMinutes%280%2C%200%2C%200%29%3B%0A%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20date%2EsetTime%28%2Bdate%20%2B%20step%20%2A%20durationHour%29%3B%0A%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20return%20%28end%20%2D%20start%29%20%2F%20durationHour%3B%0A%7D%2C%20function%28date%29%20%7B%0A%20%20return%20date%2EgetUTCHours%28%29%3B%0A%7D%29%3B%0Avar%20utcHours%20%3D%20utcHour%2Erange%3B%0A%0Avar%20utcDay%20%3D%20newInterval%28function%28date%29%20%7B%0A%20%20date%2EsetUTCHours%280%2C%200%2C%200%2C%200%29%3B%0A%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20date%2EsetUTCDate%28date%2EgetUTCDate%28%29%20%2B%20step%29%3B%0A%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20return%20%28end%20%2D%20start%29%20%2F%20durationDay%3B%0A%7D%2C%20function%28date%29%20%7B%0A%20%20return%20date%2EgetUTCDate%28%29%20%2D%201%3B%0A%7D%29%3B%0Avar%20utcDays%20%3D%20utcDay%2Erange%3B%0A%0Afunction%20utcWeekday%28i%29%20%7B%0A%20%20return%20newInterval%28function%28date%29%20%7B%0A%20%20%20%20date%2EsetUTCDate%28date%2EgetUTCDate%28%29%20%2D%20%28date%2EgetUTCDay%28%29%20%2B%207%20%2D%20i%29%20%25%207%29%3B%0A%20%20%20%20date%2EsetUTCHours%280%2C%200%2C%200%2C%200%29%3B%0A%20%20%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20%20%20date%2EsetUTCDate%28date%2EgetUTCDate%28%29%20%2B%20step%20%2A%207%29%3B%0A%20%20%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20%20%20return%20%28end%20%2D%20start%29%20%2F%20durationWeek%3B%0A%20%20%7D%29%3B%0A%7D%0A%0Avar%20utcSunday%20%3D%20utcWeekday%280%29%3B%0Avar%20utcMonday%20%3D%20utcWeekday%281%29%3B%0Avar%20utcTuesday%20%3D%20utcWeekday%282%29%3B%0Avar%20utcWednesday%20%3D%20utcWeekday%283%29%3B%0Avar%20utcThursday%20%3D%20utcWeekday%284%29%3B%0Avar%20utcFriday%20%3D%20utcWeekday%285%29%3B%0Avar%20utcSaturday%20%3D%20utcWeekday%286%29%3B%0A%0Avar%20utcSundays%20%3D%20utcSunday%2Erange%3B%0Avar%20utcMondays%20%3D%20utcMonday%2Erange%3B%0Avar%20utcTuesdays%20%3D%20utcTuesday%2Erange%3B%0Avar%20utcWednesdays%20%3D%20utcWednesday%2Erange%3B%0Avar%20utcThursdays%20%3D%20utcThursday%2Erange%3B%0Avar%20utcFridays%20%3D%20utcFriday%2Erange%3B%0Avar%20utcSaturdays%20%3D%20utcSaturday%2Erange%3B%0A%0Avar%20utcMonth%20%3D%20newInterval%28function%28date%29%20%7B%0A%20%20date%2EsetUTCDate%281%29%3B%0A%20%20date%2EsetUTCHours%280%2C%200%2C%200%2C%200%29%3B%0A%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20date%2EsetUTCMonth%28date%2EgetUTCMonth%28%29%20%2B%20step%29%3B%0A%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20return%20end%2EgetUTCMonth%28%29%20%2D%20start%2EgetUTCMonth%28%29%20%2B%20%28end%2EgetUTCFullYear%28%29%20%2D%20start%2EgetUTCFullYear%28%29%29%20%2A%2012%3B%0A%7D%2C%20function%28date%29%20%7B%0A%20%20return%20date%2EgetUTCMonth%28%29%3B%0A%7D%29%3B%0Avar%20utcMonths%20%3D%20utcMonth%2Erange%3B%0A%0Avar%20utcYear%20%3D%20newInterval%28function%28date%29%20%7B%0A%20%20date%2EsetUTCMonth%280%2C%201%29%3B%0A%20%20date%2EsetUTCHours%280%2C%200%2C%200%2C%200%29%3B%0A%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20date%2EsetUTCFullYear%28date%2EgetUTCFullYear%28%29%20%2B%20step%29%3B%0A%7D%2C%20function%28start%2C%20end%29%20%7B%0A%20%20return%20end%2EgetUTCFullYear%28%29%20%2D%20start%2EgetUTCFullYear%28%29%3B%0A%7D%2C%20function%28date%29%20%7B%0A%20%20return%20date%2EgetUTCFullYear%28%29%3B%0A%7D%29%3B%0A%0A%2F%2F%20An%20optimized%20implementation%20for%20this%20simple%20case%2E%0AutcYear%2Eevery%20%3D%20function%28k%29%20%7B%0A%20%20return%20%21isFinite%28k%20%3D%20Math%2Efloor%28k%29%29%20%7C%7C%20%21%28k%20%3E%200%29%20%3F%20null%20%3A%20newInterval%28function%28date%29%20%7B%0A%20%20%20%20date%2EsetUTCFullYear%28Math%2Efloor%28date%2EgetUTCFullYear%28%29%20%2F%20k%29%20%2A%20k%29%3B%0A%20%20%20%20date%2EsetUTCMonth%280%2C%201%29%3B%0A%20%20%20%20date%2EsetUTCHours%280%2C%200%2C%200%2C%200%29%3B%0A%20%20%7D%2C%20function%28date%2C%20step%29%20%7B%0A%20%20%20%20date%2EsetUTCFullYear%28date%2EgetUTCFullYear%28%29%20%2B%20step%20%2A%20k%29%3B%0A%20%20%7D%29%3B%0A%7D%3B%0Avar%20utcYears%20%3D%20utcYear%2Erange%3B%0A%0Afunction%20localDate%28d%29%20%7B%0A%20%20if%20%280%20%3C%3D%20d%2Ey%20%26%26%20d%2Ey%20%3C%20100%29%20%7B%0A%20%20%20%20var%20date%20%3D%20new%20Date%28%2D1%2C%20d%2Em%2C%20d%2Ed%2C%20d%2EH%2C%20d%2EM%2C%20d%2ES%2C%20d%2EL%29%3B%0A%20%20%20%20date%2EsetFullYear%28d%2Ey%29%3B%0A%20%20%20%20return%20date%3B%0A%20%20%7D%0A%20%20return%20new%20Date%28d%2Ey%2C%20d%2Em%2C%20d%2Ed%2C%20d%2EH%2C%20d%2EM%2C%20d%2ES%2C%20d%2EL%29%3B%0A%7D%0A%0Afunction%20utcDate%28d%29%20%7B%0A%20%20if%20%280%20%3C%3D%20d%2Ey%20%26%26%20d%2Ey%20%3C%20100%29%20%7B%0A%20%20%20%20var%20date%20%3D%20new%20Date%28Date%2EUTC%28%2D1%2C%20d%2Em%2C%20d%2Ed%2C%20d%2EH%2C%20d%2EM%2C%20d%2ES%2C%20d%2EL%29%29%3B%0A%20%20%20%20date%2EsetUTCFullYear%28d%2Ey%29%3B%0A%20%20%20%20return%20date%3B%0A%20%20%7D%0A%20%20return%20new%20Date%28Date%2EUTC%28d%2Ey%2C%20d%2Em%2C%20d%2Ed%2C%20d%2EH%2C%20d%2EM%2C%20d%2ES%2C%20d%2EL%29%29%3B%0A%7D%0A%0Afunction%20newYear%28y%29%20%7B%0A%20%20return%20%7By%3A%20y%2C%20m%3A%200%2C%20d%3A%201%2C%20H%3A%200%2C%20M%3A%200%2C%20S%3A%200%2C%20L%3A%200%7D%3B%0A%7D%0A%0Afunction%20formatLocale%241%28locale%29%20%7B%0A%20%20var%20locale%5FdateTime%20%3D%20locale%2EdateTime%2C%0A%20%20%20%20%20%20locale%5Fdate%20%3D%20locale%2Edate%2C%0A%20%20%20%20%20%20locale%5Ftime%20%3D%20locale%2Etime%2C%0A%20%20%20%20%20%20locale%5Fperiods%20%3D%20locale%2Eperiods%2C%0A%20%20%20%20%20%20locale%5Fweekdays%20%3D%20locale%2Edays%2C%0A%20%20%20%20%20%20locale%5FshortWeekdays%20%3D%20locale%2EshortDays%2C%0A%20%20%20%20%20%20locale%5Fmonths%20%3D%20locale%2Emonths%2C%0A%20%20%20%20%20%20locale%5FshortMonths%20%3D%20locale%2EshortMonths%3B%0A%0A%20%20var%20periodRe%20%3D%20formatRe%28locale%5Fperiods%29%2C%0A%20%20%20%20%20%20periodLookup%20%3D%20formatLookup%28locale%5Fperiods%29%2C%0A%20%20%20%20%20%20weekdayRe%20%3D%20formatRe%28locale%5Fweekdays%29%2C%0A%20%20%20%20%20%20weekdayLookup%20%3D%20formatLookup%28locale%5Fweekdays%29%2C%0A%20%20%20%20%20%20shortWeekdayRe%20%3D%20formatRe%28locale%5FshortWeekdays%29%2C%0A%20%20%20%20%20%20shortWeekdayLookup%20%3D%20formatLookup%28locale%5FshortWeekdays%29%2C%0A%20%20%20%20%20%20monthRe%20%3D%20formatRe%28locale%5Fmonths%29%2C%0A%20%20%20%20%20%20monthLookup%20%3D%20formatLookup%28locale%5Fmonths%29%2C%0A%20%20%20%20%20%20shortMonthRe%20%3D%20formatRe%28locale%5FshortMonths%29%2C%0A%20%20%20%20%20%20shortMonthLookup%20%3D%20formatLookup%28locale%5FshortMonths%29%3B%0A%0A%20%20var%20formats%20%3D%20%7B%0A%20%20%20%20%22a%22%3A%20formatShortWeekday%2C%0A%20%20%20%20%22A%22%3A%20formatWeekday%2C%0A%20%20%20%20%22b%22%3A%20formatShortMonth%2C%0A%20%20%20%20%22B%22%3A%20formatMonth%2C%0A%20%20%20%20%22c%22%3A%20null%2C%0A%20%20%20%20%22d%22%3A%20formatDayOfMonth%2C%0A%20%20%20%20%22e%22%3A%20formatDayOfMonth%2C%0A%20%20%20%20%22f%22%3A%20formatMicroseconds%2C%0A%20%20%20%20%22H%22%3A%20formatHour24%2C%0A%20%20%20%20%22I%22%3A%20formatHour12%2C%0A%20%20%20%20%22j%22%3A%20formatDayOfYear%2C%0A%20%20%20%20%22L%22%3A%20formatMilliseconds%2C%0A%20%20%20%20%22m%22%3A%20formatMonthNumber%2C%0A%20%20%20%20%22M%22%3A%20formatMinutes%2C%0A%20%20%20%20%22p%22%3A%20formatPeriod%2C%0A%20%20%20%20%22Q%22%3A%20formatUnixTimestamp%2C%0A%20%20%20%20%22s%22%3A%20formatUnixTimestampSeconds%2C%0A%20%20%20%20%22S%22%3A%20formatSeconds%2C%0A%20%20%20%20%22u%22%3A%20formatWeekdayNumberMonday%2C%0A%20%20%20%20%22U%22%3A%20formatWeekNumberSunday%2C%0A%20%20%20%20%22V%22%3A%20formatWeekNumberISO%2C%0A%20%20%20%20%22w%22%3A%20formatWeekdayNumberSunday%2C%0A%20%20%20%20%22W%22%3A%20formatWeekNumberMonday%2C%0A%20%20%20%20%22x%22%3A%20null%2C%0A%20%20%20%20%22X%22%3A%20null%2C%0A%20%20%20%20%22y%22%3A%20formatYear%2C%0A%20%20%20%20%22Y%22%3A%20formatFullYear%2C%0A%20%20%20%20%22Z%22%3A%20formatZone%2C%0A%20%20%20%20%22%25%22%3A%20formatLiteralPercent%0A%20%20%7D%3B%0A%0A%20%20var%20utcFormats%20%3D%20%7B%0A%20%20%20%20%22a%22%3A%20formatUTCShortWeekday%2C%0A%20%20%20%20%22A%22%3A%20formatUTCWeekday%2C%0A%20%20%20%20%22b%22%3A%20formatUTCShortMonth%2C%0A%20%20%20%20%22B%22%3A%20formatUTCMonth%2C%0A%20%20%20%20%22c%22%3A%20null%2C%0A%20%20%20%20%22d%22%3A%20formatUTCDayOfMonth%2C%0A%20%20%20%20%22e%22%3A%20formatUTCDayOfMonth%2C%0A%20%20%20%20%22f%22%3A%20formatUTCMicroseconds%2C%0A%20%20%20%20%22H%22%3A%20formatUTCHour24%2C%0A%20%20%20%20%22I%22%3A%20formatUTCHour12%2C%0A%20%20%20%20%22j%22%3A%20formatUTCDayOfYear%2C%0A%20%20%20%20%22L%22%3A%20formatUTCMilliseconds%2C%0A%20%20%20%20%22m%22%3A%20formatUTCMonthNumber%2C%0A%20%20%20%20%22M%22%3A%20formatUTCMinutes%2C%0A%20%20%20%20%22p%22%3A%20formatUTCPeriod%2C%0A%20%20%20%20%22Q%22%3A%20formatUnixTimestamp%2C%0A%20%20%20%20%22s%22%3A%20formatUnixTimestampSeconds%2C%0A%20%20%20%20%22S%22%3A%20formatUTCSeconds%2C%0A%20%20%20%20%22u%22%3A%20formatUTCWeekdayNumberMonday%2C%0A%20%20%20%20%22U%22%3A%20formatUTCWeekNumberSunday%2C%0A%20%20%20%20%22V%22%3A%20formatUTCWeekNumberISO%2C%0A%20%20%20%20%22w%22%3A%20formatUTCWeekdayNumberSunday%2C%0A%20%20%20%20%22W%22%3A%20formatUTCWeekNumberMonday%2C%0A%20%20%20%20%22x%22%3A%20null%2C%0A%20%20%20%20%22X%22%3A%20null%2C%0A%20%20%20%20%22y%22%3A%20formatUTCYear%2C%0A%20%20%20%20%22Y%22%3A%20formatUTCFullYear%2C%0A%20%20%20%20%22Z%22%3A%20formatUTCZone%2C%0A%20%20%20%20%22%25%22%3A%20formatLiteralPercent%0A%20%20%7D%3B%0A%0A%20%20var%20parses%20%3D%20%7B%0A%20%20%20%20%22a%22%3A%20parseShortWeekday%2C%0A%20%20%20%20%22A%22%3A%20parseWeekday%2C%0A%20%20%20%20%22b%22%3A%20parseShortMonth%2C%0A%20%20%20%20%22B%22%3A%20parseMonth%2C%0A%20%20%20%20%22c%22%3A%20parseLocaleDateTime%2C%0A%20%20%20%20%22d%22%3A%20parseDayOfMonth%2C%0A%20%20%20%20%22e%22%3A%20parseDayOfMonth%2C%0A%20%20%20%20%22f%22%3A%20parseMicroseconds%2C%0A%20%20%20%20%22H%22%3A%20parseHour24%2C%0A%20%20%20%20%22I%22%3A%20parseHour24%2C%0A%20%20%20%20%22j%22%3A%20parseDayOfYear%2C%0A%20%20%20%20%22L%22%3A%20parseMilliseconds%2C%0A%20%20%20%20%22m%22%3A%20parseMonthNumber%2C%0A%20%20%20%20%22M%22%3A%20parseMinutes%2C%0A%20%20%20%20%22p%22%3A%20parsePeriod%2C%0A%20%20%20%20%22Q%22%3A%20parseUnixTimestamp%2C%0A%20%20%20%20%22s%22%3A%20parseUnixTimestampSeconds%2C%0A%20%20%20%20%22S%22%3A%20parseSeconds%2C%0A%20%20%20%20%22u%22%3A%20parseWeekdayNumberMonday%2C%0A%20%20%20%20%22U%22%3A%20parseWeekNumberSunday%2C%0A%20%20%20%20%22V%22%3A%20parseWeekNumberISO%2C%0A%20%20%20%20%22w%22%3A%20parseWeekdayNumberSunday%2C%0A%20%20%20%20%22W%22%3A%20parseWeekNumberMonday%2C%0A%20%20%20%20%22x%22%3A%20parseLocaleDate%2C%0A%20%20%20%20%22X%22%3A%20parseLocaleTime%2C%0A%20%20%20%20%22y%22%3A%20parseYear%2C%0A%20%20%20%20%22Y%22%3A%20parseFullYear%2C%0A%20%20%20%20%22Z%22%3A%20parseZone%2C%0A%20%20%20%20%22%25%22%3A%20parseLiteralPercent%0A%20%20%7D%3B%0A%0A%20%20%2F%2F%20These%20recursive%20directive%20definitions%20must%20be%20deferred%2E%0A%20%20formats%2Ex%20%3D%20newFormat%28locale%5Fdate%2C%20formats%29%3B%0A%20%20formats%2EX%20%3D%20newFormat%28locale%5Ftime%2C%20formats%29%3B%0A%20%20formats%2Ec%20%3D%20newFormat%28locale%5FdateTime%2C%20formats%29%3B%0A%20%20utcFormats%2Ex%20%3D%20newFormat%28locale%5Fdate%2C%20utcFormats%29%3B%0A%20%20utcFormats%2EX%20%3D%20newFormat%28locale%5Ftime%2C%20utcFormats%29%3B%0A%20%20utcFormats%2Ec%20%3D%20newFormat%28locale%5FdateTime%2C%20utcFormats%29%3B%0A%0A%20%20function%20newFormat%28specifier%2C%20formats%29%20%7B%0A%20%20%20%20return%20function%28date%29%20%7B%0A%20%20%20%20%20%20var%20string%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20%20%20%20%20j%20%3D%200%2C%0A%20%20%20%20%20%20%20%20%20%20n%20%3D%20specifier%2Elength%2C%0A%20%20%20%20%20%20%20%20%20%20c%2C%0A%20%20%20%20%20%20%20%20%20%20pad%2C%0A%20%20%20%20%20%20%20%20%20%20format%3B%0A%0A%20%20%20%20%20%20if%20%28%21%28date%20instanceof%20Date%29%29%20date%20%3D%20new%20Date%28%2Bdate%29%3B%0A%0A%20%20%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28specifier%2EcharCodeAt%28i%29%20%3D%3D%3D%2037%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20string%2Epush%28specifier%2Eslice%28j%2C%20i%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%28pad%20%3D%20pads%5Bc%20%3D%20specifier%2EcharAt%28%2B%2Bi%29%5D%29%20%21%3D%20null%29%20c%20%3D%20specifier%2EcharAt%28%2B%2Bi%29%3B%0A%20%20%20%20%20%20%20%20%20%20else%20pad%20%3D%20c%20%3D%3D%3D%20%22e%22%20%3F%20%22%20%22%20%3A%20%220%22%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28format%20%3D%20formats%5Bc%5D%29%20c%20%3D%20format%28date%2C%20pad%29%3B%0A%20%20%20%20%20%20%20%20%20%20string%2Epush%28c%29%3B%0A%20%20%20%20%20%20%20%20%20%20j%20%3D%20i%20%2B%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20string%2Epush%28specifier%2Eslice%28j%2C%20i%29%29%3B%0A%20%20%20%20%20%20return%20string%2Ejoin%28%22%22%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20function%20newParse%28specifier%2C%20newDate%29%20%7B%0A%20%20%20%20return%20function%28string%29%20%7B%0A%20%20%20%20%20%20var%20d%20%3D%20newYear%281900%29%2C%0A%20%20%20%20%20%20%20%20%20%20i%20%3D%20parseSpecifier%28d%2C%20specifier%2C%20string%20%2B%3D%20%22%22%2C%200%29%2C%0A%20%20%20%20%20%20%20%20%20%20week%2C%20day%24%241%3B%0A%20%20%20%20%20%20if%20%28i%20%21%3D%20string%2Elength%29%20return%20null%3B%0A%0A%20%20%20%20%20%20%2F%2F%20If%20a%20UNIX%20timestamp%20is%20specified%2C%20return%20it%2E%0A%20%20%20%20%20%20if%20%28%22Q%22%20in%20d%29%20return%20new%20Date%28d%2EQ%29%3B%0A%0A%20%20%20%20%20%20%2F%2F%20The%20am%2Dpm%20flag%20is%200%20for%20AM%2C%20and%201%20for%20PM%2E%0A%20%20%20%20%20%20if%20%28%22p%22%20in%20d%29%20d%2EH%20%3D%20d%2EH%20%25%2012%20%2B%20d%2Ep%20%2A%2012%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Convert%20day%2Dof%2Dweek%20and%20week%2Dof%2Dyear%20to%20day%2Dof%2Dyear%2E%0A%20%20%20%20%20%20if%20%28%22V%22%20in%20d%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28d%2EV%20%3C%201%20%7C%7C%20d%2EV%20%3E%2053%29%20return%20null%3B%0A%20%20%20%20%20%20%20%20if%20%28%21%28%22w%22%20in%20d%29%29%20d%2Ew%20%3D%201%3B%0A%20%20%20%20%20%20%20%20if%20%28%22Z%22%20in%20d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20week%20%3D%20utcDate%28newYear%28d%2Ey%29%29%2C%20day%24%241%20%3D%20week%2EgetUTCDay%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20week%20%3D%20day%24%241%20%3E%204%20%7C%7C%20day%24%241%20%3D%3D%3D%200%20%3F%20utcMonday%2Eceil%28week%29%20%3A%20utcMonday%28week%29%3B%0A%20%20%20%20%20%20%20%20%20%20week%20%3D%20utcDay%2Eoffset%28week%2C%20%28d%2EV%20%2D%201%29%20%2A%207%29%3B%0A%20%20%20%20%20%20%20%20%20%20d%2Ey%20%3D%20week%2EgetUTCFullYear%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20d%2Em%20%3D%20week%2EgetUTCMonth%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20d%2Ed%20%3D%20week%2EgetUTCDate%28%29%20%2B%20%28d%2Ew%20%2B%206%29%20%25%207%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20week%20%3D%20newDate%28newYear%28d%2Ey%29%29%2C%20day%24%241%20%3D%20week%2EgetDay%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20week%20%3D%20day%24%241%20%3E%204%20%7C%7C%20day%24%241%20%3D%3D%3D%200%20%3F%20monday%2Eceil%28week%29%20%3A%20monday%28week%29%3B%0A%20%20%20%20%20%20%20%20%20%20week%20%3D%20day%2Eoffset%28week%2C%20%28d%2EV%20%2D%201%29%20%2A%207%29%3B%0A%20%20%20%20%20%20%20%20%20%20d%2Ey%20%3D%20week%2EgetFullYear%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20d%2Em%20%3D%20week%2EgetMonth%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20d%2Ed%20%3D%20week%2EgetDate%28%29%20%2B%20%28d%2Ew%20%2B%206%29%20%25%207%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28%22W%22%20in%20d%20%7C%7C%20%22U%22%20in%20d%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21%28%22w%22%20in%20d%29%29%20d%2Ew%20%3D%20%22u%22%20in%20d%20%3F%20d%2Eu%20%25%207%20%3A%20%22W%22%20in%20d%20%3F%201%20%3A%200%3B%0A%20%20%20%20%20%20%20%20day%24%241%20%3D%20%22Z%22%20in%20d%20%3F%20utcDate%28newYear%28d%2Ey%29%29%2EgetUTCDay%28%29%20%3A%20newDate%28newYear%28d%2Ey%29%29%2EgetDay%28%29%3B%0A%20%20%20%20%20%20%20%20d%2Em%20%3D%200%3B%0A%20%20%20%20%20%20%20%20d%2Ed%20%3D%20%22W%22%20in%20d%20%3F%20%28d%2Ew%20%2B%206%29%20%25%207%20%2B%20d%2EW%20%2A%207%20%2D%20%28day%24%241%20%2B%205%29%20%25%207%20%3A%20d%2Ew%20%2B%20d%2EU%20%2A%207%20%2D%20%28day%24%241%20%2B%206%29%20%25%207%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20If%20a%20time%20zone%20is%20specified%2C%20all%20fields%20are%20interpreted%20as%20UTC%20and%20then%0A%20%20%20%20%20%20%2F%2F%20offset%20according%20to%20the%20specified%20time%20zone%2E%0A%20%20%20%20%20%20if%20%28%22Z%22%20in%20d%29%20%7B%0A%20%20%20%20%20%20%20%20d%2EH%20%2B%3D%20d%2EZ%20%2F%20100%20%7C%200%3B%0A%20%20%20%20%20%20%20%20d%2EM%20%2B%3D%20d%2EZ%20%25%20100%3B%0A%20%20%20%20%20%20%20%20return%20utcDate%28d%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20Otherwise%2C%20all%20fields%20are%20in%20local%20time%2E%0A%20%20%20%20%20%20return%20newDate%28d%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%0A%20%20function%20parseSpecifier%28d%2C%20specifier%2C%20string%2C%20j%29%20%7B%0A%20%20%20%20var%20i%20%3D%200%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20specifier%2Elength%2C%0A%20%20%20%20%20%20%20%20m%20%3D%20string%2Elength%2C%0A%20%20%20%20%20%20%20%20c%2C%0A%20%20%20%20%20%20%20%20parse%3B%0A%0A%20%20%20%20while%20%28i%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20if%20%28j%20%3E%3D%20m%29%20return%20%2D1%3B%0A%20%20%20%20%20%20c%20%3D%20specifier%2EcharCodeAt%28i%2B%2B%29%3B%0A%20%20%20%20%20%20if%20%28c%20%3D%3D%3D%2037%29%20%7B%0A%20%20%20%20%20%20%20%20c%20%3D%20specifier%2EcharAt%28i%2B%2B%29%3B%0A%20%20%20%20%20%20%20%20parse%20%3D%20parses%5Bc%20in%20pads%20%3F%20specifier%2EcharAt%28i%2B%2B%29%20%3A%20c%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28%21parse%20%7C%7C%20%28%28j%20%3D%20parse%28d%2C%20string%2C%20j%29%29%20%3C%200%29%29%20return%20%2D1%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28c%20%21%3D%20string%2EcharCodeAt%28j%2B%2B%29%29%20%7B%0A%20%20%20%20%20%20%20%20return%20%2D1%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20j%3B%0A%20%20%7D%0A%0A%20%20function%20parsePeriod%28d%2C%20string%2C%20i%29%20%7B%0A%20%20%20%20var%20n%20%3D%20periodRe%2Eexec%28string%2Eslice%28i%29%29%3B%0A%20%20%20%20return%20n%20%3F%20%28d%2Ep%20%3D%20periodLookup%5Bn%5B0%5D%2EtoLowerCase%28%29%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%20%20%7D%0A%0A%20%20function%20parseShortWeekday%28d%2C%20string%2C%20i%29%20%7B%0A%20%20%20%20var%20n%20%3D%20shortWeekdayRe%2Eexec%28string%2Eslice%28i%29%29%3B%0A%20%20%20%20return%20n%20%3F%20%28d%2Ew%20%3D%20shortWeekdayLookup%5Bn%5B0%5D%2EtoLowerCase%28%29%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%20%20%7D%0A%0A%20%20function%20parseWeekday%28d%2C%20string%2C%20i%29%20%7B%0A%20%20%20%20var%20n%20%3D%20weekdayRe%2Eexec%28string%2Eslice%28i%29%29%3B%0A%20%20%20%20return%20n%20%3F%20%28d%2Ew%20%3D%20weekdayLookup%5Bn%5B0%5D%2EtoLowerCase%28%29%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%20%20%7D%0A%0A%20%20function%20parseShortMonth%28d%2C%20string%2C%20i%29%20%7B%0A%20%20%20%20var%20n%20%3D%20shortMonthRe%2Eexec%28string%2Eslice%28i%29%29%3B%0A%20%20%20%20return%20n%20%3F%20%28d%2Em%20%3D%20shortMonthLookup%5Bn%5B0%5D%2EtoLowerCase%28%29%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%20%20%7D%0A%0A%20%20function%20parseMonth%28d%2C%20string%2C%20i%29%20%7B%0A%20%20%20%20var%20n%20%3D%20monthRe%2Eexec%28string%2Eslice%28i%29%29%3B%0A%20%20%20%20return%20n%20%3F%20%28d%2Em%20%3D%20monthLookup%5Bn%5B0%5D%2EtoLowerCase%28%29%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%20%20%7D%0A%0A%20%20function%20parseLocaleDateTime%28d%2C%20string%2C%20i%29%20%7B%0A%20%20%20%20return%20parseSpecifier%28d%2C%20locale%5FdateTime%2C%20string%2C%20i%29%3B%0A%20%20%7D%0A%0A%20%20function%20parseLocaleDate%28d%2C%20string%2C%20i%29%20%7B%0A%20%20%20%20return%20parseSpecifier%28d%2C%20locale%5Fdate%2C%20string%2C%20i%29%3B%0A%20%20%7D%0A%0A%20%20function%20parseLocaleTime%28d%2C%20string%2C%20i%29%20%7B%0A%20%20%20%20return%20parseSpecifier%28d%2C%20locale%5Ftime%2C%20string%2C%20i%29%3B%0A%20%20%7D%0A%0A%20%20function%20formatShortWeekday%28d%29%20%7B%0A%20%20%20%20return%20locale%5FshortWeekdays%5Bd%2EgetDay%28%29%5D%3B%0A%20%20%7D%0A%0A%20%20function%20formatWeekday%28d%29%20%7B%0A%20%20%20%20return%20locale%5Fweekdays%5Bd%2EgetDay%28%29%5D%3B%0A%20%20%7D%0A%0A%20%20function%20formatShortMonth%28d%29%20%7B%0A%20%20%20%20return%20locale%5FshortMonths%5Bd%2EgetMonth%28%29%5D%3B%0A%20%20%7D%0A%0A%20%20function%20formatMonth%28d%29%20%7B%0A%20%20%20%20return%20locale%5Fmonths%5Bd%2EgetMonth%28%29%5D%3B%0A%20%20%7D%0A%0A%20%20function%20formatPeriod%28d%29%20%7B%0A%20%20%20%20return%20locale%5Fperiods%5B%2B%28d%2EgetHours%28%29%20%3E%3D%2012%29%5D%3B%0A%20%20%7D%0A%0A%20%20function%20formatUTCShortWeekday%28d%29%20%7B%0A%20%20%20%20return%20locale%5FshortWeekdays%5Bd%2EgetUTCDay%28%29%5D%3B%0A%20%20%7D%0A%0A%20%20function%20formatUTCWeekday%28d%29%20%7B%0A%20%20%20%20return%20locale%5Fweekdays%5Bd%2EgetUTCDay%28%29%5D%3B%0A%20%20%7D%0A%0A%20%20function%20formatUTCShortMonth%28d%29%20%7B%0A%20%20%20%20return%20locale%5FshortMonths%5Bd%2EgetUTCMonth%28%29%5D%3B%0A%20%20%7D%0A%0A%20%20function%20formatUTCMonth%28d%29%20%7B%0A%20%20%20%20return%20locale%5Fmonths%5Bd%2EgetUTCMonth%28%29%5D%3B%0A%20%20%7D%0A%0A%20%20function%20formatUTCPeriod%28d%29%20%7B%0A%20%20%20%20return%20locale%5Fperiods%5B%2B%28d%2EgetUTCHours%28%29%20%3E%3D%2012%29%5D%3B%0A%20%20%7D%0A%0A%20%20return%20%7B%0A%20%20%20%20format%3A%20function%28specifier%29%20%7B%0A%20%20%20%20%20%20var%20f%20%3D%20newFormat%28specifier%20%2B%3D%20%22%22%2C%20formats%29%3B%0A%20%20%20%20%20%20f%2EtoString%20%3D%20function%28%29%20%7B%20return%20specifier%3B%20%7D%3B%0A%20%20%20%20%20%20return%20f%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20parse%3A%20function%28specifier%29%20%7B%0A%20%20%20%20%20%20var%20p%20%3D%20newParse%28specifier%20%2B%3D%20%22%22%2C%20localDate%29%3B%0A%20%20%20%20%20%20p%2EtoString%20%3D%20function%28%29%20%7B%20return%20specifier%3B%20%7D%3B%0A%20%20%20%20%20%20return%20p%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20utcFormat%3A%20function%28specifier%29%20%7B%0A%20%20%20%20%20%20var%20f%20%3D%20newFormat%28specifier%20%2B%3D%20%22%22%2C%20utcFormats%29%3B%0A%20%20%20%20%20%20f%2EtoString%20%3D%20function%28%29%20%7B%20return%20specifier%3B%20%7D%3B%0A%20%20%20%20%20%20return%20f%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20utcParse%3A%20function%28specifier%29%20%7B%0A%20%20%20%20%20%20var%20p%20%3D%20newParse%28specifier%2C%20utcDate%29%3B%0A%20%20%20%20%20%20p%2EtoString%20%3D%20function%28%29%20%7B%20return%20specifier%3B%20%7D%3B%0A%20%20%20%20%20%20return%20p%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0A%0Avar%20pads%20%3D%20%7B%22%2D%22%3A%20%22%22%2C%20%22%5F%22%3A%20%22%20%22%2C%20%220%22%3A%20%220%22%7D%2C%0A%20%20%20%20numberRe%20%3D%20%2F%5E%5Cs%2A%5Cd%2B%2F%2C%20%2F%2F%20note%3A%20ignores%20next%20directive%0A%20%20%20%20percentRe%20%3D%20%2F%5E%25%2F%2C%0A%20%20%20%20requoteRe%20%3D%20%2F%5B%5C%5C%5E%24%2A%2B%3F%7C%5B%5C%5D%28%29%2E%7B%7D%5D%2Fg%3B%0A%0Afunction%20pad%28value%2C%20fill%2C%20width%29%20%7B%0A%20%20var%20sign%20%3D%20value%20%3C%200%20%3F%20%22%2D%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20string%20%3D%20%28sign%20%3F%20%2Dvalue%20%3A%20value%29%20%2B%20%22%22%2C%0A%20%20%20%20%20%20length%20%3D%20string%2Elength%3B%0A%20%20return%20sign%20%2B%20%28length%20%3C%20width%20%3F%20new%20Array%28width%20%2D%20length%20%2B%201%29%2Ejoin%28fill%29%20%2B%20string%20%3A%20string%29%3B%0A%7D%0A%0Afunction%20requote%28s%29%20%7B%0A%20%20return%20s%2Ereplace%28requoteRe%2C%20%22%5C%5C%24%26%22%29%3B%0A%7D%0A%0Afunction%20formatRe%28names%29%20%7B%0A%20%20return%20new%20RegExp%28%22%5E%28%3F%3A%22%20%2B%20names%2Emap%28requote%29%2Ejoin%28%22%7C%22%29%20%2B%20%22%29%22%2C%20%22i%22%29%3B%0A%7D%0A%0Afunction%20formatLookup%28names%29%20%7B%0A%20%20var%20map%20%3D%20%7B%7D%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20names%2Elength%3B%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20map%5Bnames%5Bi%5D%2EtoLowerCase%28%29%5D%20%3D%20i%3B%0A%20%20return%20map%3B%0A%7D%0A%0Afunction%20parseWeekdayNumberSunday%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%201%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2Ew%20%3D%20%2Bn%5B0%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseWeekdayNumberMonday%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%201%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2Eu%20%3D%20%2Bn%5B0%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseWeekNumberSunday%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%202%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2EU%20%3D%20%2Bn%5B0%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseWeekNumberISO%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%202%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2EV%20%3D%20%2Bn%5B0%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseWeekNumberMonday%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%202%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2EW%20%3D%20%2Bn%5B0%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseFullYear%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%204%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2Ey%20%3D%20%2Bn%5B0%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseYear%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%202%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2Ey%20%3D%20%2Bn%5B0%5D%20%2B%20%28%2Bn%5B0%5D%20%3E%2068%20%3F%201900%20%3A%202000%29%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseZone%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20%2F%5E%28Z%29%7C%28%5B%2B%2D%5D%5Cd%5Cd%29%28%3F%3A%3A%3F%28%5Cd%5Cd%29%29%3F%2F%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%206%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2EZ%20%3D%20n%5B1%5D%20%3F%200%20%3A%20%2D%28n%5B2%5D%20%2B%20%28n%5B3%5D%20%7C%7C%20%2200%22%29%29%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseMonthNumber%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%202%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2Em%20%3D%20n%5B0%5D%20%2D%201%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseDayOfMonth%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%202%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2Ed%20%3D%20%2Bn%5B0%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseDayOfYear%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%203%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2Em%20%3D%200%2C%20d%2Ed%20%3D%20%2Bn%5B0%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseHour24%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%202%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2EH%20%3D%20%2Bn%5B0%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseMinutes%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%202%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2EM%20%3D%20%2Bn%5B0%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseSeconds%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%202%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2ES%20%3D%20%2Bn%5B0%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseMilliseconds%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%203%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2EL%20%3D%20%2Bn%5B0%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseMicroseconds%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%206%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2EL%20%3D%20Math%2Efloor%28n%5B0%5D%20%2F%201000%29%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseLiteralPercent%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20percentRe%2Eexec%28string%2Eslice%28i%2C%20i%20%2B%201%29%29%3B%0A%20%20return%20n%20%3F%20i%20%2B%20n%5B0%5D%2Elength%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseUnixTimestamp%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2EQ%20%3D%20%2Bn%5B0%5D%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20parseUnixTimestampSeconds%28d%2C%20string%2C%20i%29%20%7B%0A%20%20var%20n%20%3D%20numberRe%2Eexec%28string%2Eslice%28i%29%29%3B%0A%20%20return%20n%20%3F%20%28d%2EQ%20%3D%20%28%2Bn%5B0%5D%29%20%2A%201000%2C%20i%20%2B%20n%5B0%5D%2Elength%29%20%3A%20%2D1%3B%0A%7D%0A%0Afunction%20formatDayOfMonth%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetDate%28%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatHour24%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetHours%28%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatHour12%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetHours%28%29%20%25%2012%20%7C%7C%2012%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatDayOfYear%28d%2C%20p%29%20%7B%0A%20%20return%20pad%281%20%2B%20day%2Ecount%28year%28d%29%2C%20d%29%2C%20p%2C%203%29%3B%0A%7D%0A%0Afunction%20formatMilliseconds%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetMilliseconds%28%29%2C%20p%2C%203%29%3B%0A%7D%0A%0Afunction%20formatMicroseconds%28d%2C%20p%29%20%7B%0A%20%20return%20formatMilliseconds%28d%2C%20p%29%20%2B%20%22000%22%3B%0A%7D%0A%0Afunction%20formatMonthNumber%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetMonth%28%29%20%2B%201%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatMinutes%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetMinutes%28%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatSeconds%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetSeconds%28%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatWeekdayNumberMonday%28d%29%20%7B%0A%20%20var%20day%24%241%20%3D%20d%2EgetDay%28%29%3B%0A%20%20return%20day%24%241%20%3D%3D%3D%200%20%3F%207%20%3A%20day%24%241%3B%0A%7D%0A%0Afunction%20formatWeekNumberSunday%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28sunday%2Ecount%28year%28d%29%2C%20d%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatWeekNumberISO%28d%2C%20p%29%20%7B%0A%20%20var%20day%24%241%20%3D%20d%2EgetDay%28%29%3B%0A%20%20d%20%3D%20%28day%24%241%20%3E%3D%204%20%7C%7C%20day%24%241%20%3D%3D%3D%200%29%20%3F%20thursday%28d%29%20%3A%20thursday%2Eceil%28d%29%3B%0A%20%20return%20pad%28thursday%2Ecount%28year%28d%29%2C%20d%29%20%2B%20%28year%28d%29%2EgetDay%28%29%20%3D%3D%3D%204%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatWeekdayNumberSunday%28d%29%20%7B%0A%20%20return%20d%2EgetDay%28%29%3B%0A%7D%0A%0Afunction%20formatWeekNumberMonday%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28monday%2Ecount%28year%28d%29%2C%20d%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatYear%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetFullYear%28%29%20%25%20100%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatFullYear%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetFullYear%28%29%20%25%2010000%2C%20p%2C%204%29%3B%0A%7D%0A%0Afunction%20formatZone%28d%29%20%7B%0A%20%20var%20z%20%3D%20d%2EgetTimezoneOffset%28%29%3B%0A%20%20return%20%28z%20%3E%200%20%3F%20%22%2D%22%20%3A%20%28z%20%2A%3D%20%2D1%2C%20%22%2B%22%29%29%0A%20%20%20%20%20%20%2B%20pad%28z%20%2F%2060%20%7C%200%2C%20%220%22%2C%202%29%0A%20%20%20%20%20%20%2B%20pad%28z%20%25%2060%2C%20%220%22%2C%202%29%3B%0A%7D%0A%0Afunction%20formatUTCDayOfMonth%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetUTCDate%28%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatUTCHour24%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetUTCHours%28%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatUTCHour12%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetUTCHours%28%29%20%25%2012%20%7C%7C%2012%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatUTCDayOfYear%28d%2C%20p%29%20%7B%0A%20%20return%20pad%281%20%2B%20utcDay%2Ecount%28utcYear%28d%29%2C%20d%29%2C%20p%2C%203%29%3B%0A%7D%0A%0Afunction%20formatUTCMilliseconds%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetUTCMilliseconds%28%29%2C%20p%2C%203%29%3B%0A%7D%0A%0Afunction%20formatUTCMicroseconds%28d%2C%20p%29%20%7B%0A%20%20return%20formatUTCMilliseconds%28d%2C%20p%29%20%2B%20%22000%22%3B%0A%7D%0A%0Afunction%20formatUTCMonthNumber%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetUTCMonth%28%29%20%2B%201%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatUTCMinutes%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetUTCMinutes%28%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatUTCSeconds%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetUTCSeconds%28%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatUTCWeekdayNumberMonday%28d%29%20%7B%0A%20%20var%20dow%20%3D%20d%2EgetUTCDay%28%29%3B%0A%20%20return%20dow%20%3D%3D%3D%200%20%3F%207%20%3A%20dow%3B%0A%7D%0A%0Afunction%20formatUTCWeekNumberSunday%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28utcSunday%2Ecount%28utcYear%28d%29%2C%20d%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatUTCWeekNumberISO%28d%2C%20p%29%20%7B%0A%20%20var%20day%24%241%20%3D%20d%2EgetUTCDay%28%29%3B%0A%20%20d%20%3D%20%28day%24%241%20%3E%3D%204%20%7C%7C%20day%24%241%20%3D%3D%3D%200%29%20%3F%20utcThursday%28d%29%20%3A%20utcThursday%2Eceil%28d%29%3B%0A%20%20return%20pad%28utcThursday%2Ecount%28utcYear%28d%29%2C%20d%29%20%2B%20%28utcYear%28d%29%2EgetUTCDay%28%29%20%3D%3D%3D%204%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatUTCWeekdayNumberSunday%28d%29%20%7B%0A%20%20return%20d%2EgetUTCDay%28%29%3B%0A%7D%0A%0Afunction%20formatUTCWeekNumberMonday%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28utcMonday%2Ecount%28utcYear%28d%29%2C%20d%29%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatUTCYear%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetUTCFullYear%28%29%20%25%20100%2C%20p%2C%202%29%3B%0A%7D%0A%0Afunction%20formatUTCFullYear%28d%2C%20p%29%20%7B%0A%20%20return%20pad%28d%2EgetUTCFullYear%28%29%20%25%2010000%2C%20p%2C%204%29%3B%0A%7D%0A%0Afunction%20formatUTCZone%28%29%20%7B%0A%20%20return%20%22%2B0000%22%3B%0A%7D%0A%0Afunction%20formatLiteralPercent%28%29%20%7B%0A%20%20return%20%22%25%22%3B%0A%7D%0A%0Afunction%20formatUnixTimestamp%28d%29%20%7B%0A%20%20return%20%2Bd%3B%0A%7D%0A%0Afunction%20formatUnixTimestampSeconds%28d%29%20%7B%0A%20%20return%20Math%2Efloor%28%2Bd%20%2F%201000%29%3B%0A%7D%0A%0Avar%20locale%241%3B%0A%0AdefaultLocale%241%28%7B%0A%20%20dateTime%3A%20%22%25x%2C%20%25X%22%2C%0A%20%20date%3A%20%22%25%2Dm%2F%25%2Dd%2F%25Y%22%2C%0A%20%20time%3A%20%22%25%2DI%3A%25M%3A%25S%20%25p%22%2C%0A%20%20periods%3A%20%5B%22AM%22%2C%20%22PM%22%5D%2C%0A%20%20days%3A%20%5B%22Sunday%22%2C%20%22Monday%22%2C%20%22Tuesday%22%2C%20%22Wednesday%22%2C%20%22Thursday%22%2C%20%22Friday%22%2C%20%22Saturday%22%5D%2C%0A%20%20shortDays%3A%20%5B%22Sun%22%2C%20%22Mon%22%2C%20%22Tue%22%2C%20%22Wed%22%2C%20%22Thu%22%2C%20%22Fri%22%2C%20%22Sat%22%5D%2C%0A%20%20months%3A%20%5B%22January%22%2C%20%22February%22%2C%20%22March%22%2C%20%22April%22%2C%20%22May%22%2C%20%22June%22%2C%20%22July%22%2C%20%22August%22%2C%20%22September%22%2C%20%22October%22%2C%20%22November%22%2C%20%22December%22%5D%2C%0A%20%20shortMonths%3A%20%5B%22Jan%22%2C%20%22Feb%22%2C%20%22Mar%22%2C%20%22Apr%22%2C%20%22May%22%2C%20%22Jun%22%2C%20%22Jul%22%2C%20%22Aug%22%2C%20%22Sep%22%2C%20%22Oct%22%2C%20%22Nov%22%2C%20%22Dec%22%5D%0A%7D%29%3B%0A%0Afunction%20defaultLocale%241%28definition%29%20%7B%0A%20%20locale%241%20%3D%20formatLocale%241%28definition%29%3B%0A%20%20exports%2EtimeFormat%20%3D%20locale%241%2Eformat%3B%0A%20%20exports%2EtimeParse%20%3D%20locale%241%2Eparse%3B%0A%20%20exports%2EutcFormat%20%3D%20locale%241%2EutcFormat%3B%0A%20%20exports%2EutcParse%20%3D%20locale%241%2EutcParse%3B%0A%20%20return%20locale%241%3B%0A%7D%0A%0Avar%20isoSpecifier%20%3D%20%22%25Y%2D%25m%2D%25dT%25H%3A%25M%3A%25S%2E%25LZ%22%3B%0A%0Afunction%20formatIsoNative%28date%29%20%7B%0A%20%20return%20date%2EtoISOString%28%29%3B%0A%7D%0A%0Avar%20formatIso%20%3D%20Date%2Eprototype%2EtoISOString%0A%20%20%20%20%3F%20formatIsoNative%0A%20%20%20%20%3A%20exports%2EutcFormat%28isoSpecifier%29%3B%0A%0Afunction%20parseIsoNative%28string%29%20%7B%0A%20%20var%20date%20%3D%20new%20Date%28string%29%3B%0A%20%20return%20isNaN%28date%29%20%3F%20null%20%3A%20date%3B%0A%7D%0A%0Avar%20parseIso%20%3D%20%2Bnew%20Date%28%222000%2D01%2D01T00%3A00%3A00%2E000Z%22%29%0A%20%20%20%20%3F%20parseIsoNative%0A%20%20%20%20%3A%20exports%2EutcParse%28isoSpecifier%29%3B%0A%0Avar%20durationSecond%241%20%3D%201000%2C%0A%20%20%20%20durationMinute%241%20%3D%20durationSecond%241%20%2A%2060%2C%0A%20%20%20%20durationHour%241%20%3D%20durationMinute%241%20%2A%2060%2C%0A%20%20%20%20durationDay%241%20%3D%20durationHour%241%20%2A%2024%2C%0A%20%20%20%20durationWeek%241%20%3D%20durationDay%241%20%2A%207%2C%0A%20%20%20%20durationMonth%20%3D%20durationDay%241%20%2A%2030%2C%0A%20%20%20%20durationYear%20%3D%20durationDay%241%20%2A%20365%3B%0A%0Afunction%20date%241%28t%29%20%7B%0A%20%20return%20new%20Date%28t%29%3B%0A%7D%0A%0Afunction%20number%243%28t%29%20%7B%0A%20%20return%20t%20instanceof%20Date%20%3F%20%2Bt%20%3A%20%2Bnew%20Date%28%2Bt%29%3B%0A%7D%0A%0Afunction%20calendar%28year%24%241%2C%20month%24%241%2C%20week%2C%20day%24%241%2C%20hour%24%241%2C%20minute%24%241%2C%20second%24%241%2C%20millisecond%24%241%2C%20format%29%20%7B%0A%20%20var%20scale%20%3D%20continuous%28deinterpolateLinear%2C%20reinterpolate%29%2C%0A%20%20%20%20%20%20invert%20%3D%20scale%2Einvert%2C%0A%20%20%20%20%20%20domain%20%3D%20scale%2Edomain%3B%0A%0A%20%20var%20formatMillisecond%20%3D%20format%28%22%2E%25L%22%29%2C%0A%20%20%20%20%20%20formatSecond%20%3D%20format%28%22%3A%25S%22%29%2C%0A%20%20%20%20%20%20formatMinute%20%3D%20format%28%22%25I%3A%25M%22%29%2C%0A%20%20%20%20%20%20formatHour%20%3D%20format%28%22%25I%20%25p%22%29%2C%0A%20%20%20%20%20%20formatDay%20%3D%20format%28%22%25a%20%25d%22%29%2C%0A%20%20%20%20%20%20formatWeek%20%3D%20format%28%22%25b%20%25d%22%29%2C%0A%20%20%20%20%20%20formatMonth%20%3D%20format%28%22%25B%22%29%2C%0A%20%20%20%20%20%20formatYear%20%3D%20format%28%22%25Y%22%29%3B%0A%0A%20%20var%20tickIntervals%20%3D%20%5B%0A%20%20%20%20%5Bsecond%24%241%2C%20%201%2C%20%20%20%20%20%20durationSecond%241%5D%2C%0A%20%20%20%20%5Bsecond%24%241%2C%20%205%2C%20%205%20%2A%20durationSecond%241%5D%2C%0A%20%20%20%20%5Bsecond%24%241%2C%2015%2C%2015%20%2A%20durationSecond%241%5D%2C%0A%20%20%20%20%5Bsecond%24%241%2C%2030%2C%2030%20%2A%20durationSecond%241%5D%2C%0A%20%20%20%20%5Bminute%24%241%2C%20%201%2C%20%20%20%20%20%20durationMinute%241%5D%2C%0A%20%20%20%20%5Bminute%24%241%2C%20%205%2C%20%205%20%2A%20durationMinute%241%5D%2C%0A%20%20%20%20%5Bminute%24%241%2C%2015%2C%2015%20%2A%20durationMinute%241%5D%2C%0A%20%20%20%20%5Bminute%24%241%2C%2030%2C%2030%20%2A%20durationMinute%241%5D%2C%0A%20%20%20%20%5B%20%20hour%24%241%2C%20%201%2C%20%20%20%20%20%20durationHour%241%20%20%5D%2C%0A%20%20%20%20%5B%20%20hour%24%241%2C%20%203%2C%20%203%20%2A%20durationHour%241%20%20%5D%2C%0A%20%20%20%20%5B%20%20hour%24%241%2C%20%206%2C%20%206%20%2A%20durationHour%241%20%20%5D%2C%0A%20%20%20%20%5B%20%20hour%24%241%2C%2012%2C%2012%20%2A%20durationHour%241%20%20%5D%2C%0A%20%20%20%20%5B%20%20%20day%24%241%2C%20%201%2C%20%20%20%20%20%20durationDay%241%20%20%20%5D%2C%0A%20%20%20%20%5B%20%20%20day%24%241%2C%20%202%2C%20%202%20%2A%20durationDay%241%20%20%20%5D%2C%0A%20%20%20%20%5B%20%20week%2C%20%201%2C%20%20%20%20%20%20durationWeek%241%20%20%5D%2C%0A%20%20%20%20%5B%20month%24%241%2C%20%201%2C%20%20%20%20%20%20durationMonth%20%5D%2C%0A%20%20%20%20%5B%20month%24%241%2C%20%203%2C%20%203%20%2A%20durationMonth%20%5D%2C%0A%20%20%20%20%5B%20%20year%24%241%2C%20%201%2C%20%20%20%20%20%20durationYear%20%20%5D%0A%20%20%5D%3B%0A%0A%20%20function%20tickFormat%28date%24%241%29%20%7B%0A%20%20%20%20return%20%28second%24%241%28date%24%241%29%20%3C%20date%24%241%20%3F%20formatMillisecond%0A%20%20%20%20%20%20%20%20%3A%20minute%24%241%28date%24%241%29%20%3C%20date%24%241%20%3F%20formatSecond%0A%20%20%20%20%20%20%20%20%3A%20hour%24%241%28date%24%241%29%20%3C%20date%24%241%20%3F%20formatMinute%0A%20%20%20%20%20%20%20%20%3A%20day%24%241%28date%24%241%29%20%3C%20date%24%241%20%3F%20formatHour%0A%20%20%20%20%20%20%20%20%3A%20month%24%241%28date%24%241%29%20%3C%20date%24%241%20%3F%20%28week%28date%24%241%29%20%3C%20date%24%241%20%3F%20formatDay%20%3A%20formatWeek%29%0A%20%20%20%20%20%20%20%20%3A%20year%24%241%28date%24%241%29%20%3C%20date%24%241%20%3F%20formatMonth%0A%20%20%20%20%20%20%20%20%3A%20formatYear%29%28date%24%241%29%3B%0A%20%20%7D%0A%0A%20%20function%20tickInterval%28interval%2C%20start%2C%20stop%2C%20step%29%20%7B%0A%20%20%20%20if%20%28interval%20%3D%3D%20null%29%20interval%20%3D%2010%3B%0A%0A%20%20%20%20%2F%2F%20If%20a%20desired%20tick%20count%20is%20specified%2C%20pick%20a%20reasonable%20tick%20interval%0A%20%20%20%20%2F%2F%20based%20on%20the%20extent%20of%20the%20domain%20and%20a%20rough%20estimate%20of%20tick%20size%2E%0A%20%20%20%20%2F%2F%20Otherwise%2C%20assume%20interval%20is%20already%20a%20time%20interval%20and%20use%20it%2E%0A%20%20%20%20if%20%28typeof%20interval%20%3D%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20%20%20var%20target%20%3D%20Math%2Eabs%28stop%20%2D%20start%29%20%2F%20interval%2C%0A%20%20%20%20%20%20%20%20%20%20i%20%3D%20bisector%28function%28i%29%20%7B%20return%20i%5B2%5D%3B%20%7D%29%2Eright%28tickIntervals%2C%20target%29%3B%0A%20%20%20%20%20%20if%20%28i%20%3D%3D%3D%20tickIntervals%2Elength%29%20%7B%0A%20%20%20%20%20%20%20%20step%20%3D%20tickStep%28start%20%2F%20durationYear%2C%20stop%20%2F%20durationYear%2C%20interval%29%3B%0A%20%20%20%20%20%20%20%20interval%20%3D%20year%24%241%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28i%29%20%7B%0A%20%20%20%20%20%20%20%20i%20%3D%20tickIntervals%5Btarget%20%2F%20tickIntervals%5Bi%20%2D%201%5D%5B2%5D%20%3C%20tickIntervals%5Bi%5D%5B2%5D%20%2F%20target%20%3F%20i%20%2D%201%20%3A%20i%5D%3B%0A%20%20%20%20%20%20%20%20step%20%3D%20i%5B1%5D%3B%0A%20%20%20%20%20%20%20%20interval%20%3D%20i%5B0%5D%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20step%20%3D%20Math%2Emax%28tickStep%28start%2C%20stop%2C%20interval%29%2C%201%29%3B%0A%20%20%20%20%20%20%20%20interval%20%3D%20millisecond%24%241%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20step%20%3D%3D%20null%20%3F%20interval%20%3A%20interval%2Eevery%28step%29%3B%0A%20%20%7D%0A%0A%20%20scale%2Einvert%20%3D%20function%28y%29%20%7B%0A%20%20%20%20return%20new%20Date%28invert%28y%29%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Edomain%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20domain%28map%242%2Ecall%28%5F%2C%20number%243%29%29%20%3A%20domain%28%29%2Emap%28date%241%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Eticks%20%3D%20function%28interval%2C%20step%29%20%7B%0A%20%20%20%20var%20d%20%3D%20domain%28%29%2C%0A%20%20%20%20%20%20%20%20t0%20%3D%20d%5B0%5D%2C%0A%20%20%20%20%20%20%20%20t1%20%3D%20d%5Bd%2Elength%20%2D%201%5D%2C%0A%20%20%20%20%20%20%20%20r%20%3D%20t1%20%3C%20t0%2C%0A%20%20%20%20%20%20%20%20t%3B%0A%20%20%20%20if%20%28r%29%20t%20%3D%20t0%2C%20t0%20%3D%20t1%2C%20t1%20%3D%20t%3B%0A%20%20%20%20t%20%3D%20tickInterval%28interval%2C%20t0%2C%20t1%2C%20step%29%3B%0A%20%20%20%20t%20%3D%20t%20%3F%20t%2Erange%28t0%2C%20t1%20%2B%201%29%20%3A%20%5B%5D%3B%20%2F%2F%20inclusive%20stop%0A%20%20%20%20return%20r%20%3F%20t%2Ereverse%28%29%20%3A%20t%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2EtickFormat%20%3D%20function%28count%2C%20specifier%29%20%7B%0A%20%20%20%20return%20specifier%20%3D%3D%20null%20%3F%20tickFormat%20%3A%20format%28specifier%29%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Enice%20%3D%20function%28interval%2C%20step%29%20%7B%0A%20%20%20%20var%20d%20%3D%20domain%28%29%3B%0A%20%20%20%20return%20%28interval%20%3D%20tickInterval%28interval%2C%20d%5B0%5D%2C%20d%5Bd%2Elength%20%2D%201%5D%2C%20step%29%29%0A%20%20%20%20%20%20%20%20%3F%20domain%28nice%28d%2C%20interval%29%29%0A%20%20%20%20%20%20%20%20%3A%20scale%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Ecopy%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20copy%28scale%2C%20calendar%28year%24%241%2C%20month%24%241%2C%20week%2C%20day%24%241%2C%20hour%24%241%2C%20minute%24%241%2C%20second%24%241%2C%20millisecond%24%241%2C%20format%29%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20scale%3B%0A%7D%0A%0Afunction%20time%28%29%20%7B%0A%20%20return%20calendar%28year%2C%20month%2C%20sunday%2C%20day%2C%20hour%2C%20minute%2C%20second%2C%20millisecond%2C%20exports%2EtimeFormat%29%2Edomain%28%5Bnew%20Date%282000%2C%200%2C%201%29%2C%20new%20Date%282000%2C%200%2C%202%29%5D%29%3B%0A%7D%0A%0Afunction%20utcTime%28%29%20%7B%0A%20%20return%20calendar%28utcYear%2C%20utcMonth%2C%20utcSunday%2C%20utcDay%2C%20utcHour%2C%20utcMinute%2C%20second%2C%20millisecond%2C%20exports%2EutcFormat%29%2Edomain%28%5BDate%2EUTC%282000%2C%200%2C%201%29%2C%20Date%2EUTC%282000%2C%200%2C%202%29%5D%29%3B%0A%7D%0A%0Afunction%20sequential%28interpolator%29%20%7B%0A%20%20var%20x0%20%3D%200%2C%0A%20%20%20%20%20%20x1%20%3D%201%2C%0A%20%20%20%20%20%20clamp%20%3D%20false%3B%0A%0A%20%20function%20scale%28x%29%20%7B%0A%20%20%20%20var%20t%20%3D%20%28x%20%2D%20x0%29%20%2F%20%28x1%20%2D%20x0%29%3B%0A%20%20%20%20return%20interpolator%28clamp%20%3F%20Math%2Emax%280%2C%20Math%2Emin%281%2C%20t%29%29%20%3A%20t%29%3B%0A%20%20%7D%0A%0A%20%20scale%2Edomain%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28x0%20%3D%20%2B%5F%5B0%5D%2C%20x1%20%3D%20%2B%5F%5B1%5D%2C%20scale%29%20%3A%20%5Bx0%2C%20x1%5D%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Eclamp%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28clamp%20%3D%20%21%21%5F%2C%20scale%29%20%3A%20clamp%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Einterpolator%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28interpolator%20%3D%20%5F%2C%20scale%29%20%3A%20interpolator%3B%0A%20%20%7D%3B%0A%0A%20%20scale%2Ecopy%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20sequential%28interpolator%29%2Edomain%28%5Bx0%2C%20x1%5D%29%2Eclamp%28clamp%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20linearish%28scale%29%3B%0A%7D%0A%0Afunction%20colors%28specifier%29%20%7B%0A%20%20var%20n%20%3D%20specifier%2Elength%20%2F%206%20%7C%200%2C%20colors%20%3D%20new%20Array%28n%29%2C%20i%20%3D%200%3B%0A%20%20while%20%28i%20%3C%20n%29%20colors%5Bi%5D%20%3D%20%22%23%22%20%2B%20specifier%2Eslice%28i%20%2A%206%2C%20%2B%2Bi%20%2A%206%29%3B%0A%20%20return%20colors%3B%0A%7D%0A%0Avar%20category10%20%3D%20colors%28%221f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf%22%29%3B%0A%0Avar%20Accent%20%3D%20colors%28%227fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666%22%29%3B%0A%0Avar%20Dark2%20%3D%20colors%28%221b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666%22%29%3B%0A%0Avar%20Paired%20%3D%20colors%28%22a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928%22%29%3B%0A%0Avar%20Pastel1%20%3D%20colors%28%22fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2%22%29%3B%0A%0Avar%20Pastel2%20%3D%20colors%28%22b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc%22%29%3B%0A%0Avar%20Set1%20%3D%20colors%28%22e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999%22%29%3B%0A%0Avar%20Set2%20%3D%20colors%28%2266c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3%22%29%3B%0A%0Avar%20Set3%20%3D%20colors%28%228dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f%22%29%3B%0A%0Afunction%20ramp%28scheme%29%20%7B%0A%20%20return%20rgbBasis%28scheme%5Bscheme%2Elength%20%2D%201%5D%29%3B%0A%7D%0A%0Avar%20scheme%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22d8b365f5f5f55ab4ac%22%2C%0A%20%20%22a6611adfc27d80cdc1018571%22%2C%0A%20%20%22a6611adfc27df5f5f580cdc1018571%22%2C%0A%20%20%228c510ad8b365f6e8c3c7eae55ab4ac01665e%22%2C%0A%20%20%228c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e%22%2C%0A%20%20%228c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e%22%2C%0A%20%20%228c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e%22%2C%0A%20%20%225430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30%22%2C%0A%20%20%225430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20BrBG%20%3D%20ramp%28scheme%29%3B%0A%0Avar%20scheme%241%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22af8dc3f7f7f77fbf7b%22%2C%0A%20%20%227b3294c2a5cfa6dba0008837%22%2C%0A%20%20%227b3294c2a5cff7f7f7a6dba0008837%22%2C%0A%20%20%22762a83af8dc3e7d4e8d9f0d37fbf7b1b7837%22%2C%0A%20%20%22762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837%22%2C%0A%20%20%22762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837%22%2C%0A%20%20%22762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837%22%2C%0A%20%20%2240004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b%22%2C%0A%20%20%2240004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20PRGn%20%3D%20ramp%28scheme%241%29%3B%0A%0Avar%20scheme%242%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22e9a3c9f7f7f7a1d76a%22%2C%0A%20%20%22d01c8bf1b6dab8e1864dac26%22%2C%0A%20%20%22d01c8bf1b6daf7f7f7b8e1864dac26%22%2C%0A%20%20%22c51b7de9a3c9fde0efe6f5d0a1d76a4d9221%22%2C%0A%20%20%22c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221%22%2C%0A%20%20%22c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221%22%2C%0A%20%20%22c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221%22%2C%0A%20%20%228e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419%22%2C%0A%20%20%228e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20PiYG%20%3D%20ramp%28scheme%242%29%3B%0A%0Avar%20scheme%243%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22998ec3f7f7f7f1a340%22%2C%0A%20%20%225e3c99b2abd2fdb863e66101%22%2C%0A%20%20%225e3c99b2abd2f7f7f7fdb863e66101%22%2C%0A%20%20%22542788998ec3d8daebfee0b6f1a340b35806%22%2C%0A%20%20%22542788998ec3d8daebf7f7f7fee0b6f1a340b35806%22%2C%0A%20%20%225427888073acb2abd2d8daebfee0b6fdb863e08214b35806%22%2C%0A%20%20%225427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806%22%2C%0A%20%20%222d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08%22%2C%0A%20%20%222d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20PuOr%20%3D%20ramp%28scheme%243%29%3B%0A%0Avar%20scheme%244%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22ef8a62f7f7f767a9cf%22%2C%0A%20%20%22ca0020f4a58292c5de0571b0%22%2C%0A%20%20%22ca0020f4a582f7f7f792c5de0571b0%22%2C%0A%20%20%22b2182bef8a62fddbc7d1e5f067a9cf2166ac%22%2C%0A%20%20%22b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac%22%2C%0A%20%20%22b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac%22%2C%0A%20%20%22b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac%22%2C%0A%20%20%2267001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061%22%2C%0A%20%20%2267001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20RdBu%20%3D%20ramp%28scheme%244%29%3B%0A%0Avar%20scheme%245%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22ef8a62ffffff999999%22%2C%0A%20%20%22ca0020f4a582bababa404040%22%2C%0A%20%20%22ca0020f4a582ffffffbababa404040%22%2C%0A%20%20%22b2182bef8a62fddbc7e0e0e09999994d4d4d%22%2C%0A%20%20%22b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d%22%2C%0A%20%20%22b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d%22%2C%0A%20%20%22b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d%22%2C%0A%20%20%2267001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a%22%2C%0A%20%20%2267001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20RdGy%20%3D%20ramp%28scheme%245%29%3B%0A%0Avar%20scheme%246%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22fc8d59ffffbf91bfdb%22%2C%0A%20%20%22d7191cfdae61abd9e92c7bb6%22%2C%0A%20%20%22d7191cfdae61ffffbfabd9e92c7bb6%22%2C%0A%20%20%22d73027fc8d59fee090e0f3f891bfdb4575b4%22%2C%0A%20%20%22d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4%22%2C%0A%20%20%22d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4%22%2C%0A%20%20%22d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4%22%2C%0A%20%20%22a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695%22%2C%0A%20%20%22a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20RdYlBu%20%3D%20ramp%28scheme%246%29%3B%0A%0Avar%20scheme%247%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22fc8d59ffffbf91cf60%22%2C%0A%20%20%22d7191cfdae61a6d96a1a9641%22%2C%0A%20%20%22d7191cfdae61ffffbfa6d96a1a9641%22%2C%0A%20%20%22d73027fc8d59fee08bd9ef8b91cf601a9850%22%2C%0A%20%20%22d73027fc8d59fee08bffffbfd9ef8b91cf601a9850%22%2C%0A%20%20%22d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850%22%2C%0A%20%20%22d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850%22%2C%0A%20%20%22a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837%22%2C%0A%20%20%22a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20RdYlGn%20%3D%20ramp%28scheme%247%29%3B%0A%0Avar%20scheme%248%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22fc8d59ffffbf99d594%22%2C%0A%20%20%22d7191cfdae61abdda42b83ba%22%2C%0A%20%20%22d7191cfdae61ffffbfabdda42b83ba%22%2C%0A%20%20%22d53e4ffc8d59fee08be6f59899d5943288bd%22%2C%0A%20%20%22d53e4ffc8d59fee08bffffbfe6f59899d5943288bd%22%2C%0A%20%20%22d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd%22%2C%0A%20%20%22d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd%22%2C%0A%20%20%229e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2%22%2C%0A%20%20%229e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20Spectral%20%3D%20ramp%28scheme%248%29%3B%0A%0Avar%20scheme%249%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22e5f5f999d8c92ca25f%22%2C%0A%20%20%22edf8fbb2e2e266c2a4238b45%22%2C%0A%20%20%22edf8fbb2e2e266c2a42ca25f006d2c%22%2C%0A%20%20%22edf8fbccece699d8c966c2a42ca25f006d2c%22%2C%0A%20%20%22edf8fbccece699d8c966c2a441ae76238b45005824%22%2C%0A%20%20%22f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824%22%2C%0A%20%20%22f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20BuGn%20%3D%20ramp%28scheme%249%29%3B%0A%0Avar%20scheme%2410%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22e0ecf49ebcda8856a7%22%2C%0A%20%20%22edf8fbb3cde38c96c688419d%22%2C%0A%20%20%22edf8fbb3cde38c96c68856a7810f7c%22%2C%0A%20%20%22edf8fbbfd3e69ebcda8c96c68856a7810f7c%22%2C%0A%20%20%22edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b%22%2C%0A%20%20%22f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b%22%2C%0A%20%20%22f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20BuPu%20%3D%20ramp%28scheme%2410%29%3B%0A%0Avar%20scheme%2411%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22e0f3dba8ddb543a2ca%22%2C%0A%20%20%22f0f9e8bae4bc7bccc42b8cbe%22%2C%0A%20%20%22f0f9e8bae4bc7bccc443a2ca0868ac%22%2C%0A%20%20%22f0f9e8ccebc5a8ddb57bccc443a2ca0868ac%22%2C%0A%20%20%22f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e%22%2C%0A%20%20%22f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e%22%2C%0A%20%20%22f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20GnBu%20%3D%20ramp%28scheme%2411%29%3B%0A%0Avar%20scheme%2412%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22fee8c8fdbb84e34a33%22%2C%0A%20%20%22fef0d9fdcc8afc8d59d7301f%22%2C%0A%20%20%22fef0d9fdcc8afc8d59e34a33b30000%22%2C%0A%20%20%22fef0d9fdd49efdbb84fc8d59e34a33b30000%22%2C%0A%20%20%22fef0d9fdd49efdbb84fc8d59ef6548d7301f990000%22%2C%0A%20%20%22fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000%22%2C%0A%20%20%22fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20OrRd%20%3D%20ramp%28scheme%2412%29%3B%0A%0Avar%20scheme%2413%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22ece2f0a6bddb1c9099%22%2C%0A%20%20%22f6eff7bdc9e167a9cf02818a%22%2C%0A%20%20%22f6eff7bdc9e167a9cf1c9099016c59%22%2C%0A%20%20%22f6eff7d0d1e6a6bddb67a9cf1c9099016c59%22%2C%0A%20%20%22f6eff7d0d1e6a6bddb67a9cf3690c002818a016450%22%2C%0A%20%20%22fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450%22%2C%0A%20%20%22fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20PuBuGn%20%3D%20ramp%28scheme%2413%29%3B%0A%0Avar%20scheme%2414%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22ece7f2a6bddb2b8cbe%22%2C%0A%20%20%22f1eef6bdc9e174a9cf0570b0%22%2C%0A%20%20%22f1eef6bdc9e174a9cf2b8cbe045a8d%22%2C%0A%20%20%22f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d%22%2C%0A%20%20%22f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b%22%2C%0A%20%20%22fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b%22%2C%0A%20%20%22fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20PuBu%20%3D%20ramp%28scheme%2414%29%3B%0A%0Avar%20scheme%2415%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22e7e1efc994c7dd1c77%22%2C%0A%20%20%22f1eef6d7b5d8df65b0ce1256%22%2C%0A%20%20%22f1eef6d7b5d8df65b0dd1c77980043%22%2C%0A%20%20%22f1eef6d4b9dac994c7df65b0dd1c77980043%22%2C%0A%20%20%22f1eef6d4b9dac994c7df65b0e7298ace125691003f%22%2C%0A%20%20%22f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f%22%2C%0A%20%20%22f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20PuRd%20%3D%20ramp%28scheme%2415%29%3B%0A%0Avar%20scheme%2416%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22fde0ddfa9fb5c51b8a%22%2C%0A%20%20%22feebe2fbb4b9f768a1ae017e%22%2C%0A%20%20%22feebe2fbb4b9f768a1c51b8a7a0177%22%2C%0A%20%20%22feebe2fcc5c0fa9fb5f768a1c51b8a7a0177%22%2C%0A%20%20%22feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177%22%2C%0A%20%20%22fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177%22%2C%0A%20%20%22fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20RdPu%20%3D%20ramp%28scheme%2416%29%3B%0A%0Avar%20scheme%2417%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22edf8b17fcdbb2c7fb8%22%2C%0A%20%20%22ffffcca1dab441b6c4225ea8%22%2C%0A%20%20%22ffffcca1dab441b6c42c7fb8253494%22%2C%0A%20%20%22ffffccc7e9b47fcdbb41b6c42c7fb8253494%22%2C%0A%20%20%22ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84%22%2C%0A%20%20%22ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84%22%2C%0A%20%20%22ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20YlGnBu%20%3D%20ramp%28scheme%2417%29%3B%0A%0Avar%20scheme%2418%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22f7fcb9addd8e31a354%22%2C%0A%20%20%22ffffccc2e69978c679238443%22%2C%0A%20%20%22ffffccc2e69978c67931a354006837%22%2C%0A%20%20%22ffffccd9f0a3addd8e78c67931a354006837%22%2C%0A%20%20%22ffffccd9f0a3addd8e78c67941ab5d238443005a32%22%2C%0A%20%20%22ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32%22%2C%0A%20%20%22ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20YlGn%20%3D%20ramp%28scheme%2418%29%3B%0A%0Avar%20scheme%2419%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22fff7bcfec44fd95f0e%22%2C%0A%20%20%22ffffd4fed98efe9929cc4c02%22%2C%0A%20%20%22ffffd4fed98efe9929d95f0e993404%22%2C%0A%20%20%22ffffd4fee391fec44ffe9929d95f0e993404%22%2C%0A%20%20%22ffffd4fee391fec44ffe9929ec7014cc4c028c2d04%22%2C%0A%20%20%22ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04%22%2C%0A%20%20%22ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20YlOrBr%20%3D%20ramp%28scheme%2419%29%3B%0A%0Avar%20scheme%2420%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22ffeda0feb24cf03b20%22%2C%0A%20%20%22ffffb2fecc5cfd8d3ce31a1c%22%2C%0A%20%20%22ffffb2fecc5cfd8d3cf03b20bd0026%22%2C%0A%20%20%22ffffb2fed976feb24cfd8d3cf03b20bd0026%22%2C%0A%20%20%22ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026%22%2C%0A%20%20%22ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026%22%2C%0A%20%20%22ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20YlOrRd%20%3D%20ramp%28scheme%2420%29%3B%0A%0Avar%20scheme%2421%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22deebf79ecae13182bd%22%2C%0A%20%20%22eff3ffbdd7e76baed62171b5%22%2C%0A%20%20%22eff3ffbdd7e76baed63182bd08519c%22%2C%0A%20%20%22eff3ffc6dbef9ecae16baed63182bd08519c%22%2C%0A%20%20%22eff3ffc6dbef9ecae16baed64292c62171b5084594%22%2C%0A%20%20%22f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594%22%2C%0A%20%20%22f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20Blues%20%3D%20ramp%28scheme%2421%29%3B%0A%0Avar%20scheme%2422%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22e5f5e0a1d99b31a354%22%2C%0A%20%20%22edf8e9bae4b374c476238b45%22%2C%0A%20%20%22edf8e9bae4b374c47631a354006d2c%22%2C%0A%20%20%22edf8e9c7e9c0a1d99b74c47631a354006d2c%22%2C%0A%20%20%22edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32%22%2C%0A%20%20%22f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32%22%2C%0A%20%20%22f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20Greens%20%3D%20ramp%28scheme%2422%29%3B%0A%0Avar%20scheme%2423%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22f0f0f0bdbdbd636363%22%2C%0A%20%20%22f7f7f7cccccc969696525252%22%2C%0A%20%20%22f7f7f7cccccc969696636363252525%22%2C%0A%20%20%22f7f7f7d9d9d9bdbdbd969696636363252525%22%2C%0A%20%20%22f7f7f7d9d9d9bdbdbd969696737373525252252525%22%2C%0A%20%20%22fffffff0f0f0d9d9d9bdbdbd969696737373525252252525%22%2C%0A%20%20%22fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20Greys%20%3D%20ramp%28scheme%2423%29%3B%0A%0Avar%20scheme%2424%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22efedf5bcbddc756bb1%22%2C%0A%20%20%22f2f0f7cbc9e29e9ac86a51a3%22%2C%0A%20%20%22f2f0f7cbc9e29e9ac8756bb154278f%22%2C%0A%20%20%22f2f0f7dadaebbcbddc9e9ac8756bb154278f%22%2C%0A%20%20%22f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486%22%2C%0A%20%20%22fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486%22%2C%0A%20%20%22fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20Purples%20%3D%20ramp%28scheme%2424%29%3B%0A%0Avar%20scheme%2425%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22fee0d2fc9272de2d26%22%2C%0A%20%20%22fee5d9fcae91fb6a4acb181d%22%2C%0A%20%20%22fee5d9fcae91fb6a4ade2d26a50f15%22%2C%0A%20%20%22fee5d9fcbba1fc9272fb6a4ade2d26a50f15%22%2C%0A%20%20%22fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d%22%2C%0A%20%20%22fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d%22%2C%0A%20%20%22fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20Reds%20%3D%20ramp%28scheme%2425%29%3B%0A%0Avar%20scheme%2426%20%3D%20new%20Array%283%29%2Econcat%28%0A%20%20%22fee6cefdae6be6550d%22%2C%0A%20%20%22feeddefdbe85fd8d3cd94701%22%2C%0A%20%20%22feeddefdbe85fd8d3ce6550da63603%22%2C%0A%20%20%22feeddefdd0a2fdae6bfd8d3ce6550da63603%22%2C%0A%20%20%22feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04%22%2C%0A%20%20%22fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04%22%2C%0A%20%20%22fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704%22%0A%29%2Emap%28colors%29%3B%0A%0Avar%20Oranges%20%3D%20ramp%28scheme%2426%29%3B%0A%0Avar%20cubehelix%243%20%3D%20cubehelixLong%28cubehelix%28300%2C%200%2E5%2C%200%2E0%29%2C%20cubehelix%28%2D240%2C%200%2E5%2C%201%2E0%29%29%3B%0A%0Avar%20warm%20%3D%20cubehelixLong%28cubehelix%28%2D100%2C%200%2E75%2C%200%2E35%29%2C%20cubehelix%2880%2C%201%2E50%2C%200%2E8%29%29%3B%0A%0Avar%20cool%20%3D%20cubehelixLong%28cubehelix%28260%2C%200%2E75%2C%200%2E35%29%2C%20cubehelix%2880%2C%201%2E50%2C%200%2E8%29%29%3B%0A%0Avar%20rainbow%20%3D%20cubehelix%28%29%3B%0A%0Afunction%20rainbow%241%28t%29%20%7B%0A%20%20if%20%28t%20%3C%200%20%7C%7C%20t%20%3E%201%29%20t%20%2D%3D%20Math%2Efloor%28t%29%3B%0A%20%20var%20ts%20%3D%20Math%2Eabs%28t%20%2D%200%2E5%29%3B%0A%20%20rainbow%2Eh%20%3D%20360%20%2A%20t%20%2D%20100%3B%0A%20%20rainbow%2Es%20%3D%201%2E5%20%2D%201%2E5%20%2A%20ts%3B%0A%20%20rainbow%2El%20%3D%200%2E8%20%2D%200%2E9%20%2A%20ts%3B%0A%20%20return%20rainbow%20%2B%20%22%22%3B%0A%7D%0A%0Afunction%20ramp%241%28range%29%20%7B%0A%20%20var%20n%20%3D%20range%2Elength%3B%0A%20%20return%20function%28t%29%20%7B%0A%20%20%20%20return%20range%5BMath%2Emax%280%2C%20Math%2Emin%28n%20%2D%201%2C%20Math%2Efloor%28t%20%2A%20n%29%29%29%5D%3B%0A%20%20%7D%3B%0A%7D%0A%0Avar%20viridis%20%3D%20ramp%241%28colors%28%2244015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725%22%29%29%3B%0A%0Avar%20magma%20%3D%20ramp%241%28colors%28%2200000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf%22%29%29%3B%0A%0Avar%20inferno%20%3D%20ramp%241%28colors%28%2200000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4%22%29%29%3B%0A%0Avar%20plasma%20%3D%20ramp%241%28colors%28%220d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921%22%29%29%3B%0A%0Afunction%20constant%2411%28x%29%20%7B%0A%20%20return%20function%20constant%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Avar%20abs%241%20%3D%20Math%2Eabs%3B%0Avar%20atan2%241%20%3D%20Math%2Eatan2%3B%0Avar%20cos%242%20%3D%20Math%2Ecos%3B%0Avar%20max%242%20%3D%20Math%2Emax%3B%0Avar%20min%241%20%3D%20Math%2Emin%3B%0Avar%20sin%242%20%3D%20Math%2Esin%3B%0Avar%20sqrt%242%20%3D%20Math%2Esqrt%3B%0A%0Avar%20epsilon%243%20%3D%201e%2D12%3B%0Avar%20pi%244%20%3D%20Math%2EPI%3B%0Avar%20halfPi%243%20%3D%20pi%244%20%2F%202%3B%0Avar%20tau%244%20%3D%202%20%2A%20pi%244%3B%0A%0Afunction%20acos%241%28x%29%20%7B%0A%20%20return%20x%20%3E%201%20%3F%200%20%3A%20x%20%3C%20%2D1%20%3F%20pi%244%20%3A%20Math%2Eacos%28x%29%3B%0A%7D%0A%0Afunction%20asin%241%28x%29%20%7B%0A%20%20return%20x%20%3E%3D%201%20%3F%20halfPi%243%20%3A%20x%20%3C%3D%20%2D1%20%3F%20%2DhalfPi%243%20%3A%20Math%2Easin%28x%29%3B%0A%7D%0A%0Afunction%20arcInnerRadius%28d%29%20%7B%0A%20%20return%20d%2EinnerRadius%3B%0A%7D%0A%0Afunction%20arcOuterRadius%28d%29%20%7B%0A%20%20return%20d%2EouterRadius%3B%0A%7D%0A%0Afunction%20arcStartAngle%28d%29%20%7B%0A%20%20return%20d%2EstartAngle%3B%0A%7D%0A%0Afunction%20arcEndAngle%28d%29%20%7B%0A%20%20return%20d%2EendAngle%3B%0A%7D%0A%0Afunction%20arcPadAngle%28d%29%20%7B%0A%20%20return%20d%20%26%26%20d%2EpadAngle%3B%20%2F%2F%20Note%3A%20optional%21%0A%7D%0A%0Afunction%20intersect%28x0%2C%20y0%2C%20x1%2C%20y1%2C%20x2%2C%20y2%2C%20x3%2C%20y3%29%20%7B%0A%20%20var%20x10%20%3D%20x1%20%2D%20x0%2C%20y10%20%3D%20y1%20%2D%20y0%2C%0A%20%20%20%20%20%20x32%20%3D%20x3%20%2D%20x2%2C%20y32%20%3D%20y3%20%2D%20y2%2C%0A%20%20%20%20%20%20t%20%3D%20%28x32%20%2A%20%28y0%20%2D%20y2%29%20%2D%20y32%20%2A%20%28x0%20%2D%20x2%29%29%20%2F%20%28y32%20%2A%20x10%20%2D%20x32%20%2A%20y10%29%3B%0A%20%20return%20%5Bx0%20%2B%20t%20%2A%20x10%2C%20y0%20%2B%20t%20%2A%20y10%5D%3B%0A%7D%0A%0A%2F%2F%20Compute%20perpendicular%20offset%20line%20of%20length%20rc%2E%0A%2F%2F%20http%3A%2F%2Fmathworld%2Ewolfram%2Ecom%2FCircle%2DLineIntersection%2Ehtml%0Afunction%20cornerTangents%28x0%2C%20y0%2C%20x1%2C%20y1%2C%20r1%2C%20rc%2C%20cw%29%20%7B%0A%20%20var%20x01%20%3D%20x0%20%2D%20x1%2C%0A%20%20%20%20%20%20y01%20%3D%20y0%20%2D%20y1%2C%0A%20%20%20%20%20%20lo%20%3D%20%28cw%20%3F%20rc%20%3A%20%2Drc%29%20%2F%20sqrt%242%28x01%20%2A%20x01%20%2B%20y01%20%2A%20y01%29%2C%0A%20%20%20%20%20%20ox%20%3D%20lo%20%2A%20y01%2C%0A%20%20%20%20%20%20oy%20%3D%20%2Dlo%20%2A%20x01%2C%0A%20%20%20%20%20%20x11%20%3D%20x0%20%2B%20ox%2C%0A%20%20%20%20%20%20y11%20%3D%20y0%20%2B%20oy%2C%0A%20%20%20%20%20%20x10%20%3D%20x1%20%2B%20ox%2C%0A%20%20%20%20%20%20y10%20%3D%20y1%20%2B%20oy%2C%0A%20%20%20%20%20%20x00%20%3D%20%28x11%20%2B%20x10%29%20%2F%202%2C%0A%20%20%20%20%20%20y00%20%3D%20%28y11%20%2B%20y10%29%20%2F%202%2C%0A%20%20%20%20%20%20dx%20%3D%20x10%20%2D%20x11%2C%0A%20%20%20%20%20%20dy%20%3D%20y10%20%2D%20y11%2C%0A%20%20%20%20%20%20d2%20%3D%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%2C%0A%20%20%20%20%20%20r%20%3D%20r1%20%2D%20rc%2C%0A%20%20%20%20%20%20D%20%3D%20x11%20%2A%20y10%20%2D%20x10%20%2A%20y11%2C%0A%20%20%20%20%20%20d%20%3D%20%28dy%20%3C%200%20%3F%20%2D1%20%3A%201%29%20%2A%20sqrt%242%28max%242%280%2C%20r%20%2A%20r%20%2A%20d2%20%2D%20D%20%2A%20D%29%29%2C%0A%20%20%20%20%20%20cx0%20%3D%20%28D%20%2A%20dy%20%2D%20dx%20%2A%20d%29%20%2F%20d2%2C%0A%20%20%20%20%20%20cy0%20%3D%20%28%2DD%20%2A%20dx%20%2D%20dy%20%2A%20d%29%20%2F%20d2%2C%0A%20%20%20%20%20%20cx1%20%3D%20%28D%20%2A%20dy%20%2B%20dx%20%2A%20d%29%20%2F%20d2%2C%0A%20%20%20%20%20%20cy1%20%3D%20%28%2DD%20%2A%20dx%20%2B%20dy%20%2A%20d%29%20%2F%20d2%2C%0A%20%20%20%20%20%20dx0%20%3D%20cx0%20%2D%20x00%2C%0A%20%20%20%20%20%20dy0%20%3D%20cy0%20%2D%20y00%2C%0A%20%20%20%20%20%20dx1%20%3D%20cx1%20%2D%20x00%2C%0A%20%20%20%20%20%20dy1%20%3D%20cy1%20%2D%20y00%3B%0A%0A%20%20%2F%2F%20Pick%20the%20closer%20of%20the%20two%20intersection%20points%2E%0A%20%20%2F%2F%20TODO%20Is%20there%20a%20faster%20way%20to%20determine%20which%20intersection%20to%20use%3F%0A%20%20if%20%28dx0%20%2A%20dx0%20%2B%20dy0%20%2A%20dy0%20%3E%20dx1%20%2A%20dx1%20%2B%20dy1%20%2A%20dy1%29%20cx0%20%3D%20cx1%2C%20cy0%20%3D%20cy1%3B%0A%0A%20%20return%20%7B%0A%20%20%20%20cx%3A%20cx0%2C%0A%20%20%20%20cy%3A%20cy0%2C%0A%20%20%20%20x01%3A%20%2Dox%2C%0A%20%20%20%20y01%3A%20%2Doy%2C%0A%20%20%20%20x11%3A%20cx0%20%2A%20%28r1%20%2F%20r%20%2D%201%29%2C%0A%20%20%20%20y11%3A%20cy0%20%2A%20%28r1%20%2F%20r%20%2D%201%29%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20arc%28%29%20%7B%0A%20%20var%20innerRadius%20%3D%20arcInnerRadius%2C%0A%20%20%20%20%20%20outerRadius%20%3D%20arcOuterRadius%2C%0A%20%20%20%20%20%20cornerRadius%20%3D%20constant%2411%280%29%2C%0A%20%20%20%20%20%20padRadius%20%3D%20null%2C%0A%20%20%20%20%20%20startAngle%20%3D%20arcStartAngle%2C%0A%20%20%20%20%20%20endAngle%20%3D%20arcEndAngle%2C%0A%20%20%20%20%20%20padAngle%20%3D%20arcPadAngle%2C%0A%20%20%20%20%20%20context%20%3D%20null%3B%0A%0A%20%20function%20arc%28%29%20%7B%0A%20%20%20%20var%20buffer%2C%0A%20%20%20%20%20%20%20%20r%2C%0A%20%20%20%20%20%20%20%20r0%20%3D%20%2BinnerRadius%2Eapply%28this%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20r1%20%3D%20%2BouterRadius%2Eapply%28this%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20a0%20%3D%20startAngle%2Eapply%28this%2C%20arguments%29%20%2D%20halfPi%243%2C%0A%20%20%20%20%20%20%20%20a1%20%3D%20endAngle%2Eapply%28this%2C%20arguments%29%20%2D%20halfPi%243%2C%0A%20%20%20%20%20%20%20%20da%20%3D%20abs%241%28a1%20%2D%20a0%29%2C%0A%20%20%20%20%20%20%20%20cw%20%3D%20a1%20%3E%20a0%3B%0A%0A%20%20%20%20if%20%28%21context%29%20context%20%3D%20buffer%20%3D%20path%28%29%3B%0A%0A%20%20%20%20%2F%2F%20Ensure%20that%20the%20outer%20radius%20is%20always%20larger%20than%20the%20inner%20radius%2E%0A%20%20%20%20if%20%28r1%20%3C%20r0%29%20r%20%3D%20r1%2C%20r1%20%3D%20r0%2C%20r0%20%3D%20r%3B%0A%0A%20%20%20%20%2F%2F%20Is%20it%20a%20point%3F%0A%20%20%20%20if%20%28%21%28r1%20%3E%20epsilon%243%29%29%20context%2EmoveTo%280%2C%200%29%3B%0A%0A%20%20%20%20%2F%2F%20Or%20is%20it%20a%20circle%20or%20annulus%3F%0A%20%20%20%20else%20if%20%28da%20%3E%20tau%244%20%2D%20epsilon%243%29%20%7B%0A%20%20%20%20%20%20context%2EmoveTo%28r1%20%2A%20cos%242%28a0%29%2C%20r1%20%2A%20sin%242%28a0%29%29%3B%0A%20%20%20%20%20%20context%2Earc%280%2C%200%2C%20r1%2C%20a0%2C%20a1%2C%20%21cw%29%3B%0A%20%20%20%20%20%20if%20%28r0%20%3E%20epsilon%243%29%20%7B%0A%20%20%20%20%20%20%20%20context%2EmoveTo%28r0%20%2A%20cos%242%28a1%29%2C%20r0%20%2A%20sin%242%28a1%29%29%3B%0A%20%20%20%20%20%20%20%20context%2Earc%280%2C%200%2C%20r0%2C%20a1%2C%20a0%2C%20cw%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Or%20is%20it%20a%20circular%20or%20annular%20sector%3F%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20var%20a01%20%3D%20a0%2C%0A%20%20%20%20%20%20%20%20%20%20a11%20%3D%20a1%2C%0A%20%20%20%20%20%20%20%20%20%20a00%20%3D%20a0%2C%0A%20%20%20%20%20%20%20%20%20%20a10%20%3D%20a1%2C%0A%20%20%20%20%20%20%20%20%20%20da0%20%3D%20da%2C%0A%20%20%20%20%20%20%20%20%20%20da1%20%3D%20da%2C%0A%20%20%20%20%20%20%20%20%20%20ap%20%3D%20padAngle%2Eapply%28this%2C%20arguments%29%20%2F%202%2C%0A%20%20%20%20%20%20%20%20%20%20rp%20%3D%20%28ap%20%3E%20epsilon%243%29%20%26%26%20%28padRadius%20%3F%20%2BpadRadius%2Eapply%28this%2C%20arguments%29%20%3A%20sqrt%242%28r0%20%2A%20r0%20%2B%20r1%20%2A%20r1%29%29%2C%0A%20%20%20%20%20%20%20%20%20%20rc%20%3D%20min%241%28abs%241%28r1%20%2D%20r0%29%20%2F%202%2C%20%2BcornerRadius%2Eapply%28this%2C%20arguments%29%29%2C%0A%20%20%20%20%20%20%20%20%20%20rc0%20%3D%20rc%2C%0A%20%20%20%20%20%20%20%20%20%20rc1%20%3D%20rc%2C%0A%20%20%20%20%20%20%20%20%20%20t0%2C%0A%20%20%20%20%20%20%20%20%20%20t1%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Apply%20padding%3F%20Note%20that%20since%20r1%20%E2%89%A5%20r0%2C%20da1%20%E2%89%A5%20da0%2E%0A%20%20%20%20%20%20if%20%28rp%20%3E%20epsilon%243%29%20%7B%0A%20%20%20%20%20%20%20%20var%20p0%20%3D%20asin%241%28rp%20%2F%20r0%20%2A%20sin%242%28ap%29%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20p1%20%3D%20asin%241%28rp%20%2F%20r1%20%2A%20sin%242%28ap%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28%28da0%20%2D%3D%20p0%20%2A%202%29%20%3E%20epsilon%243%29%20p0%20%2A%3D%20%28cw%20%3F%201%20%3A%20%2D1%29%2C%20a00%20%2B%3D%20p0%2C%20a10%20%2D%3D%20p0%3B%0A%20%20%20%20%20%20%20%20else%20da0%20%3D%200%2C%20a00%20%3D%20a10%20%3D%20%28a0%20%2B%20a1%29%20%2F%202%3B%0A%20%20%20%20%20%20%20%20if%20%28%28da1%20%2D%3D%20p1%20%2A%202%29%20%3E%20epsilon%243%29%20p1%20%2A%3D%20%28cw%20%3F%201%20%3A%20%2D1%29%2C%20a01%20%2B%3D%20p1%2C%20a11%20%2D%3D%20p1%3B%0A%20%20%20%20%20%20%20%20else%20da1%20%3D%200%2C%20a01%20%3D%20a11%20%3D%20%28a0%20%2B%20a1%29%20%2F%202%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20var%20x01%20%3D%20r1%20%2A%20cos%242%28a01%29%2C%0A%20%20%20%20%20%20%20%20%20%20y01%20%3D%20r1%20%2A%20sin%242%28a01%29%2C%0A%20%20%20%20%20%20%20%20%20%20x10%20%3D%20r0%20%2A%20cos%242%28a10%29%2C%0A%20%20%20%20%20%20%20%20%20%20y10%20%3D%20r0%20%2A%20sin%242%28a10%29%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Apply%20rounded%20corners%3F%0A%20%20%20%20%20%20if%20%28rc%20%3E%20epsilon%243%29%20%7B%0A%20%20%20%20%20%20%20%20var%20x11%20%3D%20r1%20%2A%20cos%242%28a11%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y11%20%3D%20r1%20%2A%20sin%242%28a11%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20x00%20%3D%20r0%20%2A%20cos%242%28a00%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y00%20%3D%20r0%20%2A%20sin%242%28a00%29%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Restrict%20the%20corner%20radius%20according%20to%20the%20sector%20angle%2E%0A%20%20%20%20%20%20%20%20if%20%28da%20%3C%20pi%244%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20oc%20%3D%20da0%20%3E%20epsilon%243%20%3F%20intersect%28x01%2C%20y01%2C%20x00%2C%20y00%2C%20x11%2C%20y11%2C%20x10%2C%20y10%29%20%3A%20%5Bx10%2C%20y10%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20ax%20%3D%20x01%20%2D%20oc%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20ay%20%3D%20y01%20%2D%20oc%5B1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20bx%20%3D%20x11%20%2D%20oc%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20by%20%3D%20y11%20%2D%20oc%5B1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20kc%20%3D%201%20%2F%20sin%242%28acos%241%28%28ax%20%2A%20bx%20%2B%20ay%20%2A%20by%29%20%2F%20%28sqrt%242%28ax%20%2A%20ax%20%2B%20ay%20%2A%20ay%29%20%2A%20sqrt%242%28bx%20%2A%20bx%20%2B%20by%20%2A%20by%29%29%29%20%2F%202%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20lc%20%3D%20sqrt%242%28oc%5B0%5D%20%2A%20oc%5B0%5D%20%2B%20oc%5B1%5D%20%2A%20oc%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20rc0%20%3D%20min%241%28rc%2C%20%28r0%20%2D%20lc%29%20%2F%20%28kc%20%2D%201%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20rc1%20%3D%20min%241%28rc%2C%20%28r1%20%2D%20lc%29%20%2F%20%28kc%20%2B%201%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20Is%20the%20sector%20collapsed%20to%20a%20line%3F%0A%20%20%20%20%20%20if%20%28%21%28da1%20%3E%20epsilon%243%29%29%20context%2EmoveTo%28x01%2C%20y01%29%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Does%20the%20sector%E2%80%99s%20outer%20ring%20have%20rounded%20corners%3F%0A%20%20%20%20%20%20else%20if%20%28rc1%20%3E%20epsilon%243%29%20%7B%0A%20%20%20%20%20%20%20%20t0%20%3D%20cornerTangents%28x00%2C%20y00%2C%20x01%2C%20y01%2C%20r1%2C%20rc1%2C%20cw%29%3B%0A%20%20%20%20%20%20%20%20t1%20%3D%20cornerTangents%28x11%2C%20y11%2C%20x10%2C%20y10%2C%20r1%2C%20rc1%2C%20cw%29%3B%0A%0A%20%20%20%20%20%20%20%20context%2EmoveTo%28t0%2Ecx%20%2B%20t0%2Ex01%2C%20t0%2Ecy%20%2B%20t0%2Ey01%29%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Have%20the%20corners%20merged%3F%0A%20%20%20%20%20%20%20%20if%20%28rc1%20%3C%20rc%29%20context%2Earc%28t0%2Ecx%2C%20t0%2Ecy%2C%20rc1%2C%20atan2%241%28t0%2Ey01%2C%20t0%2Ex01%29%2C%20atan2%241%28t1%2Ey01%2C%20t1%2Ex01%29%2C%20%21cw%29%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Otherwise%2C%20draw%20the%20two%20corners%20and%20the%20ring%2E%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20context%2Earc%28t0%2Ecx%2C%20t0%2Ecy%2C%20rc1%2C%20atan2%241%28t0%2Ey01%2C%20t0%2Ex01%29%2C%20atan2%241%28t0%2Ey11%2C%20t0%2Ex11%29%2C%20%21cw%29%3B%0A%20%20%20%20%20%20%20%20%20%20context%2Earc%280%2C%200%2C%20r1%2C%20atan2%241%28t0%2Ecy%20%2B%20t0%2Ey11%2C%20t0%2Ecx%20%2B%20t0%2Ex11%29%2C%20atan2%241%28t1%2Ecy%20%2B%20t1%2Ey11%2C%20t1%2Ecx%20%2B%20t1%2Ex11%29%2C%20%21cw%29%3B%0A%20%20%20%20%20%20%20%20%20%20context%2Earc%28t1%2Ecx%2C%20t1%2Ecy%2C%20rc1%2C%20atan2%241%28t1%2Ey11%2C%20t1%2Ex11%29%2C%20atan2%241%28t1%2Ey01%2C%20t1%2Ex01%29%2C%20%21cw%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20Or%20is%20the%20outer%20ring%20just%20a%20circular%20arc%3F%0A%20%20%20%20%20%20else%20context%2EmoveTo%28x01%2C%20y01%29%2C%20context%2Earc%280%2C%200%2C%20r1%2C%20a01%2C%20a11%2C%20%21cw%29%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Is%20there%20no%20inner%20ring%2C%20and%20it%E2%80%99s%20a%20circular%20sector%3F%0A%20%20%20%20%20%20%2F%2F%20Or%20perhaps%20it%E2%80%99s%20an%20annular%20sector%20collapsed%20due%20to%20padding%3F%0A%20%20%20%20%20%20if%20%28%21%28r0%20%3E%20epsilon%243%29%20%7C%7C%20%21%28da0%20%3E%20epsilon%243%29%29%20context%2ElineTo%28x10%2C%20y10%29%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Does%20the%20sector%E2%80%99s%20inner%20ring%20%28or%20point%29%20have%20rounded%20corners%3F%0A%20%20%20%20%20%20else%20if%20%28rc0%20%3E%20epsilon%243%29%20%7B%0A%20%20%20%20%20%20%20%20t0%20%3D%20cornerTangents%28x10%2C%20y10%2C%20x11%2C%20y11%2C%20r0%2C%20%2Drc0%2C%20cw%29%3B%0A%20%20%20%20%20%20%20%20t1%20%3D%20cornerTangents%28x01%2C%20y01%2C%20x00%2C%20y00%2C%20r0%2C%20%2Drc0%2C%20cw%29%3B%0A%0A%20%20%20%20%20%20%20%20context%2ElineTo%28t0%2Ecx%20%2B%20t0%2Ex01%2C%20t0%2Ecy%20%2B%20t0%2Ey01%29%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Have%20the%20corners%20merged%3F%0A%20%20%20%20%20%20%20%20if%20%28rc0%20%3C%20rc%29%20context%2Earc%28t0%2Ecx%2C%20t0%2Ecy%2C%20rc0%2C%20atan2%241%28t0%2Ey01%2C%20t0%2Ex01%29%2C%20atan2%241%28t1%2Ey01%2C%20t1%2Ex01%29%2C%20%21cw%29%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Otherwise%2C%20draw%20the%20two%20corners%20and%20the%20ring%2E%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20context%2Earc%28t0%2Ecx%2C%20t0%2Ecy%2C%20rc0%2C%20atan2%241%28t0%2Ey01%2C%20t0%2Ex01%29%2C%20atan2%241%28t0%2Ey11%2C%20t0%2Ex11%29%2C%20%21cw%29%3B%0A%20%20%20%20%20%20%20%20%20%20context%2Earc%280%2C%200%2C%20r0%2C%20atan2%241%28t0%2Ecy%20%2B%20t0%2Ey11%2C%20t0%2Ecx%20%2B%20t0%2Ex11%29%2C%20atan2%241%28t1%2Ecy%20%2B%20t1%2Ey11%2C%20t1%2Ecx%20%2B%20t1%2Ex11%29%2C%20cw%29%3B%0A%20%20%20%20%20%20%20%20%20%20context%2Earc%28t1%2Ecx%2C%20t1%2Ecy%2C%20rc0%2C%20atan2%241%28t1%2Ey11%2C%20t1%2Ex11%29%2C%20atan2%241%28t1%2Ey01%2C%20t1%2Ex01%29%2C%20%21cw%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20Or%20is%20the%20inner%20ring%20just%20a%20circular%20arc%3F%0A%20%20%20%20%20%20else%20context%2Earc%280%2C%200%2C%20r0%2C%20a10%2C%20a00%2C%20cw%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20context%2EclosePath%28%29%3B%0A%0A%20%20%20%20if%20%28buffer%29%20return%20context%20%3D%20null%2C%20buffer%20%2B%20%22%22%20%7C%7C%20null%3B%0A%20%20%7D%0A%0A%20%20arc%2Ecentroid%20%3D%20function%28%29%20%7B%0A%20%20%20%20var%20r%20%3D%20%28%2BinnerRadius%2Eapply%28this%2C%20arguments%29%20%2B%20%2BouterRadius%2Eapply%28this%2C%20arguments%29%29%20%2F%202%2C%0A%20%20%20%20%20%20%20%20a%20%3D%20%28%2BstartAngle%2Eapply%28this%2C%20arguments%29%20%2B%20%2BendAngle%2Eapply%28this%2C%20arguments%29%29%20%2F%202%20%2D%20pi%244%20%2F%202%3B%0A%20%20%20%20return%20%5Bcos%242%28a%29%20%2A%20r%2C%20sin%242%28a%29%20%2A%20r%5D%3B%0A%20%20%7D%3B%0A%0A%20%20arc%2EinnerRadius%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28innerRadius%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20arc%29%20%3A%20innerRadius%3B%0A%20%20%7D%3B%0A%0A%20%20arc%2EouterRadius%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28outerRadius%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20arc%29%20%3A%20outerRadius%3B%0A%20%20%7D%3B%0A%0A%20%20arc%2EcornerRadius%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28cornerRadius%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20arc%29%20%3A%20cornerRadius%3B%0A%20%20%7D%3B%0A%0A%20%20arc%2EpadRadius%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28padRadius%20%3D%20%5F%20%3D%3D%20null%20%3F%20null%20%3A%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20arc%29%20%3A%20padRadius%3B%0A%20%20%7D%3B%0A%0A%20%20arc%2EstartAngle%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28startAngle%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20arc%29%20%3A%20startAngle%3B%0A%20%20%7D%3B%0A%0A%20%20arc%2EendAngle%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28endAngle%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20arc%29%20%3A%20endAngle%3B%0A%20%20%7D%3B%0A%0A%20%20arc%2EpadAngle%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28padAngle%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20arc%29%20%3A%20padAngle%3B%0A%20%20%7D%3B%0A%0A%20%20arc%2Econtext%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28context%20%3D%20%5F%20%3D%3D%20null%20%3F%20null%20%3A%20%5F%2C%20arc%29%20%3A%20context%3B%0A%20%20%7D%3B%0A%0A%20%20return%20arc%3B%0A%7D%0A%0Afunction%20Linear%28context%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%7D%0A%0ALinear%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20areaEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20if%20%28this%2E%5Fline%20%7C%7C%20%28this%2E%5Fline%20%21%3D%3D%200%20%26%26%20this%2E%5Fpoint%20%3D%3D%3D%201%29%29%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20this%2E%5Fline%20%3D%201%20%2D%20this%2E%5Fline%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%3B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20this%2E%5Fpoint%20%3D%201%3B%20this%2E%5Fline%20%3F%20this%2E%5Fcontext%2ElineTo%28x%2C%20y%29%20%3A%20this%2E%5Fcontext%2EmoveTo%28x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%20%20case%201%3A%20this%2E%5Fpoint%20%3D%202%3B%20%2F%2F%20proceed%0A%20%20%20%20%20%20default%3A%20this%2E%5Fcontext%2ElineTo%28x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20curveLinear%28context%29%20%7B%0A%20%20return%20new%20Linear%28context%29%3B%0A%7D%0A%0Afunction%20x%243%28p%29%20%7B%0A%20%20return%20p%5B0%5D%3B%0A%7D%0A%0Afunction%20y%243%28p%29%20%7B%0A%20%20return%20p%5B1%5D%3B%0A%7D%0A%0Afunction%20line%28%29%20%7B%0A%20%20var%20x%24%241%20%3D%20x%243%2C%0A%20%20%20%20%20%20y%24%241%20%3D%20y%243%2C%0A%20%20%20%20%20%20defined%20%3D%20constant%2411%28true%29%2C%0A%20%20%20%20%20%20context%20%3D%20null%2C%0A%20%20%20%20%20%20curve%20%3D%20curveLinear%2C%0A%20%20%20%20%20%20output%20%3D%20null%3B%0A%0A%20%20function%20line%28data%29%20%7B%0A%20%20%20%20var%20i%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20data%2Elength%2C%0A%20%20%20%20%20%20%20%20d%2C%0A%20%20%20%20%20%20%20%20defined0%20%3D%20false%2C%0A%20%20%20%20%20%20%20%20buffer%3B%0A%0A%20%20%20%20if%20%28context%20%3D%3D%20null%29%20output%20%3D%20curve%28buffer%20%3D%20path%28%29%29%3B%0A%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28%21%28i%20%3C%20n%20%26%26%20defined%28d%20%3D%20data%5Bi%5D%2C%20i%2C%20data%29%29%20%3D%3D%3D%20defined0%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28defined0%20%3D%20%21defined0%29%20output%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20else%20output%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28defined0%29%20output%2Epoint%28%2Bx%24%241%28d%2C%20i%2C%20data%29%2C%20%2By%24%241%28d%2C%20i%2C%20data%29%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28buffer%29%20return%20output%20%3D%20null%2C%20buffer%20%2B%20%22%22%20%7C%7C%20null%3B%0A%20%20%7D%0A%0A%20%20line%2Ex%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28x%24%241%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20line%29%20%3A%20x%24%241%3B%0A%20%20%7D%3B%0A%0A%20%20line%2Ey%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28y%24%241%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20line%29%20%3A%20y%24%241%3B%0A%20%20%7D%3B%0A%0A%20%20line%2Edefined%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28defined%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%21%21%5F%29%2C%20line%29%20%3A%20defined%3B%0A%20%20%7D%3B%0A%0A%20%20line%2Ecurve%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28curve%20%3D%20%5F%2C%20context%20%21%3D%20null%20%26%26%20%28output%20%3D%20curve%28context%29%29%2C%20line%29%20%3A%20curve%3B%0A%20%20%7D%3B%0A%0A%20%20line%2Econtext%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28%5F%20%3D%3D%20null%20%3F%20context%20%3D%20output%20%3D%20null%20%3A%20output%20%3D%20curve%28context%20%3D%20%5F%29%2C%20line%29%20%3A%20context%3B%0A%20%20%7D%3B%0A%0A%20%20return%20line%3B%0A%7D%0A%0Afunction%20area%243%28%29%20%7B%0A%20%20var%20x0%20%3D%20x%243%2C%0A%20%20%20%20%20%20x1%20%3D%20null%2C%0A%20%20%20%20%20%20y0%20%3D%20constant%2411%280%29%2C%0A%20%20%20%20%20%20y1%20%3D%20y%243%2C%0A%20%20%20%20%20%20defined%20%3D%20constant%2411%28true%29%2C%0A%20%20%20%20%20%20context%20%3D%20null%2C%0A%20%20%20%20%20%20curve%20%3D%20curveLinear%2C%0A%20%20%20%20%20%20output%20%3D%20null%3B%0A%0A%20%20function%20area%28data%29%20%7B%0A%20%20%20%20var%20i%2C%0A%20%20%20%20%20%20%20%20j%2C%0A%20%20%20%20%20%20%20%20k%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20data%2Elength%2C%0A%20%20%20%20%20%20%20%20d%2C%0A%20%20%20%20%20%20%20%20defined0%20%3D%20false%2C%0A%20%20%20%20%20%20%20%20buffer%2C%0A%20%20%20%20%20%20%20%20x0z%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20%20%20y0z%20%3D%20new%20Array%28n%29%3B%0A%0A%20%20%20%20if%20%28context%20%3D%3D%20null%29%20output%20%3D%20curve%28buffer%20%3D%20path%28%29%29%3B%0A%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28%21%28i%20%3C%20n%20%26%26%20defined%28d%20%3D%20data%5Bi%5D%2C%20i%2C%20data%29%29%20%3D%3D%3D%20defined0%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28defined0%20%3D%20%21defined0%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20j%20%3D%20i%3B%0A%20%20%20%20%20%20%20%20%20%20output%2EareaStart%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20output%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20output%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20output%2ElineStart%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28k%20%3D%20i%20%2D%201%3B%20k%20%3E%3D%20j%3B%20%2D%2Dk%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20output%2Epoint%28x0z%5Bk%5D%2C%20y0z%5Bk%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20output%2ElineEnd%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20output%2EareaEnd%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28defined0%29%20%7B%0A%20%20%20%20%20%20%20%20x0z%5Bi%5D%20%3D%20%2Bx0%28d%2C%20i%2C%20data%29%2C%20y0z%5Bi%5D%20%3D%20%2By0%28d%2C%20i%2C%20data%29%3B%0A%20%20%20%20%20%20%20%20output%2Epoint%28x1%20%3F%20%2Bx1%28d%2C%20i%2C%20data%29%20%3A%20x0z%5Bi%5D%2C%20y1%20%3F%20%2By1%28d%2C%20i%2C%20data%29%20%3A%20y0z%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28buffer%29%20return%20output%20%3D%20null%2C%20buffer%20%2B%20%22%22%20%7C%7C%20null%3B%0A%20%20%7D%0A%0A%20%20function%20arealine%28%29%20%7B%0A%20%20%20%20return%20line%28%29%2Edefined%28defined%29%2Ecurve%28curve%29%2Econtext%28context%29%3B%0A%20%20%7D%0A%0A%20%20area%2Ex%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28x0%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20x1%20%3D%20null%2C%20area%29%20%3A%20x0%3B%0A%20%20%7D%3B%0A%0A%20%20area%2Ex0%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28x0%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20area%29%20%3A%20x0%3B%0A%20%20%7D%3B%0A%0A%20%20area%2Ex1%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28x1%20%3D%20%5F%20%3D%3D%20null%20%3F%20null%20%3A%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20area%29%20%3A%20x1%3B%0A%20%20%7D%3B%0A%0A%20%20area%2Ey%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28y0%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20y1%20%3D%20null%2C%20area%29%20%3A%20y0%3B%0A%20%20%7D%3B%0A%0A%20%20area%2Ey0%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28y0%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20area%29%20%3A%20y0%3B%0A%20%20%7D%3B%0A%0A%20%20area%2Ey1%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28y1%20%3D%20%5F%20%3D%3D%20null%20%3F%20null%20%3A%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20area%29%20%3A%20y1%3B%0A%20%20%7D%3B%0A%0A%20%20area%2ElineX0%20%3D%0A%20%20area%2ElineY0%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20arealine%28%29%2Ex%28x0%29%2Ey%28y0%29%3B%0A%20%20%7D%3B%0A%0A%20%20area%2ElineY1%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20arealine%28%29%2Ex%28x0%29%2Ey%28y1%29%3B%0A%20%20%7D%3B%0A%0A%20%20area%2ElineX1%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20arealine%28%29%2Ex%28x1%29%2Ey%28y0%29%3B%0A%20%20%7D%3B%0A%0A%20%20area%2Edefined%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28defined%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%21%21%5F%29%2C%20area%29%20%3A%20defined%3B%0A%20%20%7D%3B%0A%0A%20%20area%2Ecurve%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28curve%20%3D%20%5F%2C%20context%20%21%3D%20null%20%26%26%20%28output%20%3D%20curve%28context%29%29%2C%20area%29%20%3A%20curve%3B%0A%20%20%7D%3B%0A%0A%20%20area%2Econtext%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28%5F%20%3D%3D%20null%20%3F%20context%20%3D%20output%20%3D%20null%20%3A%20output%20%3D%20curve%28context%20%3D%20%5F%29%2C%20area%29%20%3A%20context%3B%0A%20%20%7D%3B%0A%0A%20%20return%20area%3B%0A%7D%0A%0Afunction%20descending%241%28a%2C%20b%29%20%7B%0A%20%20return%20b%20%3C%20a%20%3F%20%2D1%20%3A%20b%20%3E%20a%20%3F%201%20%3A%20b%20%3E%3D%20a%20%3F%200%20%3A%20NaN%3B%0A%7D%0A%0Afunction%20identity%247%28d%29%20%7B%0A%20%20return%20d%3B%0A%7D%0A%0Afunction%20pie%28%29%20%7B%0A%20%20var%20value%20%3D%20identity%247%2C%0A%20%20%20%20%20%20sortValues%20%3D%20descending%241%2C%0A%20%20%20%20%20%20sort%20%3D%20null%2C%0A%20%20%20%20%20%20startAngle%20%3D%20constant%2411%280%29%2C%0A%20%20%20%20%20%20endAngle%20%3D%20constant%2411%28tau%244%29%2C%0A%20%20%20%20%20%20padAngle%20%3D%20constant%2411%280%29%3B%0A%0A%20%20function%20pie%28data%29%20%7B%0A%20%20%20%20var%20i%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20data%2Elength%2C%0A%20%20%20%20%20%20%20%20j%2C%0A%20%20%20%20%20%20%20%20k%2C%0A%20%20%20%20%20%20%20%20sum%20%3D%200%2C%0A%20%20%20%20%20%20%20%20index%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20%20%20arcs%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20%20%20a0%20%3D%20%2BstartAngle%2Eapply%28this%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20da%20%3D%20Math%2Emin%28tau%244%2C%20Math%2Emax%28%2Dtau%244%2C%20endAngle%2Eapply%28this%2C%20arguments%29%20%2D%20a0%29%29%2C%0A%20%20%20%20%20%20%20%20a1%2C%0A%20%20%20%20%20%20%20%20p%20%3D%20Math%2Emin%28Math%2Eabs%28da%29%20%2F%20n%2C%20padAngle%2Eapply%28this%2C%20arguments%29%29%2C%0A%20%20%20%20%20%20%20%20pa%20%3D%20p%20%2A%20%28da%20%3C%200%20%3F%20%2D1%20%3A%201%29%2C%0A%20%20%20%20%20%20%20%20v%3B%0A%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28%28v%20%3D%20arcs%5Bindex%5Bi%5D%20%3D%20i%5D%20%3D%20%2Bvalue%28data%5Bi%5D%2C%20i%2C%20data%29%29%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20sum%20%2B%3D%20v%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Optionally%20sort%20the%20arcs%20by%20previously%2Dcomputed%20values%20or%20by%20data%2E%0A%20%20%20%20if%20%28sortValues%20%21%3D%20null%29%20index%2Esort%28function%28i%2C%20j%29%20%7B%20return%20sortValues%28arcs%5Bi%5D%2C%20arcs%5Bj%5D%29%3B%20%7D%29%3B%0A%20%20%20%20else%20if%20%28sort%20%21%3D%20null%29%20index%2Esort%28function%28i%2C%20j%29%20%7B%20return%20sort%28data%5Bi%5D%2C%20data%5Bj%5D%29%3B%20%7D%29%3B%0A%0A%20%20%20%20%2F%2F%20Compute%20the%20arcs%21%20They%20are%20stored%20in%20the%20original%20data%27s%20order%2E%0A%20%20%20%20for%20%28i%20%3D%200%2C%20k%20%3D%20sum%20%3F%20%28da%20%2D%20n%20%2A%20pa%29%20%2F%20sum%20%3A%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%2C%20a0%20%3D%20a1%29%20%7B%0A%20%20%20%20%20%20j%20%3D%20index%5Bi%5D%2C%20v%20%3D%20arcs%5Bj%5D%2C%20a1%20%3D%20a0%20%2B%20%28v%20%3E%200%20%3F%20v%20%2A%20k%20%3A%200%29%20%2B%20pa%2C%20arcs%5Bj%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20data%3A%20data%5Bj%5D%2C%0A%20%20%20%20%20%20%20%20index%3A%20i%2C%0A%20%20%20%20%20%20%20%20value%3A%20v%2C%0A%20%20%20%20%20%20%20%20startAngle%3A%20a0%2C%0A%20%20%20%20%20%20%20%20endAngle%3A%20a1%2C%0A%20%20%20%20%20%20%20%20padAngle%3A%20p%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20arcs%3B%0A%20%20%7D%0A%0A%20%20pie%2Evalue%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28value%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20pie%29%20%3A%20value%3B%0A%20%20%7D%3B%0A%0A%20%20pie%2EsortValues%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28sortValues%20%3D%20%5F%2C%20sort%20%3D%20null%2C%20pie%29%20%3A%20sortValues%3B%0A%20%20%7D%3B%0A%0A%20%20pie%2Esort%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28sort%20%3D%20%5F%2C%20sortValues%20%3D%20null%2C%20pie%29%20%3A%20sort%3B%0A%20%20%7D%3B%0A%0A%20%20pie%2EstartAngle%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28startAngle%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20pie%29%20%3A%20startAngle%3B%0A%20%20%7D%3B%0A%0A%20%20pie%2EendAngle%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28endAngle%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20pie%29%20%3A%20endAngle%3B%0A%20%20%7D%3B%0A%0A%20%20pie%2EpadAngle%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28padAngle%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20pie%29%20%3A%20padAngle%3B%0A%20%20%7D%3B%0A%0A%20%20return%20pie%3B%0A%7D%0A%0Avar%20curveRadialLinear%20%3D%20curveRadial%28curveLinear%29%3B%0A%0Afunction%20Radial%28curve%29%20%7B%0A%20%20this%2E%5Fcurve%20%3D%20curve%3B%0A%7D%0A%0ARadial%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fcurve%2EareaStart%28%29%3B%0A%20%20%7D%2C%0A%20%20areaEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fcurve%2EareaEnd%28%29%3B%0A%20%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fcurve%2ElineStart%28%29%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fcurve%2ElineEnd%28%29%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28a%2C%20r%29%20%7B%0A%20%20%20%20this%2E%5Fcurve%2Epoint%28r%20%2A%20Math%2Esin%28a%29%2C%20r%20%2A%20%2DMath%2Ecos%28a%29%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20curveRadial%28curve%29%20%7B%0A%0A%20%20function%20radial%28context%29%20%7B%0A%20%20%20%20return%20new%20Radial%28curve%28context%29%29%3B%0A%20%20%7D%0A%0A%20%20radial%2E%5Fcurve%20%3D%20curve%3B%0A%0A%20%20return%20radial%3B%0A%7D%0A%0Afunction%20lineRadial%28l%29%20%7B%0A%20%20var%20c%20%3D%20l%2Ecurve%3B%0A%0A%20%20l%2Eangle%20%3D%20l%2Ex%2C%20delete%20l%2Ex%3B%0A%20%20l%2Eradius%20%3D%20l%2Ey%2C%20delete%20l%2Ey%3B%0A%0A%20%20l%2Ecurve%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20c%28curveRadial%28%5F%29%29%20%3A%20c%28%29%2E%5Fcurve%3B%0A%20%20%7D%3B%0A%0A%20%20return%20l%3B%0A%7D%0A%0Afunction%20lineRadial%241%28%29%20%7B%0A%20%20return%20lineRadial%28line%28%29%2Ecurve%28curveRadialLinear%29%29%3B%0A%7D%0A%0Afunction%20areaRadial%28%29%20%7B%0A%20%20var%20a%20%3D%20area%243%28%29%2Ecurve%28curveRadialLinear%29%2C%0A%20%20%20%20%20%20c%20%3D%20a%2Ecurve%2C%0A%20%20%20%20%20%20x0%20%3D%20a%2ElineX0%2C%0A%20%20%20%20%20%20x1%20%3D%20a%2ElineX1%2C%0A%20%20%20%20%20%20y0%20%3D%20a%2ElineY0%2C%0A%20%20%20%20%20%20y1%20%3D%20a%2ElineY1%3B%0A%0A%20%20a%2Eangle%20%3D%20a%2Ex%2C%20delete%20a%2Ex%3B%0A%20%20a%2EstartAngle%20%3D%20a%2Ex0%2C%20delete%20a%2Ex0%3B%0A%20%20a%2EendAngle%20%3D%20a%2Ex1%2C%20delete%20a%2Ex1%3B%0A%20%20a%2Eradius%20%3D%20a%2Ey%2C%20delete%20a%2Ey%3B%0A%20%20a%2EinnerRadius%20%3D%20a%2Ey0%2C%20delete%20a%2Ey0%3B%0A%20%20a%2EouterRadius%20%3D%20a%2Ey1%2C%20delete%20a%2Ey1%3B%0A%20%20a%2ElineStartAngle%20%3D%20function%28%29%20%7B%20return%20lineRadial%28x0%28%29%29%3B%20%7D%2C%20delete%20a%2ElineX0%3B%0A%20%20a%2ElineEndAngle%20%3D%20function%28%29%20%7B%20return%20lineRadial%28x1%28%29%29%3B%20%7D%2C%20delete%20a%2ElineX1%3B%0A%20%20a%2ElineInnerRadius%20%3D%20function%28%29%20%7B%20return%20lineRadial%28y0%28%29%29%3B%20%7D%2C%20delete%20a%2ElineY0%3B%0A%20%20a%2ElineOuterRadius%20%3D%20function%28%29%20%7B%20return%20lineRadial%28y1%28%29%29%3B%20%7D%2C%20delete%20a%2ElineY1%3B%0A%0A%20%20a%2Ecurve%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20c%28curveRadial%28%5F%29%29%20%3A%20c%28%29%2E%5Fcurve%3B%0A%20%20%7D%3B%0A%0A%20%20return%20a%3B%0A%7D%0A%0Afunction%20pointRadial%28x%2C%20y%29%20%7B%0A%20%20return%20%5B%28y%20%3D%20%2By%29%20%2A%20Math%2Ecos%28x%20%2D%3D%20Math%2EPI%20%2F%202%29%2C%20y%20%2A%20Math%2Esin%28x%29%5D%3B%0A%7D%0A%0Avar%20slice%246%20%3D%20Array%2Eprototype%2Eslice%3B%0A%0Afunction%20linkSource%28d%29%20%7B%0A%20%20return%20d%2Esource%3B%0A%7D%0A%0Afunction%20linkTarget%28d%29%20%7B%0A%20%20return%20d%2Etarget%3B%0A%7D%0A%0Afunction%20link%242%28curve%29%20%7B%0A%20%20var%20source%20%3D%20linkSource%2C%0A%20%20%20%20%20%20target%20%3D%20linkTarget%2C%0A%20%20%20%20%20%20x%24%241%20%3D%20x%243%2C%0A%20%20%20%20%20%20y%24%241%20%3D%20y%243%2C%0A%20%20%20%20%20%20context%20%3D%20null%3B%0A%0A%20%20function%20link%28%29%20%7B%0A%20%20%20%20var%20buffer%2C%20argv%20%3D%20slice%246%2Ecall%28arguments%29%2C%20s%20%3D%20source%2Eapply%28this%2C%20argv%29%2C%20t%20%3D%20target%2Eapply%28this%2C%20argv%29%3B%0A%20%20%20%20if%20%28%21context%29%20context%20%3D%20buffer%20%3D%20path%28%29%3B%0A%20%20%20%20curve%28context%2C%20%2Bx%24%241%2Eapply%28this%2C%20%28argv%5B0%5D%20%3D%20s%2C%20argv%29%29%2C%20%2By%24%241%2Eapply%28this%2C%20argv%29%2C%20%2Bx%24%241%2Eapply%28this%2C%20%28argv%5B0%5D%20%3D%20t%2C%20argv%29%29%2C%20%2By%24%241%2Eapply%28this%2C%20argv%29%29%3B%0A%20%20%20%20if%20%28buffer%29%20return%20context%20%3D%20null%2C%20buffer%20%2B%20%22%22%20%7C%7C%20null%3B%0A%20%20%7D%0A%0A%20%20link%2Esource%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28source%20%3D%20%5F%2C%20link%29%20%3A%20source%3B%0A%20%20%7D%3B%0A%0A%20%20link%2Etarget%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28target%20%3D%20%5F%2C%20link%29%20%3A%20target%3B%0A%20%20%7D%3B%0A%0A%20%20link%2Ex%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28x%24%241%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20link%29%20%3A%20x%24%241%3B%0A%20%20%7D%3B%0A%0A%20%20link%2Ey%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28y%24%241%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20link%29%20%3A%20y%24%241%3B%0A%20%20%7D%3B%0A%0A%20%20link%2Econtext%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28context%20%3D%20%5F%20%3D%3D%20null%20%3F%20null%20%3A%20%5F%2C%20link%29%20%3A%20context%3B%0A%20%20%7D%3B%0A%0A%20%20return%20link%3B%0A%7D%0A%0Afunction%20curveHorizontal%28context%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20context%2EmoveTo%28x0%2C%20y0%29%3B%0A%20%20context%2EbezierCurveTo%28x0%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%2C%20y0%2C%20x0%2C%20y1%2C%20x1%2C%20y1%29%3B%0A%7D%0A%0Afunction%20curveVertical%28context%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20context%2EmoveTo%28x0%2C%20y0%29%3B%0A%20%20context%2EbezierCurveTo%28x0%2C%20y0%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%2C%20x1%2C%20y0%2C%20x1%2C%20y1%29%3B%0A%7D%0A%0Afunction%20curveRadial%241%28context%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20var%20p0%20%3D%20pointRadial%28x0%2C%20y0%29%2C%0A%20%20%20%20%20%20p1%20%3D%20pointRadial%28x0%2C%20y0%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%29%2C%0A%20%20%20%20%20%20p2%20%3D%20pointRadial%28x1%2C%20y0%29%2C%0A%20%20%20%20%20%20p3%20%3D%20pointRadial%28x1%2C%20y1%29%3B%0A%20%20context%2EmoveTo%28p0%5B0%5D%2C%20p0%5B1%5D%29%3B%0A%20%20context%2EbezierCurveTo%28p1%5B0%5D%2C%20p1%5B1%5D%2C%20p2%5B0%5D%2C%20p2%5B1%5D%2C%20p3%5B0%5D%2C%20p3%5B1%5D%29%3B%0A%7D%0A%0Afunction%20linkHorizontal%28%29%20%7B%0A%20%20return%20link%242%28curveHorizontal%29%3B%0A%7D%0A%0Afunction%20linkVertical%28%29%20%7B%0A%20%20return%20link%242%28curveVertical%29%3B%0A%7D%0A%0Afunction%20linkRadial%28%29%20%7B%0A%20%20var%20l%20%3D%20link%242%28curveRadial%241%29%3B%0A%20%20l%2Eangle%20%3D%20l%2Ex%2C%20delete%20l%2Ex%3B%0A%20%20l%2Eradius%20%3D%20l%2Ey%2C%20delete%20l%2Ey%3B%0A%20%20return%20l%3B%0A%7D%0A%0Avar%20circle%242%20%3D%20%7B%0A%20%20draw%3A%20function%28context%2C%20size%29%20%7B%0A%20%20%20%20var%20r%20%3D%20Math%2Esqrt%28size%20%2F%20pi%244%29%3B%0A%20%20%20%20context%2EmoveTo%28r%2C%200%29%3B%0A%20%20%20%20context%2Earc%280%2C%200%2C%20r%2C%200%2C%20tau%244%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20cross%242%20%3D%20%7B%0A%20%20draw%3A%20function%28context%2C%20size%29%20%7B%0A%20%20%20%20var%20r%20%3D%20Math%2Esqrt%28size%20%2F%205%29%20%2F%202%3B%0A%20%20%20%20context%2EmoveTo%28%2D3%20%2A%20r%2C%20%2Dr%29%3B%0A%20%20%20%20context%2ElineTo%28%2Dr%2C%20%2Dr%29%3B%0A%20%20%20%20context%2ElineTo%28%2Dr%2C%20%2D3%20%2A%20r%29%3B%0A%20%20%20%20context%2ElineTo%28r%2C%20%2D3%20%2A%20r%29%3B%0A%20%20%20%20context%2ElineTo%28r%2C%20%2Dr%29%3B%0A%20%20%20%20context%2ElineTo%283%20%2A%20r%2C%20%2Dr%29%3B%0A%20%20%20%20context%2ElineTo%283%20%2A%20r%2C%20r%29%3B%0A%20%20%20%20context%2ElineTo%28r%2C%20r%29%3B%0A%20%20%20%20context%2ElineTo%28r%2C%203%20%2A%20r%29%3B%0A%20%20%20%20context%2ElineTo%28%2Dr%2C%203%20%2A%20r%29%3B%0A%20%20%20%20context%2ElineTo%28%2Dr%2C%20r%29%3B%0A%20%20%20%20context%2ElineTo%28%2D3%20%2A%20r%2C%20r%29%3B%0A%20%20%20%20context%2EclosePath%28%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20tan30%20%3D%20Math%2Esqrt%281%20%2F%203%29%2C%0A%20%20%20%20tan30%5F2%20%3D%20tan30%20%2A%202%3B%0A%0Avar%20diamond%20%3D%20%7B%0A%20%20draw%3A%20function%28context%2C%20size%29%20%7B%0A%20%20%20%20var%20y%20%3D%20Math%2Esqrt%28size%20%2F%20tan30%5F2%29%2C%0A%20%20%20%20%20%20%20%20x%20%3D%20y%20%2A%20tan30%3B%0A%20%20%20%20context%2EmoveTo%280%2C%20%2Dy%29%3B%0A%20%20%20%20context%2ElineTo%28x%2C%200%29%3B%0A%20%20%20%20context%2ElineTo%280%2C%20y%29%3B%0A%20%20%20%20context%2ElineTo%28%2Dx%2C%200%29%3B%0A%20%20%20%20context%2EclosePath%28%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20ka%20%3D%200%2E89081309152928522810%2C%0A%20%20%20%20kr%20%3D%20Math%2Esin%28pi%244%20%2F%2010%29%20%2F%20Math%2Esin%287%20%2A%20pi%244%20%2F%2010%29%2C%0A%20%20%20%20kx%20%3D%20Math%2Esin%28tau%244%20%2F%2010%29%20%2A%20kr%2C%0A%20%20%20%20ky%20%3D%20%2DMath%2Ecos%28tau%244%20%2F%2010%29%20%2A%20kr%3B%0A%0Avar%20star%20%3D%20%7B%0A%20%20draw%3A%20function%28context%2C%20size%29%20%7B%0A%20%20%20%20var%20r%20%3D%20Math%2Esqrt%28size%20%2A%20ka%29%2C%0A%20%20%20%20%20%20%20%20x%20%3D%20kx%20%2A%20r%2C%0A%20%20%20%20%20%20%20%20y%20%3D%20ky%20%2A%20r%3B%0A%20%20%20%20context%2EmoveTo%280%2C%20%2Dr%29%3B%0A%20%20%20%20context%2ElineTo%28x%2C%20y%29%3B%0A%20%20%20%20for%20%28var%20i%20%3D%201%3B%20i%20%3C%205%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20var%20a%20%3D%20tau%244%20%2A%20i%20%2F%205%2C%0A%20%20%20%20%20%20%20%20%20%20c%20%3D%20Math%2Ecos%28a%29%2C%0A%20%20%20%20%20%20%20%20%20%20s%20%3D%20Math%2Esin%28a%29%3B%0A%20%20%20%20%20%20context%2ElineTo%28s%20%2A%20r%2C%20%2Dc%20%2A%20r%29%3B%0A%20%20%20%20%20%20context%2ElineTo%28c%20%2A%20x%20%2D%20s%20%2A%20y%2C%20s%20%2A%20x%20%2B%20c%20%2A%20y%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20context%2EclosePath%28%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20square%20%3D%20%7B%0A%20%20draw%3A%20function%28context%2C%20size%29%20%7B%0A%20%20%20%20var%20w%20%3D%20Math%2Esqrt%28size%29%2C%0A%20%20%20%20%20%20%20%20x%20%3D%20%2Dw%20%2F%202%3B%0A%20%20%20%20context%2Erect%28x%2C%20x%2C%20w%2C%20w%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20sqrt3%20%3D%20Math%2Esqrt%283%29%3B%0A%0Avar%20triangle%20%3D%20%7B%0A%20%20draw%3A%20function%28context%2C%20size%29%20%7B%0A%20%20%20%20var%20y%20%3D%20%2DMath%2Esqrt%28size%20%2F%20%28sqrt3%20%2A%203%29%29%3B%0A%20%20%20%20context%2EmoveTo%280%2C%20y%20%2A%202%29%3B%0A%20%20%20%20context%2ElineTo%28%2Dsqrt3%20%2A%20y%2C%20%2Dy%29%3B%0A%20%20%20%20context%2ElineTo%28sqrt3%20%2A%20y%2C%20%2Dy%29%3B%0A%20%20%20%20context%2EclosePath%28%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20c%20%3D%20%2D0%2E5%2C%0A%20%20%20%20s%20%3D%20Math%2Esqrt%283%29%20%2F%202%2C%0A%20%20%20%20k%20%3D%201%20%2F%20Math%2Esqrt%2812%29%2C%0A%20%20%20%20a%20%3D%20%28k%20%2F%202%20%2B%201%29%20%2A%203%3B%0A%0Avar%20wye%20%3D%20%7B%0A%20%20draw%3A%20function%28context%2C%20size%29%20%7B%0A%20%20%20%20var%20r%20%3D%20Math%2Esqrt%28size%20%2F%20a%29%2C%0A%20%20%20%20%20%20%20%20x0%20%3D%20r%20%2F%202%2C%0A%20%20%20%20%20%20%20%20y0%20%3D%20r%20%2A%20k%2C%0A%20%20%20%20%20%20%20%20x1%20%3D%20x0%2C%0A%20%20%20%20%20%20%20%20y1%20%3D%20r%20%2A%20k%20%2B%20r%2C%0A%20%20%20%20%20%20%20%20x2%20%3D%20%2Dx1%2C%0A%20%20%20%20%20%20%20%20y2%20%3D%20y1%3B%0A%20%20%20%20context%2EmoveTo%28x0%2C%20y0%29%3B%0A%20%20%20%20context%2ElineTo%28x1%2C%20y1%29%3B%0A%20%20%20%20context%2ElineTo%28x2%2C%20y2%29%3B%0A%20%20%20%20context%2ElineTo%28c%20%2A%20x0%20%2D%20s%20%2A%20y0%2C%20s%20%2A%20x0%20%2B%20c%20%2A%20y0%29%3B%0A%20%20%20%20context%2ElineTo%28c%20%2A%20x1%20%2D%20s%20%2A%20y1%2C%20s%20%2A%20x1%20%2B%20c%20%2A%20y1%29%3B%0A%20%20%20%20context%2ElineTo%28c%20%2A%20x2%20%2D%20s%20%2A%20y2%2C%20s%20%2A%20x2%20%2B%20c%20%2A%20y2%29%3B%0A%20%20%20%20context%2ElineTo%28c%20%2A%20x0%20%2B%20s%20%2A%20y0%2C%20c%20%2A%20y0%20%2D%20s%20%2A%20x0%29%3B%0A%20%20%20%20context%2ElineTo%28c%20%2A%20x1%20%2B%20s%20%2A%20y1%2C%20c%20%2A%20y1%20%2D%20s%20%2A%20x1%29%3B%0A%20%20%20%20context%2ElineTo%28c%20%2A%20x2%20%2B%20s%20%2A%20y2%2C%20c%20%2A%20y2%20%2D%20s%20%2A%20x2%29%3B%0A%20%20%20%20context%2EclosePath%28%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20symbols%20%3D%20%5B%0A%20%20circle%242%2C%0A%20%20cross%242%2C%0A%20%20diamond%2C%0A%20%20square%2C%0A%20%20star%2C%0A%20%20triangle%2C%0A%20%20wye%0A%5D%3B%0A%0Afunction%20symbol%28%29%20%7B%0A%20%20var%20type%20%3D%20constant%2411%28circle%242%29%2C%0A%20%20%20%20%20%20size%20%3D%20constant%2411%2864%29%2C%0A%20%20%20%20%20%20context%20%3D%20null%3B%0A%0A%20%20function%20symbol%28%29%20%7B%0A%20%20%20%20var%20buffer%3B%0A%20%20%20%20if%20%28%21context%29%20context%20%3D%20buffer%20%3D%20path%28%29%3B%0A%20%20%20%20type%2Eapply%28this%2C%20arguments%29%2Edraw%28context%2C%20%2Bsize%2Eapply%28this%2C%20arguments%29%29%3B%0A%20%20%20%20if%20%28buffer%29%20return%20context%20%3D%20null%2C%20buffer%20%2B%20%22%22%20%7C%7C%20null%3B%0A%20%20%7D%0A%0A%20%20symbol%2Etype%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28type%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%5F%29%2C%20symbol%29%20%3A%20type%3B%0A%20%20%7D%3B%0A%0A%20%20symbol%2Esize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28size%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20symbol%29%20%3A%20size%3B%0A%20%20%7D%3B%0A%0A%20%20symbol%2Econtext%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28context%20%3D%20%5F%20%3D%3D%20null%20%3F%20null%20%3A%20%5F%2C%20symbol%29%20%3A%20context%3B%0A%20%20%7D%3B%0A%0A%20%20return%20symbol%3B%0A%7D%0A%0Afunction%20noop%243%28%29%20%7B%7D%0A%0Afunction%20point%242%28that%2C%20x%2C%20y%29%20%7B%0A%20%20that%2E%5Fcontext%2EbezierCurveTo%28%0A%20%20%20%20%282%20%2A%20that%2E%5Fx0%20%2B%20that%2E%5Fx1%29%20%2F%203%2C%0A%20%20%20%20%282%20%2A%20that%2E%5Fy0%20%2B%20that%2E%5Fy1%29%20%2F%203%2C%0A%20%20%20%20%28that%2E%5Fx0%20%2B%202%20%2A%20that%2E%5Fx1%29%20%2F%203%2C%0A%20%20%20%20%28that%2E%5Fy0%20%2B%202%20%2A%20that%2E%5Fy1%29%20%2F%203%2C%0A%20%20%20%20%28that%2E%5Fx0%20%2B%204%20%2A%20that%2E%5Fx1%20%2B%20x%29%20%2F%206%2C%0A%20%20%20%20%28that%2E%5Fy0%20%2B%204%20%2A%20that%2E%5Fy1%20%2B%20y%29%20%2F%206%0A%20%20%29%3B%0A%7D%0A%0Afunction%20Basis%28context%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%7D%0A%0ABasis%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20areaEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%20%3D%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%20%3D%20NaN%3B%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%203%3A%20point%242%28this%2C%20this%2E%5Fx1%2C%20this%2E%5Fy1%29%3B%20%2F%2F%20proceed%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fcontext%2ElineTo%28this%2E%5Fx1%2C%20this%2E%5Fy1%29%3B%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this%2E%5Fline%20%7C%7C%20%28this%2E%5Fline%20%21%3D%3D%200%20%26%26%20this%2E%5Fpoint%20%3D%3D%3D%201%29%29%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20this%2E%5Fline%20%3D%201%20%2D%20this%2E%5Fline%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%3B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20this%2E%5Fpoint%20%3D%201%3B%20this%2E%5Fline%20%3F%20this%2E%5Fcontext%2ElineTo%28x%2C%20y%29%20%3A%20this%2E%5Fcontext%2EmoveTo%28x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%20%20case%201%3A%20this%2E%5Fpoint%20%3D%202%3B%20break%3B%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fpoint%20%3D%203%3B%20this%2E%5Fcontext%2ElineTo%28%285%20%2A%20this%2E%5Fx0%20%2B%20this%2E%5Fx1%29%20%2F%206%2C%20%285%20%2A%20this%2E%5Fy0%20%2B%20this%2E%5Fy1%29%20%2F%206%29%3B%20%2F%2F%20proceed%0A%20%20%20%20%20%20default%3A%20point%242%28this%2C%20x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%2C%20this%2E%5Fx1%20%3D%20x%3B%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%2C%20this%2E%5Fy1%20%3D%20y%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20basis%242%28context%29%20%7B%0A%20%20return%20new%20Basis%28context%29%3B%0A%7D%0A%0Afunction%20BasisClosed%28context%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%7D%0A%0ABasisClosed%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20noop%243%2C%0A%20%20areaEnd%3A%20noop%243%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%20%3D%20this%2E%5Fx2%20%3D%20this%2E%5Fx3%20%3D%20this%2E%5Fx4%20%3D%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%20%3D%20this%2E%5Fy2%20%3D%20this%2E%5Fy3%20%3D%20this%2E%5Fy4%20%3D%20NaN%3B%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%201%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2EmoveTo%28this%2E%5Fx2%2C%20this%2E%5Fy2%29%3B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20case%202%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2EmoveTo%28%28this%2E%5Fx2%20%2B%202%20%2A%20this%2E%5Fx3%29%20%2F%203%2C%20%28this%2E%5Fy2%20%2B%202%20%2A%20this%2E%5Fy3%29%20%2F%203%29%3B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2ElineTo%28%28this%2E%5Fx3%20%2B%202%20%2A%20this%2E%5Fx2%29%20%2F%203%2C%20%28this%2E%5Fy3%20%2B%202%20%2A%20this%2E%5Fy2%29%20%2F%203%29%3B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20case%203%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2Epoint%28this%2E%5Fx2%2C%20this%2E%5Fy2%29%3B%0A%20%20%20%20%20%20%20%20this%2Epoint%28this%2E%5Fx3%2C%20this%2E%5Fy3%29%3B%0A%20%20%20%20%20%20%20%20this%2Epoint%28this%2E%5Fx4%2C%20this%2E%5Fy4%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%3B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20this%2E%5Fpoint%20%3D%201%3B%20this%2E%5Fx2%20%3D%20x%2C%20this%2E%5Fy2%20%3D%20y%3B%20break%3B%0A%20%20%20%20%20%20case%201%3A%20this%2E%5Fpoint%20%3D%202%3B%20this%2E%5Fx3%20%3D%20x%2C%20this%2E%5Fy3%20%3D%20y%3B%20break%3B%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fpoint%20%3D%203%3B%20this%2E%5Fx4%20%3D%20x%2C%20this%2E%5Fy4%20%3D%20y%3B%20this%2E%5Fcontext%2EmoveTo%28%28this%2E%5Fx0%20%2B%204%20%2A%20this%2E%5Fx1%20%2B%20x%29%20%2F%206%2C%20%28this%2E%5Fy0%20%2B%204%20%2A%20this%2E%5Fy1%20%2B%20y%29%20%2F%206%29%3B%20break%3B%0A%20%20%20%20%20%20default%3A%20point%242%28this%2C%20x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%2C%20this%2E%5Fx1%20%3D%20x%3B%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%2C%20this%2E%5Fy1%20%3D%20y%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20basisClosed%241%28context%29%20%7B%0A%20%20return%20new%20BasisClosed%28context%29%3B%0A%7D%0A%0Afunction%20BasisOpen%28context%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%7D%0A%0ABasisOpen%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20areaEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%20%3D%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%20%3D%20NaN%3B%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20if%20%28this%2E%5Fline%20%7C%7C%20%28this%2E%5Fline%20%21%3D%3D%200%20%26%26%20this%2E%5Fpoint%20%3D%3D%3D%203%29%29%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20this%2E%5Fline%20%3D%201%20%2D%20this%2E%5Fline%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%3B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20this%2E%5Fpoint%20%3D%201%3B%20break%3B%0A%20%20%20%20%20%20case%201%3A%20this%2E%5Fpoint%20%3D%202%3B%20break%3B%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fpoint%20%3D%203%3B%20var%20x0%20%3D%20%28this%2E%5Fx0%20%2B%204%20%2A%20this%2E%5Fx1%20%2B%20x%29%20%2F%206%2C%20y0%20%3D%20%28this%2E%5Fy0%20%2B%204%20%2A%20this%2E%5Fy1%20%2B%20y%29%20%2F%206%3B%20this%2E%5Fline%20%3F%20this%2E%5Fcontext%2ElineTo%28x0%2C%20y0%29%20%3A%20this%2E%5Fcontext%2EmoveTo%28x0%2C%20y0%29%3B%20break%3B%0A%20%20%20%20%20%20case%203%3A%20this%2E%5Fpoint%20%3D%204%3B%20%2F%2F%20proceed%0A%20%20%20%20%20%20default%3A%20point%242%28this%2C%20x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%2C%20this%2E%5Fx1%20%3D%20x%3B%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%2C%20this%2E%5Fy1%20%3D%20y%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20basisOpen%28context%29%20%7B%0A%20%20return%20new%20BasisOpen%28context%29%3B%0A%7D%0A%0Afunction%20Bundle%28context%2C%20beta%29%20%7B%0A%20%20this%2E%5Fbasis%20%3D%20new%20Basis%28context%29%3B%0A%20%20this%2E%5Fbeta%20%3D%20beta%3B%0A%7D%0A%0ABundle%2Eprototype%20%3D%20%7B%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fx%20%3D%20%5B%5D%3B%0A%20%20%20%20this%2E%5Fy%20%3D%20%5B%5D%3B%0A%20%20%20%20this%2E%5Fbasis%2ElineStart%28%29%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20var%20x%20%3D%20this%2E%5Fx%2C%0A%20%20%20%20%20%20%20%20y%20%3D%20this%2E%5Fy%2C%0A%20%20%20%20%20%20%20%20j%20%3D%20x%2Elength%20%2D%201%3B%0A%0A%20%20%20%20if%20%28j%20%3E%200%29%20%7B%0A%20%20%20%20%20%20var%20x0%20%3D%20x%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20y0%20%3D%20y%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20dx%20%3D%20x%5Bj%5D%20%2D%20x0%2C%0A%20%20%20%20%20%20%20%20%20%20dy%20%3D%20y%5Bj%5D%20%2D%20y0%2C%0A%20%20%20%20%20%20%20%20%20%20i%20%3D%20%2D1%2C%0A%20%20%20%20%20%20%20%20%20%20t%3B%0A%0A%20%20%20%20%20%20while%20%28%2B%2Bi%20%3C%3D%20j%29%20%7B%0A%20%20%20%20%20%20%20%20t%20%3D%20i%20%2F%20j%3B%0A%20%20%20%20%20%20%20%20this%2E%5Fbasis%2Epoint%28%0A%20%20%20%20%20%20%20%20%20%20this%2E%5Fbeta%20%2A%20x%5Bi%5D%20%2B%20%281%20%2D%20this%2E%5Fbeta%29%20%2A%20%28x0%20%2B%20t%20%2A%20dx%29%2C%0A%20%20%20%20%20%20%20%20%20%20this%2E%5Fbeta%20%2A%20y%5Bi%5D%20%2B%20%281%20%2D%20this%2E%5Fbeta%29%20%2A%20%28y0%20%2B%20t%20%2A%20dy%29%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20this%2E%5Fx%20%3D%20this%2E%5Fy%20%3D%20null%3B%0A%20%20%20%20this%2E%5Fbasis%2ElineEnd%28%29%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20this%2E%5Fx%2Epush%28%2Bx%29%3B%0A%20%20%20%20this%2E%5Fy%2Epush%28%2By%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20bundle%20%3D%20%28function%20custom%28beta%29%20%7B%0A%0A%20%20function%20bundle%28context%29%20%7B%0A%20%20%20%20return%20beta%20%3D%3D%3D%201%20%3F%20new%20Basis%28context%29%20%3A%20new%20Bundle%28context%2C%20beta%29%3B%0A%20%20%7D%0A%0A%20%20bundle%2Ebeta%20%3D%20function%28beta%29%20%7B%0A%20%20%20%20return%20custom%28%2Bbeta%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20bundle%3B%0A%7D%29%280%2E85%29%3B%0A%0Afunction%20point%243%28that%2C%20x%2C%20y%29%20%7B%0A%20%20that%2E%5Fcontext%2EbezierCurveTo%28%0A%20%20%20%20that%2E%5Fx1%20%2B%20that%2E%5Fk%20%2A%20%28that%2E%5Fx2%20%2D%20that%2E%5Fx0%29%2C%0A%20%20%20%20that%2E%5Fy1%20%2B%20that%2E%5Fk%20%2A%20%28that%2E%5Fy2%20%2D%20that%2E%5Fy0%29%2C%0A%20%20%20%20that%2E%5Fx2%20%2B%20that%2E%5Fk%20%2A%20%28that%2E%5Fx1%20%2D%20x%29%2C%0A%20%20%20%20that%2E%5Fy2%20%2B%20that%2E%5Fk%20%2A%20%28that%2E%5Fy1%20%2D%20y%29%2C%0A%20%20%20%20that%2E%5Fx2%2C%0A%20%20%20%20that%2E%5Fy2%0A%20%20%29%3B%0A%7D%0A%0Afunction%20Cardinal%28context%2C%20tension%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%20%20this%2E%5Fk%20%3D%20%281%20%2D%20tension%29%20%2F%206%3B%0A%7D%0A%0ACardinal%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20areaEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%20%3D%20this%2E%5Fx2%20%3D%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%20%3D%20this%2E%5Fy2%20%3D%20NaN%3B%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fcontext%2ElineTo%28this%2E%5Fx2%2C%20this%2E%5Fy2%29%3B%20break%3B%0A%20%20%20%20%20%20case%203%3A%20point%243%28this%2C%20this%2E%5Fx1%2C%20this%2E%5Fy1%29%3B%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this%2E%5Fline%20%7C%7C%20%28this%2E%5Fline%20%21%3D%3D%200%20%26%26%20this%2E%5Fpoint%20%3D%3D%3D%201%29%29%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20this%2E%5Fline%20%3D%201%20%2D%20this%2E%5Fline%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%3B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20this%2E%5Fpoint%20%3D%201%3B%20this%2E%5Fline%20%3F%20this%2E%5Fcontext%2ElineTo%28x%2C%20y%29%20%3A%20this%2E%5Fcontext%2EmoveTo%28x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%20%20case%201%3A%20this%2E%5Fpoint%20%3D%202%3B%20this%2E%5Fx1%20%3D%20x%2C%20this%2E%5Fy1%20%3D%20y%3B%20break%3B%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fpoint%20%3D%203%3B%20%2F%2F%20proceed%0A%20%20%20%20%20%20default%3A%20point%243%28this%2C%20x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%2C%20this%2E%5Fx1%20%3D%20this%2E%5Fx2%2C%20this%2E%5Fx2%20%3D%20x%3B%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%2C%20this%2E%5Fy1%20%3D%20this%2E%5Fy2%2C%20this%2E%5Fy2%20%3D%20y%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20cardinal%20%3D%20%28function%20custom%28tension%29%20%7B%0A%0A%20%20function%20cardinal%28context%29%20%7B%0A%20%20%20%20return%20new%20Cardinal%28context%2C%20tension%29%3B%0A%20%20%7D%0A%0A%20%20cardinal%2Etension%20%3D%20function%28tension%29%20%7B%0A%20%20%20%20return%20custom%28%2Btension%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20cardinal%3B%0A%7D%29%280%29%3B%0A%0Afunction%20CardinalClosed%28context%2C%20tension%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%20%20this%2E%5Fk%20%3D%20%281%20%2D%20tension%29%20%2F%206%3B%0A%7D%0A%0ACardinalClosed%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20noop%243%2C%0A%20%20areaEnd%3A%20noop%243%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%20%3D%20this%2E%5Fx2%20%3D%20this%2E%5Fx3%20%3D%20this%2E%5Fx4%20%3D%20this%2E%5Fx5%20%3D%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%20%3D%20this%2E%5Fy2%20%3D%20this%2E%5Fy3%20%3D%20this%2E%5Fy4%20%3D%20this%2E%5Fy5%20%3D%20NaN%3B%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%201%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2EmoveTo%28this%2E%5Fx3%2C%20this%2E%5Fy3%29%3B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20case%202%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2ElineTo%28this%2E%5Fx3%2C%20this%2E%5Fy3%29%3B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20case%203%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2Epoint%28this%2E%5Fx3%2C%20this%2E%5Fy3%29%3B%0A%20%20%20%20%20%20%20%20this%2Epoint%28this%2E%5Fx4%2C%20this%2E%5Fy4%29%3B%0A%20%20%20%20%20%20%20%20this%2Epoint%28this%2E%5Fx5%2C%20this%2E%5Fy5%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%3B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20this%2E%5Fpoint%20%3D%201%3B%20this%2E%5Fx3%20%3D%20x%2C%20this%2E%5Fy3%20%3D%20y%3B%20break%3B%0A%20%20%20%20%20%20case%201%3A%20this%2E%5Fpoint%20%3D%202%3B%20this%2E%5Fcontext%2EmoveTo%28this%2E%5Fx4%20%3D%20x%2C%20this%2E%5Fy4%20%3D%20y%29%3B%20break%3B%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fpoint%20%3D%203%3B%20this%2E%5Fx5%20%3D%20x%2C%20this%2E%5Fy5%20%3D%20y%3B%20break%3B%0A%20%20%20%20%20%20default%3A%20point%243%28this%2C%20x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%2C%20this%2E%5Fx1%20%3D%20this%2E%5Fx2%2C%20this%2E%5Fx2%20%3D%20x%3B%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%2C%20this%2E%5Fy1%20%3D%20this%2E%5Fy2%2C%20this%2E%5Fy2%20%3D%20y%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20cardinalClosed%20%3D%20%28function%20custom%28tension%29%20%7B%0A%0A%20%20function%20cardinal%24%241%28context%29%20%7B%0A%20%20%20%20return%20new%20CardinalClosed%28context%2C%20tension%29%3B%0A%20%20%7D%0A%0A%20%20cardinal%24%241%2Etension%20%3D%20function%28tension%29%20%7B%0A%20%20%20%20return%20custom%28%2Btension%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20cardinal%24%241%3B%0A%7D%29%280%29%3B%0A%0Afunction%20CardinalOpen%28context%2C%20tension%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%20%20this%2E%5Fk%20%3D%20%281%20%2D%20tension%29%20%2F%206%3B%0A%7D%0A%0ACardinalOpen%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20areaEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%20%3D%20this%2E%5Fx2%20%3D%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%20%3D%20this%2E%5Fy2%20%3D%20NaN%3B%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20if%20%28this%2E%5Fline%20%7C%7C%20%28this%2E%5Fline%20%21%3D%3D%200%20%26%26%20this%2E%5Fpoint%20%3D%3D%3D%203%29%29%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20this%2E%5Fline%20%3D%201%20%2D%20this%2E%5Fline%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%3B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20this%2E%5Fpoint%20%3D%201%3B%20break%3B%0A%20%20%20%20%20%20case%201%3A%20this%2E%5Fpoint%20%3D%202%3B%20break%3B%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fpoint%20%3D%203%3B%20this%2E%5Fline%20%3F%20this%2E%5Fcontext%2ElineTo%28this%2E%5Fx2%2C%20this%2E%5Fy2%29%20%3A%20this%2E%5Fcontext%2EmoveTo%28this%2E%5Fx2%2C%20this%2E%5Fy2%29%3B%20break%3B%0A%20%20%20%20%20%20case%203%3A%20this%2E%5Fpoint%20%3D%204%3B%20%2F%2F%20proceed%0A%20%20%20%20%20%20default%3A%20point%243%28this%2C%20x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%2C%20this%2E%5Fx1%20%3D%20this%2E%5Fx2%2C%20this%2E%5Fx2%20%3D%20x%3B%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%2C%20this%2E%5Fy1%20%3D%20this%2E%5Fy2%2C%20this%2E%5Fy2%20%3D%20y%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20cardinalOpen%20%3D%20%28function%20custom%28tension%29%20%7B%0A%0A%20%20function%20cardinal%24%241%28context%29%20%7B%0A%20%20%20%20return%20new%20CardinalOpen%28context%2C%20tension%29%3B%0A%20%20%7D%0A%0A%20%20cardinal%24%241%2Etension%20%3D%20function%28tension%29%20%7B%0A%20%20%20%20return%20custom%28%2Btension%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20cardinal%24%241%3B%0A%7D%29%280%29%3B%0A%0Afunction%20point%244%28that%2C%20x%2C%20y%29%20%7B%0A%20%20var%20x1%20%3D%20that%2E%5Fx1%2C%0A%20%20%20%20%20%20y1%20%3D%20that%2E%5Fy1%2C%0A%20%20%20%20%20%20x2%20%3D%20that%2E%5Fx2%2C%0A%20%20%20%20%20%20y2%20%3D%20that%2E%5Fy2%3B%0A%0A%20%20if%20%28that%2E%5Fl01%5Fa%20%3E%20epsilon%243%29%20%7B%0A%20%20%20%20var%20a%20%3D%202%20%2A%20that%2E%5Fl01%5F2a%20%2B%203%20%2A%20that%2E%5Fl01%5Fa%20%2A%20that%2E%5Fl12%5Fa%20%2B%20that%2E%5Fl12%5F2a%2C%0A%20%20%20%20%20%20%20%20n%20%3D%203%20%2A%20that%2E%5Fl01%5Fa%20%2A%20%28that%2E%5Fl01%5Fa%20%2B%20that%2E%5Fl12%5Fa%29%3B%0A%20%20%20%20x1%20%3D%20%28x1%20%2A%20a%20%2D%20that%2E%5Fx0%20%2A%20that%2E%5Fl12%5F2a%20%2B%20that%2E%5Fx2%20%2A%20that%2E%5Fl01%5F2a%29%20%2F%20n%3B%0A%20%20%20%20y1%20%3D%20%28y1%20%2A%20a%20%2D%20that%2E%5Fy0%20%2A%20that%2E%5Fl12%5F2a%20%2B%20that%2E%5Fy2%20%2A%20that%2E%5Fl01%5F2a%29%20%2F%20n%3B%0A%20%20%7D%0A%0A%20%20if%20%28that%2E%5Fl23%5Fa%20%3E%20epsilon%243%29%20%7B%0A%20%20%20%20var%20b%20%3D%202%20%2A%20that%2E%5Fl23%5F2a%20%2B%203%20%2A%20that%2E%5Fl23%5Fa%20%2A%20that%2E%5Fl12%5Fa%20%2B%20that%2E%5Fl12%5F2a%2C%0A%20%20%20%20%20%20%20%20m%20%3D%203%20%2A%20that%2E%5Fl23%5Fa%20%2A%20%28that%2E%5Fl23%5Fa%20%2B%20that%2E%5Fl12%5Fa%29%3B%0A%20%20%20%20x2%20%3D%20%28x2%20%2A%20b%20%2B%20that%2E%5Fx1%20%2A%20that%2E%5Fl23%5F2a%20%2D%20x%20%2A%20that%2E%5Fl12%5F2a%29%20%2F%20m%3B%0A%20%20%20%20y2%20%3D%20%28y2%20%2A%20b%20%2B%20that%2E%5Fy1%20%2A%20that%2E%5Fl23%5F2a%20%2D%20y%20%2A%20that%2E%5Fl12%5F2a%29%20%2F%20m%3B%0A%20%20%7D%0A%0A%20%20that%2E%5Fcontext%2EbezierCurveTo%28x1%2C%20y1%2C%20x2%2C%20y2%2C%20that%2E%5Fx2%2C%20that%2E%5Fy2%29%3B%0A%7D%0A%0Afunction%20CatmullRom%28context%2C%20alpha%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%20%20this%2E%5Falpha%20%3D%20alpha%3B%0A%7D%0A%0ACatmullRom%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20areaEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%20%3D%20this%2E%5Fx2%20%3D%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%20%3D%20this%2E%5Fy2%20%3D%20NaN%3B%0A%20%20%20%20this%2E%5Fl01%5Fa%20%3D%20this%2E%5Fl12%5Fa%20%3D%20this%2E%5Fl23%5Fa%20%3D%0A%20%20%20%20this%2E%5Fl01%5F2a%20%3D%20this%2E%5Fl12%5F2a%20%3D%20this%2E%5Fl23%5F2a%20%3D%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fcontext%2ElineTo%28this%2E%5Fx2%2C%20this%2E%5Fy2%29%3B%20break%3B%0A%20%20%20%20%20%20case%203%3A%20this%2Epoint%28this%2E%5Fx2%2C%20this%2E%5Fy2%29%3B%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this%2E%5Fline%20%7C%7C%20%28this%2E%5Fline%20%21%3D%3D%200%20%26%26%20this%2E%5Fpoint%20%3D%3D%3D%201%29%29%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20this%2E%5Fline%20%3D%201%20%2D%20this%2E%5Fline%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%3B%0A%0A%20%20%20%20if%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20var%20x23%20%3D%20this%2E%5Fx2%20%2D%20x%2C%0A%20%20%20%20%20%20%20%20%20%20y23%20%3D%20this%2E%5Fy2%20%2D%20y%3B%0A%20%20%20%20%20%20this%2E%5Fl23%5Fa%20%3D%20Math%2Esqrt%28this%2E%5Fl23%5F2a%20%3D%20Math%2Epow%28x23%20%2A%20x23%20%2B%20y23%20%2A%20y23%2C%20this%2E%5Falpha%29%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20this%2E%5Fpoint%20%3D%201%3B%20this%2E%5Fline%20%3F%20this%2E%5Fcontext%2ElineTo%28x%2C%20y%29%20%3A%20this%2E%5Fcontext%2EmoveTo%28x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%20%20case%201%3A%20this%2E%5Fpoint%20%3D%202%3B%20break%3B%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fpoint%20%3D%203%3B%20%2F%2F%20proceed%0A%20%20%20%20%20%20default%3A%20point%244%28this%2C%20x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this%2E%5Fl01%5Fa%20%3D%20this%2E%5Fl12%5Fa%2C%20this%2E%5Fl12%5Fa%20%3D%20this%2E%5Fl23%5Fa%3B%0A%20%20%20%20this%2E%5Fl01%5F2a%20%3D%20this%2E%5Fl12%5F2a%2C%20this%2E%5Fl12%5F2a%20%3D%20this%2E%5Fl23%5F2a%3B%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%2C%20this%2E%5Fx1%20%3D%20this%2E%5Fx2%2C%20this%2E%5Fx2%20%3D%20x%3B%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%2C%20this%2E%5Fy1%20%3D%20this%2E%5Fy2%2C%20this%2E%5Fy2%20%3D%20y%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20catmullRom%20%3D%20%28function%20custom%28alpha%29%20%7B%0A%0A%20%20function%20catmullRom%28context%29%20%7B%0A%20%20%20%20return%20alpha%20%3F%20new%20CatmullRom%28context%2C%20alpha%29%20%3A%20new%20Cardinal%28context%2C%200%29%3B%0A%20%20%7D%0A%0A%20%20catmullRom%2Ealpha%20%3D%20function%28alpha%29%20%7B%0A%20%20%20%20return%20custom%28%2Balpha%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20catmullRom%3B%0A%7D%29%280%2E5%29%3B%0A%0Afunction%20CatmullRomClosed%28context%2C%20alpha%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%20%20this%2E%5Falpha%20%3D%20alpha%3B%0A%7D%0A%0ACatmullRomClosed%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20noop%243%2C%0A%20%20areaEnd%3A%20noop%243%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%20%3D%20this%2E%5Fx2%20%3D%20this%2E%5Fx3%20%3D%20this%2E%5Fx4%20%3D%20this%2E%5Fx5%20%3D%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%20%3D%20this%2E%5Fy2%20%3D%20this%2E%5Fy3%20%3D%20this%2E%5Fy4%20%3D%20this%2E%5Fy5%20%3D%20NaN%3B%0A%20%20%20%20this%2E%5Fl01%5Fa%20%3D%20this%2E%5Fl12%5Fa%20%3D%20this%2E%5Fl23%5Fa%20%3D%0A%20%20%20%20this%2E%5Fl01%5F2a%20%3D%20this%2E%5Fl12%5F2a%20%3D%20this%2E%5Fl23%5F2a%20%3D%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%201%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2EmoveTo%28this%2E%5Fx3%2C%20this%2E%5Fy3%29%3B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20case%202%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2ElineTo%28this%2E%5Fx3%2C%20this%2E%5Fy3%29%3B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20case%203%3A%20%7B%0A%20%20%20%20%20%20%20%20this%2Epoint%28this%2E%5Fx3%2C%20this%2E%5Fy3%29%3B%0A%20%20%20%20%20%20%20%20this%2Epoint%28this%2E%5Fx4%2C%20this%2E%5Fy4%29%3B%0A%20%20%20%20%20%20%20%20this%2Epoint%28this%2E%5Fx5%2C%20this%2E%5Fy5%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%3B%0A%0A%20%20%20%20if%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20var%20x23%20%3D%20this%2E%5Fx2%20%2D%20x%2C%0A%20%20%20%20%20%20%20%20%20%20y23%20%3D%20this%2E%5Fy2%20%2D%20y%3B%0A%20%20%20%20%20%20this%2E%5Fl23%5Fa%20%3D%20Math%2Esqrt%28this%2E%5Fl23%5F2a%20%3D%20Math%2Epow%28x23%20%2A%20x23%20%2B%20y23%20%2A%20y23%2C%20this%2E%5Falpha%29%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20this%2E%5Fpoint%20%3D%201%3B%20this%2E%5Fx3%20%3D%20x%2C%20this%2E%5Fy3%20%3D%20y%3B%20break%3B%0A%20%20%20%20%20%20case%201%3A%20this%2E%5Fpoint%20%3D%202%3B%20this%2E%5Fcontext%2EmoveTo%28this%2E%5Fx4%20%3D%20x%2C%20this%2E%5Fy4%20%3D%20y%29%3B%20break%3B%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fpoint%20%3D%203%3B%20this%2E%5Fx5%20%3D%20x%2C%20this%2E%5Fy5%20%3D%20y%3B%20break%3B%0A%20%20%20%20%20%20default%3A%20point%244%28this%2C%20x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this%2E%5Fl01%5Fa%20%3D%20this%2E%5Fl12%5Fa%2C%20this%2E%5Fl12%5Fa%20%3D%20this%2E%5Fl23%5Fa%3B%0A%20%20%20%20this%2E%5Fl01%5F2a%20%3D%20this%2E%5Fl12%5F2a%2C%20this%2E%5Fl12%5F2a%20%3D%20this%2E%5Fl23%5F2a%3B%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%2C%20this%2E%5Fx1%20%3D%20this%2E%5Fx2%2C%20this%2E%5Fx2%20%3D%20x%3B%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%2C%20this%2E%5Fy1%20%3D%20this%2E%5Fy2%2C%20this%2E%5Fy2%20%3D%20y%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20catmullRomClosed%20%3D%20%28function%20custom%28alpha%29%20%7B%0A%0A%20%20function%20catmullRom%24%241%28context%29%20%7B%0A%20%20%20%20return%20alpha%20%3F%20new%20CatmullRomClosed%28context%2C%20alpha%29%20%3A%20new%20CardinalClosed%28context%2C%200%29%3B%0A%20%20%7D%0A%0A%20%20catmullRom%24%241%2Ealpha%20%3D%20function%28alpha%29%20%7B%0A%20%20%20%20return%20custom%28%2Balpha%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20catmullRom%24%241%3B%0A%7D%29%280%2E5%29%3B%0A%0Afunction%20CatmullRomOpen%28context%2C%20alpha%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%20%20this%2E%5Falpha%20%3D%20alpha%3B%0A%7D%0A%0ACatmullRomOpen%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20areaEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%20%3D%20this%2E%5Fx2%20%3D%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%20%3D%20this%2E%5Fy2%20%3D%20NaN%3B%0A%20%20%20%20this%2E%5Fl01%5Fa%20%3D%20this%2E%5Fl12%5Fa%20%3D%20this%2E%5Fl23%5Fa%20%3D%0A%20%20%20%20this%2E%5Fl01%5F2a%20%3D%20this%2E%5Fl12%5F2a%20%3D%20this%2E%5Fl23%5F2a%20%3D%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20if%20%28this%2E%5Fline%20%7C%7C%20%28this%2E%5Fline%20%21%3D%3D%200%20%26%26%20this%2E%5Fpoint%20%3D%3D%3D%203%29%29%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20this%2E%5Fline%20%3D%201%20%2D%20this%2E%5Fline%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%3B%0A%0A%20%20%20%20if%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20var%20x23%20%3D%20this%2E%5Fx2%20%2D%20x%2C%0A%20%20%20%20%20%20%20%20%20%20y23%20%3D%20this%2E%5Fy2%20%2D%20y%3B%0A%20%20%20%20%20%20this%2E%5Fl23%5Fa%20%3D%20Math%2Esqrt%28this%2E%5Fl23%5F2a%20%3D%20Math%2Epow%28x23%20%2A%20x23%20%2B%20y23%20%2A%20y23%2C%20this%2E%5Falpha%29%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20this%2E%5Fpoint%20%3D%201%3B%20break%3B%0A%20%20%20%20%20%20case%201%3A%20this%2E%5Fpoint%20%3D%202%3B%20break%3B%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fpoint%20%3D%203%3B%20this%2E%5Fline%20%3F%20this%2E%5Fcontext%2ElineTo%28this%2E%5Fx2%2C%20this%2E%5Fy2%29%20%3A%20this%2E%5Fcontext%2EmoveTo%28this%2E%5Fx2%2C%20this%2E%5Fy2%29%3B%20break%3B%0A%20%20%20%20%20%20case%203%3A%20this%2E%5Fpoint%20%3D%204%3B%20%2F%2F%20proceed%0A%20%20%20%20%20%20default%3A%20point%244%28this%2C%20x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this%2E%5Fl01%5Fa%20%3D%20this%2E%5Fl12%5Fa%2C%20this%2E%5Fl12%5Fa%20%3D%20this%2E%5Fl23%5Fa%3B%0A%20%20%20%20this%2E%5Fl01%5F2a%20%3D%20this%2E%5Fl12%5F2a%2C%20this%2E%5Fl12%5F2a%20%3D%20this%2E%5Fl23%5F2a%3B%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%2C%20this%2E%5Fx1%20%3D%20this%2E%5Fx2%2C%20this%2E%5Fx2%20%3D%20x%3B%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%2C%20this%2E%5Fy1%20%3D%20this%2E%5Fy2%2C%20this%2E%5Fy2%20%3D%20y%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20catmullRomOpen%20%3D%20%28function%20custom%28alpha%29%20%7B%0A%0A%20%20function%20catmullRom%24%241%28context%29%20%7B%0A%20%20%20%20return%20alpha%20%3F%20new%20CatmullRomOpen%28context%2C%20alpha%29%20%3A%20new%20CardinalOpen%28context%2C%200%29%3B%0A%20%20%7D%0A%0A%20%20catmullRom%24%241%2Ealpha%20%3D%20function%28alpha%29%20%7B%0A%20%20%20%20return%20custom%28%2Balpha%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20catmullRom%24%241%3B%0A%7D%29%280%2E5%29%3B%0A%0Afunction%20LinearClosed%28context%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%7D%0A%0ALinearClosed%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20noop%243%2C%0A%20%20areaEnd%3A%20noop%243%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20if%20%28this%2E%5Fpoint%29%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%3B%0A%20%20%20%20if%20%28this%2E%5Fpoint%29%20this%2E%5Fcontext%2ElineTo%28x%2C%20y%29%3B%0A%20%20%20%20else%20this%2E%5Fpoint%20%3D%201%2C%20this%2E%5Fcontext%2EmoveTo%28x%2C%20y%29%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20linearClosed%28context%29%20%7B%0A%20%20return%20new%20LinearClosed%28context%29%3B%0A%7D%0A%0Afunction%20sign%241%28x%29%20%7B%0A%20%20return%20x%20%3C%200%20%3F%20%2D1%20%3A%201%3B%0A%7D%0A%0A%2F%2F%20Calculate%20the%20slopes%20of%20the%20tangents%20%28Hermite%2Dtype%20interpolation%29%20based%20on%0A%2F%2F%20the%20following%20paper%3A%20Steffen%2C%20M%2E%201990%2E%20A%20Simple%20Method%20for%20Monotonic%0A%2F%2F%20Interpolation%20in%20One%20Dimension%2E%20Astronomy%20and%20Astrophysics%2C%20Vol%2E%20239%2C%20NO%2E%0A%2F%2F%20NOV%28II%29%2C%20P%2E%20443%2C%201990%2E%0Afunction%20slope3%28that%2C%20x2%2C%20y2%29%20%7B%0A%20%20var%20h0%20%3D%20that%2E%5Fx1%20%2D%20that%2E%5Fx0%2C%0A%20%20%20%20%20%20h1%20%3D%20x2%20%2D%20that%2E%5Fx1%2C%0A%20%20%20%20%20%20s0%20%3D%20%28that%2E%5Fy1%20%2D%20that%2E%5Fy0%29%20%2F%20%28h0%20%7C%7C%20h1%20%3C%200%20%26%26%20%2D0%29%2C%0A%20%20%20%20%20%20s1%20%3D%20%28y2%20%2D%20that%2E%5Fy1%29%20%2F%20%28h1%20%7C%7C%20h0%20%3C%200%20%26%26%20%2D0%29%2C%0A%20%20%20%20%20%20p%20%3D%20%28s0%20%2A%20h1%20%2B%20s1%20%2A%20h0%29%20%2F%20%28h0%20%2B%20h1%29%3B%0A%20%20return%20%28sign%241%28s0%29%20%2B%20sign%241%28s1%29%29%20%2A%20Math%2Emin%28Math%2Eabs%28s0%29%2C%20Math%2Eabs%28s1%29%2C%200%2E5%20%2A%20Math%2Eabs%28p%29%29%20%7C%7C%200%3B%0A%7D%0A%0A%2F%2F%20Calculate%20a%20one%2Dsided%20slope%2E%0Afunction%20slope2%28that%2C%20t%29%20%7B%0A%20%20var%20h%20%3D%20that%2E%5Fx1%20%2D%20that%2E%5Fx0%3B%0A%20%20return%20h%20%3F%20%283%20%2A%20%28that%2E%5Fy1%20%2D%20that%2E%5Fy0%29%20%2F%20h%20%2D%20t%29%20%2F%202%20%3A%20t%3B%0A%7D%0A%0A%2F%2F%20According%20to%20https%3A%2F%2Fen%2Ewikipedia%2Eorg%2Fwiki%2FCubic%5FHermite%5Fspline%23Representations%0A%2F%2F%20%22you%20can%20express%20cubic%20Hermite%20interpolation%20in%20terms%20of%20cubic%20B%C3%A9zier%20curves%0A%2F%2F%20with%20respect%20to%20the%20four%20values%20p0%2C%20p0%20%2B%20m0%20%2F%203%2C%20p1%20%2D%20m1%20%2F%203%2C%20p1%22%2E%0Afunction%20point%245%28that%2C%20t0%2C%20t1%29%20%7B%0A%20%20var%20x0%20%3D%20that%2E%5Fx0%2C%0A%20%20%20%20%20%20y0%20%3D%20that%2E%5Fy0%2C%0A%20%20%20%20%20%20x1%20%3D%20that%2E%5Fx1%2C%0A%20%20%20%20%20%20y1%20%3D%20that%2E%5Fy1%2C%0A%20%20%20%20%20%20dx%20%3D%20%28x1%20%2D%20x0%29%20%2F%203%3B%0A%20%20that%2E%5Fcontext%2EbezierCurveTo%28x0%20%2B%20dx%2C%20y0%20%2B%20dx%20%2A%20t0%2C%20x1%20%2D%20dx%2C%20y1%20%2D%20dx%20%2A%20t1%2C%20x1%2C%20y1%29%3B%0A%7D%0A%0Afunction%20MonotoneX%28context%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%7D%0A%0AMonotoneX%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20areaEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%20%3D%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%20%3D%0A%20%20%20%20this%2E%5Ft0%20%3D%20NaN%3B%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fcontext%2ElineTo%28this%2E%5Fx1%2C%20this%2E%5Fy1%29%3B%20break%3B%0A%20%20%20%20%20%20case%203%3A%20point%245%28this%2C%20this%2E%5Ft0%2C%20slope2%28this%2C%20this%2E%5Ft0%29%29%3B%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this%2E%5Fline%20%7C%7C%20%28this%2E%5Fline%20%21%3D%3D%200%20%26%26%20this%2E%5Fpoint%20%3D%3D%3D%201%29%29%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20this%2E%5Fline%20%3D%201%20%2D%20this%2E%5Fline%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20var%20t1%20%3D%20NaN%3B%0A%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%3B%0A%20%20%20%20if%20%28x%20%3D%3D%3D%20this%2E%5Fx1%20%26%26%20y%20%3D%3D%3D%20this%2E%5Fy1%29%20return%3B%20%2F%2F%20Ignore%20coincident%20points%2E%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20this%2E%5Fpoint%20%3D%201%3B%20this%2E%5Fline%20%3F%20this%2E%5Fcontext%2ElineTo%28x%2C%20y%29%20%3A%20this%2E%5Fcontext%2EmoveTo%28x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%20%20case%201%3A%20this%2E%5Fpoint%20%3D%202%3B%20break%3B%0A%20%20%20%20%20%20case%202%3A%20this%2E%5Fpoint%20%3D%203%3B%20point%245%28this%2C%20slope2%28this%2C%20t1%20%3D%20slope3%28this%2C%20x%2C%20y%29%29%2C%20t1%29%3B%20break%3B%0A%20%20%20%20%20%20default%3A%20point%245%28this%2C%20this%2E%5Ft0%2C%20t1%20%3D%20slope3%28this%2C%20x%2C%20y%29%29%3B%20break%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this%2E%5Fx0%20%3D%20this%2E%5Fx1%2C%20this%2E%5Fx1%20%3D%20x%3B%0A%20%20%20%20this%2E%5Fy0%20%3D%20this%2E%5Fy1%2C%20this%2E%5Fy1%20%3D%20y%3B%0A%20%20%20%20this%2E%5Ft0%20%3D%20t1%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20MonotoneY%28context%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20new%20ReflectContext%28context%29%3B%0A%7D%0A%0A%28MonotoneY%2Eprototype%20%3D%20Object%2Ecreate%28MonotoneX%2Eprototype%29%29%2Epoint%20%3D%20function%28x%2C%20y%29%20%7B%0A%20%20MonotoneX%2Eprototype%2Epoint%2Ecall%28this%2C%20y%2C%20x%29%3B%0A%7D%3B%0A%0Afunction%20ReflectContext%28context%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%7D%0A%0AReflectContext%2Eprototype%20%3D%20%7B%0A%20%20moveTo%3A%20function%28x%2C%20y%29%20%7B%20this%2E%5Fcontext%2EmoveTo%28y%2C%20x%29%3B%20%7D%2C%0A%20%20closePath%3A%20function%28%29%20%7B%20this%2E%5Fcontext%2EclosePath%28%29%3B%20%7D%2C%0A%20%20lineTo%3A%20function%28x%2C%20y%29%20%7B%20this%2E%5Fcontext%2ElineTo%28y%2C%20x%29%3B%20%7D%2C%0A%20%20bezierCurveTo%3A%20function%28x1%2C%20y1%2C%20x2%2C%20y2%2C%20x%2C%20y%29%20%7B%20this%2E%5Fcontext%2EbezierCurveTo%28y1%2C%20x1%2C%20y2%2C%20x2%2C%20y%2C%20x%29%3B%20%7D%0A%7D%3B%0A%0Afunction%20monotoneX%28context%29%20%7B%0A%20%20return%20new%20MonotoneX%28context%29%3B%0A%7D%0A%0Afunction%20monotoneY%28context%29%20%7B%0A%20%20return%20new%20MonotoneY%28context%29%3B%0A%7D%0A%0Afunction%20Natural%28context%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%7D%0A%0ANatural%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20areaEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fx%20%3D%20%5B%5D%3B%0A%20%20%20%20this%2E%5Fy%20%3D%20%5B%5D%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20var%20x%20%3D%20this%2E%5Fx%2C%0A%20%20%20%20%20%20%20%20y%20%3D%20this%2E%5Fy%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20x%2Elength%3B%0A%0A%20%20%20%20if%20%28n%29%20%7B%0A%20%20%20%20%20%20this%2E%5Fline%20%3F%20this%2E%5Fcontext%2ElineTo%28x%5B0%5D%2C%20y%5B0%5D%29%20%3A%20this%2E%5Fcontext%2EmoveTo%28x%5B0%5D%2C%20y%5B0%5D%29%3B%0A%20%20%20%20%20%20if%20%28n%20%3D%3D%3D%202%29%20%7B%0A%20%20%20%20%20%20%20%20this%2E%5Fcontext%2ElineTo%28x%5B1%5D%2C%20y%5B1%5D%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20var%20px%20%3D%20controlPoints%28x%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20py%20%3D%20controlPoints%28y%29%3B%0A%20%20%20%20%20%20%20%20for%20%28var%20i0%20%3D%200%2C%20i1%20%3D%201%3B%20i1%20%3C%20n%3B%20%2B%2Bi0%2C%20%2B%2Bi1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this%2E%5Fcontext%2EbezierCurveTo%28px%5B0%5D%5Bi0%5D%2C%20py%5B0%5D%5Bi0%5D%2C%20px%5B1%5D%5Bi0%5D%2C%20py%5B1%5D%5Bi0%5D%2C%20x%5Bi1%5D%2C%20y%5Bi1%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28this%2E%5Fline%20%7C%7C%20%28this%2E%5Fline%20%21%3D%3D%200%20%26%26%20n%20%3D%3D%3D%201%29%29%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20this%2E%5Fline%20%3D%201%20%2D%20this%2E%5Fline%3B%0A%20%20%20%20this%2E%5Fx%20%3D%20this%2E%5Fy%20%3D%20null%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20this%2E%5Fx%2Epush%28%2Bx%29%3B%0A%20%20%20%20this%2E%5Fy%2Epush%28%2By%29%3B%0A%20%20%7D%0A%7D%3B%0A%0A%2F%2F%20See%20https%3A%2F%2Fwww%2Eparticleincell%2Ecom%2F2012%2Fbezier%2Dsplines%2F%20for%20derivation%2E%0Afunction%20controlPoints%28x%29%20%7B%0A%20%20var%20i%2C%0A%20%20%20%20%20%20n%20%3D%20x%2Elength%20%2D%201%2C%0A%20%20%20%20%20%20m%2C%0A%20%20%20%20%20%20a%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20b%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20r%20%3D%20new%20Array%28n%29%3B%0A%20%20a%5B0%5D%20%3D%200%2C%20b%5B0%5D%20%3D%202%2C%20r%5B0%5D%20%3D%20x%5B0%5D%20%2B%202%20%2A%20x%5B1%5D%3B%0A%20%20for%20%28i%20%3D%201%3B%20i%20%3C%20n%20%2D%201%3B%20%2B%2Bi%29%20a%5Bi%5D%20%3D%201%2C%20b%5Bi%5D%20%3D%204%2C%20r%5Bi%5D%20%3D%204%20%2A%20x%5Bi%5D%20%2B%202%20%2A%20x%5Bi%20%2B%201%5D%3B%0A%20%20a%5Bn%20%2D%201%5D%20%3D%202%2C%20b%5Bn%20%2D%201%5D%20%3D%207%2C%20r%5Bn%20%2D%201%5D%20%3D%208%20%2A%20x%5Bn%20%2D%201%5D%20%2B%20x%5Bn%5D%3B%0A%20%20for%20%28i%20%3D%201%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20m%20%3D%20a%5Bi%5D%20%2F%20b%5Bi%20%2D%201%5D%2C%20b%5Bi%5D%20%2D%3D%20m%2C%20r%5Bi%5D%20%2D%3D%20m%20%2A%20r%5Bi%20%2D%201%5D%3B%0A%20%20a%5Bn%20%2D%201%5D%20%3D%20r%5Bn%20%2D%201%5D%20%2F%20b%5Bn%20%2D%201%5D%3B%0A%20%20for%20%28i%20%3D%20n%20%2D%202%3B%20i%20%3E%3D%200%3B%20%2D%2Di%29%20a%5Bi%5D%20%3D%20%28r%5Bi%5D%20%2D%20a%5Bi%20%2B%201%5D%29%20%2F%20b%5Bi%5D%3B%0A%20%20b%5Bn%20%2D%201%5D%20%3D%20%28x%5Bn%5D%20%2B%20a%5Bn%20%2D%201%5D%29%20%2F%202%3B%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%20%2D%201%3B%20%2B%2Bi%29%20b%5Bi%5D%20%3D%202%20%2A%20x%5Bi%20%2B%201%5D%20%2D%20a%5Bi%20%2B%201%5D%3B%0A%20%20return%20%5Ba%2C%20b%5D%3B%0A%7D%0A%0Afunction%20natural%28context%29%20%7B%0A%20%20return%20new%20Natural%28context%29%3B%0A%7D%0A%0Afunction%20Step%28context%2C%20t%29%20%7B%0A%20%20this%2E%5Fcontext%20%3D%20context%3B%0A%20%20this%2E%5Ft%20%3D%20t%3B%0A%7D%0A%0AStep%2Eprototype%20%3D%20%7B%0A%20%20areaStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20areaEnd%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fline%20%3D%20NaN%3B%0A%20%20%7D%2C%0A%20%20lineStart%3A%20function%28%29%20%7B%0A%20%20%20%20this%2E%5Fx%20%3D%20this%2E%5Fy%20%3D%20NaN%3B%0A%20%20%20%20this%2E%5Fpoint%20%3D%200%3B%0A%20%20%7D%2C%0A%20%20lineEnd%3A%20function%28%29%20%7B%0A%20%20%20%20if%20%280%20%3C%20this%2E%5Ft%20%26%26%20this%2E%5Ft%20%3C%201%20%26%26%20this%2E%5Fpoint%20%3D%3D%3D%202%29%20this%2E%5Fcontext%2ElineTo%28this%2E%5Fx%2C%20this%2E%5Fy%29%3B%0A%20%20%20%20if%20%28this%2E%5Fline%20%7C%7C%20%28this%2E%5Fline%20%21%3D%3D%200%20%26%26%20this%2E%5Fpoint%20%3D%3D%3D%201%29%29%20this%2E%5Fcontext%2EclosePath%28%29%3B%0A%20%20%20%20if%20%28this%2E%5Fline%20%3E%3D%200%29%20this%2E%5Ft%20%3D%201%20%2D%20this%2E%5Ft%2C%20this%2E%5Fline%20%3D%201%20%2D%20this%2E%5Fline%3B%0A%20%20%7D%2C%0A%20%20point%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20x%20%3D%20%2Bx%2C%20y%20%3D%20%2By%3B%0A%20%20%20%20switch%20%28this%2E%5Fpoint%29%20%7B%0A%20%20%20%20%20%20case%200%3A%20this%2E%5Fpoint%20%3D%201%3B%20this%2E%5Fline%20%3F%20this%2E%5Fcontext%2ElineTo%28x%2C%20y%29%20%3A%20this%2E%5Fcontext%2EmoveTo%28x%2C%20y%29%3B%20break%3B%0A%20%20%20%20%20%20case%201%3A%20this%2E%5Fpoint%20%3D%202%3B%20%2F%2F%20proceed%0A%20%20%20%20%20%20default%3A%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this%2E%5Ft%20%3C%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this%2E%5Fcontext%2ElineTo%28this%2E%5Fx%2C%20y%29%3B%0A%20%20%20%20%20%20%20%20%20%20this%2E%5Fcontext%2ElineTo%28x%2C%20y%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20x1%20%3D%20this%2E%5Fx%20%2A%20%281%20%2D%20this%2E%5Ft%29%20%2B%20x%20%2A%20this%2E%5Ft%3B%0A%20%20%20%20%20%20%20%20%20%20this%2E%5Fcontext%2ElineTo%28x1%2C%20this%2E%5Fy%29%3B%0A%20%20%20%20%20%20%20%20%20%20this%2E%5Fcontext%2ElineTo%28x1%2C%20y%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this%2E%5Fx%20%3D%20x%2C%20this%2E%5Fy%20%3D%20y%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20step%28context%29%20%7B%0A%20%20return%20new%20Step%28context%2C%200%2E5%29%3B%0A%7D%0A%0Afunction%20stepBefore%28context%29%20%7B%0A%20%20return%20new%20Step%28context%2C%200%29%3B%0A%7D%0A%0Afunction%20stepAfter%28context%29%20%7B%0A%20%20return%20new%20Step%28context%2C%201%29%3B%0A%7D%0A%0Afunction%20none%241%28series%2C%20order%29%20%7B%0A%20%20if%20%28%21%28%28n%20%3D%20series%2Elength%29%20%3E%201%29%29%20return%3B%0A%20%20for%20%28var%20i%20%3D%201%2C%20j%2C%20s0%2C%20s1%20%3D%20series%5Border%5B0%5D%5D%2C%20n%2C%20m%20%3D%20s1%2Elength%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20s0%20%3D%20s1%2C%20s1%20%3D%20series%5Border%5Bi%5D%5D%3B%0A%20%20%20%20for%20%28j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20s1%5Bj%5D%5B1%5D%20%2B%3D%20s1%5Bj%5D%5B0%5D%20%3D%20isNaN%28s0%5Bj%5D%5B1%5D%29%20%3F%20s0%5Bj%5D%5B0%5D%20%3A%20s0%5Bj%5D%5B1%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Afunction%20none%242%28series%29%20%7B%0A%20%20var%20n%20%3D%20series%2Elength%2C%20o%20%3D%20new%20Array%28n%29%3B%0A%20%20while%20%28%2D%2Dn%20%3E%3D%200%29%20o%5Bn%5D%20%3D%20n%3B%0A%20%20return%20o%3B%0A%7D%0A%0Afunction%20stackValue%28d%2C%20key%29%20%7B%0A%20%20return%20d%5Bkey%5D%3B%0A%7D%0A%0Afunction%20stack%28%29%20%7B%0A%20%20var%20keys%20%3D%20constant%2411%28%5B%5D%29%2C%0A%20%20%20%20%20%20order%20%3D%20none%242%2C%0A%20%20%20%20%20%20offset%20%3D%20none%241%2C%0A%20%20%20%20%20%20value%20%3D%20stackValue%3B%0A%0A%20%20function%20stack%28data%29%20%7B%0A%20%20%20%20var%20kz%20%3D%20keys%2Eapply%28this%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20%20%20m%20%3D%20data%2Elength%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20kz%2Elength%2C%0A%20%20%20%20%20%20%20%20sz%20%3D%20new%20Array%28n%29%2C%0A%20%20%20%20%20%20%20%20oz%3B%0A%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20for%20%28var%20ki%20%3D%20kz%5Bi%5D%2C%20si%20%3D%20sz%5Bi%5D%20%3D%20new%20Array%28m%29%2C%20j%20%3D%200%2C%20sij%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20%20%20si%5Bj%5D%20%3D%20sij%20%3D%20%5B0%2C%20%2Bvalue%28data%5Bj%5D%2C%20ki%2C%20j%2C%20data%29%5D%3B%0A%20%20%20%20%20%20%20%20sij%2Edata%20%3D%20data%5Bj%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20si%2Ekey%20%3D%20ki%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20for%20%28i%20%3D%200%2C%20oz%20%3D%20order%28sz%29%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20sz%5Boz%5Bi%5D%5D%2Eindex%20%3D%20i%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20offset%28sz%2C%20oz%29%3B%0A%20%20%20%20return%20sz%3B%0A%20%20%7D%0A%0A%20%20stack%2Ekeys%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28keys%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28slice%246%2Ecall%28%5F%29%29%2C%20stack%29%20%3A%20keys%3B%0A%20%20%7D%3B%0A%0A%20%20stack%2Evalue%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28value%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28%2B%5F%29%2C%20stack%29%20%3A%20value%3B%0A%20%20%7D%3B%0A%0A%20%20stack%2Eorder%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28order%20%3D%20%5F%20%3D%3D%20null%20%3F%20none%242%20%3A%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2411%28slice%246%2Ecall%28%5F%29%29%2C%20stack%29%20%3A%20order%3B%0A%20%20%7D%3B%0A%0A%20%20stack%2Eoffset%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28offset%20%3D%20%5F%20%3D%3D%20null%20%3F%20none%241%20%3A%20%5F%2C%20stack%29%20%3A%20offset%3B%0A%20%20%7D%3B%0A%0A%20%20return%20stack%3B%0A%7D%0A%0Afunction%20expand%28series%2C%20order%29%20%7B%0A%20%20if%20%28%21%28%28n%20%3D%20series%2Elength%29%20%3E%200%29%29%20return%3B%0A%20%20for%20%28var%20i%2C%20n%2C%20j%20%3D%200%2C%20m%20%3D%20series%5B0%5D%2Elength%2C%20y%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28y%20%3D%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20y%20%2B%3D%20series%5Bi%5D%5Bj%5D%5B1%5D%20%7C%7C%200%3B%0A%20%20%20%20if%20%28y%29%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20series%5Bi%5D%5Bj%5D%5B1%5D%20%2F%3D%20y%3B%0A%20%20%7D%0A%20%20none%241%28series%2C%20order%29%3B%0A%7D%0A%0Afunction%20diverging%28series%2C%20order%29%20%7B%0A%20%20if%20%28%21%28%28n%20%3D%20series%2Elength%29%20%3E%201%29%29%20return%3B%0A%20%20for%20%28var%20i%2C%20j%20%3D%200%2C%20d%2C%20dy%2C%20yp%2C%20yn%2C%20n%2C%20m%20%3D%20series%5Border%5B0%5D%5D%2Elength%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28yp%20%3D%20yn%20%3D%200%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28%28dy%20%3D%20%28d%20%3D%20series%5Border%5Bi%5D%5D%5Bj%5D%29%5B1%5D%20%2D%20d%5B0%5D%29%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20d%5B0%5D%20%3D%20yp%2C%20d%5B1%5D%20%3D%20yp%20%2B%3D%20dy%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28dy%20%3C%200%29%20%7B%0A%20%20%20%20%20%20%20%20d%5B1%5D%20%3D%20yn%2C%20d%5B0%5D%20%3D%20yn%20%2B%3D%20dy%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20d%5B0%5D%20%3D%20yp%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Afunction%20silhouette%28series%2C%20order%29%20%7B%0A%20%20if%20%28%21%28%28n%20%3D%20series%2Elength%29%20%3E%200%29%29%20return%3B%0A%20%20for%20%28var%20j%20%3D%200%2C%20s0%20%3D%20series%5Border%5B0%5D%5D%2C%20n%2C%20m%20%3D%20s0%2Elength%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20y%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20y%20%2B%3D%20series%5Bi%5D%5Bj%5D%5B1%5D%20%7C%7C%200%3B%0A%20%20%20%20s0%5Bj%5D%5B1%5D%20%2B%3D%20s0%5Bj%5D%5B0%5D%20%3D%20%2Dy%20%2F%202%3B%0A%20%20%7D%0A%20%20none%241%28series%2C%20order%29%3B%0A%7D%0A%0Afunction%20wiggle%28series%2C%20order%29%20%7B%0A%20%20if%20%28%21%28%28n%20%3D%20series%2Elength%29%20%3E%200%29%20%7C%7C%20%21%28%28m%20%3D%20%28s0%20%3D%20series%5Border%5B0%5D%5D%29%2Elength%29%20%3E%200%29%29%20return%3B%0A%20%20for%20%28var%20y%20%3D%200%2C%20j%20%3D%201%2C%20s0%2C%20m%2C%20n%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20s1%20%3D%200%2C%20s2%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20var%20si%20%3D%20series%5Border%5Bi%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20sij0%20%3D%20si%5Bj%5D%5B1%5D%20%7C%7C%200%2C%0A%20%20%20%20%20%20%20%20%20%20sij1%20%3D%20si%5Bj%20%2D%201%5D%5B1%5D%20%7C%7C%200%2C%0A%20%20%20%20%20%20%20%20%20%20s3%20%3D%20%28sij0%20%2D%20sij1%29%20%2F%202%3B%0A%20%20%20%20%20%20for%20%28var%20k%20%3D%200%3B%20k%20%3C%20i%3B%20%2B%2Bk%29%20%7B%0A%20%20%20%20%20%20%20%20var%20sk%20%3D%20series%5Border%5Bk%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20skj0%20%3D%20sk%5Bj%5D%5B1%5D%20%7C%7C%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20skj1%20%3D%20sk%5Bj%20%2D%201%5D%5B1%5D%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20s3%20%2B%3D%20skj0%20%2D%20skj1%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20s1%20%2B%3D%20sij0%2C%20s2%20%2B%3D%20s3%20%2A%20sij0%3B%0A%20%20%20%20%7D%0A%20%20%20%20s0%5Bj%20%2D%201%5D%5B1%5D%20%2B%3D%20s0%5Bj%20%2D%201%5D%5B0%5D%20%3D%20y%3B%0A%20%20%20%20if%20%28s1%29%20y%20%2D%3D%20s2%20%2F%20s1%3B%0A%20%20%7D%0A%20%20s0%5Bj%20%2D%201%5D%5B1%5D%20%2B%3D%20s0%5Bj%20%2D%201%5D%5B0%5D%20%3D%20y%3B%0A%20%20none%241%28series%2C%20order%29%3B%0A%7D%0A%0Afunction%20ascending%243%28series%29%20%7B%0A%20%20var%20sums%20%3D%20series%2Emap%28sum%242%29%3B%0A%20%20return%20none%242%28series%29%2Esort%28function%28a%2C%20b%29%20%7B%20return%20sums%5Ba%5D%20%2D%20sums%5Bb%5D%3B%20%7D%29%3B%0A%7D%0A%0Afunction%20sum%242%28series%29%20%7B%0A%20%20var%20s%20%3D%200%2C%20i%20%3D%20%2D1%2C%20n%20%3D%20series%2Elength%2C%20v%3B%0A%20%20while%20%28%2B%2Bi%20%3C%20n%29%20if%20%28v%20%3D%20%2Bseries%5Bi%5D%5B1%5D%29%20s%20%2B%3D%20v%3B%0A%20%20return%20s%3B%0A%7D%0A%0Afunction%20descending%242%28series%29%20%7B%0A%20%20return%20ascending%243%28series%29%2Ereverse%28%29%3B%0A%7D%0A%0Afunction%20insideOut%28series%29%20%7B%0A%20%20var%20n%20%3D%20series%2Elength%2C%0A%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20j%2C%0A%20%20%20%20%20%20sums%20%3D%20series%2Emap%28sum%242%29%2C%0A%20%20%20%20%20%20order%20%3D%20none%242%28series%29%2Esort%28function%28a%2C%20b%29%20%7B%20return%20sums%5Bb%5D%20%2D%20sums%5Ba%5D%3B%20%7D%29%2C%0A%20%20%20%20%20%20top%20%3D%200%2C%0A%20%20%20%20%20%20bottom%20%3D%200%2C%0A%20%20%20%20%20%20tops%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20bottoms%20%3D%20%5B%5D%3B%0A%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20j%20%3D%20order%5Bi%5D%3B%0A%20%20%20%20if%20%28top%20%3C%20bottom%29%20%7B%0A%20%20%20%20%20%20top%20%2B%3D%20sums%5Bj%5D%3B%0A%20%20%20%20%20%20tops%2Epush%28j%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20bottom%20%2B%3D%20sums%5Bj%5D%3B%0A%20%20%20%20%20%20bottoms%2Epush%28j%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20bottoms%2Ereverse%28%29%2Econcat%28tops%29%3B%0A%7D%0A%0Afunction%20reverse%28series%29%20%7B%0A%20%20return%20none%242%28series%29%2Ereverse%28%29%3B%0A%7D%0A%0Afunction%20constant%2412%28x%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20x%244%28d%29%20%7B%0A%20%20return%20d%5B0%5D%3B%0A%7D%0A%0Afunction%20y%244%28d%29%20%7B%0A%20%20return%20d%5B1%5D%3B%0A%7D%0A%0Afunction%20RedBlackTree%28%29%20%7B%0A%20%20this%2E%5F%20%3D%20null%3B%20%2F%2F%20root%20node%0A%7D%0A%0Afunction%20RedBlackNode%28node%29%20%7B%0A%20%20node%2EU%20%3D%20%2F%2F%20parent%20node%0A%20%20node%2EC%20%3D%20%2F%2F%20color%20%2D%20true%20for%20red%2C%20false%20for%20black%0A%20%20node%2EL%20%3D%20%2F%2F%20left%20node%0A%20%20node%2ER%20%3D%20%2F%2F%20right%20node%0A%20%20node%2EP%20%3D%20%2F%2F%20previous%20node%0A%20%20node%2EN%20%3D%20null%3B%20%2F%2F%20next%20node%0A%7D%0A%0ARedBlackTree%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20RedBlackTree%2C%0A%0A%20%20insert%3A%20function%28after%2C%20node%29%20%7B%0A%20%20%20%20var%20parent%2C%20grandpa%2C%20uncle%3B%0A%0A%20%20%20%20if%20%28after%29%20%7B%0A%20%20%20%20%20%20node%2EP%20%3D%20after%3B%0A%20%20%20%20%20%20node%2EN%20%3D%20after%2EN%3B%0A%20%20%20%20%20%20if%20%28after%2EN%29%20after%2EN%2EP%20%3D%20node%3B%0A%20%20%20%20%20%20after%2EN%20%3D%20node%3B%0A%20%20%20%20%20%20if%20%28after%2ER%29%20%7B%0A%20%20%20%20%20%20%20%20after%20%3D%20after%2ER%3B%0A%20%20%20%20%20%20%20%20while%20%28after%2EL%29%20after%20%3D%20after%2EL%3B%0A%20%20%20%20%20%20%20%20after%2EL%20%3D%20node%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20after%2ER%20%3D%20node%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20parent%20%3D%20after%3B%0A%20%20%20%20%7D%20else%20if%20%28this%2E%5F%29%20%7B%0A%20%20%20%20%20%20after%20%3D%20RedBlackFirst%28this%2E%5F%29%3B%0A%20%20%20%20%20%20node%2EP%20%3D%20null%3B%0A%20%20%20%20%20%20node%2EN%20%3D%20after%3B%0A%20%20%20%20%20%20after%2EP%20%3D%20after%2EL%20%3D%20node%3B%0A%20%20%20%20%20%20parent%20%3D%20after%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20node%2EP%20%3D%20node%2EN%20%3D%20null%3B%0A%20%20%20%20%20%20this%2E%5F%20%3D%20node%3B%0A%20%20%20%20%20%20parent%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20node%2EL%20%3D%20node%2ER%20%3D%20null%3B%0A%20%20%20%20node%2EU%20%3D%20parent%3B%0A%20%20%20%20node%2EC%20%3D%20true%3B%0A%0A%20%20%20%20after%20%3D%20node%3B%0A%20%20%20%20while%20%28parent%20%26%26%20parent%2EC%29%20%7B%0A%20%20%20%20%20%20grandpa%20%3D%20parent%2EU%3B%0A%20%20%20%20%20%20if%20%28parent%20%3D%3D%3D%20grandpa%2EL%29%20%7B%0A%20%20%20%20%20%20%20%20uncle%20%3D%20grandpa%2ER%3B%0A%20%20%20%20%20%20%20%20if%20%28uncle%20%26%26%20uncle%2EC%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20parent%2EC%20%3D%20uncle%2EC%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20grandpa%2EC%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20after%20%3D%20grandpa%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28after%20%3D%3D%3D%20parent%2ER%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20RedBlackRotateLeft%28this%2C%20parent%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20after%20%3D%20parent%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20parent%20%3D%20after%2EU%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20parent%2EC%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20grandpa%2EC%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20RedBlackRotateRight%28this%2C%20grandpa%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20uncle%20%3D%20grandpa%2EL%3B%0A%20%20%20%20%20%20%20%20if%20%28uncle%20%26%26%20uncle%2EC%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20parent%2EC%20%3D%20uncle%2EC%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20grandpa%2EC%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20after%20%3D%20grandpa%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28after%20%3D%3D%3D%20parent%2EL%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20RedBlackRotateRight%28this%2C%20parent%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20after%20%3D%20parent%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20parent%20%3D%20after%2EU%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20parent%2EC%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20grandpa%2EC%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20RedBlackRotateLeft%28this%2C%20grandpa%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20parent%20%3D%20after%2EU%3B%0A%20%20%20%20%7D%0A%20%20%20%20this%2E%5F%2EC%20%3D%20false%3B%0A%20%20%7D%2C%0A%0A%20%20remove%3A%20function%28node%29%20%7B%0A%20%20%20%20if%20%28node%2EN%29%20node%2EN%2EP%20%3D%20node%2EP%3B%0A%20%20%20%20if%20%28node%2EP%29%20node%2EP%2EN%20%3D%20node%2EN%3B%0A%20%20%20%20node%2EN%20%3D%20node%2EP%20%3D%20null%3B%0A%0A%20%20%20%20var%20parent%20%3D%20node%2EU%2C%0A%20%20%20%20%20%20%20%20sibling%2C%0A%20%20%20%20%20%20%20%20left%20%3D%20node%2EL%2C%0A%20%20%20%20%20%20%20%20right%20%3D%20node%2ER%2C%0A%20%20%20%20%20%20%20%20next%2C%0A%20%20%20%20%20%20%20%20red%3B%0A%0A%20%20%20%20if%20%28%21left%29%20next%20%3D%20right%3B%0A%20%20%20%20else%20if%20%28%21right%29%20next%20%3D%20left%3B%0A%20%20%20%20else%20next%20%3D%20RedBlackFirst%28right%29%3B%0A%0A%20%20%20%20if%20%28parent%29%20%7B%0A%20%20%20%20%20%20if%20%28parent%2EL%20%3D%3D%3D%20node%29%20parent%2EL%20%3D%20next%3B%0A%20%20%20%20%20%20else%20parent%2ER%20%3D%20next%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this%2E%5F%20%3D%20next%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28left%20%26%26%20right%29%20%7B%0A%20%20%20%20%20%20red%20%3D%20next%2EC%3B%0A%20%20%20%20%20%20next%2EC%20%3D%20node%2EC%3B%0A%20%20%20%20%20%20next%2EL%20%3D%20left%3B%0A%20%20%20%20%20%20left%2EU%20%3D%20next%3B%0A%20%20%20%20%20%20if%20%28next%20%21%3D%3D%20right%29%20%7B%0A%20%20%20%20%20%20%20%20parent%20%3D%20next%2EU%3B%0A%20%20%20%20%20%20%20%20next%2EU%20%3D%20node%2EU%3B%0A%20%20%20%20%20%20%20%20node%20%3D%20next%2ER%3B%0A%20%20%20%20%20%20%20%20parent%2EL%20%3D%20node%3B%0A%20%20%20%20%20%20%20%20next%2ER%20%3D%20right%3B%0A%20%20%20%20%20%20%20%20right%2EU%20%3D%20next%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20next%2EU%20%3D%20parent%3B%0A%20%20%20%20%20%20%20%20parent%20%3D%20next%3B%0A%20%20%20%20%20%20%20%20node%20%3D%20next%2ER%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20red%20%3D%20node%2EC%3B%0A%20%20%20%20%20%20node%20%3D%20next%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28node%29%20node%2EU%20%3D%20parent%3B%0A%20%20%20%20if%20%28red%29%20return%3B%0A%20%20%20%20if%20%28node%20%26%26%20node%2EC%29%20%7B%20node%2EC%20%3D%20false%3B%20return%3B%20%7D%0A%0A%20%20%20%20do%20%7B%0A%20%20%20%20%20%20if%20%28node%20%3D%3D%3D%20this%2E%5F%29%20break%3B%0A%20%20%20%20%20%20if%20%28node%20%3D%3D%3D%20parent%2EL%29%20%7B%0A%20%20%20%20%20%20%20%20sibling%20%3D%20parent%2ER%3B%0A%20%20%20%20%20%20%20%20if%20%28sibling%2EC%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20sibling%2EC%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20parent%2EC%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20RedBlackRotateLeft%28this%2C%20parent%29%3B%0A%20%20%20%20%20%20%20%20%20%20sibling%20%3D%20parent%2ER%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28%28sibling%2EL%20%26%26%20sibling%2EL%2EC%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%7C%20%28sibling%2ER%20%26%26%20sibling%2ER%2EC%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21sibling%2ER%20%7C%7C%20%21sibling%2ER%2EC%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20sibling%2EL%2EC%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sibling%2EC%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20RedBlackRotateRight%28this%2C%20sibling%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sibling%20%3D%20parent%2ER%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20sibling%2EC%20%3D%20parent%2EC%3B%0A%20%20%20%20%20%20%20%20%20%20parent%2EC%20%3D%20sibling%2ER%2EC%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20RedBlackRotateLeft%28this%2C%20parent%29%3B%0A%20%20%20%20%20%20%20%20%20%20node%20%3D%20this%2E%5F%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20sibling%20%3D%20parent%2EL%3B%0A%20%20%20%20%20%20%20%20if%20%28sibling%2EC%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20sibling%2EC%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20parent%2EC%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20RedBlackRotateRight%28this%2C%20parent%29%3B%0A%20%20%20%20%20%20%20%20%20%20sibling%20%3D%20parent%2EL%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28%28sibling%2EL%20%26%26%20sibling%2EL%2EC%29%0A%20%20%20%20%20%20%20%20%20%20%7C%7C%20%28sibling%2ER%20%26%26%20sibling%2ER%2EC%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21sibling%2EL%20%7C%7C%20%21sibling%2EL%2EC%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20sibling%2ER%2EC%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sibling%2EC%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20RedBlackRotateLeft%28this%2C%20sibling%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sibling%20%3D%20parent%2EL%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20sibling%2EC%20%3D%20parent%2EC%3B%0A%20%20%20%20%20%20%20%20%20%20parent%2EC%20%3D%20sibling%2EL%2EC%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20RedBlackRotateRight%28this%2C%20parent%29%3B%0A%20%20%20%20%20%20%20%20%20%20node%20%3D%20this%2E%5F%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20sibling%2EC%20%3D%20true%3B%0A%20%20%20%20%20%20node%20%3D%20parent%3B%0A%20%20%20%20%20%20parent%20%3D%20parent%2EU%3B%0A%20%20%20%20%7D%20while%20%28%21node%2EC%29%3B%0A%0A%20%20%20%20if%20%28node%29%20node%2EC%20%3D%20false%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20RedBlackRotateLeft%28tree%2C%20node%29%20%7B%0A%20%20var%20p%20%3D%20node%2C%0A%20%20%20%20%20%20q%20%3D%20node%2ER%2C%0A%20%20%20%20%20%20parent%20%3D%20p%2EU%3B%0A%0A%20%20if%20%28parent%29%20%7B%0A%20%20%20%20if%20%28parent%2EL%20%3D%3D%3D%20p%29%20parent%2EL%20%3D%20q%3B%0A%20%20%20%20else%20parent%2ER%20%3D%20q%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20tree%2E%5F%20%3D%20q%3B%0A%20%20%7D%0A%0A%20%20q%2EU%20%3D%20parent%3B%0A%20%20p%2EU%20%3D%20q%3B%0A%20%20p%2ER%20%3D%20q%2EL%3B%0A%20%20if%20%28p%2ER%29%20p%2ER%2EU%20%3D%20p%3B%0A%20%20q%2EL%20%3D%20p%3B%0A%7D%0A%0Afunction%20RedBlackRotateRight%28tree%2C%20node%29%20%7B%0A%20%20var%20p%20%3D%20node%2C%0A%20%20%20%20%20%20q%20%3D%20node%2EL%2C%0A%20%20%20%20%20%20parent%20%3D%20p%2EU%3B%0A%0A%20%20if%20%28parent%29%20%7B%0A%20%20%20%20if%20%28parent%2EL%20%3D%3D%3D%20p%29%20parent%2EL%20%3D%20q%3B%0A%20%20%20%20else%20parent%2ER%20%3D%20q%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20tree%2E%5F%20%3D%20q%3B%0A%20%20%7D%0A%0A%20%20q%2EU%20%3D%20parent%3B%0A%20%20p%2EU%20%3D%20q%3B%0A%20%20p%2EL%20%3D%20q%2ER%3B%0A%20%20if%20%28p%2EL%29%20p%2EL%2EU%20%3D%20p%3B%0A%20%20q%2ER%20%3D%20p%3B%0A%7D%0A%0Afunction%20RedBlackFirst%28node%29%20%7B%0A%20%20while%20%28node%2EL%29%20node%20%3D%20node%2EL%3B%0A%20%20return%20node%3B%0A%7D%0A%0Afunction%20createEdge%28left%2C%20right%2C%20v0%2C%20v1%29%20%7B%0A%20%20var%20edge%20%3D%20%5Bnull%2C%20null%5D%2C%0A%20%20%20%20%20%20index%20%3D%20edges%2Epush%28edge%29%20%2D%201%3B%0A%20%20edge%2Eleft%20%3D%20left%3B%0A%20%20edge%2Eright%20%3D%20right%3B%0A%20%20if%20%28v0%29%20setEdgeEnd%28edge%2C%20left%2C%20right%2C%20v0%29%3B%0A%20%20if%20%28v1%29%20setEdgeEnd%28edge%2C%20right%2C%20left%2C%20v1%29%3B%0A%20%20cells%5Bleft%2Eindex%5D%2Ehalfedges%2Epush%28index%29%3B%0A%20%20cells%5Bright%2Eindex%5D%2Ehalfedges%2Epush%28index%29%3B%0A%20%20return%20edge%3B%0A%7D%0A%0Afunction%20createBorderEdge%28left%2C%20v0%2C%20v1%29%20%7B%0A%20%20var%20edge%20%3D%20%5Bv0%2C%20v1%5D%3B%0A%20%20edge%2Eleft%20%3D%20left%3B%0A%20%20return%20edge%3B%0A%7D%0A%0Afunction%20setEdgeEnd%28edge%2C%20left%2C%20right%2C%20vertex%29%20%7B%0A%20%20if%20%28%21edge%5B0%5D%20%26%26%20%21edge%5B1%5D%29%20%7B%0A%20%20%20%20edge%5B0%5D%20%3D%20vertex%3B%0A%20%20%20%20edge%2Eleft%20%3D%20left%3B%0A%20%20%20%20edge%2Eright%20%3D%20right%3B%0A%20%20%7D%20else%20if%20%28edge%2Eleft%20%3D%3D%3D%20right%29%20%7B%0A%20%20%20%20edge%5B1%5D%20%3D%20vertex%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20edge%5B0%5D%20%3D%20vertex%3B%0A%20%20%7D%0A%7D%0A%0A%2F%2F%20Liang%E2%80%93Barsky%20line%20clipping%2E%0Afunction%20clipEdge%28edge%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20var%20a%20%3D%20edge%5B0%5D%2C%0A%20%20%20%20%20%20b%20%3D%20edge%5B1%5D%2C%0A%20%20%20%20%20%20ax%20%3D%20a%5B0%5D%2C%0A%20%20%20%20%20%20ay%20%3D%20a%5B1%5D%2C%0A%20%20%20%20%20%20bx%20%3D%20b%5B0%5D%2C%0A%20%20%20%20%20%20by%20%3D%20b%5B1%5D%2C%0A%20%20%20%20%20%20t0%20%3D%200%2C%0A%20%20%20%20%20%20t1%20%3D%201%2C%0A%20%20%20%20%20%20dx%20%3D%20bx%20%2D%20ax%2C%0A%20%20%20%20%20%20dy%20%3D%20by%20%2D%20ay%2C%0A%20%20%20%20%20%20r%3B%0A%0A%20%20r%20%3D%20x0%20%2D%20ax%3B%0A%20%20if%20%28%21dx%20%26%26%20r%20%3E%200%29%20return%3B%0A%20%20r%20%2F%3D%20dx%3B%0A%20%20if%20%28dx%20%3C%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3C%20t0%29%20return%3B%0A%20%20%20%20if%20%28r%20%3C%20t1%29%20t1%20%3D%20r%3B%0A%20%20%7D%20else%20if%20%28dx%20%3E%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3E%20t1%29%20return%3B%0A%20%20%20%20if%20%28r%20%3E%20t0%29%20t0%20%3D%20r%3B%0A%20%20%7D%0A%0A%20%20r%20%3D%20x1%20%2D%20ax%3B%0A%20%20if%20%28%21dx%20%26%26%20r%20%3C%200%29%20return%3B%0A%20%20r%20%2F%3D%20dx%3B%0A%20%20if%20%28dx%20%3C%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3E%20t1%29%20return%3B%0A%20%20%20%20if%20%28r%20%3E%20t0%29%20t0%20%3D%20r%3B%0A%20%20%7D%20else%20if%20%28dx%20%3E%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3C%20t0%29%20return%3B%0A%20%20%20%20if%20%28r%20%3C%20t1%29%20t1%20%3D%20r%3B%0A%20%20%7D%0A%0A%20%20r%20%3D%20y0%20%2D%20ay%3B%0A%20%20if%20%28%21dy%20%26%26%20r%20%3E%200%29%20return%3B%0A%20%20r%20%2F%3D%20dy%3B%0A%20%20if%20%28dy%20%3C%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3C%20t0%29%20return%3B%0A%20%20%20%20if%20%28r%20%3C%20t1%29%20t1%20%3D%20r%3B%0A%20%20%7D%20else%20if%20%28dy%20%3E%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3E%20t1%29%20return%3B%0A%20%20%20%20if%20%28r%20%3E%20t0%29%20t0%20%3D%20r%3B%0A%20%20%7D%0A%0A%20%20r%20%3D%20y1%20%2D%20ay%3B%0A%20%20if%20%28%21dy%20%26%26%20r%20%3C%200%29%20return%3B%0A%20%20r%20%2F%3D%20dy%3B%0A%20%20if%20%28dy%20%3C%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3E%20t1%29%20return%3B%0A%20%20%20%20if%20%28r%20%3E%20t0%29%20t0%20%3D%20r%3B%0A%20%20%7D%20else%20if%20%28dy%20%3E%200%29%20%7B%0A%20%20%20%20if%20%28r%20%3C%20t0%29%20return%3B%0A%20%20%20%20if%20%28r%20%3C%20t1%29%20t1%20%3D%20r%3B%0A%20%20%7D%0A%0A%20%20if%20%28%21%28t0%20%3E%200%29%20%26%26%20%21%28t1%20%3C%201%29%29%20return%20true%3B%20%2F%2F%20TODO%20Better%20check%3F%0A%0A%20%20if%20%28t0%20%3E%200%29%20edge%5B0%5D%20%3D%20%5Bax%20%2B%20t0%20%2A%20dx%2C%20ay%20%2B%20t0%20%2A%20dy%5D%3B%0A%20%20if%20%28t1%20%3C%201%29%20edge%5B1%5D%20%3D%20%5Bax%20%2B%20t1%20%2A%20dx%2C%20ay%20%2B%20t1%20%2A%20dy%5D%3B%0A%20%20return%20true%3B%0A%7D%0A%0Afunction%20connectEdge%28edge%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20var%20v1%20%3D%20edge%5B1%5D%3B%0A%20%20if%20%28v1%29%20return%20true%3B%0A%0A%20%20var%20v0%20%3D%20edge%5B0%5D%2C%0A%20%20%20%20%20%20left%20%3D%20edge%2Eleft%2C%0A%20%20%20%20%20%20right%20%3D%20edge%2Eright%2C%0A%20%20%20%20%20%20lx%20%3D%20left%5B0%5D%2C%0A%20%20%20%20%20%20ly%20%3D%20left%5B1%5D%2C%0A%20%20%20%20%20%20rx%20%3D%20right%5B0%5D%2C%0A%20%20%20%20%20%20ry%20%3D%20right%5B1%5D%2C%0A%20%20%20%20%20%20fx%20%3D%20%28lx%20%2B%20rx%29%20%2F%202%2C%0A%20%20%20%20%20%20fy%20%3D%20%28ly%20%2B%20ry%29%20%2F%202%2C%0A%20%20%20%20%20%20fm%2C%0A%20%20%20%20%20%20fb%3B%0A%0A%20%20if%20%28ry%20%3D%3D%3D%20ly%29%20%7B%0A%20%20%20%20if%20%28fx%20%3C%20x0%20%7C%7C%20fx%20%3E%3D%20x1%29%20return%3B%0A%20%20%20%20if%20%28lx%20%3E%20rx%29%20%7B%0A%20%20%20%20%20%20if%20%28%21v0%29%20v0%20%3D%20%5Bfx%2C%20y0%5D%3B%0A%20%20%20%20%20%20else%20if%20%28v0%5B1%5D%20%3E%3D%20y1%29%20return%3B%0A%20%20%20%20%20%20v1%20%3D%20%5Bfx%2C%20y1%5D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28%21v0%29%20v0%20%3D%20%5Bfx%2C%20y1%5D%3B%0A%20%20%20%20%20%20else%20if%20%28v0%5B1%5D%20%3C%20y0%29%20return%3B%0A%20%20%20%20%20%20v1%20%3D%20%5Bfx%2C%20y0%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20fm%20%3D%20%28lx%20%2D%20rx%29%20%2F%20%28ry%20%2D%20ly%29%3B%0A%20%20%20%20fb%20%3D%20fy%20%2D%20fm%20%2A%20fx%3B%0A%20%20%20%20if%20%28fm%20%3C%20%2D1%20%7C%7C%20fm%20%3E%201%29%20%7B%0A%20%20%20%20%20%20if%20%28lx%20%3E%20rx%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21v0%29%20v0%20%3D%20%5B%28y0%20%2D%20fb%29%20%2F%20fm%2C%20y0%5D%3B%0A%20%20%20%20%20%20%20%20else%20if%20%28v0%5B1%5D%20%3E%3D%20y1%29%20return%3B%0A%20%20%20%20%20%20%20%20v1%20%3D%20%5B%28y1%20%2D%20fb%29%20%2F%20fm%2C%20y1%5D%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21v0%29%20v0%20%3D%20%5B%28y1%20%2D%20fb%29%20%2F%20fm%2C%20y1%5D%3B%0A%20%20%20%20%20%20%20%20else%20if%20%28v0%5B1%5D%20%3C%20y0%29%20return%3B%0A%20%20%20%20%20%20%20%20v1%20%3D%20%5B%28y0%20%2D%20fb%29%20%2F%20fm%2C%20y0%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28ly%20%3C%20ry%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21v0%29%20v0%20%3D%20%5Bx0%2C%20fm%20%2A%20x0%20%2B%20fb%5D%3B%0A%20%20%20%20%20%20%20%20else%20if%20%28v0%5B0%5D%20%3E%3D%20x1%29%20return%3B%0A%20%20%20%20%20%20%20%20v1%20%3D%20%5Bx1%2C%20fm%20%2A%20x1%20%2B%20fb%5D%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21v0%29%20v0%20%3D%20%5Bx1%2C%20fm%20%2A%20x1%20%2B%20fb%5D%3B%0A%20%20%20%20%20%20%20%20else%20if%20%28v0%5B0%5D%20%3C%20x0%29%20return%3B%0A%20%20%20%20%20%20%20%20v1%20%3D%20%5Bx0%2C%20fm%20%2A%20x0%20%2B%20fb%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20edge%5B0%5D%20%3D%20v0%3B%0A%20%20edge%5B1%5D%20%3D%20v1%3B%0A%20%20return%20true%3B%0A%7D%0A%0Afunction%20clipEdges%28x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20var%20i%20%3D%20edges%2Elength%2C%0A%20%20%20%20%20%20edge%3B%0A%0A%20%20while%20%28i%2D%2D%29%20%7B%0A%20%20%20%20if%20%28%21connectEdge%28edge%20%3D%20edges%5Bi%5D%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%0A%20%20%20%20%20%20%20%20%7C%7C%20%21clipEdge%28edge%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%0A%20%20%20%20%20%20%20%20%7C%7C%20%21%28Math%2Eabs%28edge%5B0%5D%5B0%5D%20%2D%20edge%5B1%5D%5B0%5D%29%20%3E%20epsilon%244%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%7C%20Math%2Eabs%28edge%5B0%5D%5B1%5D%20%2D%20edge%5B1%5D%5B1%5D%29%20%3E%20epsilon%244%29%29%20%7B%0A%20%20%20%20%20%20delete%20edges%5Bi%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Afunction%20createCell%28site%29%20%7B%0A%20%20return%20cells%5Bsite%2Eindex%5D%20%3D%20%7B%0A%20%20%20%20site%3A%20site%2C%0A%20%20%20%20halfedges%3A%20%5B%5D%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20cellHalfedgeAngle%28cell%2C%20edge%29%20%7B%0A%20%20var%20site%20%3D%20cell%2Esite%2C%0A%20%20%20%20%20%20va%20%3D%20edge%2Eleft%2C%0A%20%20%20%20%20%20vb%20%3D%20edge%2Eright%3B%0A%20%20if%20%28site%20%3D%3D%3D%20vb%29%20vb%20%3D%20va%2C%20va%20%3D%20site%3B%0A%20%20if%20%28vb%29%20return%20Math%2Eatan2%28vb%5B1%5D%20%2D%20va%5B1%5D%2C%20vb%5B0%5D%20%2D%20va%5B0%5D%29%3B%0A%20%20if%20%28site%20%3D%3D%3D%20va%29%20va%20%3D%20edge%5B1%5D%2C%20vb%20%3D%20edge%5B0%5D%3B%0A%20%20else%20va%20%3D%20edge%5B0%5D%2C%20vb%20%3D%20edge%5B1%5D%3B%0A%20%20return%20Math%2Eatan2%28va%5B0%5D%20%2D%20vb%5B0%5D%2C%20vb%5B1%5D%20%2D%20va%5B1%5D%29%3B%0A%7D%0A%0Afunction%20cellHalfedgeStart%28cell%2C%20edge%29%20%7B%0A%20%20return%20edge%5B%2B%28edge%2Eleft%20%21%3D%3D%20cell%2Esite%29%5D%3B%0A%7D%0A%0Afunction%20cellHalfedgeEnd%28cell%2C%20edge%29%20%7B%0A%20%20return%20edge%5B%2B%28edge%2Eleft%20%3D%3D%3D%20cell%2Esite%29%5D%3B%0A%7D%0A%0Afunction%20sortCellHalfedges%28%29%20%7B%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20cells%2Elength%2C%20cell%2C%20halfedges%2C%20j%2C%20m%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28%28cell%20%3D%20cells%5Bi%5D%29%20%26%26%20%28m%20%3D%20%28halfedges%20%3D%20cell%2Ehalfedges%29%2Elength%29%29%20%7B%0A%20%20%20%20%20%20var%20index%20%3D%20new%20Array%28m%29%2C%0A%20%20%20%20%20%20%20%20%20%20array%20%3D%20new%20Array%28m%29%3B%0A%20%20%20%20%20%20for%20%28j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20index%5Bj%5D%20%3D%20j%2C%20array%5Bj%5D%20%3D%20cellHalfedgeAngle%28cell%2C%20edges%5Bhalfedges%5Bj%5D%5D%29%3B%0A%20%20%20%20%20%20index%2Esort%28function%28i%2C%20j%29%20%7B%20return%20array%5Bj%5D%20%2D%20array%5Bi%5D%3B%20%7D%29%3B%0A%20%20%20%20%20%20for%20%28j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20array%5Bj%5D%20%3D%20halfedges%5Bindex%5Bj%5D%5D%3B%0A%20%20%20%20%20%20for%20%28j%20%3D%200%3B%20j%20%3C%20m%3B%20%2B%2Bj%29%20halfedges%5Bj%5D%20%3D%20array%5Bj%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Afunction%20clipCells%28x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20var%20nCells%20%3D%20cells%2Elength%2C%0A%20%20%20%20%20%20iCell%2C%0A%20%20%20%20%20%20cell%2C%0A%20%20%20%20%20%20site%2C%0A%20%20%20%20%20%20iHalfedge%2C%0A%20%20%20%20%20%20halfedges%2C%0A%20%20%20%20%20%20nHalfedges%2C%0A%20%20%20%20%20%20start%2C%0A%20%20%20%20%20%20startX%2C%0A%20%20%20%20%20%20startY%2C%0A%20%20%20%20%20%20end%2C%0A%20%20%20%20%20%20endX%2C%0A%20%20%20%20%20%20endY%2C%0A%20%20%20%20%20%20cover%20%3D%20true%3B%0A%0A%20%20for%20%28iCell%20%3D%200%3B%20iCell%20%3C%20nCells%3B%20%2B%2BiCell%29%20%7B%0A%20%20%20%20if%20%28cell%20%3D%20cells%5BiCell%5D%29%20%7B%0A%20%20%20%20%20%20site%20%3D%20cell%2Esite%3B%0A%20%20%20%20%20%20halfedges%20%3D%20cell%2Ehalfedges%3B%0A%20%20%20%20%20%20iHalfedge%20%3D%20halfedges%2Elength%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Remove%20any%20dangling%20clipped%20edges%2E%0A%20%20%20%20%20%20while%20%28iHalfedge%2D%2D%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21edges%5Bhalfedges%5BiHalfedge%5D%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20halfedges%2Esplice%28iHalfedge%2C%201%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20Insert%20any%20border%20edges%20as%20necessary%2E%0A%20%20%20%20%20%20iHalfedge%20%3D%200%2C%20nHalfedges%20%3D%20halfedges%2Elength%3B%0A%20%20%20%20%20%20while%20%28iHalfedge%20%3C%20nHalfedges%29%20%7B%0A%20%20%20%20%20%20%20%20end%20%3D%20cellHalfedgeEnd%28cell%2C%20edges%5Bhalfedges%5BiHalfedge%5D%5D%29%2C%20endX%20%3D%20end%5B0%5D%2C%20endY%20%3D%20end%5B1%5D%3B%0A%20%20%20%20%20%20%20%20start%20%3D%20cellHalfedgeStart%28cell%2C%20edges%5Bhalfedges%5B%2B%2BiHalfedge%20%25%20nHalfedges%5D%5D%29%2C%20startX%20%3D%20start%5B0%5D%2C%20startY%20%3D%20start%5B1%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28Math%2Eabs%28endX%20%2D%20startX%29%20%3E%20epsilon%244%20%7C%7C%20Math%2Eabs%28endY%20%2D%20startY%29%20%3E%20epsilon%244%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20halfedges%2Esplice%28iHalfedge%2C%200%2C%20edges%2Epush%28createBorderEdge%28site%2C%20end%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Math%2Eabs%28endX%20%2D%20x0%29%20%3C%20epsilon%244%20%26%26%20y1%20%2D%20endY%20%3E%20epsilon%244%20%3F%20%5Bx0%2C%20Math%2Eabs%28startX%20%2D%20x0%29%20%3C%20epsilon%244%20%3F%20startY%20%3A%20y1%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20Math%2Eabs%28endY%20%2D%20y1%29%20%3C%20epsilon%244%20%26%26%20x1%20%2D%20endX%20%3E%20epsilon%244%20%3F%20%5BMath%2Eabs%28startY%20%2D%20y1%29%20%3C%20epsilon%244%20%3F%20startX%20%3A%20x1%2C%20y1%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20Math%2Eabs%28endX%20%2D%20x1%29%20%3C%20epsilon%244%20%26%26%20endY%20%2D%20y0%20%3E%20epsilon%244%20%3F%20%5Bx1%2C%20Math%2Eabs%28startX%20%2D%20x1%29%20%3C%20epsilon%244%20%3F%20startY%20%3A%20y0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20Math%2Eabs%28endY%20%2D%20y0%29%20%3C%20epsilon%244%20%26%26%20endX%20%2D%20x0%20%3E%20epsilon%244%20%3F%20%5BMath%2Eabs%28startY%20%2D%20y0%29%20%3C%20epsilon%244%20%3F%20startX%20%3A%20x0%2C%20y0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20null%29%29%20%2D%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20%2B%2BnHalfedges%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20if%20%28nHalfedges%29%20cover%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20If%20there%20weren%E2%80%99t%20any%20edges%2C%20have%20the%20closest%20site%20cover%20the%20extent%2E%0A%20%20%2F%2F%20It%20doesn%E2%80%99t%20matter%20which%20corner%20of%20the%20extent%20we%20measure%21%0A%20%20if%20%28cover%29%20%7B%0A%20%20%20%20var%20dx%2C%20dy%2C%20d2%2C%20dc%20%3D%20Infinity%3B%0A%0A%20%20%20%20for%20%28iCell%20%3D%200%2C%20cover%20%3D%20null%3B%20iCell%20%3C%20nCells%3B%20%2B%2BiCell%29%20%7B%0A%20%20%20%20%20%20if%20%28cell%20%3D%20cells%5BiCell%5D%29%20%7B%0A%20%20%20%20%20%20%20%20site%20%3D%20cell%2Esite%3B%0A%20%20%20%20%20%20%20%20dx%20%3D%20site%5B0%5D%20%2D%20x0%3B%0A%20%20%20%20%20%20%20%20dy%20%3D%20site%5B1%5D%20%2D%20y0%3B%0A%20%20%20%20%20%20%20%20d2%20%3D%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%3B%0A%20%20%20%20%20%20%20%20if%20%28d2%20%3C%20dc%29%20dc%20%3D%20d2%2C%20cover%20%3D%20cell%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28cover%29%20%7B%0A%20%20%20%20%20%20var%20v00%20%3D%20%5Bx0%2C%20y0%5D%2C%20v01%20%3D%20%5Bx0%2C%20y1%5D%2C%20v11%20%3D%20%5Bx1%2C%20y1%5D%2C%20v10%20%3D%20%5Bx1%2C%20y0%5D%3B%0A%20%20%20%20%20%20cover%2Ehalfedges%2Epush%28%0A%20%20%20%20%20%20%20%20edges%2Epush%28createBorderEdge%28site%20%3D%20cover%2Esite%2C%20v00%2C%20v01%29%29%20%2D%201%2C%0A%20%20%20%20%20%20%20%20edges%2Epush%28createBorderEdge%28site%2C%20v01%2C%20v11%29%29%20%2D%201%2C%0A%20%20%20%20%20%20%20%20edges%2Epush%28createBorderEdge%28site%2C%20v11%2C%20v10%29%29%20%2D%201%2C%0A%20%20%20%20%20%20%20%20edges%2Epush%28createBorderEdge%28site%2C%20v10%2C%20v00%29%29%20%2D%201%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20Lastly%20delete%20any%20cells%20with%20no%20edges%3B%20these%20were%20entirely%20clipped%2E%0A%20%20for%20%28iCell%20%3D%200%3B%20iCell%20%3C%20nCells%3B%20%2B%2BiCell%29%20%7B%0A%20%20%20%20if%20%28cell%20%3D%20cells%5BiCell%5D%29%20%7B%0A%20%20%20%20%20%20if%20%28%21cell%2Ehalfedges%2Elength%29%20%7B%0A%20%20%20%20%20%20%20%20delete%20cells%5BiCell%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Avar%20circlePool%20%3D%20%5B%5D%3B%0A%0Avar%20firstCircle%3B%0A%0Afunction%20Circle%28%29%20%7B%0A%20%20RedBlackNode%28this%29%3B%0A%20%20this%2Ex%20%3D%0A%20%20this%2Ey%20%3D%0A%20%20this%2Earc%20%3D%0A%20%20this%2Esite%20%3D%0A%20%20this%2Ecy%20%3D%20null%3B%0A%7D%0A%0Afunction%20attachCircle%28arc%29%20%7B%0A%20%20var%20lArc%20%3D%20arc%2EP%2C%0A%20%20%20%20%20%20rArc%20%3D%20arc%2EN%3B%0A%0A%20%20if%20%28%21lArc%20%7C%7C%20%21rArc%29%20return%3B%0A%0A%20%20var%20lSite%20%3D%20lArc%2Esite%2C%0A%20%20%20%20%20%20cSite%20%3D%20arc%2Esite%2C%0A%20%20%20%20%20%20rSite%20%3D%20rArc%2Esite%3B%0A%0A%20%20if%20%28lSite%20%3D%3D%3D%20rSite%29%20return%3B%0A%0A%20%20var%20bx%20%3D%20cSite%5B0%5D%2C%0A%20%20%20%20%20%20by%20%3D%20cSite%5B1%5D%2C%0A%20%20%20%20%20%20ax%20%3D%20lSite%5B0%5D%20%2D%20bx%2C%0A%20%20%20%20%20%20ay%20%3D%20lSite%5B1%5D%20%2D%20by%2C%0A%20%20%20%20%20%20cx%20%3D%20rSite%5B0%5D%20%2D%20bx%2C%0A%20%20%20%20%20%20cy%20%3D%20rSite%5B1%5D%20%2D%20by%3B%0A%0A%20%20var%20d%20%3D%202%20%2A%20%28ax%20%2A%20cy%20%2D%20ay%20%2A%20cx%29%3B%0A%20%20if%20%28d%20%3E%3D%20%2Depsilon2%242%29%20return%3B%0A%0A%20%20var%20ha%20%3D%20ax%20%2A%20ax%20%2B%20ay%20%2A%20ay%2C%0A%20%20%20%20%20%20hc%20%3D%20cx%20%2A%20cx%20%2B%20cy%20%2A%20cy%2C%0A%20%20%20%20%20%20x%20%3D%20%28cy%20%2A%20ha%20%2D%20ay%20%2A%20hc%29%20%2F%20d%2C%0A%20%20%20%20%20%20y%20%3D%20%28ax%20%2A%20hc%20%2D%20cx%20%2A%20ha%29%20%2F%20d%3B%0A%0A%20%20var%20circle%20%3D%20circlePool%2Epop%28%29%20%7C%7C%20new%20Circle%3B%0A%20%20circle%2Earc%20%3D%20arc%3B%0A%20%20circle%2Esite%20%3D%20cSite%3B%0A%20%20circle%2Ex%20%3D%20x%20%2B%20bx%3B%0A%20%20circle%2Ey%20%3D%20%28circle%2Ecy%20%3D%20y%20%2B%20by%29%20%2B%20Math%2Esqrt%28x%20%2A%20x%20%2B%20y%20%2A%20y%29%3B%20%2F%2F%20y%20bottom%0A%0A%20%20arc%2Ecircle%20%3D%20circle%3B%0A%0A%20%20var%20before%20%3D%20null%2C%0A%20%20%20%20%20%20node%20%3D%20circles%2E%5F%3B%0A%0A%20%20while%20%28node%29%20%7B%0A%20%20%20%20if%20%28circle%2Ey%20%3C%20node%2Ey%20%7C%7C%20%28circle%2Ey%20%3D%3D%3D%20node%2Ey%20%26%26%20circle%2Ex%20%3C%3D%20node%2Ex%29%29%20%7B%0A%20%20%20%20%20%20if%20%28node%2EL%29%20node%20%3D%20node%2EL%3B%0A%20%20%20%20%20%20else%20%7B%20before%20%3D%20node%2EP%3B%20break%3B%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28node%2ER%29%20node%20%3D%20node%2ER%3B%0A%20%20%20%20%20%20else%20%7B%20before%20%3D%20node%3B%20break%3B%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20circles%2Einsert%28before%2C%20circle%29%3B%0A%20%20if%20%28%21before%29%20firstCircle%20%3D%20circle%3B%0A%7D%0A%0Afunction%20detachCircle%28arc%29%20%7B%0A%20%20var%20circle%20%3D%20arc%2Ecircle%3B%0A%20%20if%20%28circle%29%20%7B%0A%20%20%20%20if%20%28%21circle%2EP%29%20firstCircle%20%3D%20circle%2EN%3B%0A%20%20%20%20circles%2Eremove%28circle%29%3B%0A%20%20%20%20circlePool%2Epush%28circle%29%3B%0A%20%20%20%20RedBlackNode%28circle%29%3B%0A%20%20%20%20arc%2Ecircle%20%3D%20null%3B%0A%20%20%7D%0A%7D%0A%0Avar%20beachPool%20%3D%20%5B%5D%3B%0A%0Afunction%20Beach%28%29%20%7B%0A%20%20RedBlackNode%28this%29%3B%0A%20%20this%2Eedge%20%3D%0A%20%20this%2Esite%20%3D%0A%20%20this%2Ecircle%20%3D%20null%3B%0A%7D%0A%0Afunction%20createBeach%28site%29%20%7B%0A%20%20var%20beach%20%3D%20beachPool%2Epop%28%29%20%7C%7C%20new%20Beach%3B%0A%20%20beach%2Esite%20%3D%20site%3B%0A%20%20return%20beach%3B%0A%7D%0A%0Afunction%20detachBeach%28beach%29%20%7B%0A%20%20detachCircle%28beach%29%3B%0A%20%20beaches%2Eremove%28beach%29%3B%0A%20%20beachPool%2Epush%28beach%29%3B%0A%20%20RedBlackNode%28beach%29%3B%0A%7D%0A%0Afunction%20removeBeach%28beach%29%20%7B%0A%20%20var%20circle%20%3D%20beach%2Ecircle%2C%0A%20%20%20%20%20%20x%20%3D%20circle%2Ex%2C%0A%20%20%20%20%20%20y%20%3D%20circle%2Ecy%2C%0A%20%20%20%20%20%20vertex%20%3D%20%5Bx%2C%20y%5D%2C%0A%20%20%20%20%20%20previous%20%3D%20beach%2EP%2C%0A%20%20%20%20%20%20next%20%3D%20beach%2EN%2C%0A%20%20%20%20%20%20disappearing%20%3D%20%5Bbeach%5D%3B%0A%0A%20%20detachBeach%28beach%29%3B%0A%0A%20%20var%20lArc%20%3D%20previous%3B%0A%20%20while%20%28lArc%2Ecircle%0A%20%20%20%20%20%20%26%26%20Math%2Eabs%28x%20%2D%20lArc%2Ecircle%2Ex%29%20%3C%20epsilon%244%0A%20%20%20%20%20%20%26%26%20Math%2Eabs%28y%20%2D%20lArc%2Ecircle%2Ecy%29%20%3C%20epsilon%244%29%20%7B%0A%20%20%20%20previous%20%3D%20lArc%2EP%3B%0A%20%20%20%20disappearing%2Eunshift%28lArc%29%3B%0A%20%20%20%20detachBeach%28lArc%29%3B%0A%20%20%20%20lArc%20%3D%20previous%3B%0A%20%20%7D%0A%0A%20%20disappearing%2Eunshift%28lArc%29%3B%0A%20%20detachCircle%28lArc%29%3B%0A%0A%20%20var%20rArc%20%3D%20next%3B%0A%20%20while%20%28rArc%2Ecircle%0A%20%20%20%20%20%20%26%26%20Math%2Eabs%28x%20%2D%20rArc%2Ecircle%2Ex%29%20%3C%20epsilon%244%0A%20%20%20%20%20%20%26%26%20Math%2Eabs%28y%20%2D%20rArc%2Ecircle%2Ecy%29%20%3C%20epsilon%244%29%20%7B%0A%20%20%20%20next%20%3D%20rArc%2EN%3B%0A%20%20%20%20disappearing%2Epush%28rArc%29%3B%0A%20%20%20%20detachBeach%28rArc%29%3B%0A%20%20%20%20rArc%20%3D%20next%3B%0A%20%20%7D%0A%0A%20%20disappearing%2Epush%28rArc%29%3B%0A%20%20detachCircle%28rArc%29%3B%0A%0A%20%20var%20nArcs%20%3D%20disappearing%2Elength%2C%0A%20%20%20%20%20%20iArc%3B%0A%20%20for%20%28iArc%20%3D%201%3B%20iArc%20%3C%20nArcs%3B%20%2B%2BiArc%29%20%7B%0A%20%20%20%20rArc%20%3D%20disappearing%5BiArc%5D%3B%0A%20%20%20%20lArc%20%3D%20disappearing%5BiArc%20%2D%201%5D%3B%0A%20%20%20%20setEdgeEnd%28rArc%2Eedge%2C%20lArc%2Esite%2C%20rArc%2Esite%2C%20vertex%29%3B%0A%20%20%7D%0A%0A%20%20lArc%20%3D%20disappearing%5B0%5D%3B%0A%20%20rArc%20%3D%20disappearing%5BnArcs%20%2D%201%5D%3B%0A%20%20rArc%2Eedge%20%3D%20createEdge%28lArc%2Esite%2C%20rArc%2Esite%2C%20null%2C%20vertex%29%3B%0A%0A%20%20attachCircle%28lArc%29%3B%0A%20%20attachCircle%28rArc%29%3B%0A%7D%0A%0Afunction%20addBeach%28site%29%20%7B%0A%20%20var%20x%20%3D%20site%5B0%5D%2C%0A%20%20%20%20%20%20directrix%20%3D%20site%5B1%5D%2C%0A%20%20%20%20%20%20lArc%2C%0A%20%20%20%20%20%20rArc%2C%0A%20%20%20%20%20%20dxl%2C%0A%20%20%20%20%20%20dxr%2C%0A%20%20%20%20%20%20node%20%3D%20beaches%2E%5F%3B%0A%0A%20%20while%20%28node%29%20%7B%0A%20%20%20%20dxl%20%3D%20leftBreakPoint%28node%2C%20directrix%29%20%2D%20x%3B%0A%20%20%20%20if%20%28dxl%20%3E%20epsilon%244%29%20node%20%3D%20node%2EL%3B%20else%20%7B%0A%20%20%20%20%20%20dxr%20%3D%20x%20%2D%20rightBreakPoint%28node%2C%20directrix%29%3B%0A%20%20%20%20%20%20if%20%28dxr%20%3E%20epsilon%244%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21node%2ER%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20lArc%20%3D%20node%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20node%20%3D%20node%2ER%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28dxl%20%3E%20%2Depsilon%244%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20lArc%20%3D%20node%2EP%3B%0A%20%20%20%20%20%20%20%20%20%20rArc%20%3D%20node%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28dxr%20%3E%20%2Depsilon%244%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20lArc%20%3D%20node%3B%0A%20%20%20%20%20%20%20%20%20%20rArc%20%3D%20node%2EN%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20lArc%20%3D%20rArc%20%3D%20node%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20createCell%28site%29%3B%0A%20%20var%20newArc%20%3D%20createBeach%28site%29%3B%0A%20%20beaches%2Einsert%28lArc%2C%20newArc%29%3B%0A%0A%20%20if%20%28%21lArc%20%26%26%20%21rArc%29%20return%3B%0A%0A%20%20if%20%28lArc%20%3D%3D%3D%20rArc%29%20%7B%0A%20%20%20%20detachCircle%28lArc%29%3B%0A%20%20%20%20rArc%20%3D%20createBeach%28lArc%2Esite%29%3B%0A%20%20%20%20beaches%2Einsert%28newArc%2C%20rArc%29%3B%0A%20%20%20%20newArc%2Eedge%20%3D%20rArc%2Eedge%20%3D%20createEdge%28lArc%2Esite%2C%20newArc%2Esite%29%3B%0A%20%20%20%20attachCircle%28lArc%29%3B%0A%20%20%20%20attachCircle%28rArc%29%3B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%0A%20%20if%20%28%21rArc%29%20%7B%20%2F%2F%20%26%26%20lArc%0A%20%20%20%20newArc%2Eedge%20%3D%20createEdge%28lArc%2Esite%2C%20newArc%2Esite%29%3B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20else%20lArc%20%21%3D%3D%20rArc%0A%20%20detachCircle%28lArc%29%3B%0A%20%20detachCircle%28rArc%29%3B%0A%0A%20%20var%20lSite%20%3D%20lArc%2Esite%2C%0A%20%20%20%20%20%20ax%20%3D%20lSite%5B0%5D%2C%0A%20%20%20%20%20%20ay%20%3D%20lSite%5B1%5D%2C%0A%20%20%20%20%20%20bx%20%3D%20site%5B0%5D%20%2D%20ax%2C%0A%20%20%20%20%20%20by%20%3D%20site%5B1%5D%20%2D%20ay%2C%0A%20%20%20%20%20%20rSite%20%3D%20rArc%2Esite%2C%0A%20%20%20%20%20%20cx%20%3D%20rSite%5B0%5D%20%2D%20ax%2C%0A%20%20%20%20%20%20cy%20%3D%20rSite%5B1%5D%20%2D%20ay%2C%0A%20%20%20%20%20%20d%20%3D%202%20%2A%20%28bx%20%2A%20cy%20%2D%20by%20%2A%20cx%29%2C%0A%20%20%20%20%20%20hb%20%3D%20bx%20%2A%20bx%20%2B%20by%20%2A%20by%2C%0A%20%20%20%20%20%20hc%20%3D%20cx%20%2A%20cx%20%2B%20cy%20%2A%20cy%2C%0A%20%20%20%20%20%20vertex%20%3D%20%5B%28cy%20%2A%20hb%20%2D%20by%20%2A%20hc%29%20%2F%20d%20%2B%20ax%2C%20%28bx%20%2A%20hc%20%2D%20cx%20%2A%20hb%29%20%2F%20d%20%2B%20ay%5D%3B%0A%0A%20%20setEdgeEnd%28rArc%2Eedge%2C%20lSite%2C%20rSite%2C%20vertex%29%3B%0A%20%20newArc%2Eedge%20%3D%20createEdge%28lSite%2C%20site%2C%20null%2C%20vertex%29%3B%0A%20%20rArc%2Eedge%20%3D%20createEdge%28site%2C%20rSite%2C%20null%2C%20vertex%29%3B%0A%20%20attachCircle%28lArc%29%3B%0A%20%20attachCircle%28rArc%29%3B%0A%7D%0A%0Afunction%20leftBreakPoint%28arc%2C%20directrix%29%20%7B%0A%20%20var%20site%20%3D%20arc%2Esite%2C%0A%20%20%20%20%20%20rfocx%20%3D%20site%5B0%5D%2C%0A%20%20%20%20%20%20rfocy%20%3D%20site%5B1%5D%2C%0A%20%20%20%20%20%20pby2%20%3D%20rfocy%20%2D%20directrix%3B%0A%0A%20%20if%20%28%21pby2%29%20return%20rfocx%3B%0A%0A%20%20var%20lArc%20%3D%20arc%2EP%3B%0A%20%20if%20%28%21lArc%29%20return%20%2DInfinity%3B%0A%0A%20%20site%20%3D%20lArc%2Esite%3B%0A%20%20var%20lfocx%20%3D%20site%5B0%5D%2C%0A%20%20%20%20%20%20lfocy%20%3D%20site%5B1%5D%2C%0A%20%20%20%20%20%20plby2%20%3D%20lfocy%20%2D%20directrix%3B%0A%0A%20%20if%20%28%21plby2%29%20return%20lfocx%3B%0A%0A%20%20var%20hl%20%3D%20lfocx%20%2D%20rfocx%2C%0A%20%20%20%20%20%20aby2%20%3D%201%20%2F%20pby2%20%2D%201%20%2F%20plby2%2C%0A%20%20%20%20%20%20b%20%3D%20hl%20%2F%20plby2%3B%0A%0A%20%20if%20%28aby2%29%20return%20%28%2Db%20%2B%20Math%2Esqrt%28b%20%2A%20b%20%2D%202%20%2A%20aby2%20%2A%20%28hl%20%2A%20hl%20%2F%20%28%2D2%20%2A%20plby2%29%20%2D%20lfocy%20%2B%20plby2%20%2F%202%20%2B%20rfocy%20%2D%20pby2%20%2F%202%29%29%29%20%2F%20aby2%20%2B%20rfocx%3B%0A%0A%20%20return%20%28rfocx%20%2B%20lfocx%29%20%2F%202%3B%0A%7D%0A%0Afunction%20rightBreakPoint%28arc%2C%20directrix%29%20%7B%0A%20%20var%20rArc%20%3D%20arc%2EN%3B%0A%20%20if%20%28rArc%29%20return%20leftBreakPoint%28rArc%2C%20directrix%29%3B%0A%20%20var%20site%20%3D%20arc%2Esite%3B%0A%20%20return%20site%5B1%5D%20%3D%3D%3D%20directrix%20%3F%20site%5B0%5D%20%3A%20Infinity%3B%0A%7D%0A%0Avar%20epsilon%244%20%3D%201e%2D6%3B%0Avar%20epsilon2%242%20%3D%201e%2D12%3B%0Avar%20beaches%3B%0Avar%20cells%3B%0Avar%20circles%3B%0Avar%20edges%3B%0A%0Afunction%20triangleArea%28a%2C%20b%2C%20c%29%20%7B%0A%20%20return%20%28a%5B0%5D%20%2D%20c%5B0%5D%29%20%2A%20%28b%5B1%5D%20%2D%20a%5B1%5D%29%20%2D%20%28a%5B0%5D%20%2D%20b%5B0%5D%29%20%2A%20%28c%5B1%5D%20%2D%20a%5B1%5D%29%3B%0A%7D%0A%0Afunction%20lexicographic%28a%2C%20b%29%20%7B%0A%20%20return%20b%5B1%5D%20%2D%20a%5B1%5D%0A%20%20%20%20%20%20%7C%7C%20b%5B0%5D%20%2D%20a%5B0%5D%3B%0A%7D%0A%0Afunction%20Diagram%28sites%2C%20extent%29%20%7B%0A%20%20var%20site%20%3D%20sites%2Esort%28lexicographic%29%2Epop%28%29%2C%0A%20%20%20%20%20%20x%2C%0A%20%20%20%20%20%20y%2C%0A%20%20%20%20%20%20circle%3B%0A%0A%20%20edges%20%3D%20%5B%5D%3B%0A%20%20cells%20%3D%20new%20Array%28sites%2Elength%29%3B%0A%20%20beaches%20%3D%20new%20RedBlackTree%3B%0A%20%20circles%20%3D%20new%20RedBlackTree%3B%0A%0A%20%20while%20%28true%29%20%7B%0A%20%20%20%20circle%20%3D%20firstCircle%3B%0A%20%20%20%20if%20%28site%20%26%26%20%28%21circle%20%7C%7C%20site%5B1%5D%20%3C%20circle%2Ey%20%7C%7C%20%28site%5B1%5D%20%3D%3D%3D%20circle%2Ey%20%26%26%20site%5B0%5D%20%3C%20circle%2Ex%29%29%29%20%7B%0A%20%20%20%20%20%20if%20%28site%5B0%5D%20%21%3D%3D%20x%20%7C%7C%20site%5B1%5D%20%21%3D%3D%20y%29%20%7B%0A%20%20%20%20%20%20%20%20addBeach%28site%29%3B%0A%20%20%20%20%20%20%20%20x%20%3D%20site%5B0%5D%2C%20y%20%3D%20site%5B1%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20site%20%3D%20sites%2Epop%28%29%3B%0A%20%20%20%20%7D%20else%20if%20%28circle%29%20%7B%0A%20%20%20%20%20%20removeBeach%28circle%2Earc%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20sortCellHalfedges%28%29%3B%0A%0A%20%20if%20%28extent%29%20%7B%0A%20%20%20%20var%20x0%20%3D%20%2Bextent%5B0%5D%5B0%5D%2C%0A%20%20%20%20%20%20%20%20y0%20%3D%20%2Bextent%5B0%5D%5B1%5D%2C%0A%20%20%20%20%20%20%20%20x1%20%3D%20%2Bextent%5B1%5D%5B0%5D%2C%0A%20%20%20%20%20%20%20%20y1%20%3D%20%2Bextent%5B1%5D%5B1%5D%3B%0A%20%20%20%20clipEdges%28x0%2C%20y0%2C%20x1%2C%20y1%29%3B%0A%20%20%20%20clipCells%28x0%2C%20y0%2C%20x1%2C%20y1%29%3B%0A%20%20%7D%0A%0A%20%20this%2Eedges%20%3D%20edges%3B%0A%20%20this%2Ecells%20%3D%20cells%3B%0A%0A%20%20beaches%20%3D%0A%20%20circles%20%3D%0A%20%20edges%20%3D%0A%20%20cells%20%3D%20null%3B%0A%7D%0A%0ADiagram%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20Diagram%2C%0A%0A%20%20polygons%3A%20function%28%29%20%7B%0A%20%20%20%20var%20edges%20%3D%20this%2Eedges%3B%0A%0A%20%20%20%20return%20this%2Ecells%2Emap%28function%28cell%29%20%7B%0A%20%20%20%20%20%20var%20polygon%20%3D%20cell%2Ehalfedges%2Emap%28function%28i%29%20%7B%20return%20cellHalfedgeStart%28cell%2C%20edges%5Bi%5D%29%3B%20%7D%29%3B%0A%20%20%20%20%20%20polygon%2Edata%20%3D%20cell%2Esite%2Edata%3B%0A%20%20%20%20%20%20return%20polygon%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%2C%0A%0A%20%20triangles%3A%20function%28%29%20%7B%0A%20%20%20%20var%20triangles%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20edges%20%3D%20this%2Eedges%3B%0A%0A%20%20%20%20this%2Ecells%2EforEach%28function%28cell%2C%20i%29%20%7B%0A%20%20%20%20%20%20if%20%28%21%28m%20%3D%20%28halfedges%20%3D%20cell%2Ehalfedges%29%2Elength%29%29%20return%3B%0A%20%20%20%20%20%20var%20site%20%3D%20cell%2Esite%2C%0A%20%20%20%20%20%20%20%20%20%20halfedges%2C%0A%20%20%20%20%20%20%20%20%20%20j%20%3D%20%2D1%2C%0A%20%20%20%20%20%20%20%20%20%20m%2C%0A%20%20%20%20%20%20%20%20%20%20s0%2C%0A%20%20%20%20%20%20%20%20%20%20e1%20%3D%20edges%5Bhalfedges%5Bm%20%2D%201%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20s1%20%3D%20e1%2Eleft%20%3D%3D%3D%20site%20%3F%20e1%2Eright%20%3A%20e1%2Eleft%3B%0A%0A%20%20%20%20%20%20while%20%28%2B%2Bj%20%3C%20m%29%20%7B%0A%20%20%20%20%20%20%20%20s0%20%3D%20s1%3B%0A%20%20%20%20%20%20%20%20e1%20%3D%20edges%5Bhalfedges%5Bj%5D%5D%3B%0A%20%20%20%20%20%20%20%20s1%20%3D%20e1%2Eleft%20%3D%3D%3D%20site%20%3F%20e1%2Eright%20%3A%20e1%2Eleft%3B%0A%20%20%20%20%20%20%20%20if%20%28s0%20%26%26%20s1%20%26%26%20i%20%3C%20s0%2Eindex%20%26%26%20i%20%3C%20s1%2Eindex%20%26%26%20triangleArea%28site%2C%20s0%2C%20s1%29%20%3C%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20triangles%2Epush%28%5Bsite%2Edata%2C%20s0%2Edata%2C%20s1%2Edata%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20return%20triangles%3B%0A%20%20%7D%2C%0A%0A%20%20links%3A%20function%28%29%20%7B%0A%20%20%20%20return%20this%2Eedges%2Efilter%28function%28edge%29%20%7B%0A%20%20%20%20%20%20return%20edge%2Eright%3B%0A%20%20%20%20%7D%29%2Emap%28function%28edge%29%20%7B%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20source%3A%20edge%2Eleft%2Edata%2C%0A%20%20%20%20%20%20%20%20target%3A%20edge%2Eright%2Edata%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%2C%0A%0A%20%20find%3A%20function%28x%2C%20y%2C%20radius%29%20%7B%0A%20%20%20%20var%20that%20%3D%20this%2C%20i0%2C%20i1%20%3D%20that%2E%5Ffound%20%7C%7C%200%2C%20n%20%3D%20that%2Ecells%2Elength%2C%20cell%3B%0A%0A%20%20%20%20%2F%2F%20Use%20the%20previously%2Dfound%20cell%2C%20or%20start%20with%20an%20arbitrary%20one%2E%0A%20%20%20%20while%20%28%21%28cell%20%3D%20that%2Ecells%5Bi1%5D%29%29%20if%20%28%2B%2Bi1%20%3E%3D%20n%29%20return%20null%3B%0A%20%20%20%20var%20dx%20%3D%20x%20%2D%20cell%2Esite%5B0%5D%2C%20dy%20%3D%20y%20%2D%20cell%2Esite%5B1%5D%2C%20d2%20%3D%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%3B%0A%0A%20%20%20%20%2F%2F%20Traverse%20the%20half%2Dedges%20to%20find%20a%20closer%20cell%2C%20if%20any%2E%0A%20%20%20%20do%20%7B%0A%20%20%20%20%20%20cell%20%3D%20that%2Ecells%5Bi0%20%3D%20i1%5D%2C%20i1%20%3D%20null%3B%0A%20%20%20%20%20%20cell%2Ehalfedges%2EforEach%28function%28e%29%20%7B%0A%20%20%20%20%20%20%20%20var%20edge%20%3D%20that%2Eedges%5Be%5D%2C%20v%20%3D%20edge%2Eleft%3B%0A%20%20%20%20%20%20%20%20if%20%28%28v%20%3D%3D%3D%20cell%2Esite%20%7C%7C%20%21v%29%20%26%26%20%21%28v%20%3D%20edge%2Eright%29%29%20return%3B%0A%20%20%20%20%20%20%20%20var%20vx%20%3D%20x%20%2D%20v%5B0%5D%2C%20vy%20%3D%20y%20%2D%20v%5B1%5D%2C%20v2%20%3D%20vx%20%2A%20vx%20%2B%20vy%20%2A%20vy%3B%0A%20%20%20%20%20%20%20%20if%20%28v2%20%3C%20d2%29%20d2%20%3D%20v2%2C%20i1%20%3D%20v%2Eindex%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%20while%20%28i1%20%21%3D%3D%20null%29%3B%0A%0A%20%20%20%20that%2E%5Ffound%20%3D%20i0%3B%0A%0A%20%20%20%20return%20radius%20%3D%3D%20null%20%7C%7C%20d2%20%3C%3D%20radius%20%2A%20radius%20%3F%20cell%2Esite%20%3A%20null%3B%0A%20%20%7D%0A%7D%3B%0A%0Afunction%20voronoi%28%29%20%7B%0A%20%20var%20x%24%241%20%3D%20x%244%2C%0A%20%20%20%20%20%20y%24%241%20%3D%20y%244%2C%0A%20%20%20%20%20%20extent%20%3D%20null%3B%0A%0A%20%20function%20voronoi%28data%29%20%7B%0A%20%20%20%20return%20new%20Diagram%28data%2Emap%28function%28d%2C%20i%29%20%7B%0A%20%20%20%20%20%20var%20s%20%3D%20%5BMath%2Eround%28x%24%241%28d%2C%20i%2C%20data%29%20%2F%20epsilon%244%29%20%2A%20epsilon%244%2C%20Math%2Eround%28y%24%241%28d%2C%20i%2C%20data%29%20%2F%20epsilon%244%29%20%2A%20epsilon%244%5D%3B%0A%20%20%20%20%20%20s%2Eindex%20%3D%20i%3B%0A%20%20%20%20%20%20s%2Edata%20%3D%20d%3B%0A%20%20%20%20%20%20return%20s%3B%0A%20%20%20%20%7D%29%2C%20extent%29%3B%0A%20%20%7D%0A%0A%20%20voronoi%2Epolygons%20%3D%20function%28data%29%20%7B%0A%20%20%20%20return%20voronoi%28data%29%2Epolygons%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20voronoi%2Elinks%20%3D%20function%28data%29%20%7B%0A%20%20%20%20return%20voronoi%28data%29%2Elinks%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20voronoi%2Etriangles%20%3D%20function%28data%29%20%7B%0A%20%20%20%20return%20voronoi%28data%29%2Etriangles%28%29%3B%0A%20%20%7D%3B%0A%0A%20%20voronoi%2Ex%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28x%24%241%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2412%28%2B%5F%29%2C%20voronoi%29%20%3A%20x%24%241%3B%0A%20%20%7D%3B%0A%0A%20%20voronoi%2Ey%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28y%24%241%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2412%28%2B%5F%29%2C%20voronoi%29%20%3A%20y%24%241%3B%0A%20%20%7D%3B%0A%0A%20%20voronoi%2Eextent%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28extent%20%3D%20%5F%20%3D%3D%20null%20%3F%20null%20%3A%20%5B%5B%2B%5F%5B0%5D%5B0%5D%2C%20%2B%5F%5B0%5D%5B1%5D%5D%2C%20%5B%2B%5F%5B1%5D%5B0%5D%2C%20%2B%5F%5B1%5D%5B1%5D%5D%5D%2C%20voronoi%29%20%3A%20extent%20%26%26%20%5B%5Bextent%5B0%5D%5B0%5D%2C%20extent%5B0%5D%5B1%5D%5D%2C%20%5Bextent%5B1%5D%5B0%5D%2C%20extent%5B1%5D%5B1%5D%5D%5D%3B%0A%20%20%7D%3B%0A%0A%20%20voronoi%2Esize%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28extent%20%3D%20%5F%20%3D%3D%20null%20%3F%20null%20%3A%20%5B%5B0%2C%200%5D%2C%20%5B%2B%5F%5B0%5D%2C%20%2B%5F%5B1%5D%5D%5D%2C%20voronoi%29%20%3A%20extent%20%26%26%20%5Bextent%5B1%5D%5B0%5D%20%2D%20extent%5B0%5D%5B0%5D%2C%20extent%5B1%5D%5B1%5D%20%2D%20extent%5B0%5D%5B1%5D%5D%3B%0A%20%20%7D%3B%0A%0A%20%20return%20voronoi%3B%0A%7D%0A%0Afunction%20constant%2413%28x%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x%3B%0A%20%20%7D%3B%0A%7D%0A%0Afunction%20ZoomEvent%28target%2C%20type%2C%20transform%29%20%7B%0A%20%20this%2Etarget%20%3D%20target%3B%0A%20%20this%2Etype%20%3D%20type%3B%0A%20%20this%2Etransform%20%3D%20transform%3B%0A%7D%0A%0Afunction%20Transform%28k%2C%20x%2C%20y%29%20%7B%0A%20%20this%2Ek%20%3D%20k%3B%0A%20%20this%2Ex%20%3D%20x%3B%0A%20%20this%2Ey%20%3D%20y%3B%0A%7D%0A%0ATransform%2Eprototype%20%3D%20%7B%0A%20%20constructor%3A%20Transform%2C%0A%20%20scale%3A%20function%28k%29%20%7B%0A%20%20%20%20return%20k%20%3D%3D%3D%201%20%3F%20this%20%3A%20new%20Transform%28this%2Ek%20%2A%20k%2C%20this%2Ex%2C%20this%2Ey%29%3B%0A%20%20%7D%2C%0A%20%20translate%3A%20function%28x%2C%20y%29%20%7B%0A%20%20%20%20return%20x%20%3D%3D%3D%200%20%26%20y%20%3D%3D%3D%200%20%3F%20this%20%3A%20new%20Transform%28this%2Ek%2C%20this%2Ex%20%2B%20this%2Ek%20%2A%20x%2C%20this%2Ey%20%2B%20this%2Ek%20%2A%20y%29%3B%0A%20%20%7D%2C%0A%20%20apply%3A%20function%28point%29%20%7B%0A%20%20%20%20return%20%5Bpoint%5B0%5D%20%2A%20this%2Ek%20%2B%20this%2Ex%2C%20point%5B1%5D%20%2A%20this%2Ek%20%2B%20this%2Ey%5D%3B%0A%20%20%7D%2C%0A%20%20applyX%3A%20function%28x%29%20%7B%0A%20%20%20%20return%20x%20%2A%20this%2Ek%20%2B%20this%2Ex%3B%0A%20%20%7D%2C%0A%20%20applyY%3A%20function%28y%29%20%7B%0A%20%20%20%20return%20y%20%2A%20this%2Ek%20%2B%20this%2Ey%3B%0A%20%20%7D%2C%0A%20%20invert%3A%20function%28location%29%20%7B%0A%20%20%20%20return%20%5B%28location%5B0%5D%20%2D%20this%2Ex%29%20%2F%20this%2Ek%2C%20%28location%5B1%5D%20%2D%20this%2Ey%29%20%2F%20this%2Ek%5D%3B%0A%20%20%7D%2C%0A%20%20invertX%3A%20function%28x%29%20%7B%0A%20%20%20%20return%20%28x%20%2D%20this%2Ex%29%20%2F%20this%2Ek%3B%0A%20%20%7D%2C%0A%20%20invertY%3A%20function%28y%29%20%7B%0A%20%20%20%20return%20%28y%20%2D%20this%2Ey%29%20%2F%20this%2Ek%3B%0A%20%20%7D%2C%0A%20%20rescaleX%3A%20function%28x%29%20%7B%0A%20%20%20%20return%20x%2Ecopy%28%29%2Edomain%28x%2Erange%28%29%2Emap%28this%2EinvertX%2C%20this%29%2Emap%28x%2Einvert%2C%20x%29%29%3B%0A%20%20%7D%2C%0A%20%20rescaleY%3A%20function%28y%29%20%7B%0A%20%20%20%20return%20y%2Ecopy%28%29%2Edomain%28y%2Erange%28%29%2Emap%28this%2EinvertY%2C%20this%29%2Emap%28y%2Einvert%2C%20y%29%29%3B%0A%20%20%7D%2C%0A%20%20toString%3A%20function%28%29%20%7B%0A%20%20%20%20return%20%22translate%28%22%20%2B%20this%2Ex%20%2B%20%22%2C%22%20%2B%20this%2Ey%20%2B%20%22%29%20scale%28%22%20%2B%20this%2Ek%20%2B%20%22%29%22%3B%0A%20%20%7D%0A%7D%3B%0A%0Avar%20identity%248%20%3D%20new%20Transform%281%2C%200%2C%200%29%3B%0A%0Atransform%241%2Eprototype%20%3D%20Transform%2Eprototype%3B%0A%0Afunction%20transform%241%28node%29%20%7B%0A%20%20return%20node%2E%5F%5Fzoom%20%7C%7C%20identity%248%3B%0A%7D%0A%0Afunction%20nopropagation%242%28%29%20%7B%0A%20%20exports%2Eevent%2EstopImmediatePropagation%28%29%3B%0A%7D%0A%0Afunction%20noevent%242%28%29%20%7B%0A%20%20exports%2Eevent%2EpreventDefault%28%29%3B%0A%20%20exports%2Eevent%2EstopImmediatePropagation%28%29%3B%0A%7D%0A%0A%2F%2F%20Ignore%20right%2Dclick%2C%20since%20that%20should%20open%20the%20context%20menu%2E%0Afunction%20defaultFilter%242%28%29%20%7B%0A%20%20return%20%21exports%2Eevent%2Ebutton%3B%0A%7D%0A%0Afunction%20defaultExtent%241%28%29%20%7B%0A%20%20var%20e%20%3D%20this%2C%20w%2C%20h%3B%0A%20%20if%20%28e%20instanceof%20SVGElement%29%20%7B%0A%20%20%20%20e%20%3D%20e%2EownerSVGElement%20%7C%7C%20e%3B%0A%20%20%20%20w%20%3D%20e%2Ewidth%2EbaseVal%2Evalue%3B%0A%20%20%20%20h%20%3D%20e%2Eheight%2EbaseVal%2Evalue%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20w%20%3D%20e%2EclientWidth%3B%0A%20%20%20%20h%20%3D%20e%2EclientHeight%3B%0A%20%20%7D%0A%20%20return%20%5B%5B0%2C%200%5D%2C%20%5Bw%2C%20h%5D%5D%3B%0A%7D%0A%0Afunction%20defaultTransform%28%29%20%7B%0A%20%20return%20this%2E%5F%5Fzoom%20%7C%7C%20identity%248%3B%0A%7D%0A%0Afunction%20defaultWheelDelta%28%29%20%7B%0A%20%20return%20%2Dexports%2Eevent%2EdeltaY%20%2A%20%28exports%2Eevent%2EdeltaMode%20%3F%20120%20%3A%201%29%20%2F%20500%3B%0A%7D%0A%0Afunction%20defaultTouchable%241%28%29%20%7B%0A%20%20return%20%22ontouchstart%22%20in%20this%3B%0A%7D%0A%0Afunction%20defaultConstrain%28transform%2C%20extent%2C%20translateExtent%29%20%7B%0A%20%20var%20dx0%20%3D%20transform%2EinvertX%28extent%5B0%5D%5B0%5D%29%20%2D%20translateExtent%5B0%5D%5B0%5D%2C%0A%20%20%20%20%20%20dx1%20%3D%20transform%2EinvertX%28extent%5B1%5D%5B0%5D%29%20%2D%20translateExtent%5B1%5D%5B0%5D%2C%0A%20%20%20%20%20%20dy0%20%3D%20transform%2EinvertY%28extent%5B0%5D%5B1%5D%29%20%2D%20translateExtent%5B0%5D%5B1%5D%2C%0A%20%20%20%20%20%20dy1%20%3D%20transform%2EinvertY%28extent%5B1%5D%5B1%5D%29%20%2D%20translateExtent%5B1%5D%5B1%5D%3B%0A%20%20return%20transform%2Etranslate%28%0A%20%20%20%20dx1%20%3E%20dx0%20%3F%20%28dx0%20%2B%20dx1%29%20%2F%202%20%3A%20Math%2Emin%280%2C%20dx0%29%20%7C%7C%20Math%2Emax%280%2C%20dx1%29%2C%0A%20%20%20%20dy1%20%3E%20dy0%20%3F%20%28dy0%20%2B%20dy1%29%20%2F%202%20%3A%20Math%2Emin%280%2C%20dy0%29%20%7C%7C%20Math%2Emax%280%2C%20dy1%29%0A%20%20%29%3B%0A%7D%0A%0Afunction%20zoom%28%29%20%7B%0A%20%20var%20filter%20%3D%20defaultFilter%242%2C%0A%20%20%20%20%20%20extent%20%3D%20defaultExtent%241%2C%0A%20%20%20%20%20%20constrain%20%3D%20defaultConstrain%2C%0A%20%20%20%20%20%20wheelDelta%20%3D%20defaultWheelDelta%2C%0A%20%20%20%20%20%20touchable%20%3D%20defaultTouchable%241%2C%0A%20%20%20%20%20%20scaleExtent%20%3D%20%5B0%2C%20Infinity%5D%2C%0A%20%20%20%20%20%20translateExtent%20%3D%20%5B%5B%2DInfinity%2C%20%2DInfinity%5D%2C%20%5BInfinity%2C%20Infinity%5D%5D%2C%0A%20%20%20%20%20%20duration%20%3D%20250%2C%0A%20%20%20%20%20%20interpolate%20%3D%20interpolateZoom%2C%0A%20%20%20%20%20%20gestures%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20listeners%20%3D%20dispatch%28%22start%22%2C%20%22zoom%22%2C%20%22end%22%29%2C%0A%20%20%20%20%20%20touchstarting%2C%0A%20%20%20%20%20%20touchending%2C%0A%20%20%20%20%20%20touchDelay%20%3D%20500%2C%0A%20%20%20%20%20%20wheelDelay%20%3D%20150%2C%0A%20%20%20%20%20%20clickDistance2%20%3D%200%3B%0A%0A%20%20function%20zoom%28selection%24%241%29%20%7B%0A%20%20%20%20selection%24%241%0A%20%20%20%20%20%20%20%20%2Eproperty%28%22%5F%5Fzoom%22%2C%20defaultTransform%29%0A%20%20%20%20%20%20%20%20%2Eon%28%22wheel%2Ezoom%22%2C%20wheeled%29%0A%20%20%20%20%20%20%20%20%2Eon%28%22mousedown%2Ezoom%22%2C%20mousedowned%29%0A%20%20%20%20%20%20%20%20%2Eon%28%22dblclick%2Ezoom%22%2C%20dblclicked%29%0A%20%20%20%20%20%20%2Efilter%28touchable%29%0A%20%20%20%20%20%20%20%20%2Eon%28%22touchstart%2Ezoom%22%2C%20touchstarted%29%0A%20%20%20%20%20%20%20%20%2Eon%28%22touchmove%2Ezoom%22%2C%20touchmoved%29%0A%20%20%20%20%20%20%20%20%2Eon%28%22touchend%2Ezoom%20touchcancel%2Ezoom%22%2C%20touchended%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22touch%2Daction%22%2C%20%22none%22%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22%2Dwebkit%2Dtap%2Dhighlight%2Dcolor%22%2C%20%22rgba%280%2C0%2C0%2C0%29%22%29%3B%0A%20%20%7D%0A%0A%20%20zoom%2Etransform%20%3D%20function%28collection%2C%20transform%29%20%7B%0A%20%20%20%20var%20selection%24%241%20%3D%20collection%2Eselection%20%3F%20collection%2Eselection%28%29%20%3A%20collection%3B%0A%20%20%20%20selection%24%241%2Eproperty%28%22%5F%5Fzoom%22%2C%20defaultTransform%29%3B%0A%20%20%20%20if%20%28collection%20%21%3D%3D%20selection%24%241%29%20%7B%0A%20%20%20%20%20%20schedule%28collection%2C%20transform%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20selection%24%241%2Einterrupt%28%29%2Eeach%28function%28%29%20%7B%0A%20%20%20%20%20%20%20%20gesture%28this%2C%20arguments%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Estart%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Ezoom%28null%2C%20typeof%20transform%20%3D%3D%3D%20%22function%22%20%3F%20transform%2Eapply%28this%2C%20arguments%29%20%3A%20transform%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eend%28%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20zoom%2EscaleBy%20%3D%20function%28selection%24%241%2C%20k%29%20%7B%0A%20%20%20%20zoom%2EscaleTo%28selection%24%241%2C%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20k0%20%3D%20this%2E%5F%5Fzoom%2Ek%2C%0A%20%20%20%20%20%20%20%20%20%20k1%20%3D%20typeof%20k%20%3D%3D%3D%20%22function%22%20%3F%20k%2Eapply%28this%2C%20arguments%29%20%3A%20k%3B%0A%20%20%20%20%20%20return%20k0%20%2A%20k1%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%3B%0A%0A%20%20zoom%2EscaleTo%20%3D%20function%28selection%24%241%2C%20k%29%20%7B%0A%20%20%20%20zoom%2Etransform%28selection%24%241%2C%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20e%20%3D%20extent%2Eapply%28this%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20%20%20t0%20%3D%20this%2E%5F%5Fzoom%2C%0A%20%20%20%20%20%20%20%20%20%20p0%20%3D%20centroid%28e%29%2C%0A%20%20%20%20%20%20%20%20%20%20p1%20%3D%20t0%2Einvert%28p0%29%2C%0A%20%20%20%20%20%20%20%20%20%20k1%20%3D%20typeof%20k%20%3D%3D%3D%20%22function%22%20%3F%20k%2Eapply%28this%2C%20arguments%29%20%3A%20k%3B%0A%20%20%20%20%20%20return%20constrain%28translate%28scale%28t0%2C%20k1%29%2C%20p0%2C%20p1%29%2C%20e%2C%20translateExtent%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%3B%0A%0A%20%20zoom%2EtranslateBy%20%3D%20function%28selection%24%241%2C%20x%2C%20y%29%20%7B%0A%20%20%20%20zoom%2Etransform%28selection%24%241%2C%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20constrain%28this%2E%5F%5Fzoom%2Etranslate%28%0A%20%20%20%20%20%20%20%20typeof%20x%20%3D%3D%3D%20%22function%22%20%3F%20x%2Eapply%28this%2C%20arguments%29%20%3A%20x%2C%0A%20%20%20%20%20%20%20%20typeof%20y%20%3D%3D%3D%20%22function%22%20%3F%20y%2Eapply%28this%2C%20arguments%29%20%3A%20y%0A%20%20%20%20%20%20%29%2C%20extent%2Eapply%28this%2C%20arguments%29%2C%20translateExtent%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%3B%0A%0A%20%20zoom%2EtranslateTo%20%3D%20function%28selection%24%241%2C%20x%2C%20y%29%20%7B%0A%20%20%20%20zoom%2Etransform%28selection%24%241%2C%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20e%20%3D%20extent%2Eapply%28this%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20%20%20t%20%3D%20this%2E%5F%5Fzoom%2C%0A%20%20%20%20%20%20%20%20%20%20p%20%3D%20centroid%28e%29%3B%0A%20%20%20%20%20%20return%20constrain%28identity%248%2Etranslate%28p%5B0%5D%2C%20p%5B1%5D%29%2Escale%28t%2Ek%29%2Etranslate%28%0A%20%20%20%20%20%20%20%20typeof%20x%20%3D%3D%3D%20%22function%22%20%3F%20%2Dx%2Eapply%28this%2C%20arguments%29%20%3A%20%2Dx%2C%0A%20%20%20%20%20%20%20%20typeof%20y%20%3D%3D%3D%20%22function%22%20%3F%20%2Dy%2Eapply%28this%2C%20arguments%29%20%3A%20%2Dy%0A%20%20%20%20%20%20%29%2C%20e%2C%20translateExtent%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%3B%0A%0A%20%20function%20scale%28transform%2C%20k%29%20%7B%0A%20%20%20%20k%20%3D%20Math%2Emax%28scaleExtent%5B0%5D%2C%20Math%2Emin%28scaleExtent%5B1%5D%2C%20k%29%29%3B%0A%20%20%20%20return%20k%20%3D%3D%3D%20transform%2Ek%20%3F%20transform%20%3A%20new%20Transform%28k%2C%20transform%2Ex%2C%20transform%2Ey%29%3B%0A%20%20%7D%0A%0A%20%20function%20translate%28transform%2C%20p0%2C%20p1%29%20%7B%0A%20%20%20%20var%20x%20%3D%20p0%5B0%5D%20%2D%20p1%5B0%5D%20%2A%20transform%2Ek%2C%20y%20%3D%20p0%5B1%5D%20%2D%20p1%5B1%5D%20%2A%20transform%2Ek%3B%0A%20%20%20%20return%20x%20%3D%3D%3D%20transform%2Ex%20%26%26%20y%20%3D%3D%3D%20transform%2Ey%20%3F%20transform%20%3A%20new%20Transform%28transform%2Ek%2C%20x%2C%20y%29%3B%0A%20%20%7D%0A%0A%20%20function%20centroid%28extent%29%20%7B%0A%20%20%20%20return%20%5B%28%2Bextent%5B0%5D%5B0%5D%20%2B%20%2Bextent%5B1%5D%5B0%5D%29%20%2F%202%2C%20%28%2Bextent%5B0%5D%5B1%5D%20%2B%20%2Bextent%5B1%5D%5B1%5D%29%20%2F%202%5D%3B%0A%20%20%7D%0A%0A%20%20function%20schedule%28transition%24%241%2C%20transform%2C%20center%29%20%7B%0A%20%20%20%20transition%24%241%0A%20%20%20%20%20%20%20%20%2Eon%28%22start%2Ezoom%22%2C%20function%28%29%20%7B%20gesture%28this%2C%20arguments%29%2Estart%28%29%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%2Eon%28%22interrupt%2Ezoom%20end%2Ezoom%22%2C%20function%28%29%20%7B%20gesture%28this%2C%20arguments%29%2Eend%28%29%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%2Etween%28%22zoom%22%2C%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20that%20%3D%20this%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20args%20%3D%20arguments%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20g%20%3D%20gesture%28that%2C%20args%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20e%20%3D%20extent%2Eapply%28that%2C%20args%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20p%20%3D%20center%20%7C%7C%20centroid%28e%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20w%20%3D%20Math%2Emax%28e%5B1%5D%5B0%5D%20%2D%20e%5B0%5D%5B0%5D%2C%20e%5B1%5D%5B1%5D%20%2D%20e%5B0%5D%5B1%5D%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20a%20%3D%20that%2E%5F%5Fzoom%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20b%20%3D%20typeof%20transform%20%3D%3D%3D%20%22function%22%20%3F%20transform%2Eapply%28that%2C%20args%29%20%3A%20transform%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20i%20%3D%20interpolate%28a%2Einvert%28p%29%2Econcat%28w%20%2F%20a%2Ek%29%2C%20b%2Einvert%28p%29%2Econcat%28w%20%2F%20b%2Ek%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20function%28t%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3D%3D%3D%201%29%20t%20%3D%20b%3B%20%2F%2F%20Avoid%20rounding%20error%20on%20end%2E%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%20var%20l%20%3D%20i%28t%29%2C%20k%20%3D%20w%20%2F%20l%5B2%5D%3B%20t%20%3D%20new%20Transform%28k%2C%20p%5B0%5D%20%2D%20l%5B0%5D%20%2A%20k%2C%20p%5B1%5D%20%2D%20l%5B1%5D%20%2A%20k%29%3B%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20g%2Ezoom%28null%2C%20t%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%0A%20%20function%20gesture%28that%2C%20args%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20gestures%2Elength%2C%20g%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28%28g%20%3D%20gestures%5Bi%5D%29%2Ethat%20%3D%3D%3D%20that%29%20%7B%0A%20%20%20%20%20%20%20%20return%20g%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20new%20Gesture%28that%2C%20args%29%3B%0A%20%20%7D%0A%0A%20%20function%20Gesture%28that%2C%20args%29%20%7B%0A%20%20%20%20this%2Ethat%20%3D%20that%3B%0A%20%20%20%20this%2Eargs%20%3D%20args%3B%0A%20%20%20%20this%2Eindex%20%3D%20%2D1%3B%0A%20%20%20%20this%2Eactive%20%3D%200%3B%0A%20%20%20%20this%2Eextent%20%3D%20extent%2Eapply%28that%2C%20args%29%3B%0A%20%20%7D%0A%0A%20%20Gesture%2Eprototype%20%3D%20%7B%0A%20%20%20%20start%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28%2B%2Bthis%2Eactive%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20this%2Eindex%20%3D%20gestures%2Epush%28this%29%20%2D%201%3B%0A%20%20%20%20%20%20%20%20this%2Eemit%28%22start%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20zoom%3A%20function%28key%2C%20transform%29%20%7B%0A%20%20%20%20%20%20if%20%28this%2Emouse%20%26%26%20key%20%21%3D%3D%20%22mouse%22%29%20this%2Emouse%5B1%5D%20%3D%20transform%2Einvert%28this%2Emouse%5B0%5D%29%3B%0A%20%20%20%20%20%20if%20%28this%2Etouch0%20%26%26%20key%20%21%3D%3D%20%22touch%22%29%20this%2Etouch0%5B1%5D%20%3D%20transform%2Einvert%28this%2Etouch0%5B0%5D%29%3B%0A%20%20%20%20%20%20if%20%28this%2Etouch1%20%26%26%20key%20%21%3D%3D%20%22touch%22%29%20this%2Etouch1%5B1%5D%20%3D%20transform%2Einvert%28this%2Etouch1%5B0%5D%29%3B%0A%20%20%20%20%20%20this%2Ethat%2E%5F%5Fzoom%20%3D%20transform%3B%0A%20%20%20%20%20%20this%2Eemit%28%22zoom%22%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20end%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28%2D%2Dthis%2Eactive%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20gestures%2Esplice%28this%2Eindex%2C%201%29%3B%0A%20%20%20%20%20%20%20%20this%2Eindex%20%3D%20%2D1%3B%0A%20%20%20%20%20%20%20%20this%2Eemit%28%22end%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20emit%3A%20function%28type%29%20%7B%0A%20%20%20%20%20%20customEvent%28new%20ZoomEvent%28zoom%2C%20type%2C%20this%2Ethat%2E%5F%5Fzoom%29%2C%20listeners%2Eapply%2C%20listeners%2C%20%5Btype%2C%20this%2Ethat%2C%20this%2Eargs%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20function%20wheeled%28%29%20%7B%0A%20%20%20%20if%20%28%21filter%2Eapply%28this%2C%20arguments%29%29%20return%3B%0A%20%20%20%20var%20g%20%3D%20gesture%28this%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20t%20%3D%20this%2E%5F%5Fzoom%2C%0A%20%20%20%20%20%20%20%20k%20%3D%20Math%2Emax%28scaleExtent%5B0%5D%2C%20Math%2Emin%28scaleExtent%5B1%5D%2C%20t%2Ek%20%2A%20Math%2Epow%282%2C%20wheelDelta%2Eapply%28this%2C%20arguments%29%29%29%29%2C%0A%20%20%20%20%20%20%20%20p%20%3D%20mouse%28this%29%3B%0A%0A%20%20%20%20%2F%2F%20If%20the%20mouse%20is%20in%20the%20same%20location%20as%20before%2C%20reuse%20it%2E%0A%20%20%20%20%2F%2F%20If%20there%20were%20recent%20wheel%20events%2C%20reset%20the%20wheel%20idle%20timeout%2E%0A%20%20%20%20if%20%28g%2Ewheel%29%20%7B%0A%20%20%20%20%20%20if%20%28g%2Emouse%5B0%5D%5B0%5D%20%21%3D%3D%20p%5B0%5D%20%7C%7C%20g%2Emouse%5B0%5D%5B1%5D%20%21%3D%3D%20p%5B1%5D%29%20%7B%0A%20%20%20%20%20%20%20%20g%2Emouse%5B1%5D%20%3D%20t%2Einvert%28g%2Emouse%5B0%5D%20%3D%20p%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20clearTimeout%28g%2Ewheel%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20If%20this%20wheel%20event%20won%E2%80%99t%20trigger%20a%20transform%20change%2C%20ignore%20it%2E%0A%20%20%20%20else%20if%20%28t%2Ek%20%3D%3D%3D%20k%29%20return%3B%0A%0A%20%20%20%20%2F%2F%20Otherwise%2C%20capture%20the%20mouse%20point%20and%20location%20at%20the%20start%2E%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20g%2Emouse%20%3D%20%5Bp%2C%20t%2Einvert%28p%29%5D%3B%0A%20%20%20%20%20%20interrupt%28this%29%3B%0A%20%20%20%20%20%20g%2Estart%28%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20noevent%242%28%29%3B%0A%20%20%20%20g%2Ewheel%20%3D%20setTimeout%28wheelidled%2C%20wheelDelay%29%3B%0A%20%20%20%20g%2Ezoom%28%22mouse%22%2C%20constrain%28translate%28scale%28t%2C%20k%29%2C%20g%2Emouse%5B0%5D%2C%20g%2Emouse%5B1%5D%29%2C%20g%2Eextent%2C%20translateExtent%29%29%3B%0A%0A%20%20%20%20function%20wheelidled%28%29%20%7B%0A%20%20%20%20%20%20g%2Ewheel%20%3D%20null%3B%0A%20%20%20%20%20%20g%2Eend%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20mousedowned%28%29%20%7B%0A%20%20%20%20if%20%28touchending%20%7C%7C%20%21filter%2Eapply%28this%2C%20arguments%29%29%20return%3B%0A%20%20%20%20var%20g%20%3D%20gesture%28this%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20v%20%3D%20select%28exports%2Eevent%2Eview%29%2Eon%28%22mousemove%2Ezoom%22%2C%20mousemoved%2C%20true%29%2Eon%28%22mouseup%2Ezoom%22%2C%20mouseupped%2C%20true%29%2C%0A%20%20%20%20%20%20%20%20p%20%3D%20mouse%28this%29%2C%0A%20%20%20%20%20%20%20%20x0%20%3D%20exports%2Eevent%2EclientX%2C%0A%20%20%20%20%20%20%20%20y0%20%3D%20exports%2Eevent%2EclientY%3B%0A%0A%20%20%20%20dragDisable%28exports%2Eevent%2Eview%29%3B%0A%20%20%20%20nopropagation%242%28%29%3B%0A%20%20%20%20g%2Emouse%20%3D%20%5Bp%2C%20this%2E%5F%5Fzoom%2Einvert%28p%29%5D%3B%0A%20%20%20%20interrupt%28this%29%3B%0A%20%20%20%20g%2Estart%28%29%3B%0A%0A%20%20%20%20function%20mousemoved%28%29%20%7B%0A%20%20%20%20%20%20noevent%242%28%29%3B%0A%20%20%20%20%20%20if%20%28%21g%2Emoved%29%20%7B%0A%20%20%20%20%20%20%20%20var%20dx%20%3D%20exports%2Eevent%2EclientX%20%2D%20x0%2C%20dy%20%3D%20exports%2Eevent%2EclientY%20%2D%20y0%3B%0A%20%20%20%20%20%20%20%20g%2Emoved%20%3D%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%20%3E%20clickDistance2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20g%2Ezoom%28%22mouse%22%2C%20constrain%28translate%28g%2Ethat%2E%5F%5Fzoom%2C%20g%2Emouse%5B0%5D%20%3D%20mouse%28g%2Ethat%29%2C%20g%2Emouse%5B1%5D%29%2C%20g%2Eextent%2C%20translateExtent%29%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20mouseupped%28%29%20%7B%0A%20%20%20%20%20%20v%2Eon%28%22mousemove%2Ezoom%20mouseup%2Ezoom%22%2C%20null%29%3B%0A%20%20%20%20%20%20yesdrag%28exports%2Eevent%2Eview%2C%20g%2Emoved%29%3B%0A%20%20%20%20%20%20noevent%242%28%29%3B%0A%20%20%20%20%20%20g%2Eend%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20dblclicked%28%29%20%7B%0A%20%20%20%20if%20%28%21filter%2Eapply%28this%2C%20arguments%29%29%20return%3B%0A%20%20%20%20var%20t0%20%3D%20this%2E%5F%5Fzoom%2C%0A%20%20%20%20%20%20%20%20p0%20%3D%20mouse%28this%29%2C%0A%20%20%20%20%20%20%20%20p1%20%3D%20t0%2Einvert%28p0%29%2C%0A%20%20%20%20%20%20%20%20k1%20%3D%20t0%2Ek%20%2A%20%28exports%2Eevent%2EshiftKey%20%3F%200%2E5%20%3A%202%29%2C%0A%20%20%20%20%20%20%20%20t1%20%3D%20constrain%28translate%28scale%28t0%2C%20k1%29%2C%20p0%2C%20p1%29%2C%20extent%2Eapply%28this%2C%20arguments%29%2C%20translateExtent%29%3B%0A%0A%20%20%20%20noevent%242%28%29%3B%0A%20%20%20%20if%20%28duration%20%3E%200%29%20select%28this%29%2Etransition%28%29%2Eduration%28duration%29%2Ecall%28schedule%2C%20t1%2C%20p0%29%3B%0A%20%20%20%20else%20select%28this%29%2Ecall%28zoom%2Etransform%2C%20t1%29%3B%0A%20%20%7D%0A%0A%20%20function%20touchstarted%28%29%20%7B%0A%20%20%20%20if%20%28%21filter%2Eapply%28this%2C%20arguments%29%29%20return%3B%0A%20%20%20%20var%20g%20%3D%20gesture%28this%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20touches%24%241%20%3D%20exports%2Eevent%2EchangedTouches%2C%0A%20%20%20%20%20%20%20%20started%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20touches%24%241%2Elength%2C%20i%2C%20t%2C%20p%3B%0A%0A%20%20%20%20nopropagation%242%28%29%3B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20t%20%3D%20touches%24%241%5Bi%5D%2C%20p%20%3D%20touch%28this%2C%20touches%24%241%2C%20t%2Eidentifier%29%3B%0A%20%20%20%20%20%20p%20%3D%20%5Bp%2C%20this%2E%5F%5Fzoom%2Einvert%28p%29%2C%20t%2Eidentifier%5D%3B%0A%20%20%20%20%20%20if%20%28%21g%2Etouch0%29%20g%2Etouch0%20%3D%20p%2C%20started%20%3D%20true%3B%0A%20%20%20%20%20%20else%20if%20%28%21g%2Etouch1%29%20g%2Etouch1%20%3D%20p%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20If%20this%20is%20a%20dbltap%2C%20reroute%20to%20the%20%28optional%29%20dblclick%2Ezoom%20handler%2E%0A%20%20%20%20if%20%28touchstarting%29%20%7B%0A%20%20%20%20%20%20touchstarting%20%3D%20clearTimeout%28touchstarting%29%3B%0A%20%20%20%20%20%20if%20%28%21g%2Etouch1%29%20%7B%0A%20%20%20%20%20%20%20%20g%2Eend%28%29%3B%0A%20%20%20%20%20%20%20%20p%20%3D%20select%28this%29%2Eon%28%22dblclick%2Ezoom%22%29%3B%0A%20%20%20%20%20%20%20%20if%20%28p%29%20p%2Eapply%28this%2C%20arguments%29%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28started%29%20%7B%0A%20%20%20%20%20%20touchstarting%20%3D%20setTimeout%28function%28%29%20%7B%20touchstarting%20%3D%20null%3B%20%7D%2C%20touchDelay%29%3B%0A%20%20%20%20%20%20interrupt%28this%29%3B%0A%20%20%20%20%20%20g%2Estart%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20touchmoved%28%29%20%7B%0A%20%20%20%20var%20g%20%3D%20gesture%28this%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20touches%24%241%20%3D%20exports%2Eevent%2EchangedTouches%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20touches%24%241%2Elength%2C%20i%2C%20t%2C%20p%2C%20l%3B%0A%0A%20%20%20%20noevent%242%28%29%3B%0A%20%20%20%20if%20%28touchstarting%29%20touchstarting%20%3D%20clearTimeout%28touchstarting%29%3B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20t%20%3D%20touches%24%241%5Bi%5D%2C%20p%20%3D%20touch%28this%2C%20touches%24%241%2C%20t%2Eidentifier%29%3B%0A%20%20%20%20%20%20if%20%28g%2Etouch0%20%26%26%20g%2Etouch0%5B2%5D%20%3D%3D%3D%20t%2Eidentifier%29%20g%2Etouch0%5B0%5D%20%3D%20p%3B%0A%20%20%20%20%20%20else%20if%20%28g%2Etouch1%20%26%26%20g%2Etouch1%5B2%5D%20%3D%3D%3D%20t%2Eidentifier%29%20g%2Etouch1%5B0%5D%20%3D%20p%3B%0A%20%20%20%20%7D%0A%20%20%20%20t%20%3D%20g%2Ethat%2E%5F%5Fzoom%3B%0A%20%20%20%20if%20%28g%2Etouch1%29%20%7B%0A%20%20%20%20%20%20var%20p0%20%3D%20g%2Etouch0%5B0%5D%2C%20l0%20%3D%20g%2Etouch0%5B1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20p1%20%3D%20g%2Etouch1%5B0%5D%2C%20l1%20%3D%20g%2Etouch1%5B1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20dp%20%3D%20%28dp%20%3D%20p1%5B0%5D%20%2D%20p0%5B0%5D%29%20%2A%20dp%20%2B%20%28dp%20%3D%20p1%5B1%5D%20%2D%20p0%5B1%5D%29%20%2A%20dp%2C%0A%20%20%20%20%20%20%20%20%20%20dl%20%3D%20%28dl%20%3D%20l1%5B0%5D%20%2D%20l0%5B0%5D%29%20%2A%20dl%20%2B%20%28dl%20%3D%20l1%5B1%5D%20%2D%20l0%5B1%5D%29%20%2A%20dl%3B%0A%20%20%20%20%20%20t%20%3D%20scale%28t%2C%20Math%2Esqrt%28dp%20%2F%20dl%29%29%3B%0A%20%20%20%20%20%20p%20%3D%20%5B%28p0%5B0%5D%20%2B%20p1%5B0%5D%29%20%2F%202%2C%20%28p0%5B1%5D%20%2B%20p1%5B1%5D%29%20%2F%202%5D%3B%0A%20%20%20%20%20%20l%20%3D%20%5B%28l0%5B0%5D%20%2B%20l1%5B0%5D%29%20%2F%202%2C%20%28l0%5B1%5D%20%2B%20l1%5B1%5D%29%20%2F%202%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%20if%20%28g%2Etouch0%29%20p%20%3D%20g%2Etouch0%5B0%5D%2C%20l%20%3D%20g%2Etouch0%5B1%5D%3B%0A%20%20%20%20else%20return%3B%0A%20%20%20%20g%2Ezoom%28%22touch%22%2C%20constrain%28translate%28t%2C%20p%2C%20l%29%2C%20g%2Eextent%2C%20translateExtent%29%29%3B%0A%20%20%7D%0A%0A%20%20function%20touchended%28%29%20%7B%0A%20%20%20%20var%20g%20%3D%20gesture%28this%2C%20arguments%29%2C%0A%20%20%20%20%20%20%20%20touches%24%241%20%3D%20exports%2Eevent%2EchangedTouches%2C%0A%20%20%20%20%20%20%20%20n%20%3D%20touches%24%241%2Elength%2C%20i%2C%20t%3B%0A%0A%20%20%20%20nopropagation%242%28%29%3B%0A%20%20%20%20if%20%28touchending%29%20clearTimeout%28touchending%29%3B%0A%20%20%20%20touchending%20%3D%20setTimeout%28function%28%29%20%7B%20touchending%20%3D%20null%3B%20%7D%2C%20touchDelay%29%3B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20t%20%3D%20touches%24%241%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28g%2Etouch0%20%26%26%20g%2Etouch0%5B2%5D%20%3D%3D%3D%20t%2Eidentifier%29%20delete%20g%2Etouch0%3B%0A%20%20%20%20%20%20else%20if%20%28g%2Etouch1%20%26%26%20g%2Etouch1%5B2%5D%20%3D%3D%3D%20t%2Eidentifier%29%20delete%20g%2Etouch1%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28g%2Etouch1%20%26%26%20%21g%2Etouch0%29%20g%2Etouch0%20%3D%20g%2Etouch1%2C%20delete%20g%2Etouch1%3B%0A%20%20%20%20if%20%28g%2Etouch0%29%20g%2Etouch0%5B1%5D%20%3D%20this%2E%5F%5Fzoom%2Einvert%28g%2Etouch0%5B0%5D%29%3B%0A%20%20%20%20else%20g%2Eend%28%29%3B%0A%20%20%7D%0A%0A%20%20zoom%2EwheelDelta%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28wheelDelta%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2413%28%2B%5F%29%2C%20zoom%29%20%3A%20wheelDelta%3B%0A%20%20%7D%3B%0A%0A%20%20zoom%2Efilter%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28filter%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2413%28%21%21%5F%29%2C%20zoom%29%20%3A%20filter%3B%0A%20%20%7D%3B%0A%0A%20%20zoom%2Etouchable%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28touchable%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2413%28%21%21%5F%29%2C%20zoom%29%20%3A%20touchable%3B%0A%20%20%7D%3B%0A%0A%20%20zoom%2Eextent%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28extent%20%3D%20typeof%20%5F%20%3D%3D%3D%20%22function%22%20%3F%20%5F%20%3A%20constant%2413%28%5B%5B%2B%5F%5B0%5D%5B0%5D%2C%20%2B%5F%5B0%5D%5B1%5D%5D%2C%20%5B%2B%5F%5B1%5D%5B0%5D%2C%20%2B%5F%5B1%5D%5B1%5D%5D%5D%29%2C%20zoom%29%20%3A%20extent%3B%0A%20%20%7D%3B%0A%0A%20%20zoom%2EscaleExtent%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28scaleExtent%5B0%5D%20%3D%20%2B%5F%5B0%5D%2C%20scaleExtent%5B1%5D%20%3D%20%2B%5F%5B1%5D%2C%20zoom%29%20%3A%20%5BscaleExtent%5B0%5D%2C%20scaleExtent%5B1%5D%5D%3B%0A%20%20%7D%3B%0A%0A%20%20zoom%2EtranslateExtent%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28translateExtent%5B0%5D%5B0%5D%20%3D%20%2B%5F%5B0%5D%5B0%5D%2C%20translateExtent%5B1%5D%5B0%5D%20%3D%20%2B%5F%5B1%5D%5B0%5D%2C%20translateExtent%5B0%5D%5B1%5D%20%3D%20%2B%5F%5B0%5D%5B1%5D%2C%20translateExtent%5B1%5D%5B1%5D%20%3D%20%2B%5F%5B1%5D%5B1%5D%2C%20zoom%29%20%3A%20%5B%5BtranslateExtent%5B0%5D%5B0%5D%2C%20translateExtent%5B0%5D%5B1%5D%5D%2C%20%5BtranslateExtent%5B1%5D%5B0%5D%2C%20translateExtent%5B1%5D%5B1%5D%5D%5D%3B%0A%20%20%7D%3B%0A%0A%20%20zoom%2Econstrain%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28constrain%20%3D%20%5F%2C%20zoom%29%20%3A%20constrain%3B%0A%20%20%7D%3B%0A%0A%20%20zoom%2Eduration%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28duration%20%3D%20%2B%5F%2C%20zoom%29%20%3A%20duration%3B%0A%20%20%7D%3B%0A%0A%20%20zoom%2Einterpolate%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28interpolate%20%3D%20%5F%2C%20zoom%29%20%3A%20interpolate%3B%0A%20%20%7D%3B%0A%0A%20%20zoom%2Eon%20%3D%20function%28%29%20%7B%0A%20%20%20%20var%20value%20%3D%20listeners%2Eon%2Eapply%28listeners%2C%20arguments%29%3B%0A%20%20%20%20return%20value%20%3D%3D%3D%20listeners%20%3F%20zoom%20%3A%20value%3B%0A%20%20%7D%3B%0A%0A%20%20zoom%2EclickDistance%20%3D%20function%28%5F%29%20%7B%0A%20%20%20%20return%20arguments%2Elength%20%3F%20%28clickDistance2%20%3D%20%28%5F%20%3D%20%2B%5F%29%20%2A%20%5F%2C%20zoom%29%20%3A%20Math%2Esqrt%28clickDistance2%29%3B%0A%20%20%7D%3B%0A%0A%20%20return%20zoom%3B%0A%7D%0A%0Aexports%2Eversion%20%3D%20version%3B%0Aexports%2Ebisect%20%3D%20bisectRight%3B%0Aexports%2EbisectRight%20%3D%20bisectRight%3B%0Aexports%2EbisectLeft%20%3D%20bisectLeft%3B%0Aexports%2Eascending%20%3D%20ascending%3B%0Aexports%2Ebisector%20%3D%20bisector%3B%0Aexports%2Ecross%20%3D%20cross%3B%0Aexports%2Edescending%20%3D%20descending%3B%0Aexports%2Edeviation%20%3D%20deviation%3B%0Aexports%2Eextent%20%3D%20extent%3B%0Aexports%2Ehistogram%20%3D%20histogram%3B%0Aexports%2EthresholdFreedmanDiaconis%20%3D%20freedmanDiaconis%3B%0Aexports%2EthresholdScott%20%3D%20scott%3B%0Aexports%2EthresholdSturges%20%3D%20thresholdSturges%3B%0Aexports%2Emax%20%3D%20max%3B%0Aexports%2Emean%20%3D%20mean%3B%0Aexports%2Emedian%20%3D%20median%3B%0Aexports%2Emerge%20%3D%20merge%3B%0Aexports%2Emin%20%3D%20min%3B%0Aexports%2Epairs%20%3D%20pairs%3B%0Aexports%2Epermute%20%3D%20permute%3B%0Aexports%2Equantile%20%3D%20threshold%3B%0Aexports%2Erange%20%3D%20sequence%3B%0Aexports%2Escan%20%3D%20scan%3B%0Aexports%2Eshuffle%20%3D%20shuffle%3B%0Aexports%2Esum%20%3D%20sum%3B%0Aexports%2Eticks%20%3D%20ticks%3B%0Aexports%2EtickIncrement%20%3D%20tickIncrement%3B%0Aexports%2EtickStep%20%3D%20tickStep%3B%0Aexports%2Etranspose%20%3D%20transpose%3B%0Aexports%2Evariance%20%3D%20variance%3B%0Aexports%2Ezip%20%3D%20zip%3B%0Aexports%2EaxisTop%20%3D%20axisTop%3B%0Aexports%2EaxisRight%20%3D%20axisRight%3B%0Aexports%2EaxisBottom%20%3D%20axisBottom%3B%0Aexports%2EaxisLeft%20%3D%20axisLeft%3B%0Aexports%2Ebrush%20%3D%20brush%3B%0Aexports%2EbrushX%20%3D%20brushX%3B%0Aexports%2EbrushY%20%3D%20brushY%3B%0Aexports%2EbrushSelection%20%3D%20brushSelection%3B%0Aexports%2Echord%20%3D%20chord%3B%0Aexports%2Eribbon%20%3D%20ribbon%3B%0Aexports%2Enest%20%3D%20nest%3B%0Aexports%2Eset%20%3D%20set%242%3B%0Aexports%2Emap%20%3D%20map%241%3B%0Aexports%2Ekeys%20%3D%20keys%3B%0Aexports%2Evalues%20%3D%20values%3B%0Aexports%2Eentries%20%3D%20entries%3B%0Aexports%2Ecolor%20%3D%20color%3B%0Aexports%2Ergb%20%3D%20rgb%3B%0Aexports%2Ehsl%20%3D%20hsl%3B%0Aexports%2Elab%20%3D%20lab%3B%0Aexports%2Ehcl%20%3D%20hcl%3B%0Aexports%2Elch%20%3D%20lch%3B%0Aexports%2Egray%20%3D%20gray%3B%0Aexports%2Ecubehelix%20%3D%20cubehelix%3B%0Aexports%2Econtours%20%3D%20contours%3B%0Aexports%2EcontourDensity%20%3D%20density%3B%0Aexports%2Edispatch%20%3D%20dispatch%3B%0Aexports%2Edrag%20%3D%20drag%3B%0Aexports%2EdragDisable%20%3D%20dragDisable%3B%0Aexports%2EdragEnable%20%3D%20yesdrag%3B%0Aexports%2EdsvFormat%20%3D%20dsvFormat%3B%0Aexports%2EcsvParse%20%3D%20csvParse%3B%0Aexports%2EcsvParseRows%20%3D%20csvParseRows%3B%0Aexports%2EcsvFormat%20%3D%20csvFormat%3B%0Aexports%2EcsvFormatRows%20%3D%20csvFormatRows%3B%0Aexports%2EtsvParse%20%3D%20tsvParse%3B%0Aexports%2EtsvParseRows%20%3D%20tsvParseRows%3B%0Aexports%2EtsvFormat%20%3D%20tsvFormat%3B%0Aexports%2EtsvFormatRows%20%3D%20tsvFormatRows%3B%0Aexports%2EeaseLinear%20%3D%20linear%241%3B%0Aexports%2EeaseQuad%20%3D%20quadInOut%3B%0Aexports%2EeaseQuadIn%20%3D%20quadIn%3B%0Aexports%2EeaseQuadOut%20%3D%20quadOut%3B%0Aexports%2EeaseQuadInOut%20%3D%20quadInOut%3B%0Aexports%2EeaseCubic%20%3D%20cubicInOut%3B%0Aexports%2EeaseCubicIn%20%3D%20cubicIn%3B%0Aexports%2EeaseCubicOut%20%3D%20cubicOut%3B%0Aexports%2EeaseCubicInOut%20%3D%20cubicInOut%3B%0Aexports%2EeasePoly%20%3D%20polyInOut%3B%0Aexports%2EeasePolyIn%20%3D%20polyIn%3B%0Aexports%2EeasePolyOut%20%3D%20polyOut%3B%0Aexports%2EeasePolyInOut%20%3D%20polyInOut%3B%0Aexports%2EeaseSin%20%3D%20sinInOut%3B%0Aexports%2EeaseSinIn%20%3D%20sinIn%3B%0Aexports%2EeaseSinOut%20%3D%20sinOut%3B%0Aexports%2EeaseSinInOut%20%3D%20sinInOut%3B%0Aexports%2EeaseExp%20%3D%20expInOut%3B%0Aexports%2EeaseExpIn%20%3D%20expIn%3B%0Aexports%2EeaseExpOut%20%3D%20expOut%3B%0Aexports%2EeaseExpInOut%20%3D%20expInOut%3B%0Aexports%2EeaseCircle%20%3D%20circleInOut%3B%0Aexports%2EeaseCircleIn%20%3D%20circleIn%3B%0Aexports%2EeaseCircleOut%20%3D%20circleOut%3B%0Aexports%2EeaseCircleInOut%20%3D%20circleInOut%3B%0Aexports%2EeaseBounce%20%3D%20bounceOut%3B%0Aexports%2EeaseBounceIn%20%3D%20bounceIn%3B%0Aexports%2EeaseBounceOut%20%3D%20bounceOut%3B%0Aexports%2EeaseBounceInOut%20%3D%20bounceInOut%3B%0Aexports%2EeaseBack%20%3D%20backInOut%3B%0Aexports%2EeaseBackIn%20%3D%20backIn%3B%0Aexports%2EeaseBackOut%20%3D%20backOut%3B%0Aexports%2EeaseBackInOut%20%3D%20backInOut%3B%0Aexports%2EeaseElastic%20%3D%20elasticOut%3B%0Aexports%2EeaseElasticIn%20%3D%20elasticIn%3B%0Aexports%2EeaseElasticOut%20%3D%20elasticOut%3B%0Aexports%2EeaseElasticInOut%20%3D%20elasticInOut%3B%0Aexports%2Eblob%20%3D%20blob%3B%0Aexports%2Ebuffer%20%3D%20buffer%3B%0Aexports%2Edsv%20%3D%20dsv%3B%0Aexports%2Ecsv%20%3D%20csv%241%3B%0Aexports%2Etsv%20%3D%20tsv%241%3B%0Aexports%2Eimage%20%3D%20image%3B%0Aexports%2Ejson%20%3D%20json%3B%0Aexports%2Etext%20%3D%20text%3B%0Aexports%2Exml%20%3D%20xml%3B%0Aexports%2Ehtml%20%3D%20html%3B%0Aexports%2Esvg%20%3D%20svg%3B%0Aexports%2EforceCenter%20%3D%20center%241%3B%0Aexports%2EforceCollide%20%3D%20collide%3B%0Aexports%2EforceLink%20%3D%20link%3B%0Aexports%2EforceManyBody%20%3D%20manyBody%3B%0Aexports%2EforceRadial%20%3D%20radial%3B%0Aexports%2EforceSimulation%20%3D%20simulation%3B%0Aexports%2EforceX%20%3D%20x%242%3B%0Aexports%2EforceY%20%3D%20y%242%3B%0Aexports%2EformatDefaultLocale%20%3D%20defaultLocale%3B%0Aexports%2EformatLocale%20%3D%20formatLocale%3B%0Aexports%2EformatSpecifier%20%3D%20formatSpecifier%3B%0Aexports%2EprecisionFixed%20%3D%20precisionFixed%3B%0Aexports%2EprecisionPrefix%20%3D%20precisionPrefix%3B%0Aexports%2EprecisionRound%20%3D%20precisionRound%3B%0Aexports%2EgeoArea%20%3D%20area%241%3B%0Aexports%2EgeoBounds%20%3D%20bounds%3B%0Aexports%2EgeoCentroid%20%3D%20centroid%3B%0Aexports%2EgeoCircle%20%3D%20circle%3B%0Aexports%2EgeoClipAntimeridian%20%3D%20clipAntimeridian%3B%0Aexports%2EgeoClipCircle%20%3D%20clipCircle%3B%0Aexports%2EgeoClipExtent%20%3D%20extent%241%3B%0Aexports%2EgeoClipRectangle%20%3D%20clipRectangle%3B%0Aexports%2EgeoContains%20%3D%20contains%241%3B%0Aexports%2EgeoDistance%20%3D%20distance%3B%0Aexports%2EgeoGraticule%20%3D%20graticule%3B%0Aexports%2EgeoGraticule10%20%3D%20graticule10%3B%0Aexports%2EgeoInterpolate%20%3D%20interpolate%241%3B%0Aexports%2EgeoLength%20%3D%20length%241%3B%0Aexports%2EgeoPath%20%3D%20index%241%3B%0Aexports%2EgeoAlbers%20%3D%20albers%3B%0Aexports%2EgeoAlbersUsa%20%3D%20albersUsa%3B%0Aexports%2EgeoAzimuthalEqualArea%20%3D%20azimuthalEqualArea%3B%0Aexports%2EgeoAzimuthalEqualAreaRaw%20%3D%20azimuthalEqualAreaRaw%3B%0Aexports%2EgeoAzimuthalEquidistant%20%3D%20azimuthalEquidistant%3B%0Aexports%2EgeoAzimuthalEquidistantRaw%20%3D%20azimuthalEquidistantRaw%3B%0Aexports%2EgeoConicConformal%20%3D%20conicConformal%3B%0Aexports%2EgeoConicConformalRaw%20%3D%20conicConformalRaw%3B%0Aexports%2EgeoConicEqualArea%20%3D%20conicEqualArea%3B%0Aexports%2EgeoConicEqualAreaRaw%20%3D%20conicEqualAreaRaw%3B%0Aexports%2EgeoConicEquidistant%20%3D%20conicEquidistant%3B%0Aexports%2EgeoConicEquidistantRaw%20%3D%20conicEquidistantRaw%3B%0Aexports%2EgeoEquirectangular%20%3D%20equirectangular%3B%0Aexports%2EgeoEquirectangularRaw%20%3D%20equirectangularRaw%3B%0Aexports%2EgeoGnomonic%20%3D%20gnomonic%3B%0Aexports%2EgeoGnomonicRaw%20%3D%20gnomonicRaw%3B%0Aexports%2EgeoIdentity%20%3D%20identity%245%3B%0Aexports%2EgeoProjection%20%3D%20projection%3B%0Aexports%2EgeoProjectionMutator%20%3D%20projectionMutator%3B%0Aexports%2EgeoMercator%20%3D%20mercator%3B%0Aexports%2EgeoMercatorRaw%20%3D%20mercatorRaw%3B%0Aexports%2EgeoNaturalEarth1%20%3D%20naturalEarth1%3B%0Aexports%2EgeoNaturalEarth1Raw%20%3D%20naturalEarth1Raw%3B%0Aexports%2EgeoOrthographic%20%3D%20orthographic%3B%0Aexports%2EgeoOrthographicRaw%20%3D%20orthographicRaw%3B%0Aexports%2EgeoStereographic%20%3D%20stereographic%3B%0Aexports%2EgeoStereographicRaw%20%3D%20stereographicRaw%3B%0Aexports%2EgeoTransverseMercator%20%3D%20transverseMercator%3B%0Aexports%2EgeoTransverseMercatorRaw%20%3D%20transverseMercatorRaw%3B%0Aexports%2EgeoRotation%20%3D%20rotation%3B%0Aexports%2EgeoStream%20%3D%20geoStream%3B%0Aexports%2EgeoTransform%20%3D%20transform%3B%0Aexports%2Ecluster%20%3D%20cluster%3B%0Aexports%2Ehierarchy%20%3D%20hierarchy%3B%0Aexports%2Epack%20%3D%20index%242%3B%0Aexports%2EpackSiblings%20%3D%20siblings%3B%0Aexports%2EpackEnclose%20%3D%20enclose%3B%0Aexports%2Epartition%20%3D%20partition%3B%0Aexports%2Estratify%20%3D%20stratify%3B%0Aexports%2Etree%20%3D%20tree%3B%0Aexports%2Etreemap%20%3D%20index%243%3B%0Aexports%2EtreemapBinary%20%3D%20binary%3B%0Aexports%2EtreemapDice%20%3D%20treemapDice%3B%0Aexports%2EtreemapSlice%20%3D%20treemapSlice%3B%0Aexports%2EtreemapSliceDice%20%3D%20sliceDice%3B%0Aexports%2EtreemapSquarify%20%3D%20squarify%3B%0Aexports%2EtreemapResquarify%20%3D%20resquarify%3B%0Aexports%2Einterpolate%20%3D%20interpolateValue%3B%0Aexports%2EinterpolateArray%20%3D%20array%241%3B%0Aexports%2EinterpolateBasis%20%3D%20basis%241%3B%0Aexports%2EinterpolateBasisClosed%20%3D%20basisClosed%3B%0Aexports%2EinterpolateDate%20%3D%20date%3B%0Aexports%2EinterpolateNumber%20%3D%20reinterpolate%3B%0Aexports%2EinterpolateObject%20%3D%20object%3B%0Aexports%2EinterpolateRound%20%3D%20interpolateRound%3B%0Aexports%2EinterpolateString%20%3D%20interpolateString%3B%0Aexports%2EinterpolateTransformCss%20%3D%20interpolateTransformCss%3B%0Aexports%2EinterpolateTransformSvg%20%3D%20interpolateTransformSvg%3B%0Aexports%2EinterpolateZoom%20%3D%20interpolateZoom%3B%0Aexports%2EinterpolateRgb%20%3D%20interpolateRgb%3B%0Aexports%2EinterpolateRgbBasis%20%3D%20rgbBasis%3B%0Aexports%2EinterpolateRgbBasisClosed%20%3D%20rgbBasisClosed%3B%0Aexports%2EinterpolateHsl%20%3D%20hsl%242%3B%0Aexports%2EinterpolateHslLong%20%3D%20hslLong%3B%0Aexports%2EinterpolateLab%20%3D%20lab%241%3B%0Aexports%2EinterpolateHcl%20%3D%20hcl%242%3B%0Aexports%2EinterpolateHclLong%20%3D%20hclLong%3B%0Aexports%2EinterpolateCubehelix%20%3D%20cubehelix%242%3B%0Aexports%2EinterpolateCubehelixLong%20%3D%20cubehelixLong%3B%0Aexports%2Equantize%20%3D%20quantize%3B%0Aexports%2Epath%20%3D%20path%3B%0Aexports%2EpolygonArea%20%3D%20area%242%3B%0Aexports%2EpolygonCentroid%20%3D%20centroid%241%3B%0Aexports%2EpolygonHull%20%3D%20hull%3B%0Aexports%2EpolygonContains%20%3D%20contains%242%3B%0Aexports%2EpolygonLength%20%3D%20length%242%3B%0Aexports%2Equadtree%20%3D%20quadtree%3B%0Aexports%2ErandomUniform%20%3D%20uniform%3B%0Aexports%2ErandomNormal%20%3D%20normal%3B%0Aexports%2ErandomLogNormal%20%3D%20logNormal%3B%0Aexports%2ErandomBates%20%3D%20bates%3B%0Aexports%2ErandomIrwinHall%20%3D%20irwinHall%3B%0Aexports%2ErandomExponential%20%3D%20exponential%241%3B%0Aexports%2EscaleBand%20%3D%20band%3B%0Aexports%2EscalePoint%20%3D%20point%241%3B%0Aexports%2EscaleIdentity%20%3D%20identity%246%3B%0Aexports%2EscaleLinear%20%3D%20linear%242%3B%0Aexports%2EscaleLog%20%3D%20log%241%3B%0Aexports%2EscaleOrdinal%20%3D%20ordinal%3B%0Aexports%2EscaleImplicit%20%3D%20implicit%3B%0Aexports%2EscalePow%20%3D%20pow%241%3B%0Aexports%2EscaleSqrt%20%3D%20sqrt%241%3B%0Aexports%2EscaleQuantile%20%3D%20quantile%24%241%3B%0Aexports%2EscaleQuantize%20%3D%20quantize%241%3B%0Aexports%2EscaleThreshold%20%3D%20threshold%241%3B%0Aexports%2EscaleTime%20%3D%20time%3B%0Aexports%2EscaleUtc%20%3D%20utcTime%3B%0Aexports%2EscaleSequential%20%3D%20sequential%3B%0Aexports%2EschemeCategory10%20%3D%20category10%3B%0Aexports%2EschemeAccent%20%3D%20Accent%3B%0Aexports%2EschemeDark2%20%3D%20Dark2%3B%0Aexports%2EschemePaired%20%3D%20Paired%3B%0Aexports%2EschemePastel1%20%3D%20Pastel1%3B%0Aexports%2EschemePastel2%20%3D%20Pastel2%3B%0Aexports%2EschemeSet1%20%3D%20Set1%3B%0Aexports%2EschemeSet2%20%3D%20Set2%3B%0Aexports%2EschemeSet3%20%3D%20Set3%3B%0Aexports%2EinterpolateBrBG%20%3D%20BrBG%3B%0Aexports%2EschemeBrBG%20%3D%20scheme%3B%0Aexports%2EinterpolatePRGn%20%3D%20PRGn%3B%0Aexports%2EschemePRGn%20%3D%20scheme%241%3B%0Aexports%2EinterpolatePiYG%20%3D%20PiYG%3B%0Aexports%2EschemePiYG%20%3D%20scheme%242%3B%0Aexports%2EinterpolatePuOr%20%3D%20PuOr%3B%0Aexports%2EschemePuOr%20%3D%20scheme%243%3B%0Aexports%2EinterpolateRdBu%20%3D%20RdBu%3B%0Aexports%2EschemeRdBu%20%3D%20scheme%244%3B%0Aexports%2EinterpolateRdGy%20%3D%20RdGy%3B%0Aexports%2EschemeRdGy%20%3D%20scheme%245%3B%0Aexports%2EinterpolateRdYlBu%20%3D%20RdYlBu%3B%0Aexports%2EschemeRdYlBu%20%3D%20scheme%246%3B%0Aexports%2EinterpolateRdYlGn%20%3D%20RdYlGn%3B%0Aexports%2EschemeRdYlGn%20%3D%20scheme%247%3B%0Aexports%2EinterpolateSpectral%20%3D%20Spectral%3B%0Aexports%2EschemeSpectral%20%3D%20scheme%248%3B%0Aexports%2EinterpolateBuGn%20%3D%20BuGn%3B%0Aexports%2EschemeBuGn%20%3D%20scheme%249%3B%0Aexports%2EinterpolateBuPu%20%3D%20BuPu%3B%0Aexports%2EschemeBuPu%20%3D%20scheme%2410%3B%0Aexports%2EinterpolateGnBu%20%3D%20GnBu%3B%0Aexports%2EschemeGnBu%20%3D%20scheme%2411%3B%0Aexports%2EinterpolateOrRd%20%3D%20OrRd%3B%0Aexports%2EschemeOrRd%20%3D%20scheme%2412%3B%0Aexports%2EinterpolatePuBuGn%20%3D%20PuBuGn%3B%0Aexports%2EschemePuBuGn%20%3D%20scheme%2413%3B%0Aexports%2EinterpolatePuBu%20%3D%20PuBu%3B%0Aexports%2EschemePuBu%20%3D%20scheme%2414%3B%0Aexports%2EinterpolatePuRd%20%3D%20PuRd%3B%0Aexports%2EschemePuRd%20%3D%20scheme%2415%3B%0Aexports%2EinterpolateRdPu%20%3D%20RdPu%3B%0Aexports%2EschemeRdPu%20%3D%20scheme%2416%3B%0Aexports%2EinterpolateYlGnBu%20%3D%20YlGnBu%3B%0Aexports%2EschemeYlGnBu%20%3D%20scheme%2417%3B%0Aexports%2EinterpolateYlGn%20%3D%20YlGn%3B%0Aexports%2EschemeYlGn%20%3D%20scheme%2418%3B%0Aexports%2EinterpolateYlOrBr%20%3D%20YlOrBr%3B%0Aexports%2EschemeYlOrBr%20%3D%20scheme%2419%3B%0Aexports%2EinterpolateYlOrRd%20%3D%20YlOrRd%3B%0Aexports%2EschemeYlOrRd%20%3D%20scheme%2420%3B%0Aexports%2EinterpolateBlues%20%3D%20Blues%3B%0Aexports%2EschemeBlues%20%3D%20scheme%2421%3B%0Aexports%2EinterpolateGreens%20%3D%20Greens%3B%0Aexports%2EschemeGreens%20%3D%20scheme%2422%3B%0Aexports%2EinterpolateGreys%20%3D%20Greys%3B%0Aexports%2EschemeGreys%20%3D%20scheme%2423%3B%0Aexports%2EinterpolatePurples%20%3D%20Purples%3B%0Aexports%2EschemePurples%20%3D%20scheme%2424%3B%0Aexports%2EinterpolateReds%20%3D%20Reds%3B%0Aexports%2EschemeReds%20%3D%20scheme%2425%3B%0Aexports%2EinterpolateOranges%20%3D%20Oranges%3B%0Aexports%2EschemeOranges%20%3D%20scheme%2426%3B%0Aexports%2EinterpolateCubehelixDefault%20%3D%20cubehelix%243%3B%0Aexports%2EinterpolateRainbow%20%3D%20rainbow%241%3B%0Aexports%2EinterpolateWarm%20%3D%20warm%3B%0Aexports%2EinterpolateCool%20%3D%20cool%3B%0Aexports%2EinterpolateViridis%20%3D%20viridis%3B%0Aexports%2EinterpolateMagma%20%3D%20magma%3B%0Aexports%2EinterpolateInferno%20%3D%20inferno%3B%0Aexports%2EinterpolatePlasma%20%3D%20plasma%3B%0Aexports%2Ecreate%20%3D%20create%3B%0Aexports%2Ecreator%20%3D%20creator%3B%0Aexports%2Elocal%20%3D%20local%3B%0Aexports%2Ematcher%20%3D%20matcher%241%3B%0Aexports%2Emouse%20%3D%20mouse%3B%0Aexports%2Enamespace%20%3D%20namespace%3B%0Aexports%2Enamespaces%20%3D%20namespaces%3B%0Aexports%2EclientPoint%20%3D%20point%3B%0Aexports%2Eselect%20%3D%20select%3B%0Aexports%2EselectAll%20%3D%20selectAll%3B%0Aexports%2Eselection%20%3D%20selection%3B%0Aexports%2Eselector%20%3D%20selector%3B%0Aexports%2EselectorAll%20%3D%20selectorAll%3B%0Aexports%2Estyle%20%3D%20styleValue%3B%0Aexports%2Etouch%20%3D%20touch%3B%0Aexports%2Etouches%20%3D%20touches%3B%0Aexports%2Ewindow%20%3D%20defaultView%3B%0Aexports%2EcustomEvent%20%3D%20customEvent%3B%0Aexports%2Earc%20%3D%20arc%3B%0Aexports%2Earea%20%3D%20area%243%3B%0Aexports%2Eline%20%3D%20line%3B%0Aexports%2Epie%20%3D%20pie%3B%0Aexports%2EareaRadial%20%3D%20areaRadial%3B%0Aexports%2EradialArea%20%3D%20areaRadial%3B%0Aexports%2ElineRadial%20%3D%20lineRadial%241%3B%0Aexports%2EradialLine%20%3D%20lineRadial%241%3B%0Aexports%2EpointRadial%20%3D%20pointRadial%3B%0Aexports%2ElinkHorizontal%20%3D%20linkHorizontal%3B%0Aexports%2ElinkVertical%20%3D%20linkVertical%3B%0Aexports%2ElinkRadial%20%3D%20linkRadial%3B%0Aexports%2Esymbol%20%3D%20symbol%3B%0Aexports%2Esymbols%20%3D%20symbols%3B%0Aexports%2EsymbolCircle%20%3D%20circle%242%3B%0Aexports%2EsymbolCross%20%3D%20cross%242%3B%0Aexports%2EsymbolDiamond%20%3D%20diamond%3B%0Aexports%2EsymbolSquare%20%3D%20square%3B%0Aexports%2EsymbolStar%20%3D%20star%3B%0Aexports%2EsymbolTriangle%20%3D%20triangle%3B%0Aexports%2EsymbolWye%20%3D%20wye%3B%0Aexports%2EcurveBasisClosed%20%3D%20basisClosed%241%3B%0Aexports%2EcurveBasisOpen%20%3D%20basisOpen%3B%0Aexports%2EcurveBasis%20%3D%20basis%242%3B%0Aexports%2EcurveBundle%20%3D%20bundle%3B%0Aexports%2EcurveCardinalClosed%20%3D%20cardinalClosed%3B%0Aexports%2EcurveCardinalOpen%20%3D%20cardinalOpen%3B%0Aexports%2EcurveCardinal%20%3D%20cardinal%3B%0Aexports%2EcurveCatmullRomClosed%20%3D%20catmullRomClosed%3B%0Aexports%2EcurveCatmullRomOpen%20%3D%20catmullRomOpen%3B%0Aexports%2EcurveCatmullRom%20%3D%20catmullRom%3B%0Aexports%2EcurveLinearClosed%20%3D%20linearClosed%3B%0Aexports%2EcurveLinear%20%3D%20curveLinear%3B%0Aexports%2EcurveMonotoneX%20%3D%20monotoneX%3B%0Aexports%2EcurveMonotoneY%20%3D%20monotoneY%3B%0Aexports%2EcurveNatural%20%3D%20natural%3B%0Aexports%2EcurveStep%20%3D%20step%3B%0Aexports%2EcurveStepAfter%20%3D%20stepAfter%3B%0Aexports%2EcurveStepBefore%20%3D%20stepBefore%3B%0Aexports%2Estack%20%3D%20stack%3B%0Aexports%2EstackOffsetExpand%20%3D%20expand%3B%0Aexports%2EstackOffsetDiverging%20%3D%20diverging%3B%0Aexports%2EstackOffsetNone%20%3D%20none%241%3B%0Aexports%2EstackOffsetSilhouette%20%3D%20silhouette%3B%0Aexports%2EstackOffsetWiggle%20%3D%20wiggle%3B%0Aexports%2EstackOrderAscending%20%3D%20ascending%243%3B%0Aexports%2EstackOrderDescending%20%3D%20descending%242%3B%0Aexports%2EstackOrderInsideOut%20%3D%20insideOut%3B%0Aexports%2EstackOrderNone%20%3D%20none%242%3B%0Aexports%2EstackOrderReverse%20%3D%20reverse%3B%0Aexports%2EtimeInterval%20%3D%20newInterval%3B%0Aexports%2EtimeMillisecond%20%3D%20millisecond%3B%0Aexports%2EtimeMilliseconds%20%3D%20milliseconds%3B%0Aexports%2EutcMillisecond%20%3D%20millisecond%3B%0Aexports%2EutcMilliseconds%20%3D%20milliseconds%3B%0Aexports%2EtimeSecond%20%3D%20second%3B%0Aexports%2EtimeSeconds%20%3D%20seconds%3B%0Aexports%2EutcSecond%20%3D%20second%3B%0Aexports%2EutcSeconds%20%3D%20seconds%3B%0Aexports%2EtimeMinute%20%3D%20minute%3B%0Aexports%2EtimeMinutes%20%3D%20minutes%3B%0Aexports%2EtimeHour%20%3D%20hour%3B%0Aexports%2EtimeHours%20%3D%20hours%3B%0Aexports%2EtimeDay%20%3D%20day%3B%0Aexports%2EtimeDays%20%3D%20days%3B%0Aexports%2EtimeWeek%20%3D%20sunday%3B%0Aexports%2EtimeWeeks%20%3D%20sundays%3B%0Aexports%2EtimeSunday%20%3D%20sunday%3B%0Aexports%2EtimeSundays%20%3D%20sundays%3B%0Aexports%2EtimeMonday%20%3D%20monday%3B%0Aexports%2EtimeMondays%20%3D%20mondays%3B%0Aexports%2EtimeTuesday%20%3D%20tuesday%3B%0Aexports%2EtimeTuesdays%20%3D%20tuesdays%3B%0Aexports%2EtimeWednesday%20%3D%20wednesday%3B%0Aexports%2EtimeWednesdays%20%3D%20wednesdays%3B%0Aexports%2EtimeThursday%20%3D%20thursday%3B%0Aexports%2EtimeThursdays%20%3D%20thursdays%3B%0Aexports%2EtimeFriday%20%3D%20friday%3B%0Aexports%2EtimeFridays%20%3D%20fridays%3B%0Aexports%2EtimeSaturday%20%3D%20saturday%3B%0Aexports%2EtimeSaturdays%20%3D%20saturdays%3B%0Aexports%2EtimeMonth%20%3D%20month%3B%0Aexports%2EtimeMonths%20%3D%20months%3B%0Aexports%2EtimeYear%20%3D%20year%3B%0Aexports%2EtimeYears%20%3D%20years%3B%0Aexports%2EutcMinute%20%3D%20utcMinute%3B%0Aexports%2EutcMinutes%20%3D%20utcMinutes%3B%0Aexports%2EutcHour%20%3D%20utcHour%3B%0Aexports%2EutcHours%20%3D%20utcHours%3B%0Aexports%2EutcDay%20%3D%20utcDay%3B%0Aexports%2EutcDays%20%3D%20utcDays%3B%0Aexports%2EutcWeek%20%3D%20utcSunday%3B%0Aexports%2EutcWeeks%20%3D%20utcSundays%3B%0Aexports%2EutcSunday%20%3D%20utcSunday%3B%0Aexports%2EutcSundays%20%3D%20utcSundays%3B%0Aexports%2EutcMonday%20%3D%20utcMonday%3B%0Aexports%2EutcMondays%20%3D%20utcMondays%3B%0Aexports%2EutcTuesday%20%3D%20utcTuesday%3B%0Aexports%2EutcTuesdays%20%3D%20utcTuesdays%3B%0Aexports%2EutcWednesday%20%3D%20utcWednesday%3B%0Aexports%2EutcWednesdays%20%3D%20utcWednesdays%3B%0Aexports%2EutcThursday%20%3D%20utcThursday%3B%0Aexports%2EutcThursdays%20%3D%20utcThursdays%3B%0Aexports%2EutcFriday%20%3D%20utcFriday%3B%0Aexports%2EutcFridays%20%3D%20utcFridays%3B%0Aexports%2EutcSaturday%20%3D%20utcSaturday%3B%0Aexports%2EutcSaturdays%20%3D%20utcSaturdays%3B%0Aexports%2EutcMonth%20%3D%20utcMonth%3B%0Aexports%2EutcMonths%20%3D%20utcMonths%3B%0Aexports%2EutcYear%20%3D%20utcYear%3B%0Aexports%2EutcYears%20%3D%20utcYears%3B%0Aexports%2EtimeFormatDefaultLocale%20%3D%20defaultLocale%241%3B%0Aexports%2EtimeFormatLocale%20%3D%20formatLocale%241%3B%0Aexports%2EisoFormat%20%3D%20formatIso%3B%0Aexports%2EisoParse%20%3D%20parseIso%3B%0Aexports%2Enow%20%3D%20now%3B%0Aexports%2Etimer%20%3D%20timer%3B%0Aexports%2EtimerFlush%20%3D%20timerFlush%3B%0Aexports%2Etimeout%20%3D%20timeout%241%3B%0Aexports%2Einterval%20%3D%20interval%241%3B%0Aexports%2Etransition%20%3D%20transition%3B%0Aexports%2Eactive%20%3D%20active%3B%0Aexports%2Einterrupt%20%3D%20interrupt%3B%0Aexports%2Evoronoi%20%3D%20voronoi%3B%0Aexports%2Ezoom%20%3D%20zoom%3B%0Aexports%2EzoomTransform%20%3D%20transform%241%3B%0Aexports%2EzoomIdentity%20%3D%20identity%248%3B%0A%0AObject%2EdefineProperty%28exports%2C%20%27%5F%5FesModule%27%2C%20%7B%20value%3A%20true%20%7D%29%3B%0A%0A%7D%29%29%29%3B%0A"></script>
<script src="data:application/x-javascript,%2F%2A%20%20Copyright%202022%20Lakshay%20Anand%2E%0A%20%20%20%20All%20rights%20reserved%2E%0A%0A%20%20%20%20This%20program%20is%20free%20software%3A%20you%20can%20redistribute%20it%20and%2For%20modify%0A%20%20%20%20it%20under%20the%20terms%20of%20the%20GNU%20General%20Public%20License%20as%20published%20by%0A%20%20%20%20the%20Free%20Software%20Foundation%2C%20either%20version%203%20of%20the%20License%2C%20or%0A%20%20%20%20%28at%20your%20option%29%20any%20later%20version%2E%0A%0A%20%20%20%20This%20program%20is%20distributed%20in%20the%20hope%20that%20it%20will%20be%20useful%2C%0A%20%20%20%20but%20WITHOUT%20ANY%20WARRANTY%3B%20without%20even%20the%20implied%20warranty%20of%0A%20%20%20%20MERCHANTABILITY%20or%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE%2E%20%20See%20the%0A%20%20%20%20GNU%20General%20Public%20License%20for%20more%20details%2E%0A%0A%20%20%20%20To%20view%20GNU%20General%20Public%20License%20%20see%20%3Chttp%3A%2F%2Fwww%2Egnu%2Eorg%2Flicenses%2F%3E%2E%0A%0A%20%20%20%20The%20chromoMap%2Ejs%20Javascript%20library%20depends%20on%20an%20open%20source%20software%20component%2E%0A%20%20%20%20d3%2Ejs%20%2C%20%20https%3A%2F%2Fgithub%2Ecom%2Fd3%2Fd3%0A%0A%20%20d3%20license%0A%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%0ACopyright%202010%2D2022%20Mike%20Bostock%0AAll%20rights%20reserved%2E%0A%0ARedistribution%20and%20use%20in%20source%20and%20binary%20forms%2C%20with%20or%20without%20modification%2C%0Aare%20permitted%20provided%20that%20the%20following%20conditions%20are%20met%3A%0A%0A%2A%20Redistributions%20of%20source%20code%20must%20retain%20the%20above%20copyright%20notice%2C%20this%0A%20%20list%20of%20conditions%20and%20the%20following%20disclaimer%2E%0A%0A%2A%20Redistributions%20in%20binary%20form%20must%20reproduce%20the%20above%20copyright%20notice%2C%0A%20%20this%20list%20of%20conditions%20and%20the%20following%20disclaimer%20in%20the%20documentation%0A%20%20and%2For%20other%20materials%20provided%20with%20the%20distribution%2E%0A%0A%2A%20Neither%20the%20name%20of%20the%20author%20nor%20the%20names%20of%20contributors%20may%20be%20used%20to%0A%20%20endorse%20or%20promote%20products%20derived%20from%20this%20software%20without%20specific%20prior%0A%20%20written%20permission%2E%0A%0ATHIS%20SOFTWARE%20IS%20PROVIDED%20BY%20THE%20COPYRIGHT%20HOLDERS%20AND%20CONTRIBUTORS%20%22AS%20IS%22%20AND%0AANY%20EXPRESS%20OR%20IMPLIED%20WARRANTIES%2C%20INCLUDING%2C%20BUT%20NOT%20LIMITED%20TO%2C%20THE%20IMPLIED%0AWARRANTIES%20OF%20MERCHANTABILITY%20AND%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE%20ARE%0ADISCLAIMED%2E%20IN%20NO%20EVENT%20SHALL%20THE%20COPYRIGHT%20OWNER%20OR%20CONTRIBUTORS%20BE%20LIABLE%20FOR%0AANY%20DIRECT%2C%20INDIRECT%2C%20INCIDENTAL%2C%20SPECIAL%2C%20EXEMPLARY%2C%20OR%20CONSEQUENTIAL%20DAMAGES%0A%28INCLUDING%2C%20BUT%20NOT%20LIMITED%20TO%2C%20PROCUREMENT%20OF%20SUBSTITUTE%20GOODS%20OR%20SERVICES%3B%0ALOSS%20OF%20USE%2C%20DATA%2C%20OR%20PROFITS%3B%20OR%20BUSINESS%20INTERRUPTION%29%20HOWEVER%20CAUSED%20AND%20ON%0AANY%20THEORY%20OF%20LIABILITY%2C%20WHETHER%20IN%20CONTRACT%2C%20STRICT%20LIABILITY%2C%20OR%20TORT%0A%28INCLUDING%20NEGLIGENCE%20OR%20OTHERWISE%29%20ARISING%20IN%20ANY%20WAY%20OUT%20OF%20THE%20USE%20OF%20THIS%0ASOFTWARE%2C%20EVEN%20IF%20ADVISED%20OF%20THE%20POSSIBILITY%20OF%20SUCH%20DAMAGE%2E%0A%0A%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%2D%0A%20%2A%2F%0A%0A%0A%2F%2A%20Global%20variables%20%2A%2F%0A%0Avar%20colors%3D%5B%5D%2Cplot%5Fcolors%3D%5B%5D%2CchDataReduced%2C%0A%20%20%20%20chr%5Fspacing%2Cy%5Fval%2Cch%5Fwidth%2C%0A%20%20%20%20loci%5Fwidth%2Ctop%5Fmargin%2C%0A%20%20%20%20left%5Fmargin%2Cx%5Fscale%5Fpos%2C%0A%20%20%20%20chLinGradV%3D%5B%5D%2Ctimes%2C%0A%20%20%20%20ch%5Fcurve%2Cch%5Fgap%2Cplot%5Fspacing%3D%5B%5D%2C%0A%20%20%20%20v%5Falign%20%3D%20false%2Cplot%5Fspace%2Cdiv%5Fid%2C%0A%20%20%20%20plot%5Fshift%5Fg%20%3D%200%3B%0A%0A%2F%2Fvar%20plot%5Fy%5Flabs%3D%5B%22%23genes%22%2C%22%2Dlog10%28FDR%29%22%5D%3B%0A%2F%2Fvar%20plot%5Fy%5Flabs%3D%5B%22%23DEGs%22%2C%22logFC%22%2C%22Severe%22%2C%22Asymp%2E%22%2C%22logFC%22%5D%3B%0A%2F%2Fvar%20plot%5Flegend%5Flabel%3D%5B%22none%22%2C%22logFC%22%2C%22normalized%20expr%2E%22%2C%22normalized%20expr%2E%22%2C%22logFC%22%5D%3B%0A%2F%2Fvar%20plot%5Flegend%5Flabel%3D%5B%22logFC%22%2C%22normalized%20expr%2E%22%2C%22normalized%20expr%2E%22%5D%3B%0Avar%20make%5Fplot%5Fy%5Flabs%20%3D%20true%3B%0A%0A%2F%2F%20creating%20the%20rounded%20ends%20of%20telomeric%20loci%0Afunction%20rounded%5Frect%28x%2C%20y%2C%20w%2C%20h%2C%20r%2C%20tl%2C%20tr%2C%20bl%2C%20br%29%20%7B%0A%20%20%20%20var%20retval%3B%0A%20%20%20%20retval%20%20%3D%20%22M%22%20%2B%20%28x%20%2B%20r%29%20%2B%20%22%2C%22%20%2B%20y%3B%0A%20%20%20%20retval%20%2B%3D%20%22h%22%20%2B%20%28w%20%2D%202%2Ar%29%3B%0A%20%20%20%20if%20%28tr%29%20%7B%20retval%20%2B%3D%20%22a%22%20%2B%20r%20%2B%20%22%2C%22%20%2B%20r%20%2B%20%22%200%200%201%20%22%20%2B%20r%20%2B%20%22%2C%22%20%2B%20r%3B%20%7D%0A%20%20%20%20else%20%7B%20retval%20%2B%3D%20%22h%22%20%2B%20r%3B%20retval%20%2B%3D%20%22v%22%20%2B%20r%3B%20%7D%0A%20%20%20%20retval%20%2B%3D%20%22v%22%20%2B%20%28h%20%2D%202%2Ar%29%3B%0A%20%20%20%20if%20%28br%29%20%7B%20retval%20%2B%3D%20%22a%22%20%2B%20r%20%2B%20%22%2C%22%20%2B%20r%20%2B%20%22%200%200%201%20%22%20%2B%20%2Dr%20%2B%20%22%2C%22%20%2B%20r%3B%20%7D%0A%20%20%20%20else%20%7B%20retval%20%2B%3D%20%22v%22%20%2B%20r%3B%20retval%20%2B%3D%20%22h%22%20%2B%20%2Dr%3B%20%7D%0A%20%20%20%20retval%20%2B%3D%20%22h%22%20%2B%20%282%2Ar%20%2D%20w%29%3B%0A%20%20%20%20if%20%28bl%29%20%7B%20retval%20%2B%3D%20%22a%22%20%2B%20r%20%2B%20%22%2C%22%20%2B%20r%20%2B%20%22%200%200%201%20%22%20%2B%20%2Dr%20%2B%20%22%2C%22%20%2B%20%2Dr%3B%20%7D%0A%20%20%20%20else%20%7B%20retval%20%2B%3D%20%22h%22%20%2B%20%2Dr%3B%20retval%20%2B%3D%20%22v%22%20%2B%20%2Dr%3B%20%7D%0A%20%20%20%20retval%20%2B%3D%20%22v%22%20%2B%20%282%2Ar%20%2D%20h%29%3B%0A%20%20%20%20if%20%28tl%29%20%7B%20retval%20%2B%3D%20%22a%22%20%2B%20r%20%2B%20%22%2C%22%20%2B%20r%20%2B%20%22%200%200%201%20%22%20%2B%20r%20%2B%20%22%2C%22%20%2B%20%2Dr%3B%20%7D%0A%20%20%20%20else%20%7B%20retval%20%2B%3D%20%22v%22%20%2B%20%2Dr%3B%20retval%20%2B%3D%20%22h%22%20%2B%20r%3B%20%7D%0A%20%20%20%20retval%20%2B%3D%20%22z%22%3B%0A%20%20%20%20return%20retval%3B%0A%7D%0A%0A%0A%0A%0A%2F%2FLOGIC%20FOR%20THE%20CHROMOMAP%0Afunction%20chromoMap%28chData%2CnLoci%2Cploidy%5Fn%2Ctitle%2Ccnt%2Cch%5Fgap%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20top%5Fmargin%2Cleft%5Fmargin%2Cchr%5Fwidth%2Cchr%5Flength%2Cchr%5Fcol%2Cheatmap%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ch%5Fdomain%2Clg%5Fx%2Clg%5Fy%2Cheat%5Fscale%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20labels%2Cdiv%5Fid%2Cwidth%2Cheight%2Crng%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20heat%5Fcol%2Can%5Fcol%2Cch%5Ftext%2Clegend%2Caggregate%5Ffunc%2Cplots%2Ctag%5Ffilter%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fh%2Cplot%5Fticks%2Cplot%5Fcolor%2Cplot%5Fy%5Fdomain%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ref%5Fline%2Crefl%5Fpos%2Crefl%5Fcolor%2Crefl%5Fstroke%5Fw%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tagColor%2CrenderHeat%2Ctext%5Ffont%5Fsize%2Cchr%5Fcurve%2Ctitle%5Ffont%5Fsize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%5Ffont%2Clabel%5Fangle%2C%20grid%5Farray%2Cvertical%5Fgrid%2Cgrid%5Fcolor%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20plot%5Ffilter%2Cloci%5Flinks%2Cuniq%5Fcates%2Cscatter%5Fcol%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20grid%5Ftext%2Cgrid%5Ftext%5Fsize%2Cgrid%5Ftext%5Fy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20scatter%5Fmapping%2Cscatter%5Flg%5Fx%2Cscatter%5Flg%5Fy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20show%5Flinks%2Cseg%5Fanno%2Cdirected%5Fedges%2Cy%5Fchr%5Fscale%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20links%5Fcolors%2Clinks%5Flg%5Fx%2Clinks%5Flg%5Fy%2Clinks%5Fcolor%5Fmaps%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20win%5Fscale%2Cscale%5Fticks%2Cexport%5Foptions%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20guides%2Cguides%5Fcolor%2Cann%5Fh%2Cdisplay%5Fchr%2Cplot%5Fshift%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20plot%5Flegend%5Flabel%2Ccat%5Flegend%5Flab%2Cplot%5Fy%5Flabs%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fy%5Flab%5Fx%2Cplot%5Fy%5Flab%5Fy%2Cplot%5Fy%5Flab%5Fsize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20scale%5Fsuffix%2Cinteractivity%29%7B%0A%0A%0A%0A%0A%20%20%20%20%2F%2Fswapping%20margins%0A%20%20if%28v%5Falign%29%7B%0A%20%20%20%20var%20t%3Dtop%5Fmargin%3B%0A%20%20%20%20top%5Fmargin%3Dleft%5Fmargin%3B%0A%20%20%20%20left%5Fmargin%3Dt%3B%0A%0A%20%20%7D%0A%0A%0A%0A%0A%20%20%20%20if%28%21labels%29%7B%0A%20%20%20%20%20%20y%5Fval%20%3D%20top%5Fmargin%3B%0A%20%20%20%20%7D%20else%20%7B%0A%0A%20%20%20%20%20%20y%5Fval%20%3D%20top%5Fmargin%2B10%3B%0A%20%20%20%20%7D%0A%0A%0A%0A%20%20%20%20%0A%20%20%20%20ch%5Fwidth%20%3D%20chr%5Fwidth%3B%20%2F%2Aheight%20of%20chromosome%20bar%20%2A%2F%0A%20%20%20%20arc%5Fradius%3Dchr%5Fwidth%2F2%3B%0A%0A%20%20%20%20loci%5Fwidth%3Dchr%5Flength%3B%20%2F%2Awidht%20of%20each%20loci%20determined%20for%20ch%20length%20%2A%2F%0A%0A%20%20%20%20ch%5Fcurve%3Dchr%5Fcurve%3B%20%2F%2A%20the%20curve%20at%20the%20end%20loci%2A%2F%0A%0A%20%20%20%20var%20plot%5Fheight%20%3D%20plot%5Fh%3B%0A%20%20%20%2F%2Fconsole%2Elog%28plot%5Fh%29%3B%0A%20%20%20if%28plots%5B0%5D%20%3D%3D%20%22none%22%29%7B%0A%20%20%20%20%20var%20plot%5Fspacing%20%3D%20%5B%5D%3B%0A%20%20%20%20%20for%28var%20h%3D0%3Bh%3Cploidy%5Fn%3Bh%2B%2B%29%7B%0A%20%20%20%20%20plot%5Fspacing%2Epush%280%29%3B%7D%0A%20%20%20%20%20plot%5Fspace%20%3D%200%0A%0A%20%20%20%7D%20else%20%7B%0A%0A%20%20%20%20plot%5Fspacing%20%3D%20plot%5Fheight%2Emap%28%20function%28value%29%20%7B%0A%20%20%20%20return%20value%20%2B%2018%3B%20%7D%20%29%3B%0A%0A%0A%20%20%20%20plot%5Fspace%20%3D%20plot%5Fspacing%2Ereduce%28function%28a%2C%20b%29%7B%0A%20%20%20%20%20%20%20%20%20%20return%20a%20%2B%20b%3B%0A%20%20%20%20%20%20%7D%2C%200%29%3B%0A%0A%20%20%20%20%2F%2Fplot%5Fspace%20%3D%20plot%5Fspace%20%2B%20%28ploidy%5Fn%20%2D%201%29%2A%28ch%5Fgap%2A3%29%3B%0A%7D%0A%2F%2Fconsole%2Elog%28plot%5Fspace%29%3B%0Aif%28labels%29%7B%0A%20%20plot%5Fspacing%20%3D%20plot%5Fspacing%2Emap%28%20function%28value%29%20%7B%0A%20%20%20%20return%20value%20%2B%2050%3B%20%7D%20%29%3B%0A%0A%20%20%20%20plot%5Fspace%20%3D%20plot%5Fspacing%2Ereduce%28function%28a%2C%20b%29%7B%0A%20%20%20%20%20%20return%20a%20%2B%20b%3B%0A%20%20%7D%2C%200%29%3B%0A%7D%0A%0Avar%20plot%5Fpadding%20%3D%2015%3B%0A%0A%20%20%20%20if%28%21labels%29%7B%0A%20%20%20%20%20%20chr%5Fspacing%3D%20ploidy%5Fn%2Achr%5Fwidth%20%2B%20ploidy%5Fn%20%2B%20ch%5Fgap%2A2%20%2B%20plot%5Fspace%3B%0A%7D%20else%20%7B%0A%20%20chr%5Fspacing%3D%20ploidy%5Fn%2Achr%5Fwidth%20%2B%20ploidy%5Fn%20%2B%20ch%5Fgap%2A2%20%2B%20plot%5Fspace%3B%0A%7D%0A%0A%0A%0A%20%20%20%20ttl%3Dtitle%3B%0A%0A%0A%2F%2F%20%20%20%20%20var%20arc%20%3D%20d3%2Earc%28%29%0A%2F%2F%20%20%2EinnerRadius%280%29%0A%2F%2F%20%20%2EouterRadius%28arc%5Fradius%29%0A%2F%2F%20%20%2EstartAngle%280%29%0A%2F%2F%20%20%2EendAngle%28Math%2EPI%29%3B%0A%0A%2F%2F%20%20var%20arcLeft%20%3D%20d3%2Earc%28%29%0A%2F%2F%20%20%2EinnerRadius%280%29%0A%2F%2F%20%20%2EouterRadius%28arc%5Fradius%29%0A%2F%2F%20%20%2EstartAngle%28Math%2EPI%29%0A%2F%2F%20%20%2EendAngle%282%2AMath%2EPI%29%3B%0A%0A%2F%2F%20%20var%20arcTop%20%3D%20d3%2Earc%28%29%0A%2F%2F%20%20%2EinnerRadius%280%29%0A%2F%2F%20%20%2EouterRadius%28arc%5Fradius%29%0A%2F%2F%20%20%2EstartAngle%28%2DMath%2EPI%2F2%29%0A%2F%2F%20%20%2EendAngle%28Math%2EPI%2F2%29%3B%0A%0A%2F%2F%20%20var%20arcBot%20%3D%20d3%2Earc%28%29%0A%2F%2F%20%20%2EinnerRadius%280%29%0A%2F%2F%20%20%2EouterRadius%28arc%5Fradius%29%0A%2F%2F%20%20%2EstartAngle%28Math%2EPI%2F2%29%0A%2F%2F%20%20%2EendAngle%28%283%2AMath%2EPI%29%2F2%29%3B%0A%0A%2F%2F%20automaticlally%20update%20height%20if%20not%20given%0A%0Aif%28height%20%3D%3D%20null%29%7B%0A%20%20if%28%21legend%2Eincludes%28true%29%29%7B%0A%20%20%20%20height%20%3D%20%28%20top%5Fmargin%2B%28chr%5Fspacing%29%2AnLoci%5B0%5D%2Elength%2B10%29%2D%20y%5Fchr%5Fscale%20%2B%20100%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20height%20%3D%20%28%20top%5Fmargin%2B%28chr%5Fspacing%29%2AnLoci%5B0%5D%2Elength%2B10%29%2D%20y%5Fchr%5Fscale%20%2B%20300%3B%0A%20%20%7D%0A%7D%0A%0Ad3%2Eselect%28%27body%27%29%2Estyle%28%22overflow%2Dy%22%2C%22scroll%22%29%0A%2Estyle%28%22overflow%2Dx%22%2C%22scroll%22%29%3B%0A%0Avar%20chmap%5Fdiv%20%3D%20d3%2Eselect%28%22%23%22%2Bdiv%5Fid%29%3B%0Achmap%5Fdiv%2Estyle%28%22background%2Dcolor%22%2C%22white%22%29%3B%0A%0A%0A%0Avar%20svg%20%3D%20chmap%5Fdiv%2Eappend%28%22svg%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2Cwidth%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2Cheight%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2Dsvg%22%29%3B%0A%0A%0A%2F%2F%20adding%20download%20buttons%0Aif%28export%5Foptions%29%7B%0Avar%20css%20%3D%20%60%0A%23save%5Fpng%20%7B%0A%20%20background%2Dcolor%3A%20%234CAF50%3B%20%0A%20%20color%3A%20white%3B%0A%20%20padding%3A%2015px%2032px%3B%0A%20%20text%2Dalign%3A%20center%3B%0A%20%20font%2Dsize%3A%2016px%3B%0A%20%20width%3A100%25%3B%0A%20%20border%3Asolid%3B%0A%20%20border%2Dradius%3A10px%3B%0A%7D%0A%23save%5Fpng%3Ahover%7B%0A%20%20background%2Dcolor%3A%20white%3B%0A%20%20color%3A%20black%3B%0A%20%20cursor%3Apointer%3B%0A%7D%0A%23save%5Fsvg%20%7B%0A%20%20background%2Dcolor%3A%20%234CAF50%3B%20%0A%20%20color%3A%20white%3B%0A%20%20padding%3A%2015px%2032px%3B%0A%20%20text%2Dalign%3A%20center%3B%0A%20%20font%2Dsize%3A%2016px%3B%0A%20%20width%3A100%25%3B%0A%20%20border%3Asolid%3B%0A%20%20border%2Dradius%3A10px%3B%0A%7D%0A%23save%5Fsvg%3Ahover%7B%0A%20%20background%2Dcolor%3A%20white%3B%0A%20%20color%3A%20black%3B%0A%20%20cursor%3Apointer%3B%0A%7D%0A%0A%60%3B%0Avar%20style%20%3D%20document%2EcreateElement%28%27style%27%29%3B%0Astyle%2EappendChild%28document%2EcreateTextNode%28css%29%29%3B%0A%20%20%0Adocument%2EgetElementsByTagName%28%27head%27%29%5B0%5D%2EappendChild%28style%29%3B%0A%0A%0Alet%20fname%5Flabel%20%3D%20document%2EcreateElement%28%22label%22%29%3B%0Afname%5Flabel%2EinnerHTML%20%3D%20%22%20Filename%3A%20%22%3B%0Afname%5Flabel%2Efor%20%3D%20%22flnme%22%3B%0Alet%20filename%20%3D%20document%2EcreateElement%28%22input%22%29%3B%0Afilename%2Etype%20%3D%20%22text%22%3B%0Afilename%2Ename%20%3D%20%22filename%3A%22%3B%0Afilename%2Eid%20%3D%20%22flnme%22%3B%0Afilename%2Evalue%20%3D%20%22my%5FchromoMap%5Fplot%22%3B%0Apng%5Fopts%20%3D%20document%2EcreateElement%28%22h2%22%29%3B%0Apng%5Fopts%2EinnerHTML%20%3D%20%20%22Export%20as%20PNG%2FSVG%22%3B%0Ackgrncol%5Flab%20%3D%20document%2EcreateElement%28%22label%22%29%3B%0Ackgrncol%5Flab%2EinnerHTML%20%3D%20%22%20Background%20Color%3A%20%22%3B%0Ackgrncol%5Flab%2Efor%20%3D%20%22bgcoll%22%3B%0Alet%20bgcoll%20%3D%20document%2EcreateElement%28%22input%22%29%3B%0Abgcoll%2Etype%20%3D%20%22color%22%3B%0Abgcoll%2Eid%20%3D%20%22bgcoll%22%3B%0Abgcoll%2Evalue%20%3D%20%22%23ffffff%22%3B%0Alet%20imgscle%5Flab%20%3D%20document%2EcreateElement%28%22label%22%29%3B%0Aimgscle%5Flab%2EinnerHTML%20%3D%20%22%20Scale%281%2D6%29%3A%20%22%3B%0Aimgscle%5Flab%2Efor%20%3D%20%22imgscl%22%3B%0Alet%20imgscl%20%3D%20document%2EcreateElement%28%22input%22%29%3B%0Aimgscl%2Etype%20%3D%20%22range%22%3B%0Aimgscl%2Emin%20%3D%201%3B%0Aimgscl%2Emax%20%3D%206%3B%0Aimgscl%2Evalue%20%3D%203%3B%0Aimgscl%2Eid%20%3D%20%22imgscl%22%3B%0Alet%20btn%20%3D%20document%2EcreateElement%28%22button%22%29%3B%0Abtn%2EinnerHTML%20%3D%20%22Save%20as%20png%22%3B%0Abtn%2Eonclick%20%3D%20function%28%29%7B%0AsaveSvgAsPng%28document%2EgetElementById%28div%5Fid%2B%27%2Dsvg%27%29%2C%20document%2EgetElementById%28%22flnme%22%29%2Evalue%20%2B%20%22%2Epng%22%2C%20%7Bscale%3A%20document%2EgetElementById%28%22imgscl%22%29%2Evalue%2CbackgroundColor%3Adocument%2EgetElementById%28%22bgcoll%22%29%2Evalue%2CencoderOptions%3A1%7D%29%3B%0A%7D%0Abtn%2Eid%20%3D%20%22save%5Fpng%22%3B%0A%0Alet%20btn2%20%3D%20document%2EcreateElement%28%22button%22%29%3B%0Abtn2%2EinnerHTML%20%3D%20%22Save%20as%20SVG%22%3B%0Abtn2%2Eonclick%20%3D%20function%28%29%7B%0AsaveSvg%28div%5Fid%2B%27%2Dsvg%27%2C%20document%2EgetElementById%28%22flnme%22%29%2Evalue%20%2B%20%22%2Esvg%22%29%3B%0A%7D%0Abtn2%2Eid%20%3D%20%22save%5Fsvg%22%3B%0A%2F%2Fbtn%2Estyle%20%3D%20%22background%2Dcolor%3A%20%234CAF50%3B%20color%3A%20white%3Bpadding%3A%2015px%2032px%3Btext%2Dalign%3A%20center%3Btext%2Ddecoration%3A%20none%3Bdisplay%3A%20inline%2Dblock%3Bfont%2Dsize%3A%2016px%3Bwidth%3A100%25%3Bborder%3Asolid%3Bborder%2Dradius%3A10px%3B%22%0A%2F%2Fcmap%5Fdiv%5Fele%20%3D%20document%2EgetElementById%28div%5Fid%29%3B%0A%2F%2Fcmap%5Fdiv%5Fele%2EappendChild%28dwdiv%29%3B%0Adw%5Fele%20%3D%20document%2EgetElementById%28%22dwopt%22%29%3B%0Adw%5Fele%2EappendChild%28fname%5Flabel%29%3B%0Adw%5Fele%2EappendChild%28filename%29%3B%0Adw%5Fele%2EappendChild%28document%2EcreateElement%28%22br%22%29%29%3B%0Adw%5Fele%2EappendChild%28document%2EcreateElement%28%22hr%22%29%29%3B%0Adw%5Fele%2EappendChild%28png%5Fopts%29%3B%0Adw%5Fele%2EappendChild%28ckgrncol%5Flab%29%3B%0Adw%5Fele%2EappendChild%28bgcoll%29%3B%0Adw%5Fele%2EappendChild%28document%2EcreateElement%28%22br%22%29%29%3B%0Adw%5Fele%2EappendChild%28imgscle%5Flab%29%3B%0Adw%5Fele%2EappendChild%28imgscl%29%3B%0Adw%5Fele%2EappendChild%28document%2EcreateElement%28%22br%22%29%29%3B%0Adw%5Fele%2EappendChild%28btn%29%3B%0Adw%5Fele%2EappendChild%28document%2EcreateElement%28%22br%22%29%29%3B%0Adw%5Fele%2EappendChild%28document%2EcreateElement%28%22br%22%29%29%3B%0Adw%5Fele%2EappendChild%28document%2EcreateElement%28%22hr%22%29%29%3B%0Adw%5Fele%2EappendChild%28btn2%29%3B%0Adw%5Fele%2EappendChild%28document%2EcreateElement%28%22br%22%29%29%3B%0Adw%5Fele%2EappendChild%28document%2EcreateElement%28%22br%22%29%29%3B%0Adw%5Fele%2EappendChild%28document%2EcreateElement%28%22hr%22%29%29%3B%0A%0A%7D%0A%0A%20%20%20%20if%28%21v%5Falign%29%7B%0A%20%20%20%20%2F%2A%20Adding%20title%20%2A%2F%0A%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%2Eattr%28%22x%22%2Cwidth%2F2%29%0A%20%20%20%20%2Eattr%28%22y%22%2C%28top%5Fmargin%2F2%29%29%0A%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20title%5Ffont%5Fsize%29%0A%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%2Etext%28ttl%29%3B%0A%7D%20else%20%7B%0A%20%20svg%2Eappend%28%22text%22%29%0A%20%20%2Eattr%28%22x%22%2Cwidth%2F2%29%0A%20%20%2Eattr%28%22y%22%2C%28left%5Fmargin%2F3%29%29%0A%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%2Eattr%28%22font%2Dsize%22%2C%20%2212px%22%29%0A%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%2Etext%28ttl%29%3B%0A%0A%7D%0A%0A%0A%20%20%20if%28%21v%5Falign%29%7B%0A%20%20%20%20%2F%2Aadding%20axes%20%20%2A%2F%0A%20%20%20%20x%5Fscale%5Fpos%3D%28%20top%5Fmargin%2B%28chr%5Fspacing%29%2AnLoci%5B0%5D%2Elength%2B10%29%2D%20y%5Fchr%5Fscale%3B%0A%0A%0A%20%20%20%20nnmax%3D%20win%5Fscale%3B%0A%0A%20%20%20%20if%28cnt%29%7B%0A%20%20%20%20x%5Fscale%5Fwidth%3D%20%28nnmax%29%2Aloci%5Fwidth%20%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20x%5Fscale%5Fwidth%3D%20%28nnmax%29%2Aloci%5Fwidth%20%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20Create%20scale%0A%20%20%20%20cc%5Fary%20%3D%20d3%2Erange%280%2Cx%5Fscale%5Fwidth%2Cloci%5Fwidth%29%0A%20%20%20%20cc%5Fary%2Epush%28x%5Fscale%5Fwidth%29%0A%20%20%20%20console%2Elog%28cc%5Fary%29%0A%20%20%20%20var%20scale%20%3D%20d3%2EscaleLinear%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Edomain%28ch%5Fdomain%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Erange%28cc%5Fary%29%3B%0A%20%20%20%20%2F%2Fvar%20scale%5Fsuffix%20%3D%20%22bp%22%0A%20%20%20%20%2F%2Fconsole%2Elog%28scale%28700%29%29%3B%0A%20%20%20%20%2F%2Fconsole%2Elog%28%28parseInt%28ch%5Fdomain%5B1%5D%29%2D%20parseInt%28ch%5Fdomain%5B0%5D%29%29%29%3B%0A%20%20%20%20var%20show%5Fpos%5Fscale%20%3D%20false%3B%0A%20%20%20%20if%28show%5Fpos%5Fscale%29%7B%0A%20%20%20%20%20%20var%20p%5Fscale%20%3D%20d3%2EscaleLinear%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Edomain%28%5B1%2C%28%28parseInt%28ch%5Fdomain%5B1%5D%29%2D%20parseInt%28ch%5Fdomain%5B0%5D%29%29%29%5D%29%2Enice%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Erange%28%5B0%2C%20x%5Fscale%5Fwidth%5D%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20x%5Faxis2%20%3D%20d3%2EaxisBottom%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Escale%28p%5Fscale%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eticks%285%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2EtickFormat%28function%28d%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%3E%3D1000000000%29%7B%20return%20%28d%2F1000000000%29%2B%22Gb%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%28d%3E%3D1000000%29%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%28d%2F1000000%29%2B%22Mb%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28d%3E%3D1000%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%28d%2F1000%29%2B%22kb%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%20return%20d%2B%22bp%22%3B%7D%7D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2Fvar%20tickValues%3D%20%5B%5D%2Econcat%28scale%2Edomain%28%29%5B0%5D%2C%20scale%2Eticks%285%29%2C%20scale%2Edomain%28%29%5B1%5D%29%3B%0A%20%20%20%20%2F%2F%20Add%20scales%20to%20axis%0A%20%20%20%20var%20x%5Faxis%20%3D%20d3%2EaxisBottom%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Escale%28scale%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eticks%28scale%5Fticks%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2EtickFormat%28function%28d%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%3E%3D1000000000%29%7B%20return%20%28d%2F1000000000%29%2B%22G%22%2Bscale%5Fsuffix%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%28d%3E%3D1000000%29%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%28d%2F1000000%29%2B%22M%22%2Bscale%5Fsuffix%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28d%3E%3D1000%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%28d%2F1000%29%2B%22k%22%2Bscale%5Fsuffix%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%20return%20d%2Bscale%5Fsuffix%3B%7D%7D%29%3B%0A%0A%20%20%20%20%2F%2FAppend%20group%20and%20insert%20axis%0A%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2B%28left%5Fmargin%29%2B%22%2C%22%20%2B%20x%5Fscale%5Fpos%20%2B%20%22%29%22%29%0A%20%20%20%20%2Eattr%28%22id%22%2C%22main%5Faxis%22%29%0A%20%20%20%20%2Ecall%28x%5Faxis%29%3B%0A%20%20%20%20%0A%0A%20%20%20%20svg%2Eselect%28%22%23main%5Faxis%22%29%2Estyle%28%22font%2Dsize%22%2C%2212px%22%29%0A%20%20%20%20if%28show%5Fpos%5Fscale%29%7B%0A%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2B%28left%5Fmargin%29%2B%22%2C%22%20%2B%20%28x%5Fscale%5Fpos%2B30%29%20%2B%20%22%29%22%29%0A%20%20%20%20%20%20%2Eattr%28%22id%22%2C%22main%5Faxis2%22%29%0A%20%20%20%20%20%20%2Ecall%28x%5Faxis2%29%3B%0A%0A%20%20%20%20%20%20svg%2Eselect%28%22%23main%5Faxis2%22%29%2Estyle%28%22font%2Dsize%22%2C%2215px%22%29%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2A%20axis%20title%20%2A%2F%0A%20%20%20%20%2F%2A%0A%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%2Eattr%28%22x%22%2Cx%5Fscale%5Fwidth%2F2%29%0A%20%20%20%20%2Eattr%28%22y%22%2Cx%5Fscale%5Fpos%20%2B%2045%20%2B%2015%29%0A%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20%2215px%22%29%0A%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%2Etext%28%22Length%22%29%3B%0A%20%20%20%20%2A%2F%0A%0A%20%20%20%20var%20grid%5Fh%20%3D%200%20%2D%20%28x%5Fscale%5Fpos%20%2D%20top%5Fmargin%20%2B%2015%29%3B%0A%20%20%20%20%2F%2Fvar%20grid%5Farray%20%3D%20%5B0%2C20%2C56%2C80%2C90%5D%3B%0A%20%20%20%20%2F%2A%20%20adding%20vertical%20grid%20lines%2A%2F%0A%20%20%20%20%2F%2Fconsole%2Elog%28scale%28150%29%29%0A%20%20%20%20%2F%2Fvar%20grid%5Ftext%20%3D%20%5B%22AUREA%22%2C%22%22%5D%3B%0A%20%20%20%20%2F%2Fvar%20liness%20%3D%20%5B%5D%3B%0A%20%20%20%20if%28typeof%20grid%5Farray%20%3D%3D%20%27number%27%29%7B%0A%20%20%20%20%20%20grid%5Farray%20%3D%20%5Bgrid%5Farray%5D%3B%0A%20%20%20%20%20%20grid%5Ftext%20%3D%20%5Bgrid%5Ftext%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2Fconsole%2Elog%28grid%5Farray%2Elength%29%0A%20%20%20%20%0A%20%20%20%20if%28vertical%5Fgrid%29%7B%0A%20%20%20%20for%28i%3D0%3Bi%3Cgrid%5Farray%2Elength%3Bi%2B%2B%29%7B%0A%0A%20%20%20%20%20%20svg%2Eselect%28%22%23main%5Faxis%22%29%2Eappend%28%22line%22%29%0A%20%20%20%20%20%20%2Eattr%28%22x1%22%2C%20scale%28grid%5Farray%5Bi%5D%29%29%0A%20%20%20%20%20%20%2Eattr%28%22x2%22%2C%20scale%28grid%5Farray%5Bi%5D%29%29%0A%20%20%20%20%20%20%2Eattr%28%22y1%22%2C%20%200%29%0A%20%20%20%20%20%20%2Eattr%28%22y2%22%2C%20%20grid%5Fh%29%0A%20%20%20%20%20%20%2Eattr%28%22stroke%22%2C%20grid%5Fcolor%29%0A%20%20%20%20%20%20%2Eattr%28%22stroke%2Ddasharray%22%2C%225%2C5%22%29%0A%20%20%20%20%20%20%2Eattr%28%22stroke%2Dwidth%22%2C2%29%0A%20%20%20%20%20%20%2Eattr%28%22id%22%2C%22grid%5Fid%5F%22%2Bi%29%0A%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22overlines%22%29%3B%0A%0A%20%20%20%20%20%20let%20line%5Fx%20%3D%20parseFloat%28d3%2Eselect%28%22%23grid%5Fid%5F%22%2Bi%29%2Eattr%28%22x1%22%29%29%3B%0A%0A%20%20%20%20%20%20if%28grid%5Ftext%20%21%3D%20null%29%7B%0A%20%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%2Eattr%28%22x%22%2Cline%5Fx%2Bleft%5Fmargin%2B4%29%0A%20%20%20%20%20%20%2Eattr%28%22y%22%2Cgrid%5Ftext%5Fy%29%0A%20%20%20%20%20%20%2Eattr%28%27text%2Danchor%27%2C%20%27start%27%29%0A%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2Cgrid%5Ftext%5Fsize%29%0A%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%2Eattr%28%22class%22%2C%20%22myLabel%22%29%0A%20%20%20%20%20%20%2Etext%28grid%5Ftext%5Bi%5D%29%3B%0A%7D%0A%0A%20%20%20%20%7D%7D%0A%20%20%20%20%2F%2A%20%2A%2F%0A%20%20%20%20%2F%2F%20window%20guides%0A%20%20%20%20if%28guides%29%7B%0A%20%20%20%20%20%20for%28i%3D0%3Bi%3Cch%5Fdomain%2Elength%3Bi%2B%2B%29%7B%0A%20%20%0A%20%20%20%20%20%20%20%20svg%2Eselect%28%22%23main%5Faxis%22%29%2Eappend%28%22line%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22x1%22%2C%20scale%28ch%5Fdomain%5Bi%5D%29%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22x2%22%2C%20scale%28ch%5Fdomain%5Bi%5D%29%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22y1%22%2C%20%200%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22y2%22%2C%20%20grid%5Fh%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%22%2C%20guides%5Fcolor%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%2Dwidth%22%2C1%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2C%22guide%5Fid%5F%22%2Bi%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22overlines2%22%29%3B%0A%20%20%0A%20%20%20%20%20%20%7D%7D%0A%0A%20%20%20%20%2F%2A%20end%20of%20guides%20%2A%2F%0A%0A%7D%20else%20%7B%0A%0A%2F%2Aadding%20axes%20%20%2A%2F%0Ax%5Fscale%5Fpos%3D%28%20top%5Fmargin%2B%28chr%5Fspacing%29%2AnLoci%5B0%5D%2Elength%2B10%29%3B%0A%0A%0A%0Annmax%3D%20100%3B%0A%0Aif%28cnt%29%7B%0Ax%5Fscale%5Fwidth%3D%20%28nnmax%29%2Aloci%5Fwidth%20%2B%203%2Aarc%5Fradius%3B%0A%7D%20else%20%7B%0A%20%20x%5Fscale%5Fwidth%3D%20%28nnmax%29%2Aloci%5Fwidth%20%2B%20arc%5Fradius%3B%0A%7D%0A%2F%2F%20Create%20scale%0Avar%20scale%20%3D%20d3%2EscaleLinear%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Edomain%28ch%5Fdomain%29%2Enice%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Erange%28%5B0%2C%20x%5Fscale%5Fwidth%5D%29%3B%0A%0A%2F%2F%20Add%20scales%20to%20axis%0Avar%20x%5Faxis%20%3D%20d3%2EaxisRight%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Escale%28scale%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eticks%285%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2EtickFormat%28function%28d%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%3E%3D1000000000%29%7B%20return%20%28d%2F1000000000%29%2B%22Gb%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%28d%3E%3D1000000%29%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%28d%2F1000000%29%2B%22Mb%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28d%3E%3D1000%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%28d%2F1000%29%2B%22kb%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%20return%20d%2B%22bp%22%3B%7D%7D%29%3B%0A%0A%2F%2FAppend%20group%20and%20insert%20axis%0Asvg%2Eappend%28%22g%22%29%0A%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bx%5Fscale%5Fpos%2B%22%2C%22%20%2B%20%28left%5Fmargin%29%20%2B%20%22%29%22%29%0A%2Ecall%28x%5Faxis%29%2EselectAll%28%22text%22%29%2Eattr%28%22transform%22%2C%20%22rotate%2890%29%22%29%2Eattr%28%22y%22%2C%20%2D12%29%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%3B%0A%0A%0A%2F%2A%20axis%20title%20%2A%2F%0Asvg%2Eappend%28%22text%22%29%0A%2Eattr%28%22transform%22%2C%20%22translate%28%22%2B%28x%5Fscale%5Fpos%20%2B%2035%29%2B%22%2C%22%20%2B%20%28x%5Fscale%5Fwidth%2F2%29%20%2B%20%22%29%20rotate%2890%29%22%29%0A%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%2Eattr%28%22font%2Dsize%22%2C%20%2212px%22%29%0A%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%2Etext%28%22%20Length%20%28bp%29%22%29%3B%0A%0A%0A%0A%0A%7D%0A%0A%0A%2F%2F%20scatter%20color%20function%20and%20scatter%20legend%0A%0A%2F%2Fconsole%2Elog%28uniq%5Fcates%29%0Ascatter%5Fcolor%5Fmap%5Ffn%20%3D%20d3%2EscaleOrdinal%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Edomain%28uniq%5Fcates%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Erange%28scatter%5Fcol%29%3B%0A%0A%0Aif%28scatter%5Fmapping%29%7B%0A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20w2%3Duniq%5Fcates%2Elength%2A20%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Create%20scale%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20scalescatter%20%3D%20d3%2EscaleBand%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Edomain%28uniq%5Fcates%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Erange%28%5B2%2Cw2%5D%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Add%20scales%20to%20axis%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20legendscatter%20%3D%20d3%2EaxisRight%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Escale%28scalescatter%29%2EtickSizeOuter%280%29%3B%0A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2FAppend%20group%20and%20insert%20axis%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2B%28%28width%2D35%29%2Dscatter%5Flg%5Fx%29%2B%22%2C%22%20%2B%20%28%28height%2D100%29%2Dscatter%5Flg%5Fy%20%29%2B%20%22%29%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22scatter%5Flegend%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Ecall%28legendscatter%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2Eselect%28%22%2Escatter%5Flegend%22%29%2Estyle%28%22font%2Dsize%22%2C%2215px%22%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Fading%20the%20label%20for%20the%20scatter%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%28width%2D35%29%2Dscatter%5Flg%5Fx%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%28%28height%2D100%29%2Dscatter%5Flg%5Fy%20%2D%2015%20%29%20%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%2020%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22start%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Etext%28cat%5Flegend%5Flab%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22sctrlbl%22%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bwidth%2F2%2B%22%2C%22%20%2Bheight%2F2%2B%20%22%29%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%2Eattr%28%22id%22%2C%22scatter%5Flegend%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%2Ecall%28legendscatter%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20rec%5Fh2%3Dw2%2Funiq%5Fcates%2Elength%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Edata%28scatter%5Fcol%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20function%28d%2Ci%29%7Breturn%20%28%28%28height%2D99%29%2Dscatter%5Flg%5Fy%29%2Bi%2Arec%5Fh2%29%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20rec%5Fh2%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20function%28d%2Ci%29%7Breturn%20%28%28width%2D45%29%2Dscatter%5Flg%5Fx%29%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2C%2010%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20function%28d%29%7Breturn%20d%3B%7D%29%3B%0A%0A%0A%7D%0A%0A%2F%2A%20%20Rendering%20chromoMap%20%20%2A%2F%0A%20%20%20u%3D1%3B%0A%20%20%20%20while%28u%3C%3DparseInt%28ploidy%5Fn%29%29%7B%0A%0A%20%20%20%20%20%20%20%20renderChromoMap%28chData%5Bu%2D1%5D%2Cchr%5Fspacing%2Cploidy%3Du%2Cch%5Fwidth%2Csvg%2CnLoci%5Bu%2D1%5D%2Ccnt%2Cch%5Fgap%2Cchr%5Fcol%5Bu%2D1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20heatmap%2Cleft%5Fmargin%2Clg%5Fx%2Clg%5Fy%2Cheat%5Fscale%2Clabels%2Cwidth%2Cheight%2Crng%5Bu%2D1%5D%2Cheat%5Fcol%5Bu%2D1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20an%5Fcol%5Bu%2D1%5D%2Cch%5Ftext%5Bu%2D1%5D%2Clegend%5Bu%2D1%5D%2Cu%2D1%2Caggregate%5Ffunc%5Bu%2D1%5D%2Cplots%5Bu%2D1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fspacing%5Bu%2D1%5D%2Cplot%5Fheight%5Bu%2D1%5D%2Cv%5Falign%2Ctag%5Ffilter%5Bu%2D1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fticks%5Bu%2D1%5D%2Cplot%5Fcolor%5Bu%2D1%5D%2Cplot%5Fy%5Fdomain%5Bu%2D1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ref%5Fline%5Bu%2D1%5D%2Crefl%5Fpos%5Bu%2D1%5D%2Crefl%5Fcolor%5Bu%2D1%5D%2Crefl%5Fstroke%5Fw%5Bu%2D1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tagColor%5Bu%2D1%5D%2CrenderHeat%5Bu%2D1%5D%2Ctext%5Ffont%5Fsize%5Bu%2D1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%5Ffont%2Clabel%5Fangle%2Cplot%5Ffilter%5Bu%2D1%5D%2Cdiv%5Fid%2Cloci%5Flinks%2Cploidy%5Fn%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20scatter%5Fcolor%5Fmap%5Ffn%2Cshow%5Flinks%2Cseg%5Fanno%2Cdirected%5Fedges%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20links%5Fcolors%2Clinks%5Flg%5Fx%2Clinks%5Flg%5Fy%2Clinks%5Fcolor%5Fmaps%2Cwin%5Fscale%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ann%5Fh%2Cdisplay%5Fchr%5Bu%2D1%5D%2Cplot%5Fshift%5Bu%2D1%5D%2Cplot%5Flegend%5Flabel%5Bu%2D1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cat%5Flegend%5Flab%2Cplot%5Fy%5Flabs%5Bu%2D1%5D%2Cplot%5Fy%5Flab%5Fx%2Cplot%5Fy%5Flab%5Fy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fy%5Flab%5Fsize%2Cinteractivity%29%3B%0A%0A%20%20%20%20u%2B%2B%3B%0A%20%20%20%20%7D%0A%0A%20%2F%2A%20end%20of%20rendering%20chromomap%20%20%2A%2F%0A%0A%0A%0A%7D%20%2F%2A%20end%20of%20chromomap%20function%20%2A%2F%0A%0Afunction%20renderChromoMap%28chData%2Cchr%5Fspacing%2Cploidy%2Cch%5Fwidth%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2CnLoci%2Ccnt%2Cch%5Fgap%2Cchr%5Fcolor%2Cheatmap%2Cleft%5Fmargin%2Clg%5Fx%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20lg%5Fy%2Cheat%5Fscale%2Clabels%2Cwidth%2Cheight%2Crng%2Cheat%5Fcol%2Can%5Fcol%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ch%5Ftext%2Clegend%2Ctimes%2Caggregate%5Ffunc%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20plots%2Cplot%5Fspacing%2Cplot%5Fheight%2Cv%2Ctag%5Ff%2Cplot%5Fticks%2Cplot%5Fcolor%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fy%5Fdomain%2Cref%5Fline%2Crefl%5Fpos%2Crefl%5Fcolor%2Crefl%5Fstroke%5Fw%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tagColor%2CrenderHeat%2Ctext%5Ffont%5Fsize%2Clabel%5Ffont%2Clabel%5Fangle%2Cplot%5Ff%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20div%5Fid%2Cloci%5Flinks%2Cploidy%5Fn%2Cscatter%5Fcolor%5Fmap%5Ffn%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20show%5Flinks%2Cseg%5Fanno%2Cdirected%5Fedges%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20links%5Fcolors%2Clinks%5Flg%5Fx%2Clinks%5Flg%5Fy%2Clinks%5Fcolor%5Fmaps%2Cwin%5Fscale%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ann%5Fh%2Cdisplay%5Fchr%2Cplot%5Fshift%2Cplot%5Flegend%5Flabel%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cat%5Flegend%5Flab%2Cplot%5Fy%5Flabs%2Cplot%5Fy%5Flab%5Fx%2Cplot%5Fy%5Flab%5Fy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fy%5Flab%5Fsize%2Cinteractivity%29%7B%0A%0A%0A%2F%2A%20chromoMap%20render%20code%20%2A%2F%0A%20%20if%28cnt%29%7B%0A%0A%20%20%20%20var%20allDatap%20%3D%5B%5D%3B%0A%20%20%20%20var%20allDataq%3D%5B%5D%3B%0A%20%20%20%20var%20allData%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%28i%3D0%3Bi%20%3C%20nLoci%2Elength%3Bi%2B%2B%29%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20allDatap%5Bi%5D%3Dd3%2Erange%28nLoci%5Bi%5D%2Ep%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20allDataq%5Bi%5D%3Dd3%2Erange%28nLoci%5Bi%5D%2Eq%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20allData%5Bi%5D%3Dd3%2Erange%28nLoci%5Bi%5D%2Ep%2BnLoci%5Bi%5D%2Eq%29%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20for%28i%3D0%3Bi%3C%20nLoci%2Elength%3Bi%2B%2B%29%7B%0A%20%20%20%20%20%20%0A%0A%20%20%20%20%20%20if%28display%5Fchr%29%7B%0A%20%20%20%20%20%20%20%20%2F%2A%20%20first%20cap%20%2A%2F%0A%20%20%20%20%20%20%20%20posx%3Dleft%5Fmargin%3B%0A%20%20%20%20%20%20%20%20posy%3Dy%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%20%2B%20plot%5Fspacing%29%20%3B%0A%0A%20%20%20%20%20%20%20%20if%28%21v%29%7B%0A%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bposx%2B%22%2C%22%2Bposy%2B%22%29%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B1%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20rounded%5Frect%280%2C%200%2C%20loci%5Fwidth%2C%20ch%5Fwidth%2Cch%5Fcurve%2C%20true%2Cfalse%2Ctrue%2Cfalse%29%29%3B%0A%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bposx%2B%22%2C%22%2Bposy%2B%22%29%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B1%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20rounded%5Frect%280%2C%200%2C%20loci%5Fwidth%2C%20ch%5Fwidth%2Cch%5Fcurve%2C%20true%2Cfalse%2Ctrue%2Cfalse%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%0A%20%20%20%20%20%20%20%20%2F%2A%20%20p%20arm%20%2A%2F%0A%20%20%20%20%20%20%20%20if%28%21v%29%7B%0A%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Edata%28allDatap%5Bi%5D%2Eslice%281%2CallDatap%5Bi%5D%2Elength%2D1%29%29%0A%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20ch%5Fwidth%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20function%28d%2Ci%29%7Breturn%20left%5Fmargin%20%2B%20loci%5Fwidth%20%2B%20i%2Aloci%5Fwidth%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2C%20loci%5Fwidth%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20div%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B2%29%2B%22%2D%22%2Bploidy%3B%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Edata%28allDatap%5Bi%5D%2Eslice%281%2CallDatap%5Bi%5D%2Elength%2D1%29%29%0A%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20y%5Fval%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B1%20%29%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2C%20ch%5Fwidth%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20function%28d%2Ci%29%7Breturn%20left%5Fmargin%20%2B%20i%2Aloci%5Fwidth%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20loci%5Fwidth%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20div%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B2%29%2B%22%2D%22%2Bploidy%3B%7D%29%3B%0A%0A%0A%20%20%20%20%20%20%20%20%7D%0A%0A%0A%20%20%20%20%20%20%20%20%20%20%2F%2Flabellings%0A%0A%20%20%20%20%20%20%20%20if%28%21v%29%7B%0A%20%20%20%20%20%20svg%2EselectAll%28%22%2Etexts%22%29%0A%20%20%20%20%20%20%2Edata%28allDatap%5Bi%5D%29%0A%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22labels%22%29%0A%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%2D2%29%0A%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20function%28d%2Ci%29%7Breturn%20left%5Fmargin%20%2B%20i%2Aloci%5Fwidth%20%2B%20%28loci%5Fwidth%2F2%29%3B%7D%29%0A%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20div%5Fid%2B%22%2D%22%2B%22L%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%2Etext%28%22%22%29%0A%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20label%5Ffont%29%0A%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22start%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Etexts%22%29%0A%20%20%20%20%20%20%20%20%2Edata%28allDatap%5Bi%5D%29%0A%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22labels%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%20%7Breturn%20%22L%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%2Etext%28%22%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20%229px%22%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%2Eattr%28%22transform%22%2Cfunction%28d%2Cj%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%22translate%28%22%20%2B%20%28%28y%5Fval%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B1%20%29%29%2D2%29%20%2B%20%22%2C%20%22%2B%28left%5Fmargin%20%2B%20j%2Aloci%5Fwidth%29%2B%22%29%20%22%20%2B%20%22rotate%28%2D90%29%22%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%0A%20%20%20%20%20%20%20%20%20%20%2F%2A%20%20centromere%20%2A%2F%0A%20%20%20%20%20%20%20%20%20%20posx%3Dleft%5Fmargin%2B%20loci%5Fwidth%20%2B%28nLoci%5Bi%5D%2Ep%2D2%29%2Aloci%5Fwidth%0A%20%20%20%20%20%20%20%20%20%20%2F%2Fposy%3Dy%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%2B%20%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B1%20%29%0A%20%20%20%20%20%20%20%20%20%20posy%3D%20y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%0A%0A%20%20%20%20%20%20%20%20%20%20if%28%21v%29%7B%0A%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bposx%2B%22%2C%22%2Bposy%2B%22%29%22%29%0A%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2BallDatap%5Bi%5D%2Elength%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20rounded%5Frect%280%2C%200%2C%20loci%5Fwidth%2C%20ch%5Fwidth%2Cch%5Fcurve%2C%20false%2Ctrue%2Cfalse%2Ctrue%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bposy%2B%22%2C%22%2Bposx%2B%22%29%22%29%0A%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2CnLoci%5Bi%5D%2Ename%2B%22%2D%22%2BallDatap%5Bi%5D%2Elength%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20rounded%5Frect%280%2C%200%2C%20loci%5Fwidth%2C%20ch%5Fwidth%2Cch%5Fcurve%2C%20false%2Ctrue%2Cfalse%2Ctrue%29%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20posx%3Dleft%5Fmargin%2B%20loci%5Fwidth%2A2%20%2B%28nLoci%5Bi%5D%2Ep%2D2%29%2Aloci%5Fwidth%0A%20%20%20%20%20%20%20%20posy%3D%20y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%0A%0A%20%20%20%20%20%20%20%20if%28%21v%29%7B%0A%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bposx%2B%22%2C%22%2Bposy%2B%22%29%22%29%0A%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28nLoci%5Bi%5D%2Ep%2B1%29%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20rounded%5Frect%280%2C%200%2C%20loci%5Fwidth%2C%20ch%5Fwidth%2Cch%5Fcurve%2C%20true%2Cfalse%2Ctrue%2Cfalse%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bposy%2B%22%2C%22%2Bposx%2B%22%29%22%29%0A%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2CnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28nLoci%5Bi%5D%2Ep%2B1%29%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20rounded%5Frect%280%2C%200%2C%20loci%5Fwidth%2C%20ch%5Fwidth%2Cch%5Fcurve%2C%20true%2Cfalse%2Ctrue%2Cfalse%29%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2A%20short%20arm%20%20%2A%2F%0A%20%20%20%20%20%20if%28%21v%29%7B%0A%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Edata%28allDataq%5Bi%5D%2Eslice%281%2CallDataq%5Bi%5D%2Elength%2D1%29%29%0A%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20ch%5Fwidth%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20function%28d%2Cj%29%7Breturn%20left%5Fmargin%2B%20loci%5Fwidth%2A3%20%2B%20j%2Aloci%5Fwidth%20%2B%20%28nLoci%5Bi%5D%2Ep%2D2%29%2Aloci%5Fwidth%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2C%20loci%5Fwidth%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20div%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%2BnLoci%5Bi%5D%2Ep%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Edata%28allDataq%5Bi%5D%2Eslice%281%2CallDataq%5Bi%5D%2Elength%2D1%29%29%0A%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20y%5Fval%20%2B%20i%2Achr%5Fspacing%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B1%20%29%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2C%20ch%5Fwidth%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20function%28d%2Cj%29%7Breturn%20left%5Fmargin%2B%20loci%5Fwidth%2A3%20%2B%20j%2Aloci%5Fwidth%20%2B%20%28nLoci%5Bi%5D%2Ep%2D2%29%2Aloci%5Fwidth%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20loci%5Fwidth%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20nLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%2BnLoci%5Bi%5D%2Ep%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2Flabellings%0A%0A%20%20%20%20%20%20%20%20if%28%21v%29%7B%0A%20%20%20%20%20%20svg%2EselectAll%28%22%2Etexts%22%29%0A%20%20%20%20%20%20%2Edata%28allDataq%5Bi%5D%29%0A%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22labels%22%29%0A%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%2D2%29%0A%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20function%28d%2Cj%29%7Breturn%20left%5Fmargin%20%2B%20j%2Aloci%5Fwidth%20%2B%20%28nLoci%5Bi%5D%2Ep%29%2Aloci%5Fwidth%20%2B%20%28loci%5Fwidth%2F2%29%3B%7D%29%0A%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20div%5Fid%2B%22%2D%22%2B%22L%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%2BnLoci%5Bi%5D%2Ep%29%2B%22%2D%22%2Bploidy%3B%7D%29%2Etext%28%22%22%29%0A%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20label%5Ffont%29%0A%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22start%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Etexts%22%29%0A%20%20%20%20%20%20%20%20%2Edata%28allDataq%5Bi%5D%29%0A%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22labels%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7Breturn%20%22L%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%2BnLoci%5Bi%5D%2Ep%29%2B%22%2D%22%2Bploidy%3B%7D%29%2Etext%28%22%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20%229px%22%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%2Eattr%28%22transform%22%2Cfunction%28d%2Cj%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%22translate%28%22%20%2B%20%28%28y%5Fval%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B1%20%29%29%2D2%29%20%2B%20%22%2C%20%22%2B%28left%5Fmargin%20%2B%20j%2Aloci%5Fwidth%2B%20%28nLoci%5Bi%5D%2Ep%29%2Aloci%5Fwidth%20%2B2%2Aarc%5Fradius%29%2B%22%29%20%22%20%2B%20%22rotate%28%2D90%29%22%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%0A%0A%0A%0A%20%20%20%20%20%20%20%20%20%2F%2A%20%20%20final%20cap%20%2A%2F%0A%0A%0A%20%20%20%20%20%20%20%20%20%20posx%3Dleft%5Fmargin%2B%28nLoci%5Bi%5D%2Ep%2D2%29%2Aloci%5Fwidth%20%2B%203%2Aloci%5Fwidth%20%2B%20%28nLoci%5Bi%5D%2Eq%2D2%29%2Aloci%5Fwidth%3B%0A%20%20%20%20%20%20%20%20%20%20posy%3Dy%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%2B%20%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%3B%0A%20%20%20%20%20%20%20%20if%28%21v%29%7B%0A%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bposx%2B%22%2C%22%2Bposy%2B%22%29%22%29%0A%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28nLoci%5Bi%5D%2Ep%20%2BnLoci%5Bi%5D%2Eq%29%20%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20rounded%5Frect%280%2C%200%2C%20loci%5Fwidth%2C%20ch%5Fwidth%2Cch%5Fcurve%2C%20false%2Ctrue%2Cfalse%2Ctrue%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bposy%2B%22%2C%22%2Bposx%2B%22%29%22%29%0A%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2CnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28nLoci%5Bi%5D%2Ep%20%2BnLoci%5Bi%5D%2Eq%29%20%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20rounded%5Frect%280%2C%200%2C%20loci%5Fwidth%2C%20ch%5Fwidth%2Cch%5Fcurve%2C%20false%2Ctrue%2Cfalse%2Ctrue%29%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20if%28%21v%29%7B%0A%20%20%20%20%20%20%20%20%20%20if%28ch%5Ftext%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2Cleft%5Fmargin%2A0%2E5%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C10%20%2B%20y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20text%5Ffont%5Fsize%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Etext%28nLoci%5Bi%5D%2Ename%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%28ch%5Ftext%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2Cleft%5Fmargin%2A0%2E75%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2Cy%5Fval%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B2%20%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20%229px%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Etext%28nLoci%5Bi%5D%2Ename%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20end%20od%20display%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%28plots%3D%3D%22bar%22%29%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2A%20logic%20for%20bar%2A%2F%0A%20%20%20%20%20%20%20%20%20%20if%28%21v%29%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%28%21display%5Fchr%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%20ch%5Fwidth%20%2B%2010%20%2B%20plot%5Fshift%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%28make%5Fplot%5Fy%5Flabs%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2Cplot%5Fy%5Flab%5Fx%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%28y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%20%2B%20plot%5Fshift%5Fg%29%20%2B%20plot%5Fy%5Flab%5Fy%20%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20plot%5Fy%5Flab%5Fsize%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Etext%28plot%5Fy%5Flabs%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22plotylabs%22%29%3B%0A%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Eplotylabs%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20xRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22x%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20yRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22y%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%60rotate%28%2D90%2C%20%24%7BxRot%7D%2C%20%20%24%7ByRot%7D%20%29%60%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%2Cj%29%7B%20return%20%22translate%28%22%2B%28left%5Fmargin%20%2D%20left%5Fmargin%2A0%2E5%29%2B%22%2C%22%2B%28y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%20%2B%20plot%5Fshift%5Fg%29%2B%22%29%22%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2D%22%2B%22bar%2Daxis%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22plotxis%22%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Edata%28allData%5Bi%5D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%20%2B%20plot%5Fshift%5Fg%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2Cplot%5Fheight%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20function%28d%2Ci%29%7Breturn%20%28left%5Fmargin%20%2B%20i%2Aloci%5Fwidth%29%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2C%20loci%5Fwidth%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22white%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%2Dopacity%22%2C0%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22barplot%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20%22bar%2D%22%2Bdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Edata%28allData%5Bi%5D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2Cplot%5Fheight%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20function%28d%2Ci%29%7Breturn%20%28left%5Fmargin%20%2B%20i%2Aloci%5Fwidth%29%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20loci%5Fwidth%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22white%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22barplot%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20div%5Fid%2B%22%2D%22%2B%22bar%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%2F%2A%20logic%20for%20bar%20ends%20%2A%2F%0A%20%20%20%20%20%20%20%20%20%20%2F%2A%20logic%20for%20scatter%2A%2F%0A%20%20%20%20%20%20%20%20%20if%28plots%3D%3D%22scatter%22%29%7B%0A%20%20%20%20%20%20%20%20%20%20if%28%21display%5Fchr%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%20ch%5Fwidth%20%2B%2010%20%2B%20plot%5Fshift%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20sc%5Fy%3Dy%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B7%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%20%2B%20plot%5Fshift%5Fg%3B%0A%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20if%28make%5Fplot%5Fy%5Flabs%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2Cplot%5Fy%5Flab%5Fx%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2Csc%5Fy%2Bplot%5Fy%5Flab%5Fy%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20plot%5Fy%5Flab%5Fsize%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Etext%28plot%5Fy%5Flabs%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22plotylabs%22%29%3B%0A%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Eplotylabs%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20xRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22x%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20yRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22y%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%60rotate%28%2D90%2C%20%24%7BxRot%7D%2C%20%20%24%7ByRot%7D%20%29%60%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%7D%0A%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%2Cj%29%7B%20return%20%22translate%28%22%2B%28left%5Fmargin%20%2D%20left%5Fmargin%2A0%2E5%29%2B%22%2C%22%2B%28sc%5Fy%29%2B%22%29%22%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2D%22%2B%22sc%2Daxis%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22plotxis%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20test%20%3D%20svg%2EselectAll%28%22scss%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Edata%28allData%5Bi%5D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%2Cj%29%7B%20return%20%22translate%28%22%2B%28left%5Fmargin%20%2B%20j%2Aloci%5Fwidth%29%2B%22%2C%22%2Bsc%5Fy%2B%22%29%22%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20%22sc%2D%22%2Bdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22scplot%22%29%3B%0A%0A%0A%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%2F%2A%20logic%20for%20scatter%20ends%20%2A%2F%0A%20%20%20%20%20%20%20%20%20%20%2F%2A%20logic%20for%202d%20genome%2A%2F%0A%20%20%20%20%20%20%20%20%20if%28plots%3D%3D%222d%22%29%7B%0A%20%20%20%20%20%20%20%20%20%20if%28%21display%5Fchr%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%20ch%5Fwidth%20%2B%2010%20%2B%20plot%5Fshift%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20sc%5Fy%3Dy%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B7%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%20%2B%20plot%5Fshift%5Fg%3B%0A%20%20%20%20%20%20%20%20%20%20if%28make%5Fplot%5Fy%5Flabs%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2Cplot%5Fy%5Flab%5Fx%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2Csc%5Fy%2Bplot%5Fy%5Flab%5Fy%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20plot%5Fy%5Flab%5Fsize%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Etext%28plot%5Fy%5Flabs%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22plotylabs%22%29%3B%0A%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Eplotylabs%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20xRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22x%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20yRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22y%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%60rotate%28%2D90%2C%20%24%7BxRot%7D%2C%20%20%24%7ByRot%7D%20%29%60%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%2Cj%29%7B%20return%20%22translate%28%22%2B%28left%5Fmargin%20%2D%20left%5Fmargin%2A0%2E5%29%2B%22%2C%22%2B%28sc%5Fy%29%2B%22%29%22%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2D%22%2B%22g2d%2Daxis%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22plotxis%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20test%20%3D%20svg%2EselectAll%28%22g2dd%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Edata%28allData%5Bi%5D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%2Cj%29%7B%20return%20%22translate%28%22%2B%28left%5Fmargin%20%2B%20j%2Aloci%5Fwidth%29%2B%22%2C%22%2Bsc%5Fy%2B%22%29%22%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20%22g2d%2D%22%2Bdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22g2dplot%22%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%0A%0A%0A%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%2F%2A%20logic%20for%202dg%20ends%20%2A%2F%0A%20%20%20%20%20%20%20%20%20%20%2F%2A%20logic%20for%20tags%2A%2F%0A%20%20%20%20%20%20%20%20%20%20if%28plots%3D%3D%22tags%22%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%28%21display%5Fchr%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%20ch%5Fwidth%20%2B%2010%20%2B%20plot%5Fshift%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20sc%5Fy%3Dy%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%20%2B%20plot%5Fshift%5Fg%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20if%28make%5Fplot%5Fy%5Flabs%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2Cplot%5Fy%5Flab%5Fx%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2Csc%5Fy%2Bplot%5Fy%5Flab%5Fy%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20plot%5Fy%5Flab%5Fsize%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Etext%28plot%5Fy%5Flabs%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22plotylabs%22%29%3B%0A%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Eplotylabs%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20xRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22x%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20yRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22y%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%60rotate%28%2D90%2C%20%24%7BxRot%7D%2C%20%20%24%7ByRot%7D%20%29%60%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20var%20test%20%3D%20svg%2EselectAll%28%22tagss%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Edata%28allData%5Bi%5D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%2Cj%29%7B%20return%20%22translate%28%22%2B%28left%5Fmargin%20%2B%20j%2Aloci%5Fwidth%29%2B%22%2C%22%2Bsc%5Fy%2B%22%29%22%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20%22tags%2D%22%2Bdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22tags%22%29%3B%0A%0A%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%2F%2A%20logic%20for%20tage%20ends%20%2A%2F%0A%0A%0A%0A%20%20%20%20%20%20%20%20%7D%20%2F%2Fend%20of%20for%0A%0A%7D%20else%20%7B%0A%20%20%2F%2A%2A%20%20without%20centromere%2A%2F%0A%20%20var%20allData%20%3D%5B%5D%3B%0A%0A%20%20%20%20for%28i%3D0%3Bi%20%3C%20nLoci%2Elength%3Bi%2B%2B%29%7B%0A%0A%20%20%20%20%20%20%20%20%20allData%5Bi%5D%3Dd3%2Erange%28nLoci%5Bi%5D%2En%29%3B%0A%0A%20%20%20%20%7D%0A%0A%0A%20%20for%28i%3D0%3Bi%3C%20nLoci%2Elength%3Bi%2B%2B%29%7B%0A%0A%20%20%20%20if%28display%5Fchr%29%7B%0A%20%20%20%20%2F%2A%20%20first%20cap%20%2A%2F%0A%20%20%20%20posx%3Dleft%5Fmargin%3B%0A%20%20%20%20posy%3Dy%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%20%2B%20plot%5Fspacing%29%20%3B%0A%0A%20%20%20%20if%28%21v%29%7B%0A%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bposx%2B%22%2C%22%2Bposy%2B%22%29%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B1%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20rounded%5Frect%280%2C%200%2C%20loci%5Fwidth%2C%20ch%5Fwidth%2Cch%5Fcurve%2C%20true%2Cfalse%2Ctrue%2Cfalse%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bposy%2B%22%2C%22%2Bposx%2B%22%29%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2CnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B1%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20rounded%5Frect%280%2C%200%2C%20loci%5Fwidth%2C%20ch%5Fwidth%2Cch%5Fcurve%2C%20true%2Cfalse%2Ctrue%2Cfalse%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2A%20%20p%20arm%20%2A%2F%0A%0A%20%20%20%20if%28%21v%29%7B%0A%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Edata%28allData%5Bi%5D%2Eslice%281%2CallData%5Bi%5D%2Elength%2D1%29%29%0A%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20ch%5Fwidth%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20function%28d%2Ci%29%7Breturn%20%28left%5Fmargin%20%2B%20loci%5Fwidth%20%2B%20i%2Aloci%5Fwidth%29%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2C%20loci%5Fwidth%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20div%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B2%29%2B%22%2D%22%2Bploidy%3B%7D%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%20%2Edata%28allData%5Bi%5D%2Eslice%281%2CallData%5Bi%5D%2Elength%2D1%29%29%0A%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%29%0A%20%20%20%20%20%20%2Eattr%28%22width%22%2C%20ch%5Fwidth%29%0A%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20function%28d%2Ci%29%7Breturn%20%28left%5Fmargin%20%2B%20loci%5Fwidth%20%2B%20i%2Aloci%5Fwidth%29%3B%7D%29%0A%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20loci%5Fwidth%29%0A%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22chLoc%22%29%0A%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20nLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B2%29%2B%22%2D%22%2Bploidy%3B%7D%29%3B%0A%20%20%20%20%7D%0A%0A%0A%0A%20%20%20%20%20%20%2F%2Flabellings%0A%20%20%20%20%20%20if%28%21v%29%7B%0A%20%20%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Etexts%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Edata%28allData%5Bi%5D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22labels%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20%28y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%20%2B%20plot%5Fspacing%29%29%2D2%20%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20function%28d%2Ci%29%7Breturn%20left%5Fmargin%20%2B%20i%2Aloci%5Fwidth%20%2B%20%28loci%5Fwidth%2F2%29%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7Breturn%20div%5Fid%2B%22%2D%22%2B%22L%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%2Etext%28%22%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20label%5Ffont%29%0A%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22start%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Etexts%22%29%0A%20%20%20%20%20%20%20%20%2Edata%28allData%5Bi%5D%29%0A%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22labels%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7Breturn%20%22L%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%2Etext%28%22%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20%229px%22%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%2Eattr%28%22transform%22%2Cfunction%28d%2Cj%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%22translate%28%22%20%2B%20%28%28y%5Fval%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B1%20%29%29%2D2%29%20%2B%20%22%2C%20%22%2B%28left%5Fmargin%20%2B%20j%2Aloci%5Fwidth%29%2B%22%29%20%22%20%2B%20%22rotate%28%2D90%29%22%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%0A%20%20%20%20%20%2F%2A%20%20%20final%20cap%20%2A%2F%0A%20%20%20%20%20%20posx%3Dleft%5Fmargin%2Bloci%5Fwidth%20%2B%28nLoci%5Bi%5D%2En%2D2%29%2Aloci%5Fwidth%3B%0A%20%20%20%20%20%20posy%3Dy%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%2B%20%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%3B%0A%0A%20%20%20%20%20%20if%28%21v%29%7B%0A%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bposx%2B%22%2C%22%2Bposy%2B%22%29%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%20allData%5Bi%5D%2Elength%20%20%20%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20rounded%5Frect%280%2C%200%2C%20loci%5Fwidth%2C%20ch%5Fwidth%2Cch%5Fcurve%2C%20false%2Ctrue%2Cfalse%2Ctrue%29%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2Bposy%2B%22%2C%22%2Bposx%2B%22%29%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20chr%5Fcolor%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2CnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%20allData%5Bi%5D%2Elength%20%20%20%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20rounded%5Frect%280%2C%200%2C%20loci%5Fwidth%2C%20ch%5Fwidth%2Cch%5Fcurve%2C%20false%2Ctrue%2Cfalse%2Ctrue%29%29%3B%0A%20%20%7D%0A%0A%20%20if%28%21v%29%7B%0A%0A%20%20%20%20%20%20%20%20if%28ch%5Ftext%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2Cleft%5Fmargin%2A0%2E5%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C10%2By%5Fval%20%2B%20plot%5Fspacing%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%20%2B%20plot%5Fspacing%29%20%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20text%5Ffont%5Fsize%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Etext%28nLoci%5Bi%5D%2Ename%29%3B%0A%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28ch%5Ftext%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2Cleft%5Fmargin%2A0%2E75%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2Cy%5Fval%20%2B%20i%2Achr%5Fspacing%20%2Barc%5Fradius%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B2%20%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20%229px%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Etext%28nLoci%5Bi%5D%2Ename%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%0A%2F%2A%20end%20of%20visible%20chr%2A%2F%0A%20%20%20%20%7D%0A%0Aif%28plots%3D%3D%22bar%22%29%7B%0A%20%20%20%2F%2A%20logic%20for%20bar%2A%2F%0A%20%20%20if%28%21display%5Fchr%29%7B%0A%20%20%20%20%20plot%5Fshift%5Fg%20%3D%20ch%5Fwidth%20%2B%2010%20%2B%20plot%5Fshift%3B%0A%20%20%20%7D%20else%20%7B%0A%20%20%20%20plot%5Fshift%5Fg%20%3D%200%3B%0A%20%20%7D%0A%20%20%20if%28%21v%29%7B%0A%20%20%20%20if%28make%5Fplot%5Fy%5Flabs%29%7B%0A%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2Cplot%5Fy%5Flab%5Fx%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%28y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%20%2B%20plot%5Fshift%5Fg%29%20%2B%20plot%5Fy%5Flab%5Fy%20%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20plot%5Fy%5Flab%5Fsize%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%2Etext%28plot%5Fy%5Flabs%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22plotylabs%22%29%3B%0A%0A%20%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Eplotylabs%22%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20xRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22x%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20yRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22y%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20%60rotate%28%2D90%2C%20%24%7BxRot%7D%2C%20%20%24%7ByRot%7D%20%29%60%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%7D%0A%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%2Cj%29%7B%20return%20%22translate%28%22%2B%28left%5Fmargin%20%2D%20left%5Fmargin%2A0%2E5%29%2B%22%2C%22%2B%28y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%20%2B%20plot%5Fshift%5Fg%20%29%2B%22%29%22%3B%7D%29%0A%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2D%22%2B%22bar%2Daxis%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22plotxis%22%29%3B%0A%0A%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%2Edata%28allData%5Bi%5D%29%0A%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%2Eattr%28%22y%22%2C%20y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%20%2B%20plot%5Fshift%5Fg%20%29%0A%20%20%20%20%20%2Eattr%28%22height%22%2Cplot%5Fheight%29%0A%20%20%20%20%20%2Eattr%28%22x%22%2C%20function%28d%2Ci%29%7Breturn%20%28left%5Fmargin%20%2B%20i%2Aloci%5Fwidth%29%3B%7D%29%0A%20%20%20%20%20%2Eattr%28%22width%22%2C%20loci%5Fwidth%29%0A%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22white%22%29%0A%20%20%20%20%20%2Eattr%28%22fill%2Dopacity%22%2C0%29%0A%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22barplot%22%29%0A%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20%22bar%2D%22%2Bdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%2Edata%28allData%5Bi%5D%29%0A%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%2Eattr%28%22x%22%2C%20y%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%29%0A%20%20%20%20%20%2Eattr%28%22width%22%2Cplot%5Fheight%29%0A%20%20%20%20%20%2Eattr%28%22y%22%2C%20function%28d%2Ci%29%7Breturn%20%28left%5Fmargin%20%2B%20i%2Aloci%5Fwidth%29%3B%7D%29%0A%20%20%20%20%20%2Eattr%28%22height%22%2C%20loci%5Fwidth%29%0A%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22white%22%29%0A%20%20%20%20%20%2Eattr%28%22class%22%2C%22barplot%22%29%0A%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20%22bar%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%3B%0A%20%20%20%20%7D%0A%7D%0A%0A%20%20%20%2F%2A%20logic%20for%20bar%20ends%20%2A%2F%0A%20%20%20%2F%2A%20logic%20for%20scatter%2A%2F%0A%20%20if%28plots%3D%3D%22scatter%22%29%7B%0A%20%20%20%20if%28%21display%5Fchr%29%7B%0A%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%20ch%5Fwidth%20%2B%2010%20%2B%20plot%5Fshift%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%200%3B%0A%20%20%20%20%7D%0A%0A%20%20%20sc%5Fy%3Dy%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B7%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%20%2B%20plot%5Fshift%5Fg%3B%0A%0A%20%20if%28make%5Fplot%5Fy%5Flabs%29%7B%0A%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%2Eattr%28%22x%22%2Cplot%5Fy%5Flab%5Fx%29%0A%20%20%20%20%20%20%20%2Eattr%28%22y%22%2Csc%5Fy%2Bplot%5Fy%5Flab%5Fy%29%0A%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20plot%5Fy%5Flab%5Fsize%29%0A%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%2Etext%28plot%5Fy%5Flabs%29%0A%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22plotylabs%22%29%3B%0A%0A%20%20%20%20svg%2EselectAll%28%22%2Eplotylabs%22%29%0A%20%20%20%20%2Eattr%28%22transform%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20var%20xRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22x%22%29%3B%0A%20%20%20%20%20var%20yRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22y%22%29%3B%0A%20%20%20%20%20return%20%60rotate%28%2D90%2C%20%24%7BxRot%7D%2C%20%20%24%7ByRot%7D%20%29%60%0A%20%20%20%20%20%7D%29%3B%7D%0A%0A%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%2Cj%29%7B%20return%20%22translate%28%22%2B%28left%5Fmargin%20%2D%20left%5Fmargin%2A0%2E5%29%2B%22%2C%22%2B%28sc%5Fy%29%2B%22%29%22%3B%7D%29%0A%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2D%22%2B%22sc%2Daxis%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22plotxis%22%29%3B%0A%20%20%20var%20test%20%3D%20svg%2EselectAll%28%22scss%22%29%0A%20%20%20%20%20%2Edata%28allData%5Bi%5D%29%0A%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%2Eappend%28%22g%22%29%0A%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%2Cj%29%7B%20return%20%22translate%28%22%2B%28left%5Fmargin%20%2B%20j%2Aloci%5Fwidth%29%2B%22%2C%22%2Bsc%5Fy%2B%22%29%22%3B%7D%29%0A%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20%22sc%2D%22%2Bdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%0A%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22scplot%22%29%3B%0A%0A%0A%7D%0A%0A%20%20%20%2F%2A%20logic%20for%20scatter%20ends%20%2A%2F%0A%0A%20%20%20%2F%2A%20logic%20for%20genome%202d%2A%2F%0A%20%20if%28plots%3D%3D%222d%22%29%7B%0A%20%20%20%20if%28%21display%5Fchr%29%7B%0A%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%20ch%5Fwidth%20%2B%2010%20%2B%20plot%5Fshift%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%200%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20sc%5Fy%3Dy%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B7%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%20%2B%20plot%5Fshift%5Fg%3B%0A%20%0A%20%20%20if%28make%5Fplot%5Fy%5Flabs%29%7B%0A%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2Cplot%5Fy%5Flab%5Fx%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2Csc%5Fy%2Bplot%5Fy%5Flab%5Fy%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20plot%5Fy%5Flab%5Fsize%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%2Etext%28plot%5Fy%5Flabs%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22plotylabs%22%29%3B%0A%20%0A%20%20%20%20%20svg%2EselectAll%28%22%2Eplotylabs%22%29%0A%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20var%20xRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22x%22%29%3B%0A%20%20%20%20%20%20var%20yRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22y%22%29%3B%0A%20%20%20%20%20%20return%20%60rotate%28%2D90%2C%20%24%7BxRot%7D%2C%20%20%24%7ByRot%7D%20%29%60%0A%20%20%20%20%20%20%7D%29%3B%7D%0A%20%0A%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%2Cj%29%7B%20return%20%22translate%28%22%2B%28left%5Fmargin%20%2D%20left%5Fmargin%2A0%2E5%29%2B%22%2C%22%2B%28sc%5Fy%29%2B%22%29%22%3B%7D%29%0A%20%20%20%20%20%2Eattr%28%22id%22%2Cdiv%5Fid%2B%22%2D%22%2B%22g2d%2Daxis%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22plotxis%22%29%3B%0A%20%20%20%20var%20test%20%3D%20svg%2EselectAll%28%22g2dd%22%29%0A%20%20%20%20%20%20%2Edata%28allData%5Bi%5D%29%0A%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%2Cj%29%7B%20return%20%22translate%28%22%2B%28left%5Fmargin%20%2B%20j%2Aloci%5Fwidth%29%2B%22%2C%22%2Bsc%5Fy%2B%22%29%22%3B%7D%29%0A%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20%22g2d%2D%22%2Bdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%0A%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22g2dplot%22%29%3B%0A%20%0A%20%0A%20%7D%0A%20%0A%20%20%20%20%2F%2A%20logic%20for%20genome%202d%20ends%20%2A%2F%0A%20%20%20%2F%2A%20logic%20for%20tags%2A%2F%0A%20%20%20if%28plots%3D%3D%22tags%22%29%7B%0A%20%20%20%20if%28%21display%5Fchr%29%7B%0A%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%20ch%5Fwidth%20%2B%2010%20%2B%20plot%5Fshift%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20plot%5Fshift%5Fg%20%3D%200%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20sc%5Fy%3Dy%5Fval%20%2B%20plot%5Fspacing%20%2B%20i%2Achr%5Fspacing%20%2B%20%28ploidy%20%2D%201%29%2A%28ch%5Fwidth%20%2B3%2B%20plot%5Fspacing%20%29%20%2D%20plot%5Fspacing%20%2B%20plot%5Fshift%5Fg%3B%0A%20%20%20%20if%28make%5Fplot%5Fy%5Flabs%29%7B%0A%20%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2Cplot%5Fy%5Flab%5Fx%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2Csc%5Fy%2Bplot%5Fy%5Flab%5Fy%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20plot%5Fy%5Flab%5Fsize%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Etext%28plot%5Fy%5Flabs%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22plotylabs%22%29%3B%0A%20%20%20%0A%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Eplotylabs%22%29%0A%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20var%20xRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22x%22%29%3B%0A%20%20%20%20%20%20%20%20var%20yRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22y%22%29%3B%0A%20%20%20%20%20%20%20%20return%20%60rotate%28%2D90%2C%20%24%7BxRot%7D%2C%20%20%24%7ByRot%7D%20%29%60%0A%20%20%20%20%20%20%20%20%7D%29%3B%7D%0A%20%20%20%20var%20test%20%3D%20svg%2EselectAll%28%22tagss%22%29%0A%20%20%20%20%20%20%2Edata%28allData%5Bi%5D%29%0A%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%28d%2Cj%29%7B%20return%20%22translate%28%22%2B%28left%5Fmargin%20%2B%20j%2Aloci%5Fwidth%29%2B%22%2C%22%2Bsc%5Fy%2B%22%29%22%3B%7D%29%0A%20%20%20%20%20%20%2Eattr%28%22id%22%2Cfunction%28d%2Cj%29%7B%20return%20%22tags%2D%22%2Bdiv%5Fid%2B%22%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2B%28j%2B1%29%2B%22%2D%22%2Bploidy%3B%7D%29%0A%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22tags%22%29%3B%0A%0A%0A%20%7D%0A%20%20%20%2F%2A%20logic%20for%20tage%20ends%20%2A%2F%0A%0A%20%20%20%20%7D%20%2F%2Fend%20of%20for%0A%0A%0A%7D%20%2F%2F%20end%20of%20render%20code%0A%0A%2F%2Fvar%20linking%20%3D%20false%3B%0A%2F%2F%20code%20for%20linking%20loci%0Aif%28show%5Flinks%29%7B%0Aif%28ploidy%3D%3Dploidy%5Fn%29%7B%0Aif%28%21seg%5Fanno%29%7B%0A%2F%2Fconsole%2Elog%28loci%5Flinks%5B0%5D%2Esrc%5Floci%29%0Avar%20loci%5Flinks%5Fcoords%20%3D%20%5B%5D%3B%0Aconsole%2Elog%28loci%5Flinks%29%3B%0Afor%28var%20tk%3D0%3Btk%3Cloci%5Flinks%2Elength%3Btk%2B%2B%29%7B%0A%20%20let%20sx%2Csy%2Ctx%2Cty%3B%0A%20%20if%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci%29%2Enode%28%29%2EnodeName%20%3D%3D%3D%20%22rect%22%29%7B%0A%20%20%20sx%20%3D%20parseFloat%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci%29%2Eattr%28%22x%22%29%29%3B%0A%20%20%20sy%20%3D%20parseFloat%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci%29%2Eattr%28%22y%22%29%29%3B%0A%20%20%7D%20else%20if%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci%29%2Enode%28%29%2EnodeName%20%3D%3D%3D%20%22path%22%29%7B%0A%20%20%20%20sx%20%3D%20%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci%29%2Enode%28%29%2EgetBoundingClientRect%28%29%2Ex%0A%20%20%20%20%2D%2010%29%3B%0A%20%20%20%20sy%20%3D%20%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci%29%2Enode%28%29%2EgetBoundingClientRect%28%29%2Ey%0A%20%20%20%20%2D%2010%29%3B%0A%20%20%7D%0A%20%20if%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci%29%2Enode%28%29%2EnodeName%20%3D%3D%3D%20%22rect%22%29%7B%0A%20%20%20tx%20%3D%20parseFloat%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci%29%2Eattr%28%22x%22%29%29%3B%0A%20%20%20ty%20%3D%20parseFloat%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci%29%2Eattr%28%22y%22%29%29%3B%0A%20%20%7D%20else%20if%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci%29%2Enode%28%29%2EnodeName%20%3D%3D%3D%20%22path%22%29%7B%0A%20%20%20%20tx%20%3D%20%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci%29%2Enode%28%29%2EgetBoundingClientRect%28%29%2Ex%0A%20%20%20%20%2D%2010%29%3B%0A%20%20%20%20ty%20%3D%20%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci%29%2Enode%28%29%2EgetBoundingClientRect%28%29%2Ey%0A%20%20%20%20%2D%2010%29%3B%0A%20%20%7D%0A%20%20%2F%2Flet%20sx%5Fcurve%20%3D%20d3%2Eselect%28%22%23chromap%2Dchr2%2D1%2D1%22%29%2Enode%28%29%2EgetBoundingClientRect%28%29%3B%0A%20%20let%20gg%20%3D%20%7B%7D%3B%0A%20%20if%28sy%20%3E%20ty%29%7B%0A%20%20gg%20%3D%20%7B%0A%20%20x%3A%5Bsx%2Bloci%5Fwidth%2F2%2Csy%5D%2C%0A%20%20y%3A%5Btx%2Bloci%5Fwidth%2F2%2Cty%2Bch%5Fwidth%5D%2C%0A%20%20nm%3Aloci%5Flinks%5Btk%5D%2Elnk%5Fnm%2C%0A%20%20dt%3Aloci%5Flinks%5Btk%5D%2Elink%5Fdata%0A%20%20%7D%0A%7D%20else%20if%28sy%20%3C%20ty%29%7B%0A%20%20gg%20%3D%20%7B%0A%20%20%20%20x%3A%5Bsx%2Bloci%5Fwidth%2F2%2Csy%2Bch%5Fwidth%5D%2C%0A%20%20%20%20y%3A%5Btx%2Bloci%5Fwidth%2F2%2Cty%5D%2C%0A%20%20%20%20nm%3Aloci%5Flinks%5Btk%5D%2Elnk%5Fnm%2C%0A%20%20%20%20dt%3Aloci%5Flinks%5Btk%5D%2Elink%5Fdata%0A%20%20%20%20%7D%0A%7D%20else%20%7B%0A%20%20gg%20%3D%20%7B%0A%20%20%20%20x%3A%5Bsx%2Bloci%5Fwidth%2F2%2Csy%5D%2C%0A%20%20%20%20y%3A%5Btx%2Bloci%5Fwidth%2F2%2Cty%5D%2C%0A%20%20%20%20nm%3Aloci%5Flinks%5Btk%5D%2Elnk%5Fnm%2C%0A%20%20%20%20dt%3Aloci%5Flinks%5Btk%5D%2Elink%5Fdata%0A%20%20%20%20%7D%0A%7D%0A%0A%20%20loci%5Flinks%5Fcoords%2Epush%28gg%29%3B%0A%7D%0A%2F%2Fconsole%2Elog%28loci%5Flinks%5Fcoords%29%0A%0Avar%20dt%5Fvals%20%3D%20%5B%5D%3B%0Afor%28var%20i%3D0%3Bi%3Cloci%5Flinks%5Fcoords%2Elength%3Bi%2B%2B%29%7B%0A%20%20dt%5Fvals%2Epush%28loci%5Flinks%5Fcoords%5Bi%5D%2Edt%29%0A%7D%0A%0A%0A%2F%2Fvar%20directed%5Fedges%20%3D%20false%3B%0A%2F%2F%20directed%20edges%0Asvg%2Eappend%28%27defs%27%29%2Eappend%28%27marker%27%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%27refX%27%2C13%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%27refY%27%2C0%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%27orient%27%2C%27auto%27%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%27markerWidth%27%2C10%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%27markerHeight%27%2C10%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%27xoverflow%27%2C%27visible%27%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%27viewBox%27%2C%27%2D0%20%2D5%2010%2010%27%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%27id%27%2C%27arrowhead%27%29%0A%20%20%20%20%20%20%20%20%2Eappend%28%27svg%3Apath%27%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%27d%27%2C%20%27M%200%2C%2D5%20L%2010%20%2C0%20L%200%2C5%27%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%27fill%27%2C%20%27grey%27%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%27stroke%27%2C%27none%27%29%3B%0A%0A%2F%2F%20string%20or%20number%0Aconst%20curve%20%3D%20d3%2Eline%28%29%2Ecurve%28d3%2EcurveNatural%29%3B%0Avar%20link%5Fcol%5Ffn%3B%0Aif%28links%5Fcolor%5Fmaps%29%7B%0Aif%28typeof%20dt%5Fvals%5B0%5D%20%3D%3D%20%22string%22%29%7B%0Avar%20flags%20%3D%20%5B%5D%2C%20uniq%5Fvals%20%3D%20%5B%5D%3B%0Afor%28%20var%20i%3D0%3B%20i%3Cloci%5Flinks%5Fcoords%2Elength%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20if%28%20flags%5Bloci%5Flinks%5Fcoords%5Bi%5D%2Edt%5D%29%20continue%3B%0A%20%20%20%20flags%5Bloci%5Flinks%5Fcoords%5Bi%5D%2Edt%5D%20%3D%20true%3B%0A%20%20%20%20uniq%5Fvals%2Epush%28loci%5Flinks%5Fcoords%5Bi%5D%2Edt%29%3B%0A%7D%0A%0Auniq%5Fvals%20%3D%20uniq%5Fvals%2Esort%28%29%3B%0Alink%5Fcol%5Ffn%20%3D%20d3%2EscaleOrdinal%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Edomain%28uniq%5Fvals%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Erange%28links%5Fcolors%29%3B%0A%0A%20%20w22%3Duniq%5Fvals%2Elength%2A20%3B%0A%20%20%2F%2F%20Create%20scale%0A%0A%20%20var%20scalelinks%20%3D%20d3%2EscaleBand%28%29%0A%20%20%2Edomain%28uniq%5Fvals%29%0A%20%20%2Erange%28%5B2%2Cw22%5D%29%3B%0A%0A%20%20%2F%2F%20Add%20scales%20to%20axis%0A%20%20var%20legendlinks%5Fcat%20%3D%20d3%2EaxisRight%28%29%0A%20%20%2Escale%28scalelinks%29%2EtickSizeOuter%280%29%3B%0A%0A%0A%20%20%2F%2FAppend%20group%20and%20insert%20axis%0A%20%20svg%2Eappend%28%22g%22%29%0A%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2B%28%28width%2D35%29%2Dlinks%5Flg%5Fx%29%2B%22%2C%22%20%2B%20%28%28height%2D100%29%2Dlinks%5Flg%5Fy%20%29%2B%20%22%29%22%29%0A%20%20%2Eattr%28%22class%22%2C%22scatter%5Flegend%22%29%0A%20%20%2Ecall%28legendlinks%5Fcat%29%3B%0A%0A%20%20svg%2Eselect%28%22%2Escatter%5Flegend%22%29%2Estyle%28%22font%2Dsize%22%2C%2215px%22%29%3B%0A%0A%20%20rec%5Fh22%3Dw22%2Funiq%5Fvals%2Elength%3B%0A%20%20%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%20%2Edata%28links%5Fcolors%29%0A%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20function%28d%2Ci%29%7Breturn%20%28%28%28height%2D99%29%2Dlinks%5Flg%5Fy%29%2Bi%2Arec%5Fh22%29%3B%7D%29%0A%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20rec%5Fh22%29%0A%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20function%28d%2Ci%29%7Breturn%20%28%28width%2D45%29%2Dlinks%5Flg%5Fx%29%3B%7D%29%0A%20%20%20%20%20%20%2Eattr%28%22width%22%2C%2010%29%0A%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20function%28d%29%7Breturn%20d%3B%7D%29%3B%0A%0A%0A%0A%0A%7D%20else%20if%28typeof%20dt%5Fvals%5B0%5D%20%3D%3D%20%22number%22%29%7B%0A%0A%20%20link%5Fcol%5Ffn%20%3D%20d3%2EscaleLinear%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Edomain%28d3%2Eextent%28dt%5Fvals%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Erange%28links%5Fcolors%29%3B%0A%0Alink%5Flegend%5Fgrad%20%3D%20svg%2Eappend%28%22defs%22%29%2Eappend%28%22linearGradient%22%29%0A%2Eattr%28%22id%22%2C%20function%28d%29%7B%20return%20div%5Fid%2B%22%2D%22%2B%22linear%2Dgradient%2DLINK%2Dcont%22%3B%7D%29%0A%2Eattr%28%22x1%22%2C%20%220%25%22%29%0A%2Eattr%28%22y1%22%2C%20%220%25%22%29%0A%2Eattr%28%22x2%22%2C%20%220%25%22%29%0A%2Eattr%28%22y2%22%2C%20%22100%25%22%29%0A%2EselectAll%28%22stop%22%29%0A%2Edata%28%20link%5Fcol%5Ffn%2Erange%28%29%20%29%0A%2Eenter%28%29%2Eappend%28%22stop%22%29%0A%2Eattr%28%22offset%22%2C%20function%28d%2Ci%29%20%7B%20return%20i%2F%28link%5Fcol%5Ffn%2Erange%28%29%2Elength%2D1%29%3B%20%7D%29%0A%2Eattr%28%22stop%2Dcolor%22%2C%20function%28d%29%20%7B%20return%20d%3B%20%7D%29%3B%0A%0Asvg%2Eappend%28%27rect%27%29%0A%20%20%20%20%20%20%2Eattr%28%22height%22%2C100%29%2Eattr%28%22width%22%2C10%29%2Eattr%28%22y%22%2C%28%28height%2D99%29%2Dlinks%5Flg%5Fy%29%29%0A%20%20%20%20%20%20%2Eattr%28%22x%22%2C%28%28width%2D45%2D%281%2A50%29%29%2Dlinks%5Flg%5Fx%29%29%0A%20%20%20%20%20%20%2Eattr%28%22class%22%2Cfunction%28d%29%7Breturn%20%22lg%5Floci%22%3B%7D%29%0A%20%20%20%20%20%20%2Estyle%28%22fill%22%2C%20%22url%28%23%22%2Bdiv%5Fid%2B%22%2D%22%2B%22linear%2Dgradient%2DLINK%2Dcont%29%22%29%3B%0A%0Alet%20locirng%20%3D%20%5Bd3%2Emin%28dt%5Fvals%29%2Cd3%2Emean%28dt%5Fvals%29%2Cd3%2Emax%28dt%5Fvals%29%5D%3B%0Asvg%2EselectAll%28%22%2Etexts%22%29%0A%2Edata%28d3%2Erange%283%29%29%0A%2Eenter%28%29%0A%2Eappend%28%22text%22%29%0A%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22labels%2Dlinks%22%29%0A%2Etext%28function%28i%29%7B%20return%20locirng%5Bi%5D%2EtoFixed%281%29%3B%7D%29%0A%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%2Eattr%28%22font%2Dsize%22%2C%20%229px%22%29%0A%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%2Eattr%28%22transform%22%2Cfunction%28d%2Cj%29%7B%0A%20%20%20%20return%20%22translate%28%22%20%2B%28%28width%2D32%2D%281%2A50%29%29%2Dlinks%5Flg%5Fx%29%2B%22%2C%22%20%2B%20%28%28height%2D94%2B%28j%2A48%29%29%2Dlinks%5Flg%5Fy%20%20%29%2B%20%22%29%22%7D%29%3B%0A%0A%7D%0A%7D%0Avar%20links%5Ftip%20%20%3D%20d3%2Eselect%28%22body%22%29%2Eappend%28%22div%22%29%0A%20%20%20%20%20%2Eattr%28%22class%22%2C%20div%5Fid%2B%22%2D%22%2B%22linkstooltip%22%29%0A%20%20%20%20%20%2Estyle%28%22opacity%22%2C%200%29%0A%20%20%20%20%20%2Eattr%28%22style%22%2C%20%22position%3A%20absolute%3Btext%2Dalign%3A%20center%3Bwidth%3A%20100px%3Bheight%3A%2050px%3B%09%20padding%3A%202px%3B%09font%3A%2012px%20sans%2Dserif%3B%09box%2Dsizing%3A%20border%2Dbox%3B%09border%3A%200px%3Bborder%2Dradius%3A%208px%3Bpointer%2Devents%3A%20none%3B%22%29%20%3B%0A%0A%0Asvg%2EselectAll%28%22paths%22%29%0A%20%20%20%20%20%20%20%20%2Edata%28loci%5Flinks%5Fcoords%29%0A%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20function%28d%29%7B%0A%20%20%20%20%20%20%20%20if%28d%2Ex%5B1%5D%20%21%3D%20d%2Ey%5B1%5D%29%7B%0A%20%20%20%20%20%20%20%20return%20d3%2ElinkVertical%28%29%28%7B%0A%20%20%20%20%20%20%20%20%20%20source%3A%20d%2Ex%2C%0A%20%20%20%20%20%20%20%20%20%20target%3A%20d%2Ey%0A%20%20%20%20%20%20%20%20%7D%29%3B%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%28d%2Ex%5B0%5D%3Cd%2Ey%5B0%5D%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20dist%20%3D%20d%2Ey%5B0%5D%20%2D%20d%2Ex%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20d%5Fhalf%20%3D%20dist%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20d%5Fquat%20%3D%20d%5Fhalf%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20points%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ex%5B0%5D%2Cd%2Ex%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ex%5B0%5D%2Bd%5Fquat%2Cd%2Ex%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ex%5B0%5D%2Bd%5Fhalf%2Cd%2Ex%5B1%5D%2Dch%5Fgap%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ex%5B0%5D%2Bd%5Fhalf%2Bd%5Fquat%2Cd%2Ex%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ey%5B0%5D%2Cd%2Ey%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20curve%28points%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%28d%2Ex%5B0%5D%3Ed%2Ey%5B0%5D%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20dist%20%3D%20d%2Ex%5B0%5D%20%2D%20d%2Ey%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20d%5Fhalf%20%3D%20dist%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20d%5Fquat%20%3D%20d%5Fhalf%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20points%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ex%5B0%5D%2Cd%2Ex%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ex%5B0%5D%2Dd%5Fquat%2Cd%2Ex%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ex%5B0%5D%2Dd%5Fhalf%2Cd%2Ex%5B1%5D%2Dch%5Fgap%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ex%5B0%5D%2Dd%5Fhalf%2Dd%5Fquat%2Cd%2Ex%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ey%5B0%5D%2Cd%2Ey%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20curve%28points%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20points%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ex%5B0%5D%2Cd%2Ex%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ex%5B0%5D%2D15%2Cd%2Ex%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ex%5B0%5D%2Cd%2Ex%5B1%5D%2Dch%5Fgap%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ex%5B0%5D%2B15%2Cd%2Ex%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Ey%5B0%5D%2Cd%2Ey%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20curve%28points%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%2Eclassed%28%22link%22%2C%20true%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%22none%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%2Dwidth%22%2C%221%2E5%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%27marker%2Dend%27%2Cfunction%28d%29%7Bif%28directed%5Fedges%29%7B%20return%20%27url%28%23arrowhead%27%3B%7D%20else%20%7B%20return%20%22none%22%7D%7D%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%22%2Cfunction%28d%29%7B%20%20%20if%28links%5Fcolor%5Fmaps%29%7B%20return%20link%5Fcol%5Ffn%28d%2Edt%29%3B%7Delse%7Breturn%20links%5Fcolors%7D%7D%29%0A%20%20%20%20%20%20%20%20%2Eon%28%22mouseover%22%2C%20function%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20links%5Ftip%2Etransition%28%29%2Eduration%28200%29%2Estyle%28%22opacity%22%2C%20%2E9%29%2Estyle%28%22background%2Dcolor%22%2C%22%23F5F5F5%22%29%2Estyle%28%22width%22%2C100%2B%28d%2Edt%2Elength%2A3%29%2B%27px%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20links%5Ftip%2Ehtml%28%22link%3A%20%22%2Bd%2Enm%2B%22%3Cbr%3E%20value%3A%20%22%2Bd%2Edt%29%2Estyle%28%22left%22%2C%20%28d3%2Eevent%2EpageX%29%20%2B%20%22px%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22top%22%2C%20%28d3%2Eevent%2EpageY%20%2D%2018%29%20%2B%20%22px%22%29%3B%20d3%2Eselect%28this%29%2Eattr%28%22stroke%22%2C%22black%22%29%3B%0A%20%20%20%20%20%20%20%20%20%7D%29%2Eon%28%22mouseout%22%2C%20function%28d%29%20%7B%09links%5Ftip%2Etransition%28%29%20%2Edelay%281000%29%2Eduration%28500%29%09%2Estyle%28%22opacity%22%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20d3%2Eselect%28this%29%2Eattr%28%22stroke%22%2Cfunction%28d%29%7Bif%28links%5Fcolor%5Fmaps%29%7Breturn%20link%5Fcol%5Ffn%28d%2Edt%29%3B%7Delse%7B%20return%20links%5Fcolors%3B%7D%7D%29%3B%7D%29%3B%0A%20%20%20%20%7D%20%20else%20%7B%0A%0A%20%20%20%20%20%20%2F%2Flogic%20for%20chords%0A%20%20%20%20%20%20%2F%2Fconsole%2Elog%28loci%5Flinks%29%0Avar%20loci%5Flinks%5Fcoords%20%3D%20%5B%5D%3B%0A%0Afor%28var%20tk%3D0%3Btk%3Cloci%5Flinks%2Elength%3Btk%2B%2B%29%7B%0A%20%20let%20s1x%2Cs1y%2Ct1x%2Ct1y%2Cs2x%2Cs2y%2Ct2x%2Ct2y%3B%0A%20%20if%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci%29%2Enode%28%29%2EnodeName%20%3D%3D%3D%20%22rect%22%29%7B%0A%20%20%20s1x%20%3D%20parseFloat%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci%29%2Eattr%28%22x%22%29%29%3B%0A%20%20%20s1y%20%3D%20parseFloat%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci%29%2Eattr%28%22y%22%29%29%3B%0A%20%20%7D%20else%20if%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci%29%2Enode%28%29%2EnodeName%20%3D%3D%3D%20%22path%22%29%7B%0A%20%20%20%20s1x%20%3D%20%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci%29%2Enode%28%29%2EgetBoundingClientRect%28%29%2Ex%0A%20%20%20%20%2D%2010%29%3B%0A%20%20%20%20s1y%20%3D%20%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci%29%2Enode%28%29%2EgetBoundingClientRect%28%29%2Ey%0A%20%20%20%20%2D%2010%29%3B%0A%20%20%7D%0A%20%20if%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci2%29%2Enode%28%29%2EnodeName%20%3D%3D%3D%20%22rect%22%29%7B%0A%20%20%20%20s2x%20%3D%20parseFloat%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci2%29%2Eattr%28%22x%22%29%29%3B%0A%20%20%20%20s2y%20%3D%20parseFloat%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci2%29%2Eattr%28%22y%22%29%29%3B%0A%20%20%20%7D%20else%20if%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci2%29%2Enode%28%29%2EnodeName%20%3D%3D%3D%20%22path%22%29%7B%0A%20%20%20%20%20s2x%20%3D%20%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci2%29%2Enode%28%29%2EgetBoundingClientRect%28%29%2Ex%0A%20%20%20%20%20%2D%2010%29%3B%0A%20%20%20%20%20s2y%20%3D%20%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Esrc%5Floci2%29%2Enode%28%29%2EgetBoundingClientRect%28%29%2Ey%0A%20%20%20%20%20%2D%2010%29%3B%0A%20%20%20%7D%0A%20%20if%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci%29%2Enode%28%29%2EnodeName%20%3D%3D%3D%20%22rect%22%29%7B%0A%20%20%20t1x%20%3D%20parseFloat%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci%29%2Eattr%28%22x%22%29%29%3B%0A%20%20%20t1y%20%3D%20parseFloat%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci%29%2Eattr%28%22y%22%29%29%3B%0A%20%20%7D%20else%20if%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci%29%2Enode%28%29%2EnodeName%20%3D%3D%3D%20%22path%22%29%7B%0A%20%20%20%20t1x%20%3D%20%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci%29%2Enode%28%29%2EgetBoundingClientRect%28%29%2Ex%0A%20%20%20%20%2D%2010%29%3B%0A%20%20%20%20t1y%20%3D%20%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci%29%2Enode%28%29%2EgetBoundingClientRect%28%29%2Ey%0A%20%20%20%20%2D%2010%29%3B%0A%20%20%7D%0A%20%20if%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci2%29%2Enode%28%29%2EnodeName%20%3D%3D%3D%20%22rect%22%29%7B%0A%20%20%20%20t2x%20%3D%20parseFloat%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci2%29%2Eattr%28%22x%22%29%29%3B%0A%20%20%20%20t2y%20%3D%20parseFloat%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci2%29%2Eattr%28%22y%22%29%29%3B%0A%20%20%20%7D%20else%20if%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci2%29%2Enode%28%29%2EnodeName%20%3D%3D%3D%20%22path%22%29%7B%0A%20%20%20%20%20t2x%20%3D%20%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci2%29%2Enode%28%29%2EgetBoundingClientRect%28%29%2Ex%0A%20%20%20%20%20%2D%2010%29%3B%0A%20%20%20%20%20t2y%20%3D%20%28d3%2Eselect%28%22%23%22%2Bloci%5Flinks%5Btk%5D%2Etarg%5Floci2%29%2Enode%28%29%2EgetBoundingClientRect%28%29%2Ey%0A%20%20%20%20%20%2D%2010%29%3B%0A%20%20%20%7D%0A%20%20%2F%2Flet%20sx%5Fcurve%20%3D%20d3%2Eselect%28%22%23chromap%2Dchr2%2D1%2D1%22%29%2Enode%28%29%2EgetBoundingClientRect%28%29%3B%0A%20%20let%20gg%20%3D%20%7B%7D%3B%0A%20%20if%28s1y%20%3E%20t1y%29%7B%0A%20%20gg%20%3D%20%7B%0A%20%20s1%3A%5Bs1x%2Bloci%5Fwidth%2F2%2Cs1y%5D%2C%0A%20%20t1%3A%5Bt1x%2Bloci%5Fwidth%2F2%2Ct1y%2Bch%5Fwidth%5D%2C%0A%20%20s2%3A%5Bs2x%2Bloci%5Fwidth%2F2%2Cs2y%5D%2C%0A%20%20t2%3A%5Bt2x%2Bloci%5Fwidth%2F2%2Ct2y%2Bch%5Fwidth%5D%2C%0A%20%20nm%3Aloci%5Flinks%5Btk%5D%2Elnk%5Fnm%2C%0A%20%20dt%3Aloci%5Flinks%5Btk%5D%2Elink%5Fdata%0A%20%20%7D%0A%7D%20else%20if%28s1y%20%3C%20t1y%29%7B%0A%20%20gg%20%3D%20%7B%0A%20%20%20%20s1%3A%5Bs1x%2Bloci%5Fwidth%2F2%2Cs1y%2Bch%5Fwidth%5D%2C%0A%20%20%20%20t1%3A%5Bt1x%2Bloci%5Fwidth%2F2%2Ct1y%5D%2C%0A%20%20%20%20s2%3A%5Bs2x%2Bloci%5Fwidth%2F2%2Cs2y%2Bch%5Fwidth%5D%2C%0A%20%20%20%20t2%3A%5Bt2x%2Bloci%5Fwidth%2F2%2Ct2y%5D%2C%0A%20%20%20%20nm%3Aloci%5Flinks%5Btk%5D%2Elnk%5Fnm%2C%0A%20%20%20%20dt%3Aloci%5Flinks%5Btk%5D%2Elink%5Fdata%0A%20%20%20%20%7D%0A%7D%20else%20%7B%0A%20%20gg%20%3D%20%7B%0A%20%20%20%20s1%3A%5Bs1x%2Bloci%5Fwidth%2F2%2Cs1y%5D%2C%0A%20%20%20%20t1%3A%5Bt1x%2Bloci%5Fwidth%2F2%2Ct1y%5D%2C%0A%20%20%20%20s2%3A%5Bs2x%2Bloci%5Fwidth%2F2%2Cs2y%5D%2C%0A%20%20%20%20t2%3A%5Bt2x%2Bloci%5Fwidth%2F2%2Ct2y%5D%2C%0A%20%20%20%20nm%3Aloci%5Flinks%5Btk%5D%2Elnk%5Fnm%2C%0A%20%20%20%20dt%3Aloci%5Flinks%5Btk%5D%2Elink%5Fdata%0A%20%20%20%20%7D%0A%7D%0A%0A%20%20loci%5Flinks%5Fcoords%2Epush%28gg%29%3B%0A%7D%0A%2F%2Fconsole%2Elog%28loci%5Flinks%5Fcoords%29%0A%0Avar%20dt%5Fvals%20%3D%20%5B%5D%3B%0Afor%28var%20i%3D0%3Bi%3Cloci%5Flinks%5Fcoords%2Elength%3Bi%2B%2B%29%7B%0A%20%20dt%5Fvals%2Epush%28loci%5Flinks%5Fcoords%5Bi%5D%2Edt%29%0A%7D%0A%0A%2F%2F%20%2F%2F%20string%20or%20number%0Aconst%20curve%20%3D%20d3%2Eline%28%29%2Ecurve%28d3%2EcurveNatural%29%3B%0Avar%20link%5Fcol%5Ffn%3B%0Aif%28links%5Fcolor%5Fmaps%29%7B%0Aif%28typeof%20dt%5Fvals%5B0%5D%20%3D%3D%20%22string%22%29%7B%0Avar%20flags%20%3D%20%5B%5D%2C%20uniq%5Fvals%20%3D%20%5B%5D%3B%0Afor%28%20var%20i%3D0%3B%20i%3Cloci%5Flinks%5Fcoords%2Elength%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20if%28%20flags%5Bloci%5Flinks%5Fcoords%5Bi%5D%2Edt%5D%29%20continue%3B%0A%20%20%20%20flags%5Bloci%5Flinks%5Fcoords%5Bi%5D%2Edt%5D%20%3D%20true%3B%0A%20%20%20%20uniq%5Fvals%2Epush%28loci%5Flinks%5Fcoords%5Bi%5D%2Edt%29%3B%0A%7D%0A%0Alink%5Fcol%5Ffn%20%3D%20d3%2EscaleOrdinal%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Edomain%28uniq%5Fvals%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Erange%28links%5Fcolors%29%3B%0A%0A%20%20w22%3Duniq%5Fvals%2Elength%2A20%3B%0A%20%20%2F%2F%20Create%20scale%0A%0A%20%20var%20scalelinks%20%3D%20d3%2EscaleBand%28%29%0A%20%20%2Edomain%28uniq%5Fvals%29%0A%20%20%2Erange%28%5B2%2Cw22%5D%29%3B%0A%0A%20%20%2F%2F%20Add%20scales%20to%20axis%0A%20%20var%20legendlinks%5Fcat%20%3D%20d3%2EaxisRight%28%29%0A%20%20%2Escale%28scalelinks%29%2EtickSizeOuter%280%29%3B%0A%0A%0A%20%20%2F%2FAppend%20group%20and%20insert%20axis%0A%20%20svg%2Eappend%28%22g%22%29%0A%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2B%28%28width%2D35%29%2Dlinks%5Flg%5Fx%29%2B%22%2C%22%20%2B%20%28%28height%2D100%29%2Dlinks%5Flg%5Fy%20%29%2B%20%22%29%22%29%0A%20%20%2Eattr%28%22class%22%2C%22scatter%5Flegend%22%29%0A%20%20%2Ecall%28legendlinks%5Fcat%29%3B%0A%0Asvg%2Eselect%28%22%2Escatter%5Flegend%22%29%2Estyle%28%22font%2Dsize%22%2C%2215px%22%29%3B%0A%20%20rec%5Fh22%3Dw22%2Funiq%5Fvals%2Elength%3B%0A%20%20%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%20%2Edata%28links%5Fcolors%29%0A%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20function%28d%2Ci%29%7Breturn%20%28%28%28height%2D99%29%2Dlinks%5Flg%5Fy%29%2Bi%2Arec%5Fh22%29%3B%7D%29%0A%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20rec%5Fh22%29%0A%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20function%28d%2Ci%29%7Breturn%20%28%28width%2D45%29%2Dlinks%5Flg%5Fx%29%3B%7D%29%0A%20%20%20%20%20%20%2Eattr%28%22width%22%2C%2010%29%0A%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20function%28d%29%7Breturn%20d%3B%7D%29%3B%0A%0A%0A%7D%20else%20if%28typeof%20dt%5Fvals%5B0%5D%20%3D%3D%20%22number%22%29%7B%0A%0A%20%20link%5Fcol%5Ffn%20%3D%20d3%2EscaleLinear%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Edomain%28d3%2Eextent%28dt%5Fvals%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Erange%28links%5Fcolors%29%3B%0A%0A%0A%20%20%20%20link%5Flegend%5Fgrad%20%3D%20svg%2Eappend%28%22defs%22%29%2Eappend%28%22linearGradient%22%29%0A%20%20%20%20%2Eattr%28%22id%22%2C%20function%28d%29%7B%20return%20div%5Fid%2B%22%2D%22%2B%22linear%2Dgradient%2DLINK%2Dcont%22%3B%7D%29%0A%20%20%20%20%2Eattr%28%22x1%22%2C%20%220%25%22%29%0A%20%20%20%20%2Eattr%28%22y1%22%2C%20%220%25%22%29%0A%20%20%20%20%2Eattr%28%22x2%22%2C%20%220%25%22%29%0A%20%20%20%20%2Eattr%28%22y2%22%2C%20%22100%25%22%29%0A%20%20%20%20%2EselectAll%28%22stop%22%29%0A%20%20%20%20%2Edata%28%20link%5Fcol%5Ffn%2Erange%28%29%20%29%0A%20%20%20%20%2Eenter%28%29%2Eappend%28%22stop%22%29%0A%20%20%20%20%2Eattr%28%22offset%22%2C%20function%28d%2Ci%29%20%7B%20return%20i%2F%28link%5Fcol%5Ffn%2Erange%28%29%2Elength%2D1%29%3B%20%7D%29%0A%20%20%20%20%2Eattr%28%22stop%2Dcolor%22%2C%20function%28d%29%20%7B%20return%20d%3B%20%7D%29%3B%0A%0A%20%20%20%20svg%2Eappend%28%27rect%27%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2C100%29%2Eattr%28%22width%22%2C10%29%2Eattr%28%22y%22%2C%28%28height%2D99%29%2Dlinks%5Flg%5Fy%29%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%28%28width%2D45%2D%281%2A50%29%29%2Dlinks%5Flg%5Fx%29%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cfunction%28d%29%7Breturn%20%22lg%5Floci%22%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22fill%22%2C%20%22url%28%23%22%2Bdiv%5Fid%2B%22%2D%22%2B%22linear%2Dgradient%2DLINK%2Dcont%29%22%29%3B%0A%0A%20%20%20%20let%20locirng%20%3D%20%5Bd3%2Emin%28dt%5Fvals%29%2Cd3%2Emean%28dt%5Fvals%29%2Cd3%2Emax%28dt%5Fvals%29%5D%3B%0A%20%20%20%20svg%2EselectAll%28%22%2Etexts%22%29%0A%20%20%20%20%2Edata%28d3%2Erange%283%29%29%0A%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%2Eappend%28%22text%22%29%0A%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22labels%2Dlinks%22%29%0A%20%20%20%20%2Etext%28function%28i%29%7B%20return%20locirng%5Bi%5D%2EtoFixed%281%29%3B%7D%29%0A%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20%229px%22%29%0A%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%2Eattr%28%22transform%22%2Cfunction%28d%2Cj%29%7B%0A%20%20%20%20%20%20%20%20return%20%22translate%28%22%20%2B%28%28width%2D32%2D%281%2A50%29%29%2Dlinks%5Flg%5Fx%29%2B%22%2C%22%20%2B%20%28%28height%2D94%2B%28j%2A48%29%29%2Dlinks%5Flg%5Fy%20%20%29%2B%20%22%29%22%7D%29%3B%0A%0A%7D%0A%7D%0Avar%20links%5Ftip%20%20%3D%20d3%2Eselect%28%22body%22%29%2Eappend%28%22div%22%29%0A%20%20%20%20%20%2Eattr%28%22class%22%2C%20div%5Fid%2B%22%2D%22%2B%22scattertooltip%22%29%0A%20%20%20%20%20%2Estyle%28%22opacity%22%2C%200%29%0A%20%20%20%20%20%2Eattr%28%22style%22%2C%20%22position%3A%20absolute%3Btext%2Dalign%3A%20center%3Bwidth%3A%20100px%3Bheight%3A%2050px%3B%09%20padding%3A%202px%3B%09font%3A%2012px%20sans%2Dserif%3B%09box%2Dsizing%3A%20border%2Dbox%3B%09border%3A%200px%3Bborder%2Dradius%3A%208px%3Bpointer%2Devents%3A%20none%3B%22%29%20%3B%0A%0A%0Asvg%2EselectAll%28%22paths%22%29%0A%20%20%20%20%20%20%20%20%2Edata%28loci%5Flinks%5Fcoords%29%0A%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%2Eappend%28%27path%27%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2C%20function%28d%29%7B%0A%20%20%20%20%20%20%20%20if%28d%2Es1%5B1%5D%20%21%3D%20d%2Et1%5B1%5D%29%7B%0A%20%20%20%20%20%20%20%20%20%20let%20chords%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20chords%2Epush%28d3%2ElinkVertical%28%29%28%7B%0A%20%20%20%20%20%20%20%20%20%20source%3A%20d%2Es1%2C%0A%20%20%20%20%20%20%20%20%20%20target%3A%20d%2Et1%0A%20%20%20%20%20%20%20%20%7D%29%29%3B%0A%20%20%20%20%20%20%20%20chords%2Epush%28d3%2ElinkVertical%28%29%28%7B%0A%20%20%20%20%20%20%20%20%20%20source%3A%20d%2Et1%2C%0A%20%20%20%20%20%20%20%20%20%20target%3A%20d%2Et2%0A%20%20%20%20%20%20%20%20%7D%29%29%3B%0A%20%20%20%20%20%20%20%20chords%2Epush%28d3%2ElinkVertical%28%29%28%7B%0A%20%20%20%20%20%20%20%20%20%20source%3A%20d%2Et2%2C%0A%20%20%20%20%20%20%20%20%20%20target%3A%20d%2Es2%0A%20%20%20%20%20%20%20%20%7D%29%29%3B%0A%20%20%20%20%20%20%20%20%2F%2Fconsole%2Elog%28chords%29%0A%20%20%20%20%20%20%20%20chords%5B0%5D%20%3D%20chords%5B0%5D%2Esplit%28%22%2C%22%29%2Esplice%280%2C%28chords%5B0%5D%2Esplit%28%22%2C%22%29%2Elength%2D2%29%29%2Ejoin%28%29%3B%0A%20%20%20%20%20%20%20%20chords%5B0%5D%20%3D%20chords%5B0%5D%2B%22%2C%22%0A%20%20%20%20%20%20%20%20chords%5B1%5D%20%3D%20chords%5B1%5D%2Esplit%28%22%2C%22%29%2Esplice%280%2C%28chords%5B1%5D%2Esplit%28%22%2C%22%29%2Elength%20%2D%202%29%29%2Ejoin%28%29%3B%0A%20%20%20%20%20%20%20%20chords%5B1%5D%20%3D%20chords%5B1%5D%2Esubstring%281%29%3B%0A%20%20%20%20%20%20%20%20chords%5B1%5D%20%3D%20chords%5B1%5D%2B%22%2C%22%0A%20%20%20%20%20%20%20%20chords%5B2%5D%20%3D%20chords%5B2%5D%2Esubstring%281%29%3B%0A%20%20%20%20%20%20%20%20%2F%2Fconsole%2Elog%28chords%29%0A%20%20%20%20%20%20%20%20%2F%2F%20chords%2Epush%28d3%2ElinkVertical%28%29%28%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%20%20source%3A%20d%2Es2%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20%20%20target%3A%20d%2Es1%0A%20%20%20%20%20%20%20%20%2F%2F%20%7D%29%29%3B%0A%20%20%20%20%20%20%20%20let%20full%5Fchord%5Fpath%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20for%28var%20u%3D0%3Bu%3Cchords%2Elength%3Bu%2B%2B%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20full%5Fchord%5Fpath%20%2B%3D%20chords%5Bu%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20full%5Fchord%5Fpath%20%2B%3D%20%22z%22%3B%0A%20%20%20%20%20%20%20%20console%2Elog%28full%5Fchord%5Fpath%29%3B%0A%20%20%20%20%20%20%20%20return%20full%5Fchord%5Fpath%3B%0A%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%28d%2Es1%5B0%5D%3Cd%2Et1%5B0%5D%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20dist1%20%3D%20d%2Et2%5B0%5D%20%2D%20d%2Es1%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20dist2%20%3D%20d%2Et1%5B0%5D%20%2D%20d%2Es2%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20d1%5Fhalf%20%3D%20dist1%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20d1%5Fquat%20%3D%20d1%5Fhalf%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20d2%5Fhalf%20%3D%20dist2%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20d2%5Fquat%20%3D%20d2%5Fhalf%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20points1%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20points2%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points1%2Epush%28%5Bd%2Es1%5B0%5D%2Cd%2Es1%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points1%2Epush%28%5Bd%2Es1%5B0%5D%2Bd1%5Fquat%2Cd%2Es1%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points1%2Epush%28%5Bd%2Es1%5B0%5D%2Bd1%5Fhalf%2Cd%2Es1%5B1%5D%2Dch%5Fgap%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points1%2Epush%28%5Bd%2Es1%5B0%5D%2Bd1%5Fhalf%2Bd1%5Fquat%2Cd%2Es1%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points1%2Epush%28%5Bd%2Et2%5B0%5D%2Cd%2Et2%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20out%5Fcv%20%3D%20curve%28points1%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points2%2Epush%28%5Bd%2Es2%5B0%5D%2Cd%2Es2%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points2%2Epush%28%5Bd%2Es2%5B0%5D%2Bd2%5Fquat%2Cd%2Es2%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points2%2Epush%28%5Bd%2Es2%5B0%5D%2Bd2%5Fhalf%2Cd%2Es2%5B1%5D%2Dch%5Fgap%20%2B%205%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points2%2Epush%28%5Bd%2Es2%5B0%5D%2Bd2%5Fhalf%2Bd2%5Fquat%2Cd%2Es2%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points2%2Epush%28%5Bd%2Et1%5B0%5D%2Cd%2Et1%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20in%5Fcv%20%3D%20curve%28points2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20lne1%20%3D%20d3%2Eline%28%29%28%5Bd%2Es1%2Cd%2Es2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20lne2%20%3D%20d3%2Eline%28%29%28%5Bd%2Et1%2Cd%2Et2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20lne1%2Bin%5Fcv%2Blne2%2Bout%5Fcv%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%28d%2Es1%5B0%5D%3Ed%2Et1%5B0%5D%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20s%5F1%20%3D%20d%2Es1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20s%5F2%20%3D%20d%2Es2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20t%5F1%20%3D%20d%2Et1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20t%5F2%20%3D%20d%2Et2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20dist1%20%3D%20s%5F2%5B0%5D%20%2D%20t%5F1%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20dist2%20%3D%20s%5F1%5B0%5D%20%2D%20t%5F2%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20d1%5Fhalf%20%3D%20dist1%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20d1%5Fquat%20%3D%20d1%5Fhalf%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20d2%5Fhalf%20%3D%20dist2%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20d2%5Fquat%20%3D%20d2%5Fhalf%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20points1%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20points2%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points1%2Epush%28%5Bt%5F1%5B0%5D%2Ct%5F1%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points1%2Epush%28%5Bt%5F1%5B0%5D%2Bd1%5Fquat%2Ct%5F1%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points1%2Epush%28%5Bt%5F1%5B0%5D%2Bd1%5Fhalf%2Ct%5F1%5B1%5D%2Dch%5Fgap%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points1%2Epush%28%5Bt%5F1%5B0%5D%2Bd1%5Fhalf%2Bd1%5Fquat%2Ct%5F1%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points1%2Epush%28%5Bs%5F2%5B0%5D%2Cs%5F2%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20out%5Fcv%20%3D%20curve%28points1%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points2%2Epush%28%5Bt%5F2%5B0%5D%2Ct%5F2%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points2%2Epush%28%5Bt%5F2%5B0%5D%2Bd2%5Fquat%2Ct%5F2%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points2%2Epush%28%5Bt%5F2%5B0%5D%2Bd2%5Fhalf%2Ct%5F2%5B1%5D%2Dch%5Fgap%20%2B%205%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points2%2Epush%28%5Bt%5F2%5B0%5D%2Bd2%5Fhalf%2Bd2%5Fquat%2Ct%5F2%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points2%2Epush%28%5Bs%5F1%5B0%5D%2Cs%5F1%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20in%5Fcv%20%3D%20curve%28points2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20lne1%20%3D%20d3%2Eline%28%29%28%5Bt%5F1%2Ct%5F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20lne2%20%3D%20d3%2Eline%28%29%28%5Bs%5F1%2Cs%5F2%5D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20lne1%2Bin%5Fcv%2Blne2%2Bout%5Fcv%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20points%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Es1%5B0%5D%2Cd%2Es1%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Es1%5B0%5D%2D15%2Cd%2Es1%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Es1%5B0%5D%2Cd%2Es1%5B1%5D%2Dch%5Fgap%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Es1%5B0%5D%2B15%2Cd%2Es1%5B1%5D%2Dch%5Fgap%2F2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%2Epush%28%5Bd%2Et1%5B0%5D%2Cd%2Et1%5B1%5D%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20curve%28points%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%2Eclassed%28%22link%22%2C%20true%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2Cfunction%28d%29%7B%0A%20%20%20%20%20%20%20%20%20%20if%28d%2Es1%5B1%5D%20%21%3D%20d%2Et1%5B1%5D%29%7B%0A%20%20%20%20%20%20%20%20%20%20return%20link%5Fcol%5Ffn%28d%2Edt%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%20return%20%22none%22%7D%0A%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%22%2Cfunction%28d%29%7B%20%20if%28links%5Fcolor%5Fmaps%29%7B%20return%20link%5Fcol%5Ffn%28d%2Edt%29%3B%7Delse%20%7B%20return%20links%5Fcolors%3B%7D%7D%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22opacity%22%2C0%2E8%29%0A%20%20%20%20%20%20%20%20%2Eon%28%22mouseover%22%2C%20function%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20links%5Ftip%2Etransition%28%29%2Eduration%28200%29%2Estyle%28%22opacity%22%2C%20%2E9%29%2Estyle%28%22background%2Dcolor%22%2C%22%23F5F5F5%22%29%2Estyle%28%22width%22%2C100%2B%28d%2Edt%2Elength%2A3%29%2B%27px%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20links%5Ftip%2Ehtml%28%22link%3A%20%22%2Bd%2Enm%2B%22%3Cbr%3E%20value%3A%20%22%2Bd%2Edt%29%2Estyle%28%22left%22%2C%20%28d3%2Eevent%2EpageX%29%20%2B%20%22px%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22top%22%2C%20%28d3%2Eevent%2EpageY%20%2D%2018%29%20%2B%20%22px%22%29%3B%20d3%2Eselect%28this%29%2Eattr%28%22stroke%22%2C%22black%22%29%3B%0A%20%20%20%20%20%20%20%20%20%7D%29%2Eon%28%22mouseout%22%2C%20function%28d%29%20%7B%09links%5Ftip%2Etransition%28%29%20%2Edelay%281000%29%2Eduration%28500%29%09%2Estyle%28%22opacity%22%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20d3%2Eselect%28this%29%2Eattr%28%22stroke%22%2Cfunction%28d%29%7B%20if%28links%5Fcolor%5Fmaps%29%7Breturn%20link%5Fcol%5Ffn%28d%2Edt%29%3B%7Delse%7B%20return%20links%5Fcolors%3B%7D%7D%29%3B%7D%29%3B%0A%0A%20%20%20%20%20%20%2F%2Flogic%20for%20chords%20ends%0A%0A%20%20%20%20%7D%0A%7D%7D%0A%2F%2F%20code%20ends%20fo%20linking%20loci%0A%0Aif%28%21heatmap%29%7B%0A%20%20%20%20%20%20%20%20%2F%2Fdata%20reduction%20for%20anntation%0Avar%20chDataReduced%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20var%20label%20%3D%27%27%3B%20var%20tot%20%3D%20%27%3Cfont%20color%3D%22grey%22%3E%20Count%3A%20%3C%2Ffont%3E%20%27%2Bv%2Elength%2B%22%20%20%3C%2Fp%3E%3C%2Fdiv%3E%3Chr%3E%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A80%25%3Boverflow%2Dwrap%3A%20break%2Dword%3B%27%20%3E%20%3Cfont%20size%3D%271%27%3E%22%3Bfor%28var%20i%3D0%3B%20i%3C%20v%2Elength%3Bi%2B%2B%29%7B%20label%20%3D%20label%20%2B%22%3Ca%20href%3D%22%2Bv%5Bi%5D%2Ehlink%2B%22%20style%3D%27text%2Ddecoration%3Anone%3Bcursor%3Apointer%3Bcolor%3Agrey%3Bpointer%2Devents%3A%20all%27%3E%22%2B%20v%5Bi%5D%2Ename%2B%22%3C%2Fa%3E%22%20%2B%22%20%2C%22%3B%20%20%20%20%7D%3B%20return%20tot%2Blabel%2Eslice%280%2C%2D1%29%3B%7D%29%0A%2Eentries%28chData%29%3B%0A%0Avar%20chDataReducedCount%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20%20return%20v%2Elength%3B%7D%29%0A%2Eentries%28chData%29%3B%0A%0Avar%20chDataRange%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20%20var%20a%2Cb%3Bfor%28var%20i%3D0%3B%20i%3C%20v%2Elength%3Bi%2B%2B%29%7B%20a%20%3D%20v%5Bi%5D%2Eloci%5Fstart%3B%20b%3Dv%5Bi%5D%2Eloci%5Fend%3B%20%20%20%20%7D%3Breturn%20%22%22%2Ba%2B%22%2D%22%2Bb%2B%22bp%20%22%3B%7D%29%0A%2Eentries%28chData%29%3B%0A%0A%20%2F%2A%20adding%20the%20chromosome%20tootltips%20%20%20%20%2A%2F%0Afor%28var%20i%20%3D%200%3Bi%20%3C%20chDataReduced%2Elength%3Bi%2B%2B%29%20%7B%0A%0A%0A%20%20chDataReduced%5Bi%5D%2Erange%20%3D%20chDataRange%5Bi%5D%2Evalue%3B%0A%20%20chDataReduced%5Bi%5D%2Elen%20%3D%20chDataReducedCount%5Bi%5D%2Evalue%3B%0A%7D%0A%0A%0A%2F%2Fdata%20ready%20for%20rendering%0A%20%20%20%20%20var%20tip%20%3D%5B%5D%3B%0A%20%20%20%20%20%20%20%20tip%5Bploidy%2D1%5D%20%3D%20d3%2Eselect%28%22body%22%29%2Eappend%28%22div%22%29%0A%20%2Eattr%28%22class%22%2C%20div%5Fid%2B%22%2D%22%2B%22chtooltip%22%29%0A%20%2Estyle%28%22opacity%22%2C%200%29%0A%20%2Eattr%28%22style%22%2C%20%22position%3A%20absolute%3Btext%2Dalign%3A%20center%3B%09box%2Dsizing%3A%20border%2Dbox%3B%20padding%3A%203px%3B%09font%3A%2012px%20sans%2Dserif%3B%09%09border%3A%200px%3Bborder%2Dradius%3A%208px%3Bpointer%2Devents%3A%20none%3B%22%29%20%3B%0A%0A%20var%20tip2%20%3D%20%5B%5D%3B%0A%20%20tip2%5Bploidy%2D1%5D%20%3D%20d3%2Eselect%28%22body%22%29%2Eappend%28%22div%22%29%0A%20%20%20%20%20%2Eattr%28%22class%22%2C%20div%5Fid%2B%22%2D%22%2B%22chtooltip2%22%29%0A%20%20%20%20%20%2Estyle%28%22opacity%22%2C%200%29%0A%20%20%20%20%20%2Eattr%28%22style%22%2C%20%22position%3A%20absolute%3Btext%2Dalign%3A%20center%3Bwidth%3A%20180px%3Bheight%3A%20140px%3B%09%20padding%3A%202px%3B%09font%3A%2012px%20sans%2Dserif%3B%09box%2Dsizing%3A%20border%2Dbox%3B%09border%3A%200px%3Bborder%2Dradius%3A%208px%3Bpointer%2Devents%3A%20none%3B%22%29%20%3B%0A%20var%20clickFlag%3Dfalse%3B%0Aif%28interactivity%29%7B%0A%20d3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%2Edata%28chDataReduced%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Ekey%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%2Eon%28%22mouseover%22%2C%20function%28d%29%20%7Btip%5Bploidy%2D1%5D%2Etransition%28%29%2Eduration%28200%29%09%2Estyle%28%22opacity%22%2C%20%2E9%29%2Estyle%28%22background%2Dcolor%22%2C%22%23F5F5F5%22%29%3B%09tip%5Bploidy%2D1%5D%2Estyle%28%22height%22%2C100%2Bd%2Elen%2A1%2E5%29%2Estyle%28%22width%22%2C190%2Bd%2Elen%29%3B%0A%20tip%5Bploidy%2D1%5D%2Ehtml%28%22%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A10%25%3Bcolor%3Ablack%3Bfont%2Dsize%3A12px%3B%27%3E%3Cp%3E%22%2Bd%2Erange%2B%22%3C%2Fp%3E%3C%2Fdiv%3E%3Chr%3E%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A10%25%3B%27%3E%3Cp%20%3E%3Cb%3E%22%2Bd%2Evalue%2B%22%3C%2Ffont%3E%3C%2Fdiv%3E%22%29%2Estyle%28%22left%22%2C%20%28d3%2Eevent%2EpageX%29%20%2B%20%22px%22%29%09%2Estyle%28%22top%22%2C%20%28d3%2Eevent%2EpageY%20%2D%2018%29%20%2B%20%22px%22%29%3B%7D%29%2Eon%28%22mouseout%22%2C%20function%28d%29%20%7B%09tip%5Bploidy%2D1%5D%2Etransition%28%29%20%2Edelay%281000%29%2Eduration%28500%29%09%2Estyle%28%22opacity%22%2C%200%29%3B%7D%29%2Eattr%28%22fill%22%2C%20an%5Fcol%29%0A%20%2Eon%28%22click%22%2C%20function%28d%29%20%7B%0A%0A%0A%20%20%20if%28clickFlag%29%7B%0A%20%20%20%20%20%20%20%20tip2%5Bploidy%2D1%5D%2Estyle%28%22opacity%22%2C%200%29%3B%0A%20%20%20%20%20%7Delse%7B%0A%20%20%20%20%20%20%20tip2%5Bploidy%2D1%5D%2Etransition%28%29%2Eduration%28200%29%09%2Estyle%28%22opacity%22%2C%201%29%2Estyle%28%22background%2Dcolor%22%2C%22%23F5F5F5%22%29%3B%09tip2%5Bploidy%2D1%5D%2Estyle%28%22height%22%2C100%2Bd%2Elen%2A1%2E5%29%2Estyle%28%22width%22%2C190%2Bd%2Elen%29%3B%0A%20%20%20%20%20%20%20tip2%5Bploidy%2D1%5D%2Ehtml%28%22%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A10%25%3Bcolor%3Ablack%3Bfont%2Dsize%3A12px%3B%27%3E%3Cp%3E%22%2Bd%2Erange%2B%22%3C%2Fp%3E%3C%2Fdiv%3E%3Chr%3E%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A10%25%3B%27%3E%3Cp%20%3E%3Cb%3E%22%2Bd%2Evalue%2B%22%3C%2Ffont%3E%3C%2Fdiv%3E%22%29%2Estyle%28%22left%22%2C%20%28d3%2Eevent%2EpageX%29%20%2B%20%22px%22%29%09%2Estyle%28%22top%22%2C%20%28d3%2Eevent%2EpageY%20%2D%2018%29%20%2B%20%22px%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%20return%20clickFlag%20%3D%20%21clickFlag%3B%20%7D%29%3B%0A%7D%20else%20%7B%0A%20%20%2F%2F%20without%20interactivity%0A%20%20d3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%2Edata%28chDataReduced%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Ekey%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%0A%20%20%2Eattr%28%22fill%22%2C%20an%5Fcol%29%3B%0A%20%0A%20%20%2F%2Fend%20of%20without%20interactivity%0A%7D%0A%0A%0A%0A%20if%28labels%29%7B%0A%0A%20%20var%20chDataLabels%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20%20var%20a%3D%5B%5D%3Bfor%28var%20i%3D0%3B%20i%3C%20v%2Elength%3Bi%2B%2B%29%7B%20a%2Epush%28v%5Bi%5D%2Ename%29%3B%20%20%20%7D%3Breturn%20a%5B0%5D%3B%7D%29%0A%2Eentries%28chData%29%3B%0Avar%20chDataLabel%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20%20var%20a%3D%5B%5D%3Bfor%28var%20i%3D0%3B%20i%3C%20v%2Elength%3Bi%2B%2B%29%7B%20a%2Epush%28v%5Bi%5D%2Elabel%29%3B%20%20%20%7D%3Breturn%20a%5B0%5D%3B%7D%29%0A%2Eentries%28chData%29%3B%0A%20for%28var%20i%20%3D%200%3Bi%20%3C%20chDataReduced%2Elength%3Bi%2B%2B%29%20%7B%0A%0A%0A%0A%20%20chDataReduced%5Bi%5D%2Elabels%20%3DchDataLabels%5Bi%5D%2Evalue%3B%0A%20%20chDataReduced%5Bi%5D%2Elabel%5Fid%20%3DchDataLabel%5Bi%5D%2Evalue%3B%0A%0A%7D%0A%0Ad3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22labels%22%29%2Edata%28chDataReduced%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Elabel%5Fid%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%0A%20%20%20%20%20%20%20%2Etext%28function%28d%29%7B%20return%20d%2Elabels%3B%7D%29%0A%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20var%20xRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22x%22%29%3B%0A%20%20%20%20%20%20%20%20var%20yRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22y%22%29%3B%0A%20%20%20%20%20%20%20%20return%20%60rotate%28%24%7Blabel%5Fangle%7D%2C%20%24%7BxRot%7D%2C%20%20%24%7ByRot%7D%20%29%60%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%7D%0A%0A%0A%0A%0A%20%7D%20else%20%7B%0A%0A%20%20%20%2F%2Fheatmap%20code%0A%20%20%20if%28heat%5Fscale%3D%3D%22linear%22%29%7B%0A%0A%0A%20%20%20%20%20%2F%2F%20if%28times%3D%3D1%20%7C%7C%20times%3D%3D2%29%7B%0A%20%20%20%20%20%2F%2F%20%20%20rng%3D%5B2%2E5%2C3%2E8%5D%3B%0A%20%20%20%20%20%2F%2F%20%7D%0A%0A%20%20%20%20colors%5Btimes%5D%20%3D%20d3%2EscaleLinear%28%29%0A%20%20%20%20%20%20%20%20%2Edomain%28rng%29%2Enice%28%29%0A%20%20%20%20%20%20%20%20%2Erange%28heat%5Fcol%29%3B%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%20%20%20%20%2F%2F%20Create%20scale%0A%0A%2F%2A%20%20%20%20var%20scale2%20%3D%20d3%2EscaleLinear%28%29%0A%20%20%20%20%2Edomain%28rng%29%2Enice%28%29%0A%20%20%20%20%2Erange%28%5B2%2C%20100%5D%29%3B%0A%0A%20%20%20%20%2F%2F%20Add%20scales%20to%20axis%0A%20%20%20%20legend2%20%3D%20d3%2EaxisRight%28%29%0A%20%20%20%20%2Escale%28scale2%29%0A%20%20%20%20%2Eticks%283%29%3B%0Aif%28legend%29%7B%0A%20%20%20%20%2F%2FAppend%20group%20and%20insert%20axis%0A%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2B%28%28width%2D35%2D%28times%2A50%29%29%2Dlg%5Fx%29%2B%22%2C%22%20%2B%20%28%28height%2D100%29%2Dlg%5Fy%20%29%2B%20%22%29%22%29%0A%20%20%20%20%2Ecall%28legend2%29%3B%0A%0A%7D%20%20%2A%2F%0A%2F%2Fconsole%2Elog%28colors%5Btimes%5D%2Erange%28%29%29%3B%0A%20%20%20%20chLinGradV%5Btimes%5D%20%3D%20svg%2Eappend%28%22defs%22%29%2Eappend%28%22linearGradient%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2C%20function%28d%29%7B%20return%20div%5Fid%2B%22%2D%22%2B%22linear%2Dgradient%2DchromH%2D%22%2Btimes%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x1%22%2C%20%220%25%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y1%22%2C%20%220%25%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x2%22%2C%20%220%25%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y2%22%2C%20%22100%25%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2EselectAll%28%22stop%22%29%0A%20%20%20%20%20%20%20%20%2Edata%28%20colors%5Btimes%5D%2Erange%28%29%2Ereverse%28%29%20%29%0A%20%20%20%20%20%20%20%20%2Eenter%28%29%2Eappend%28%22stop%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22offset%22%2C%20function%28d%2Ci%29%20%7B%20return%20i%2F%28colors%5Btimes%5D%2Erange%28%29%2Ereverse%28%29%2Elength%2D1%29%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22stop%2Dcolor%22%2C%20function%28d%29%20%7B%20return%20d%3B%20%7D%29%3B%0A%0A%0Aif%28legend%29%7B%0A%20%20%20%20%20%20svg%2Eappend%28%27rect%27%29%0A%20%20%20%20%20%20%2Eattr%28%22height%22%2C100%29%2Eattr%28%22width%22%2C12%29%2Eattr%28%22y%22%2C%28%28height%2D99%29%2Dlg%5Fy%29%29%2Eattr%28%22x%22%2C%28%28width%2D45%2B%28times%2A100%29%29%2Dlg%5Fx%29%29%2Eattr%28%22class%22%2Cfunction%28d%29%7Breturn%20%22lg%22%2Btimes%3B%7D%29%0A%20%20%20%20%20%20%2Estyle%28%22fill%22%2C%20%22url%28%23%22%2Bdiv%5Fid%2B%22%2D%22%2B%22linear%2Dgradient%2DchromH%2D%22%2Btimes%2B%22%29%22%29%3B%0A%0A%20%20%20%20%20%20var%20rng2%3B%0A%20%20%20%20%20%20%2F%2F%20if%28rng%2Elength%3D%3D3%29%7B%0A%20%20%20%20%20%20%2F%2F%20%20%20rng2%3Drng%3B%0A%20%20%20%20%20%20%2F%2F%20%7Delse%20if%20%28rng%2Elength%3D%3D2%29%20%7B%0A%20%20%20%20%20%20%2F%2F%20%20%20rng2%3D%5Brng%5B0%5D%2Cd3%2Emean%28rng%29%2Crng%5B1%5D%5D%0A%20%20%20%20%20%20%2F%2F%20%7D%0A%0A%20%20%20%20%20%20if%28rng%2Elength%3D%3D3%29%7B%0A%20%20%20%20%20%20%20%20rng2%3D%5Brng%5B2%5D%2Crng%5B1%5D%2Crng%5B0%5D%5D%3B%0A%20%20%20%20%20%20%7Delse%20if%20%28rng%2Elength%3D%3D2%29%20%7B%0A%20%20%20%20%20%20%20%20rng2%3D%5Brng%5B1%5D%2Cd3%2Emean%28rng%29%2Crng%5B0%5D%5D%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20svg%2EselectAll%28%22%2Etexts%22%29%0A%20%20%20%20%20%2Edata%28d3%2Erange%283%29%29%0A%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%2Eappend%28%22text%22%29%0A%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22labels%22%29%0A%20%20%20%20%20%2Etext%28function%28i%29%7B%20return%20rng2%5Bi%5D%2EtoFixed%281%29%3B%7D%29%0A%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20%2212px%22%29%0A%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%2Eattr%28%22transform%22%2Cfunction%28d%2Cj%29%7B%0A%20%20%20%20%20%20%20%20%20return%20%22translate%28%22%20%2B%28%28width%2D32%2B%28times%2A100%29%29%2Dlg%5Fx%20%2B%202%29%2B%22%2C%22%20%2B%20%28%28height%2D90%2B%28j%2A44%29%29%2Dlg%5Fy%20%20%29%2B%20%22%29%22%7D%29%3B%0A%0A%0A%20%20%20%20%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%28%28width%2D45%2B%28times%2A100%29%29%2Dlg%5Fx%20%2D%2010%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%28%28height%2D99%29%2Dlg%5Fy%2B50%29%20%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%2015%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22middle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Etext%28plot%5Flegend%5Flabel%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22plotleglabs%22%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Eplotleglabs%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20xRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22x%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20yRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22y%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%60rotate%28%2D90%2C%20%24%7BxRot%7D%2C%20%20%24%7ByRot%7D%20%29%60%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%0A%7D%0A%0A%20%20%20%20%7D%20else%7B%20if%28heat%5Fscale%3D%3D%22ordinal%22%29%7B%0A%0A%0A%0A%0A%20%20%20%20%20%20colors%5Btimes%5D%20%3D%20d3%2EscaleOrdinal%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Edomain%28rng%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Erange%28heat%5Fcol%29%3B%0A%0A%0A%20%20%20%20%20%20%20%20w%3Drng%2Elength%2A20%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20Create%20scale%0A%0A%20%20%20%20%20%20%20%20var%20scale2%20%3D%20d3%2EscaleBand%28%29%0A%20%20%20%20%20%20%20%20%2Edomain%28rng%29%0A%20%20%20%20%20%20%20%20%2Erange%28%5B2%2Cw%5D%29%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Add%20scales%20to%20axis%0A%20%20%20%20%20%20%20%20var%20legend2%20%3D%20d3%2EaxisRight%28%29%0A%20%20%20%20%20%20%20%20%2Escale%28scale2%29%2EtickSizeOuter%280%29%3B%0A%0Aif%28legend%29%7B%0A%20%20%20%20%20%20%20%20%2F%2FAppend%20group%20and%20insert%20axis%0A%20%20%20%20%20%20%20%20svg%2Eappend%28%22g%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20%22translate%28%22%2B%28%28width%2D35%29%2Dlg%5Fx%29%2B%22%2C%22%20%2B%20%28%28height%2D100%29%2Dlg%5Fy%20%29%2B%20%22%29%22%29%0A%20%20%20%20%20%20%20%20%2Ecall%28legend2%29%2Eattr%28%22id%22%2C%22glgnd%22%29%3B%0A%0A%20%20%20%20%20%20%20svg%2Eselect%28%22%23glgnd%22%29%2Estyle%28%22font%2Dsize%22%2C%2220px%22%29%3B%0A%0A%20%20%20%20%20%20%20%2F%2F%20LEGEND%20LABEL%0A%20%20%20%20%20%20%20%20%2F%2Fading%20the%20label%20for%20the%20LEGEND%0A%20%20%20%20%20%20%20%20svg%2Eappend%28%22text%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%28width%2D35%29%2Dlg%5Fx%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%28%28height%2D100%29%2Dlg%5Fy%20%2D%2015%20%29%20%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dfamily%22%2C%20%22sans%2Dserif%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%2020%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22text%2Danchor%22%2C%20%22start%22%29%0A%20%20%20%20%20%20%20%20%2Etext%28cat%5Flegend%5Flab%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22sctrlbl2%22%29%3B%0A%0A%0A%0A%20%20%20%20%20%20%20%20rec%5Fh%3Dw%2Frng%2Elength%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20svg%2EselectAll%28%22%2Erects%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Edata%28heat%5Fcol%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22rect%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y%22%2C%20function%28d%2Ci%29%7Breturn%20%28%28%28height%2D99%29%2Dlg%5Fy%29%2Bi%2Arec%5Fh%29%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22height%22%2C%20rec%5Fh%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x%22%2C%20function%28d%2Ci%29%7Breturn%20%28%28width%2D45%29%2Dlg%5Fx%29%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22width%22%2C%2010%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20function%28d%29%7Breturn%20d%3B%7D%29%3B%0A%7D%0A%0A%0A%0A%0A%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%0A%0A%0A%09%2F%2A%20creating%20final%20data%20%20%20%20%2A%2F%0A%0A%0A%0Aif%28heat%5Fscale%3D%3D%22linear%22%29%7B%0A%0A%2F%2A%20aggregate%20functions%2A%2F%0Avar%20tag%3B%0Aif%28aggregate%5Ffunc%3D%3D%22avg%22%29%7B%0AchDataReduced%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20return%20d3%2Emean%28v%2C%20function%28d%29%20%7B%20return%20d%2Edata%3B%20%7D%29%3B%7D%29%0A%2Eentries%28chData%29%3B%0A%0Atag%3D%22avg%22%3B%0A%7D%20else%20if%28aggregate%5Ffunc%3D%3D%22sum%22%29%7B%0A%0AchDataReduced%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20return%20d3%2Esum%28v%2C%20function%28d%29%20%7B%20return%20d%2Edata%3B%20%7D%29%3B%7D%29%0A%2Eentries%28chData%29%3B%0Atag%3D%22sum%22%3B%0A%0A%7D%20else%20if%28aggregate%5Ffunc%3D%3D%22min%22%29%7B%0A%0AchDataReduced%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20return%20d3%2Emin%28v%2C%20function%28d%29%20%7B%20return%20d%2Edata%3B%20%7D%29%3B%7D%29%0A%2Eentries%28chData%29%3B%0Atag%3D%22min%22%3B%0A%0A%7D%20else%20if%28aggregate%5Ffunc%3D%3D%22max%22%29%7B%0A%0AchDataReduced%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20return%20d3%2Emax%28v%2C%20function%28d%29%20%7B%20return%20d%2Edata%3B%20%7D%29%3B%7D%29%0A%2Eentries%28chData%29%3B%0Atag%3D%22max%22%3B%0A%0A%7D%20else%20if%28aggregate%5Ffunc%3D%3D%22count%22%29%7B%0A%0AchDataReduced%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20return%20v%2Elength%3B%7D%29%0A%2Eentries%28chData%29%3B%0Atag%3D%22count%22%3B%0A%0A%7D%20else%20if%20%28aggregate%5Ffunc%3D%3D%22median%22%29%7B%0A%20%20chDataReduced%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20return%20d3%2Emedian%28v%2C%20function%28d%29%20%7B%20return%20d%2Edata%3B%20%7D%29%3B%7D%29%0A%2Eentries%28chData%29%3B%0Atag%3D%22median%22%3B%0A%7D%20else%20if%20%28aggregate%5Ffunc%3D%3D%22none%22%29%7B%0A%20%20chDataReduced%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20return%20d3%2Emean%28v%2C%20function%28d%29%20%7B%20return%20d%2Edata%3B%20%7D%29%3B%7D%29%0A%2Eentries%28chData%29%3B%0A%7D%0A%2F%2A%20aggregate%20functions%2A%2F%0A%0A%0A%0A%0A%0A%20%20var%20chDataReducedMin%20%3D%20d3%2Enest%28%29%0A%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%2Erollup%28function%28v%29%20%7B%20return%20d3%2Emin%28v%2C%20function%28d%29%20%7B%20return%20d%2Edata%3B%20%7D%29%3B%7D%29%0A%20%20%2Eentries%28chData%29%3B%0A%20%20var%20chDataReducedMax%20%3D%20d3%2Enest%28%29%0A%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%2Erollup%28function%28v%29%20%7B%20return%20d3%2Emax%28v%2C%20function%28d%29%20%7B%20return%20d%2Edata%3B%20%7D%29%3B%7D%29%0A%20%20%2Eentries%28chData%29%3B%0A%20%20var%20chDataReducedBarData%20%3D%20d3%2Enest%28%29%0A%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%2Erollup%28function%28v%29%20%7B%20v%3Dv%2Esort%28function%28a%2Cb%29%7Breturn%20Math%2Eabs%28a%5B%27ch%5Fstart%27%5D%29%20%2D%20Math%2Eabs%28b%5B%27ch%5Fstart%27%5D%29%7D%29%3Bbar%3D%5B%5D%3B%20for%28var%20g%3D0%3Bg%3Cv%2Elength%3Bg%2B%2B%29%7Bbar%2Epush%28v%5Bg%5D%2Edata%29%3B%7D%3Breturn%20bar%3B%7D%29%0A%20%20%2Eentries%28chData%29%3B%0A%20%20var%20chDataReducedBarLabel%20%3D%20d3%2Enest%28%29%0A%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%2Erollup%28function%28v%29%20%7B%20v%3Dv%2Esort%28function%28a%2Cb%29%7Breturn%20Math%2Eabs%28a%5B%27ch%5Fstart%27%5D%29%20%2D%20Math%2Eabs%28b%5B%27ch%5Fstart%27%5D%29%7D%29%3Bbar%3D%5B%5D%3B%20for%28var%20g%3D0%3Bg%3Cv%2Elength%3Bg%2B%2B%29%7Bbar%2Epush%28v%5Bg%5D%2Ename%29%3B%7D%3Breturn%20bar%3B%7D%29%0A%20%20%2Eentries%28chData%29%3B%0A%0A%20%20var%20chDataReducedCategory%20%3D%20d3%2Enest%28%29%0A%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%2Erollup%28function%28v%29%20%7B%20v%3Dv%2Esort%28function%28a%2Cb%29%7Breturn%20Math%2Eabs%28a%5B%27ch%5Fstart%27%5D%29%20%2D%20Math%2Eabs%28b%5B%27ch%5Fstart%27%5D%29%7D%29%3Bbar%3D%5B%5D%3B%20for%28var%20g%3D0%3Bg%3Cv%2Elength%3Bg%2B%2B%29%7Bbar%2Epush%28v%5Bg%5D%2Ecate%29%3B%7D%3Breturn%20bar%3B%7D%29%0A%20%20%2Eentries%28chData%29%3B%0A%0A%20%20var%20chDataReducedBarLink%20%3D%20d3%2Enest%28%29%0A%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%2Erollup%28function%28v%29%20%7B%20v%3Dv%2Esort%28function%28a%2Cb%29%7Breturn%20Math%2Eabs%28a%5B%27ch%5Fstart%27%5D%29%20%2D%20Math%2Eabs%28b%5B%27ch%5Fstart%27%5D%29%7D%29%3Bbar%3D%5B%5D%3B%20for%28var%20g%3D0%3Bg%3Cv%2Elength%3Bg%2B%2B%29%7Bbar%2Epush%28v%5Bg%5D%2Ehlink%29%3B%7D%3Breturn%20bar%3B%7D%29%0A%20%20%2Eentries%28chData%29%3B%0A%20%20var%20chDataReducedCount%20%3D%20d3%2Enest%28%29%0A%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%2Erollup%28function%28v%29%20%7B%20return%20v%2Elength%3B%7D%29%0A%20%20%2Eentries%28chData%29%3B%0A%09var%20chDataRange%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20%20var%20a%2Cb%3Bfor%28var%20i%3D0%3B%20i%3C%20v%2Elength%3Bi%2B%2B%29%7B%20a%20%3D%20v%5Bi%5D%2Eloci%5Fstart%3B%20b%3Dv%5Bi%5D%2Eloci%5Fend%3B%20%20%20%20%7D%3Breturn%20%22%22%2Ba%2B%22%2D%22%2Bb%2B%22bp%20%22%3B%7D%29%0A%2Eentries%28chData%29%3B%0A%0Avar%20chDataReducedForStatic%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20var%20label%20%3D%27%27%3B%20var%20tot%20%3D%20%27%3Cfont%20color%3D%22grey%22%3E%20Count%3A%20%3C%2Ffont%3E%20%27%2Bv%2Elength%2B%22%20%20%3C%2Fp%3E%3C%2Fdiv%3E%3Chr%3E%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A80%25%3Boverflow%2Dwrap%3A%20break%2Dword%3B%27%20%3E%20%3Cfont%20size%3D%271%27%3E%22%3Bfor%28var%20i%3D0%3B%20i%3C%20v%2Elength%3Bi%2B%2B%29%7B%20label%20%3D%20label%20%2B%22%3Ca%20href%3D%22%2Bv%5Bi%5D%2Ehlink%2B%22%20style%3D%27text%2Ddecoration%3Anone%3Bcursor%3Apointer%3Bcolor%3Agrey%3Bpointer%2Devents%3A%20all%27%3E%22%2B%20v%5Bi%5D%2Ename%2B%22%3C%2Fa%3E%22%20%2B%22%20%2C%22%3B%20%20%20%20%7D%3B%20return%20tot%2Blabel%2Eslice%280%2C%2D1%29%3B%7D%29%0A%2Eentries%28chData%29%3B%0A%20%20for%28var%20i%20%3D%200%3Bi%20%3C%20chDataReduced%2Elength%3Bi%2B%2B%29%20%7B%0A%0A%0A%09chDataReduced%5Bi%5D%2Erange%20%3D%20chDataRange%5Bi%5D%2Evalue%3B%0A%09chDataReduced%5Bi%5D%2Emin%20%3D%20chDataReducedMin%5Bi%5D%2Evalue%3B%0A%09chDataReduced%5Bi%5D%2Emax%20%3D%20chDataReducedMax%5Bi%5D%2Evalue%3B%0A%09chDataReduced%5Bi%5D%2Ebar%20%3D%20chDataReducedBarData%5Bi%5D%2Evalue%3B%0A%09chDataReduced%5Bi%5D%2Elabel%20%3D%20chDataReducedBarLabel%5Bi%5D%2Evalue%3B%0A%09chDataReduced%5Bi%5D%2Ecount%20%3D%20chDataReducedCount%5Bi%5D%2Evalue%3B%0A%20%20chDataReduced%5Bi%5D%2Ehlink%20%3D%20chDataReducedBarLink%5Bi%5D%2Evalue%3B%0A%20%20chDataReduced%5Bi%5D%2Estatic%20%3D%20chDataReducedForStatic%5Bi%5D%2Evalue%3B%0A%20%20chDataReduced%5Bi%5D%2Ecategory%20%3D%20chDataReducedCategory%5Bi%5D%2Evalue%3B%0A%7D%0A%0Adelete%20chDataRange%3B%0Adelete%20chDataReducedMin%3B%0Adelete%20chDataReducedMax%3B%0Adelete%20chDataReducedBarData%3B%0Adelete%20chDataReducedBarLabel%3B%0Adelete%20chDataReducedBarLink%3B%0Adelete%20chDataReducedForStatic%3B%0Adelete%20chDataReducedCategory%3B%0A%0Aif%28plots%3D%3D%22bar%22%29%7B%0A%2F%2Abarplot%2A%2F%0A%20var%20BarData%3DJSON%2Eparse%28JSON%2Estringify%28chDataReduced%29%29%3B%0Afor%20%28var%20i%20%3D%200%3B%20i%20%3C%20BarData%2Elength%3B%20i%2B%2B%29%20%7B%0A%0A%20%20%20%20BarData%5Bi%5D%2Ekey%20%3D%20%22bar%2D%22%2BBarData%5Bi%5D%2Ekey%3B%0A%20%20%7D%0A%0A%0A%20%20%2F%2F%20Add%20Y%20axis%0A%20%20if%28parseFloat%28plot%5Fy%5Fdomain%5B0%5D%29%20%3D%3D%3D%200%20%26%26%20parseFloat%28plot%5Fy%5Fdomain%5B1%5D%29%20%3D%3D%3D%200%29%7B%0A%20%20var%20y%20%3D%20d3%2EscaleLinear%28%29%0A%20%20%20%20%2Edomain%28d3%2Eextent%28BarData%2C%20function%28d%29%20%7B%20return%20d%2Evalue%7D%20%29%29%0A%20%20%20%20%2Erange%28%5B%20plot%5Fheight%2C0%5D%29%2Enice%28%29%3B%0A%7D%20else%20%7B%0A%20%20var%20y%20%3D%20d3%2EscaleLinear%28%29%0A%20%20%20%20%2Edomain%28plot%5Fy%5Fdomain%29%0A%20%20%20%20%2Erange%28%5B%20plot%5Fheight%2C0%5D%29%2Enice%28%29%3B%0A%7D%0A%20%20%20%20for%28i%3D0%3Bi%3C%20nLoci%2Elength%3Bi%2B%2B%29%7B%0A%20%20%20%20%20%20%2F%2Fconsole%2Elog%28%22axis%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2Bploidy%29%0A%20%20%20%20%20%20svg%2Eselect%28%22%23%22%2Bdiv%5Fid%2B%22%2D%22%2B%22bar%2Daxis%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2Bploidy%29%2Ecall%28d3%2EaxisLeft%28%29%2Escale%28y%29%2Eticks%28plot%5Fticks%29%29%3B%0A%0A%0A%20%20%20%20%7D%0A%0A%20%20%2F%2Fconsole%2Elog%28y%281%29%29%3B%0A%7D%0A%2F%2Abarplot%2A%2F%0A%2F%2Fconsole%2Elog%28BarData%29%0A%2F%2Ascatterplot%2A%2F%0Aif%28plots%3D%3D%22scatter%22%29%7B%0Avar%20ScData%3DJSON%2Eparse%28JSON%2Estringify%28chDataReduced%29%29%3B%0Afor%20%28var%20i%20%3D%200%3B%20i%20%3C%20ScData%2Elength%3B%20i%2B%2B%29%20%7B%0A%0A%20%20%20%20ScData%5Bi%5D%2Ekey%20%3D%20%22sc%2D%22%2BScData%5Bi%5D%2Ekey%3B%0A%20%20%7D%0A%0A%20%20%2F%2Fconsole%2Elog%28plot%5Fy%5Fdomain%29%3B%0A%20%20%2F%2F%20Add%20Y%20axis%0A%20%20if%28parseFloat%28plot%5Fy%5Fdomain%5B0%5D%29%20%3D%3D%3D%200%20%26%26%20parseFloat%28plot%5Fy%5Fdomain%5B1%5D%29%20%3D%3D%3D%200%29%7B%0A%20%20var%20scy%20%3D%20d3%2EscaleLinear%28%29%0A%20%20%20%20%2Edomain%28%5Bd3%2Emin%28ScData%2C%20function%28d%29%20%7B%20return%20d%2Emin%7D%20%29%2Cd3%2Emax%28ScData%2C%20function%28d%29%20%7B%20return%20d%2Emax%7D%20%29%5D%29%0A%20%20%20%20%2Erange%28%5B%20%28plot%5Fheight%20%2D%205%29%2C0%5D%29%2Enice%28%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20var%20scy%20%3D%20d3%2EscaleLinear%28%29%0A%20%20%20%20%2Edomain%28plot%5Fy%5Fdomain%29%0A%20%20%20%20%2Erange%28%5B%20%28plot%5Fheight%20%2D%205%29%2C0%5D%29%2Enice%28%29%3B%0A%20%20%7D%0A%20%20%20%20for%28i%3D0%3Bi%3C%20nLoci%2Elength%3Bi%2B%2B%29%7B%0A%0A%20%20%20%20%20%20svg%2Eselect%28%22%23%22%2Bdiv%5Fid%2B%22%2D%22%2B%22sc%2Daxis%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2Bploidy%29%2Ecall%28d3%2EaxisLeft%28%29%2Escale%28scy%29%2Eticks%28plot%5Fticks%29%29%0A%20%20%20%20%7D%0A%0A%7D%0A%0A%2F%2A2d%20genome%2A%2F%0Aif%28plots%3D%3D%222d%22%29%7B%0A%20%20var%20g2dData%3DJSON%2Eparse%28JSON%2Estringify%28chDataReduced%29%29%3B%0A%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20g2dData%2Elength%3B%20i%2B%2B%29%20%7B%0A%20%20%0A%20%20%20%20%20%20g2dData%5Bi%5D%2Ekey%20%3D%20%22g2d%2D%22%2Bg2dData%5Bi%5D%2Ekey%3B%0A%20%20%20%20%7D%0A%20%20%0A%20%20%20%20%2F%2Fconsole%2Elog%28plot%5Fy%5Fdomain%29%3B%0A%20%20%20%20%2F%2F%20Add%20Y%20axis%0A%20%20%20%20if%28parseFloat%28plot%5Fy%5Fdomain%5B0%5D%29%20%3D%3D%3D%200%20%26%26%20parseFloat%28plot%5Fy%5Fdomain%5B1%5D%29%20%3D%3D%3D%200%29%7B%0A%20%20%20%20var%20g2dy%20%3D%20d3%2EscaleLinear%28%29%0A%20%20%20%20%20%20%2Edomain%28%5Bd3%2Emin%28g2dData%2C%20function%28d%29%20%7B%20return%20d%2Emin%7D%20%29%2Cd3%2Emax%28g2dData%2C%20function%28d%29%20%7B%20return%20d%2Emax%7D%20%29%5D%29%0A%20%20%20%20%20%20%2Erange%28%5B%20%28plot%5Fheight%20%2D%205%20%29%2C0%5D%29%2Enice%28%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20var%20g2dy%20%3D%20d3%2EscaleLinear%28%29%0A%20%20%20%20%20%20%2Edomain%28plot%5Fy%5Fdomain%29%0A%20%20%20%20%20%20%2Erange%28%5B%20%28plot%5Fheight%20%2D%205%20%29%2C0%5D%29%2Enice%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20%20%20for%28i%3D0%3Bi%3C%20nLoci%2Elength%3Bi%2B%2B%29%7B%0A%20%20%0A%20%20%20%20%20%20%20%20svg%2Eselect%28%22%23%22%2Bdiv%5Fid%2B%22%2D%22%2B%22g2d%2Daxis%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2Bploidy%29%2Ecall%28d3%2EaxisLeft%28%29%2Escale%28g2dy%29%2Eticks%28plot%5Fticks%29%29%0A%20%20%20%20%20%20%7D%0A%20%20%0A%20%20%7D%0A%0A%20%20%2F%2F%20adding%20logic%20for%20the%20axis%2E%0A%0A%0A%2F%2Ascatterplot%2A%2F%0Aif%28plots%3D%3D%22tags%22%29%7B%0A%20%20var%20tagDatatemp%3DJSON%2Eparse%28JSON%2Estringify%28chDataReduced%29%29%3B%0A%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20tagDatatemp%2Elength%3B%20i%2B%2B%29%20%7B%0A%0A%20%20%20%20tagDatatemp%5Bi%5D%2Ekey%20%3D%20%22tags%2D%22%2BtagDatatemp%5Bi%5D%2Ekey%3B%0A%20%20%7D%0A%0A%20%20switch%28tag%5Ff%5B0%5D%29%7B%0A%20%20%20%20case%20%22eq%22%3A%0A%20%20%20%20%20%20var%20tagData%20%3D%20tagDatatemp%2Efilter%28function%28d%29%7B%20return%20d%2Evalue%20%3D%3D%20tag%5Ff%5B1%5D%20%7D%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22gt%22%3A%0A%20%20%20%20%20%20var%20tagData%20%3D%20tagDatatemp%2Efilter%28function%28d%29%7B%20return%20d%2Emax%20%3E%20tag%5Ff%5B1%5D%20%7D%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22gte%22%3A%0A%20%20%20%20%20%20var%20tagData%20%3D%20tagDatatemp%2Efilter%28function%28d%29%7B%20return%20d%2Emax%20%3E%3D%20tag%5Ff%5B1%5D%20%7D%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22lt%22%3A%0A%20%20%20%20%20%20var%20tagData%20%3D%20tagDatatemp%2Efilter%28function%28d%29%7B%20return%20d%2Emin%20%3C%20tag%5Ff%5B1%5D%20%7D%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22lte%22%3A%0A%20%20%20%20%20%20var%20tagData%20%3D%20tagDatatemp%2Efilter%28function%28d%29%7B%20return%20d%2Emin%20%3C%3D%20tag%5Ff%5B1%5D%20%7D%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22gtalt%22%3A%0A%20%20%20%20%20%20var%20tagData%20%3D%20tagDatatemp%2Efilter%28function%28d%29%7B%20return%20d%2Emax%20%3E%20tag%5Ff%5B1%5D%20%26%26%20d%2Emin%20%3C%20tag%5Ff%5B2%5D%20%7D%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22gtealte%22%3A%0A%20%20%20%20%20%20var%20tagData%20%3D%20tagDatatemp%2Efilter%28function%28d%29%7B%20return%20d%2Emax%20%3E%3D%20tag%5Ff%5B1%5D%20%26%26%20d%2Emin%20%3C%3D%20tag%5Ff%5B2%5D%20%7D%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22gtolt%22%3A%0A%20%20%20%20%20%20var%20tagData%20%3D%20tagDatatemp%2Efilter%28function%28d%29%7B%20return%20d%2Emax%20%3E%20tag%5Ff%5B1%5D%20%7C%7C%20d%2Emin%20%3C%20tag%5Ff%5B2%5D%20%7D%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22gteolte%22%3A%0A%20%20%20%20%20%20var%20tagData%20%3D%20tagDatatemp%2Efilter%28function%28d%29%7B%20return%20d%2Emax%20%3E%3D%20tag%5Ff%5B1%5D%20%7C%7C%20d%2Emin%20%3C%3D%20tag%5Ff%5B2%5D%20%7D%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22none%22%3A%0A%20%20%20%20%20%20var%20tagData%3DJSON%2Eparse%28JSON%2Estringify%28tagDatatemp%29%29%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20console%2Elog%28%22nothing%2E%22%29%0A%0A%20%20%7D%0A%0A%20%20%2F%2Fvar%20tagData%20%3D%20tagDatatemp%2Efilter%28function%28d%29%7B%20return%20d%2Emin%20%3E%2055%20%7D%29%0A%20%20%2F%2Fconsole%2Elog%28tagData%2Efilter%28function%28d%29%7B%20return%20d%2Emin%20%3E%2055%20%7D%29%29%0A%7D%0A%0A%2F%2A%20%2A%2F%0Avar%20tip%20%3D%20%5B%5D%3B%0A%20tip%5Bploidy%2D1%5D%20%3D%20d3%2Eselect%28%22body%22%29%2Eappend%28%22div%22%29%0A%20%20%20%20%2Eattr%28%22class%22%2C%20div%5Fid%2B%22%2D%22%2B%22chtooltip%22%29%0A%20%20%20%20%2Estyle%28%22opacity%22%2C%200%29%0A%20%20%20%20%2Eattr%28%22style%22%2C%20%22position%3A%20absolute%3Btext%2Dalign%3A%20center%3Bwidth%3A%20180px%3Bheight%3A%20140px%3B%09%20padding%3A%202px%3B%09font%3A%2012px%20sans%2Dserif%3B%09box%2Dsizing%3A%20border%2Dbox%3B%09border%3A%200px%3Bborder%2Dradius%3A%208px%3Bpointer%2Devents%3A%20none%3B%22%29%20%3B%0A%0A%20%20%20%20var%20tip2%20%3D%20%5B%5D%3B%0A%20%20%20%20%20tip2%5Bploidy%2D1%5D%20%3D%20d3%2Eselect%28%22body%22%29%2Eappend%28%22div%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%20div%5Fid%2B%22%2D%22%2B%22chtooltip2%22%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22opacity%22%2C%200%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22style%22%2C%20%22position%3A%20absolute%3Btext%2Dalign%3A%20center%3Bwidth%3A%20180px%3Bheight%3A%20140px%3B%09%20padding%3A%202px%3B%09font%3A%2012px%20sans%2Dserif%3B%09box%2Dsizing%3A%20border%2Dbox%3B%09border%3A%200px%3Bborder%2Dradius%3A%208px%3Bpointer%2Devents%3A%20none%3B%22%29%20%3B%0A%20%20%20%20var%20clickFlag%3Dfalse%3B%0A%0A%0A%20%20%20%20%20if%28renderHeat%29%7B%0A%0A%20%20%20%20%20if%28interactivity%29%20%7B%0A%20%20%20%20d3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%2Edata%28chDataReduced%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Ekey%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%2Eon%28%22mouseover%22%2C%20function%28d%29%20%7Btip%5Bploidy%2D1%5D%2Etransition%28%29%2Eduration%28200%29%09%2Estyle%28%22opacity%22%2C%20%2E9%29%2Estyle%28%22background%2Dcolor%22%2C%22%23F5F5F5%22%29%2Estyle%28%22width%22%2C180%2Bd%2Ecount%2A%28d3%2Emax%28d%2Elabel%29%2Elength%2A3%29%2B%27px%27%29%3B%0A%20%20%20%20%20%20tip%5Bploidy%2D1%5D%2Ehtml%28%22%3Cdiv%20%20style%3D%27float%3Atop%3Bposition%3Arelative%3Bheight%3A35%25%3B%27%20%3E%3Cdiv%20style%3D%27border%2Dradius%3A%205px%3Bfloat%3Aleft%3Bposition%3Arelative%3Bheight%3A55px%3Bwidth%3A30%25%3Bbackground%2Dcolor%3A%22%2Bcolors%5Btimes%5D%28d%2Evalue%29%2B%0A%20%20%20%20%20%20%22%3B%27%20%3E%3C%2Fdiv%3E%3Cdiv%20%20style%3D%27float%3Aleft%3Bposition%3Arelative%3Bwidth%3A70%25%3B%27%20%3E%3Cp%20%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20%22%2Btag%2B%22%3A%20%3C%2Ffont%3E%20%3Cfont%20size%3D%271%27%20%20%3E%3Cb%3E%20%22%2B%28d%2Evalue%29%2EtoFixed%282%29%2B%0A%20%20%20%20%20%20%22%20%3Cbr%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20Min%2E%3A%20%3C%2Ffont%3E%22%2B%28d%2Emin%29%2EtoFixed%282%29%2B%22%20%3Cbr%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20Max%2E%3A%20%3C%2Ffont%3E%20%22%2B%28d%2Emax%29%2EtoFixed%282%29%2B%0A%20%20%20%20%20%20%22%3C%2Ffont%3E%3Cbr%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20Count%3A%20%3C%2Ffont%3E%3Cfont%20size%3D%271%27%3E%22%2Bd%2Ecount%2B%22%3C%2Fp%3E%3C%2Ffont%3E%3C%2Fdiv%3E%3C%2Fdiv%3E%3Cdiv%20id%20%3D%27%22%2Bdiv%5Fid%2B%22%2DmicroBar%22%2Bploidy%2B%22%27%20style%3D%27float%3Atop%3Bposition%3Arelative%3Bheight%3A35%25%27%3E%3C%2Fdiv%3E%3Cbr%3E%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A20%25%3Bposition%3Arelative%3Bcolor%3A%27black%22%2B%0A%20%20%20%20%20%20%22%3B%27%3E%3Cfont%20size%3D%272%27%20%3E%22%2Bd%2Erange%2B%22%3C%2Ffont%3E%3C%2Fp%3E%3C%2Fdiv%3E%22%29%0A%20%20%20%20%20%20%2Estyle%28%22left%22%2C%20%28d3%2Eevent%2EpageX%29%20%2B%20%22px%22%29%0A%20%20%20%20%20%20%2Estyle%28%22top%22%2C%20%28d3%2Eevent%2EpageY%20%2D%2018%29%20%2B%20%22px%22%29%3B%20var%20svgWidth%20%3D%20175%2Bd%2Ecount%2A%28d3%2Emax%28d%2Elabel%29%2Elength%29%2A3%3Bvar%20svgHeight%20%3D%2050%3Bvar%20barPadding%20%3D%205%3Bvar%20barWidth%20%3D%20%28svgWidth%20%2F%20d%2Ebar%2Elength%29%3Bvar%20mysvg%20%3D%20d3%2Eselect%28%27%23%27%2Bdiv%5Fid%2B%27%2DmicroBar%27%2Bploidy%29%2Eappend%28%22svg%22%29%2Eattr%28%22width%22%2CsvgWidth%29%2Eattr%28%22heigth%22%2CsvgHeight%29%3Bvar%20barChart%20%3D%20mysvg%2EselectAll%28%27rect%27%29%2Edata%28d%2Ebar%29%2Eenter%28%29%2Eappend%28%27rect%27%29%2Eattr%28%27height%27%2CsvgHeight%2D40%29%2Eattr%28%27width%27%2C%20barWidth%29%2Eattr%28%27transform%27%2C%20function%20%28d%2C%20i%29%20%7B%20var%20translate%20%3D%20%5BbarWidth%20%2A%20i%2C%200%5D%3B%20%20return%20%27translate%28%27%2B%20translate%20%2B%27%29%27%3B%7D%29%2Estyle%28%22fill%22%2Cfunction%28d%29%7Breturn%20colors%5Btimes%5D%28d%29%3B%7D%29%3B%0A%20%20%20%20%20%20t%5Fdata%3D%5B%5D%3B%0A%20%20%20%20%20%20for%28j%3D0%3Bj%3Cd%2Elabel%2Elength%3Bj%2B%2B%29%7B%0A%20%20%20%20%20%20%20%20t%5Fdata%2Epush%28%7Blb%3Ad%2Elabel%5Bj%5D%2Chl%3Ad%2Ehlink%5Bj%5D%7D%29%3B%20%7D%0A%20%20%20%20%20%20var%20ttext%3Dmysvg%2EselectAll%28%22%2Enode%22%29%2Edata%28t%5Fdata%29%2Eenter%28%29%2Eappend%28%22svg%3Aa%22%29%2Eattr%28%22xlink%3Ahref%22%2C%20function%28d%2Ci%29%7B%20return%20d%2Ehl%3B%7D%29%0A%20%20%20%20%20%20%2Eappend%28%22svg%3Atext%22%29%2Eattr%28%22y%22%2CsvgHeight%2A0%2E4%29%2Eattr%28%22transform%22%2C%22rotate%2890%29%22%29%0A%20%20%20%20%20%20%2Eattr%28%27transform%27%2C%20function%20%28d%2C%20i%29%20%7B%20var%20translate%20%3D%20%5BbarWidth%20%2A%20i%2C%200%5D%3B%20%20return%20%27translate%28%27%2B%20translate%20%2B%27%29%27%3B%7D%29%0A%20%20%20%20%20%20%2Estyle%28%22pointer%2Devents%22%2C%20%22all%22%29%2Estyle%28%22cursor%22%2C%22pointer%22%29%2Eattr%28%22font%2Dsize%22%2C%20%229px%22%29%0A%20%20%20%20%20%20%2Etext%28function%28d%2Ci%29%7Breturn%20d%2Elb%3B%7D%29%3B%20%7D%29%0A%20%20%20%20%20%20%2Eon%28%22mouseout%22%2C%20function%28d%29%20%7B%09tip%5Bploidy%2D1%5D%2Etransition%28%29%20%2Edelay%281000%29%2Eduration%28500%29%09%2Estyle%28%22opacity%22%2C%200%29%3B%7D%29%2Estyle%28%22visibility%22%2C%22visible%22%29%2Estyle%28%22fill%22%2Cfunction%28d%29%7B%20return%20colors%5Btimes%5D%28d%2Evalue%29%3B%7D%29%0A%20%20%20%20%20%20%2Eon%28%22click%22%2C%20function%28d%29%20%7B%0A%0A%0A%20%20%20%20%20%20%20%20if%28clickFlag%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20tip2%5Bploidy%2D1%5D%2Estyle%28%22opacity%22%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7Delse%7B%0A%20%20%20%20%20%20%20%20tip2%5Bploidy%2D1%5D%2Estyle%28%22z%2Dindex%22%2C99999999%29%09%2Estyle%28%22opacity%22%2C%201%29%2Estyle%28%22background%2Dcolor%22%2C%22%23F5F5F5%22%29%2Estyle%28%22width%22%2C180%2Bd%2Ecount%2A%28d3%2Emax%28d%2Elabel%29%2Elength%2A3%29%2B%27px%27%29%3B%0A%20%20%20%20%20%20%20%20tip2%5Bploidy%2D1%5D%2Ehtml%28%22%3Cdiv%20%20style%3D%27float%3Atop%3Bposition%3Arelative%3Bheight%3A35%25%3B%27%20%3E%3Cdiv%20style%3D%27border%2Dradius%3A%205px%3Bfloat%3Aleft%3Bposition%3Arelative%3Bheight%3A55px%3Bwidth%3A30%25%3Bbackground%2Dcolor%3A%22%2Bcolors%5Btimes%5D%28d%2Evalue%29%2B%0A%20%20%20%20%20%20%20%20%22%3B%27%20%3E%3C%2Fdiv%3E%3Cdiv%20%20style%3D%27float%3Aleft%3Bposition%3Arelative%3Bwidth%3A70%25%3B%27%20%3E%3Cp%20%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20%22%2Btag%2B%22%3A%20%3C%2Ffont%3E%20%3Cfont%20size%3D%271%27%20%20%3E%3Cb%3E%20%22%2B%28d%2Evalue%29%2EtoFixed%282%29%2B%0A%20%20%20%20%20%20%20%20%22%20%3Cbr%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20Min%2E%3A%20%3C%2Ffont%3E%22%2B%28d%2Emin%29%2EtoFixed%282%29%2B%22%20%3Cbr%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20Max%2E%3A%20%3C%2Ffont%3E%20%22%2B%28d%2Emax%29%2EtoFixed%282%29%2B%0A%20%20%20%20%20%20%20%20%22%3C%2Ffont%3E%3Cbr%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20Count%3A%20%3C%2Ffont%3E%3Cfont%20size%3D%271%27%3E%22%2Bd%2Ecount%2B%22%3C%2Fp%3E%3C%2Ffont%3E%3C%2Fdiv%3E%3C%2Fdiv%3E%3Cdiv%20id%20%3D%27%22%2Bdiv%5Fid%2B%22%2DmicroBar2%22%2Bploidy%2B%22%27%20style%3D%27float%3Atop%3Bposition%3Arelative%3Bheight%3A35%25%27%3E%3C%2Fdiv%3E%3Cbr%3E%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A20%25%3Bposition%3Arelative%3Bcolor%3A%27black%22%2B%0A%20%20%20%20%20%20%20%20%22%3B%27%3E%3Cfont%20size%3D%272%27%20%3E%22%2Bd%2Erange%2B%22%3C%2Ffont%3E%3C%2Fp%3E%3C%2Fdiv%3E%22%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22left%22%2C%20%28d3%2Eevent%2EpageX%29%20%2B%20%22px%22%29%0A%20%20%20%20%20%20%20%20%2Estyle%28%22top%22%2C%20%28d3%2Eevent%2EpageY%20%2D%2018%29%20%2B%20%22px%22%29%3B%20var%20svgWidth%20%3D%20175%2Bd%2Ecount%2A%28d3%2Emax%28d%2Elabel%29%2Elength%29%2A3%3Bvar%20svgHeight%20%3D%2050%3Bvar%20barPadding%20%3D%205%3Bvar%20barWidth%20%3D%20%28svgWidth%20%2F%20d%2Ebar%2Elength%29%3Bvar%20mysvg2%20%3D%20d3%2Eselect%28%27%23%27%2Bdiv%5Fid%2B%27%2DmicroBar2%27%2Bploidy%29%2Eappend%28%22svg%22%29%2Eattr%28%22width%22%2CsvgWidth%29%2Eattr%28%22heigth%22%2CsvgHeight%29%3Bvar%20barChart%20%3D%20mysvg2%2EselectAll%28%27rect%27%29%2Edata%28d%2Ebar%29%2Eenter%28%29%2Eappend%28%27rect%27%29%2Eattr%28%27height%27%2CsvgHeight%2D40%29%2Eattr%28%27width%27%2C%20barWidth%29%2Eattr%28%27transform%27%2C%20function%20%28d%2C%20i%29%20%7B%20var%20translate%20%3D%20%5BbarWidth%20%2A%20i%2C%200%5D%3B%20%20return%20%27translate%28%27%2B%20translate%20%2B%27%29%27%3B%7D%29%2Estyle%28%22fill%22%2Cfunction%28d%29%7Breturn%20colors%5Btimes%5D%28d%29%3B%7D%29%3B%0A%20%20%20%20%20%20%20%20t%5Fdata%3D%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%28j%3D0%3Bj%3Cd%2Elabel%2Elength%3Bj%2B%2B%29%7B%0A%20%20%20%20%20%20%20%20%20%20t%5Fdata%2Epush%28%7Blb%3Ad%2Elabel%5Bj%5D%2Chl%3Ad%2Ehlink%5Bj%5D%7D%29%3B%20%7D%0A%20%20%20%20%20%20%20%20var%20ttext%3Dmysvg2%2EselectAll%28%22%2Enode%22%29%2Edata%28t%5Fdata%29%2Eenter%28%29%2Eappend%28%22svg%3Aa%22%29%2Eattr%28%22xlink%3Ahref%22%2C%20function%28d%2Ci%29%7B%20return%20d%2Ehl%3B%7D%29%2Eappend%28%22svg%3Atext%22%29%2Eattr%28%22y%22%2CsvgHeight%2A0%2E4%29%2Eattr%28%22transform%22%2C%22rotate%2890%29%22%29%2Eattr%28%27transform%27%2C%20function%20%28d%2C%20i%29%20%7B%20var%20translate%20%3D%20%5BbarWidth%20%2A%20i%2C%200%5D%3B%20%20return%20%27translate%28%27%2B%20translate%20%2B%27%29%27%3B%7D%29%2Estyle%28%22pointer%2Devents%22%2C%20%22all%22%29%2Estyle%28%22cursor%22%2C%22pointer%22%29%2Eattr%28%22font%2Dsize%22%2C%20%229px%22%29%2Etext%28function%28d%2Ci%29%7Breturn%20d%2Elb%3B%7D%29%3B%0A%20%20%20%20%20%20%7D%20return%20clickFlag%20%3D%20%21clickFlag%3B%20%7D%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%2F%2Fwithout%20interacitivuty%0A%20%20%20%20%20%20d3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%20%20%20%20%2Edata%28chDataReduced%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Ekey%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%0A%20%20%20%20%20%20%2Estyle%28%22visibility%22%2C%22visible%22%29%0A%20%20%20%20%20%20%2Estyle%28%22fill%22%2Cfunction%28d%29%7B%20return%20colors%5Btimes%5D%28d%2Evalue%29%3B%7D%29%3B%0A%20%20%20%20%20%20%0A%0A%20%20%20%20%20%20%2F%2Fwithout%20interactivity%20end%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20%2F%2Aend%20of%20renderHeat%2A%2F%20%7D%20else%20%7B%0A%20%20%20%20%0A%20%20%20%20%20%20if%28interactivity%29%7B%0A%20%20%20%20d3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%2Edata%28chDataReduced%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Ekey%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%2Eon%28%22mouseover%22%2C%20function%28d%29%20%7Btip%5Bploidy%2D1%5D%2Etransition%28%29%2Eduration%28200%29%09%2Estyle%28%22opacity%22%2C%20%2E9%29%2Estyle%28%22background%2Dcolor%22%2C%22%23F5F5F5%22%29%3B%09tip%5Bploidy%2D1%5D%2Estyle%28%22height%22%2C100%2Bd%2Elen%2A1%2E5%29%2Estyle%28%22width%22%2C190%2Bd%2Elen%29%3B%0A%20%20%20%20tip%5Bploidy%2D1%5D%2Ehtml%28%22%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A10%25%3Bcolor%3Ablack%3Bfont%2Dsize%3A12px%3B%27%3E%3Cp%3E%22%2Bd%2Erange%2B%22%3C%2Fp%3E%3C%2Fdiv%3E%3Chr%3E%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A10%25%3B%27%3E%3Cp%20%3E%3Cb%3E%22%2Bd%2Estatic%2B%22%3C%2Ffont%3E%3C%2Fdiv%3E%22%29%2Estyle%28%22left%22%2C%20%28d3%2Eevent%2EpageX%29%20%2B%20%22px%22%29%09%2Estyle%28%22top%22%2C%20%28d3%2Eevent%2EpageY%20%2D%2018%29%20%2B%20%22px%22%29%3B%7D%29%2Eon%28%22mouseout%22%2C%20function%28d%29%20%7B%09tip%5Bploidy%2D1%5D%2Etransition%28%29%20%2Edelay%281000%29%2Eduration%28500%29%09%2Estyle%28%22opacity%22%2C%200%29%3B%7D%29%2Eattr%28%22fill%22%2C%20an%5Fcol%29%0A%20%20%20%20%2Eon%28%22click%22%2C%20function%28d%29%20%7B%0A%0A%0A%20%20%20%20%20%20if%28clickFlag%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20tip2%5Bploidy%2D1%5D%2Estyle%28%22opacity%22%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%7Delse%7B%0A%20%20%20%20%20%20%20%20%20%20tip2%5Bploidy%2D1%5D%2Etransition%28%29%2Eduration%28200%29%09%2Estyle%28%22opacity%22%2C%201%29%2Estyle%28%22background%2Dcolor%22%2C%22%23F5F5F5%22%29%3B%09tip2%5Bploidy%2D1%5D%2Estyle%28%22height%22%2C100%2Bd%2Elen%2A1%2E5%29%2Estyle%28%22width%22%2C190%2Bd%2Elen%29%3B%0A%20%20%20%20%20%20%20%20%20%20tip2%5Bploidy%2D1%5D%2Ehtml%28%22%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A10%25%3Bcolor%3Ablack%3Bfont%2Dsize%3A12px%3B%27%3E%3Cp%3E%22%2Bd%2Erange%2B%22%3C%2Fp%3E%3C%2Fdiv%3E%3Chr%3E%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A10%25%3B%27%3E%3Cp%20%3E%3Cb%3E%22%2Bd%2Estatic%2B%22%3C%2Ffont%3E%3C%2Fdiv%3E%22%29%2Estyle%28%22left%22%2C%20%28d3%2Eevent%2EpageX%29%20%2B%20%22px%22%29%09%2Estyle%28%22top%22%2C%20%28d3%2Eevent%2EpageY%20%2D%2018%29%20%2B%20%22px%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%7D%20return%20clickFlag%20%3D%20%21clickFlag%3B%20%7D%29%3B%0A%7D%20else%20%7B%0A%20%20%2F%2Fwithout%20interactvity%0A%20%20d3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%2Edata%28chDataReduced%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Ekey%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%0A%20%20%2Eattr%28%22fill%22%2C%20an%5Fcol%29%3B%0A%20%20%0A%20%20%2F%2Fwithout%20interactivity%20ends%0A%7D%0A%0A%20%20%2F%2Aend%20of%20renderHeat%20else%2A%2F%7D%0A%0A%20%20%20%20%20%20if%28labels%29%7B%0A%0A%20%20%20%20%20%20%20%20var%20chDataLabels%20%3D%20d3%2Enest%28%29%0A%20%20%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%20%20%2Erollup%28function%28v%29%20%7B%20%20var%20a%3D%5B%5D%3Bfor%28var%20i%3D0%3B%20i%3C%20v%2Elength%3Bi%2B%2B%29%7B%20a%2Epush%28v%5Bi%5D%2Ename%29%3B%20%20%20%7D%3Breturn%20a%5B0%5D%3B%7D%29%0A%20%20%20%20%2Eentries%28chData%29%3B%0A%0A%20%20%20%20var%20chDataLabel%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20%20var%20a%3D%5B%5D%3Bfor%28var%20i%3D0%3B%20i%3C%20v%2Elength%3Bi%2B%2B%29%7B%20a%2Epush%28v%5Bi%5D%2Elabel%29%3B%20%20%20%7D%3Breturn%20a%5B0%5D%3B%7D%29%0A%2Eentries%28chData%29%3B%0A%20%20%20%20%20%20%20for%28var%20i%20%3D%200%3Bi%20%3C%20chDataReduced%2Elength%3Bi%2B%2B%29%20%7B%0A%0A%0A%20%20%20%20%20%20%20%20chDataReduced%5Bi%5D%2Elabel%5Fid%3DchDataLabel%5Bi%5D%2Evalue%3B%0A%20%20%20%20%20%20%20%20chDataReduced%5Bi%5D%2Elabels%20%3DchDataLabels%5Bi%5D%2Evalue%3B%0A%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%2F%2Fconsole%2Elog%28chDataReduced%29%3B%0A%20%20%20%20%20delete%20chDataLabels%3B%0A%0A%20%20%20%20%20%20%20d3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22labels%22%29%2Edata%28chDataReduced%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Elabel%5Fid%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%0A%20%20%20%20%20%20%20%2Etext%28function%28d%29%7B%20return%20d%2Elabels%3B%7D%29%0A%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20var%20xRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22x%22%29%3B%0A%20%20%20%20%20%20%20%20var%20yRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22y%22%29%3B%0A%20%20%20%20%20%20%20%20return%20%60rotate%28%24%7Blabel%5Fangle%7D%2C%20%24%7BxRot%7D%2C%20%20%24%7ByRot%7D%20%29%60%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%7D%0A%0A%0Aif%28plots%3D%3D%22bar%22%29%7B%0A%2F%2Abar%2A%2F%0A%0Ad3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22barplot%22%29%2Edata%28BarData%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Ekey%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%0A%2Eattr%28%22fill%22%2Cfunction%28d%29%7B%0A%20%20%2F%2Fif%28d%2Evalue%20%3E%3D%200%29%7B%20return%20plot%5Fcolor%3B%7D%20else%20%7Breturn%20%22red%22%3B%7D%0A%20%20switch%28plot%5Ff%5B0%5D%29%7B%0A%20%20%20%20case%20%22eq%22%3A%0A%20%20%20%20%20%20if%28d%2Evalue%20%3D%3D%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20case%20%22gt%22%3A%0A%20%20%20%20%20%20if%28d%2Evalue%20%3E%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20case%20%22gte%22%3A%0A%20%20%20%20%20%20if%28d%2Evalue%20%3E%3D%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20case%20%22lt%22%3A%0A%20%20%20%20%20%20if%28d%2Evalue%20%3C%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20case%20%22lte%22%3A%0A%20%20%20%20%20%20if%28d%2Evalue%20%3C%3D%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20case%20%22gtalt%22%3A%0A%20%20%20%20%20%20if%28d%2Evalue%20%3E%20plot%5Ff%5B1%5D%20%26%26%20d%2Evalue%20%3C%20plot%5Ff%5B2%5D%29%7Breturn%20plot%5Ff%5B3%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20case%20%22gtealte%22%3A%0A%20%20%20%20%20%20if%28d%2Evalue%20%3E%3D%20plot%5Ff%5B1%5D%20%26%26%20d%2Evalue%20%3C%3D%20plot%5Ff%5B2%5D%29%7Breturn%20plot%5Ff%5B3%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20case%20%22gtolt%22%3A%0A%20%20%20%20%20%20if%28d%2Evalue%20%3E%20plot%5Ff%5B1%5D%20%7C%7C%20d%2Evalue%20%3C%20plot%5Ff%5B2%5D%29%7Breturn%20plot%5Ff%5B3%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20case%20%22gteolte%22%3A%0A%20%20%20%20%20%20if%28d%2Evalue%20%3E%3D%20plot%5Ff%5B1%5D%20%7C%7C%20d%2Evalue%20%3C%3D%20plot%5Ff%5B2%5D%29%7Breturn%20plot%5Ff%5B3%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20case%20%22none%22%3A%0A%20%20%20%20%20%20return%20plot%5Fcolor%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20return%20plot%5Fcolor%3B%0A%0A%20%20%7D%0A%0A%7D%29%0A%2Eattr%28%22fill%2Dopacity%22%2C1%29%0A%20%20%2Eattr%28%22y%22%2C%20function%28d%29%7B%20return%20d3%2Eselect%28this%29%2Eattr%28%27y%27%29%20%2D%200%2E001%2By%28d%2Evalue%29%3B%7D%29%0A%20%20%2Eattr%28%22height%22%2Cfunction%28d%29%20%7B%20return%20plot%5Fheight%2Dy%28d%2Evalue%29%3B%20%7D%29%3B%0A%20%20%20%20if%28ref%5Fline%29%7B%0A%20%20%20%20%20%20for%28i%3D0%3Bi%3C%20nLoci%2Elength%3Bi%2B%2B%29%7B%0A%0A%20%20%20%20%20%20%20%20svg%2Eselect%28%22%23%22%2Bdiv%5Fid%2B%22%2D%22%2B%22bar%2Daxis%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2Bploidy%29%2Eappend%28%22line%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22x1%22%2C%200%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22x2%22%2C%20left%5Fmargin%20%2B%20%20%28win%5Fscale%2Aloci%5Fwidth%29%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22y1%22%2C%20%20y%28refl%5Fpos%29%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22y2%22%2C%20y%28refl%5Fpos%29%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%22%2C%20refl%5Fcolor%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%2Ddasharray%22%2C%225%2C5%22%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%2Dwidth%22%2Crefl%5Fstroke%5Fw%29%0A%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22overlines%22%29%3B%0A%0A%0A%20%20%20%20%20%20%7D%7D%0A%7D%0A%2F%2A%2A%2F%0A%2F%2Ascatter%2A%2F%0Aif%28plots%3D%3D%22scatter%22%29%7B%0A%20%20%2F%2Fconsole%2Elog%28ScData%29%3B%0A%20%20var%20sc%5Ftip%20%3D%20%5B%5D%3B%0A%20%20sc%5Ftip%5Bploidy%2D1%5D%20%3D%20d3%2Eselect%28%22body%22%29%2Eappend%28%22div%22%29%0A%20%20%20%20%20%2Eattr%28%22class%22%2C%20div%5Fid%2B%22%2D%22%2B%22scattertooltip%22%29%0A%20%20%20%20%20%2Estyle%28%22opacity%22%2C%200%29%0A%20%20%20%20%20%2Eattr%28%22style%22%2C%20%22position%3A%20absolute%3Btext%2Dalign%3A%20center%3Bwidth%3A%20100px%3Bheight%3A%2050px%3B%09%20padding%3A%202px%3B%09font%3A%2012px%20sans%2Dserif%3B%09box%2Dsizing%3A%20border%2Dbox%3B%09border%3A%200px%3Bborder%2Dradius%3A%208px%3Bpointer%2Devents%3A%20none%3B%22%29%20%3B%0A%0Ad3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22scplot%22%29%2Edata%28ScData%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Ekey%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%2EselectAll%28%22dots%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Edata%28function%28d%2Ci%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20var%20sc%5Fdata%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20for%28var%20l%3D0%3Bl%3Cd%2Ebar%2Elength%3Bl%2B%2B%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20objj%20%3D%20%7B%22br%22%3Ad%2Ebar%5Bl%5D%2C%22nm%22%3Ad%2Elabel%5Bl%5D%2C%22cte%22%3Ad%2Ecategory%5Bl%5D%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sc%5Fdata%2Epush%28objj%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20return%20sc%5Fdata%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22circle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22cx%22%2C%20loci%5Fwidth%2F2%20%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22cy%22%2C%20function%20%28d%29%20%7B%20return%20scy%28d%2Ebr%29%3B%20%7D%20%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22r%22%2C%201%2E5%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22fill%22%2C%20function%28d%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Fif%28d%2Ebr%20%3E%3D%200%29%7B%20return%20plot%5Fcolor%3B%7D%20else%20%7Breturn%20%22red%22%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Fvar%20scatter%5Ffill%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20switch%28plot%5Ff%5B0%5D%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22eq%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3D%3D%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22gt%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3E%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22gte%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3E%3D%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22lt%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3C%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22lte%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3C%3D%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22gtalt%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3E%20plot%5Ff%5B1%5D%20%26%26%20d%2Ebr%20%3C%20plot%5Ff%5B2%5D%29%7Breturn%20plot%5Ff%5B3%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22gtealte%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3E%3D%20plot%5Ff%5B1%5D%20%26%26%20d%2Ebr%20%3C%3D%20plot%5Ff%5B2%5D%29%7Breturn%20plot%5Ff%5B3%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22gtolt%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3E%20plot%5Ff%5B1%5D%20%7C%7C%20d%2Ebr%20%3C%20plot%5Ff%5B2%5D%29%7Breturn%20plot%5Ff%5B3%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22gteolte%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3E%3D%20plot%5Ff%5B1%5D%20%7C%7C%20d%2Ebr%20%3C%3D%20plot%5Ff%5B2%5D%29%7Breturn%20plot%5Ff%5B3%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22none%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20plot%5Fcolor%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22col%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20scatter%5Fcolor%5Fmap%5Ffn%28d%2Ecte%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20plot%5Fcolor%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eon%28%22mouseover%22%2C%20function%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20sc%5Ftip%5Bploidy%2D1%5D%2Etransition%28%29%2Eduration%28200%29%2Estyle%28%22opacity%22%2C%20%2E9%29%2Estyle%28%22background%2Dcolor%22%2C%22%23F5F5F5%22%29%2Estyle%28%22width%22%2C100%2B%28d%2Enm%2Elength%2A3%29%2B%27px%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20sc%5Ftip%5Bploidy%2D1%5D%2Ehtml%28%22name%3A%20%22%2Bd%2Enm%2B%22%3Cbr%3E%20value%3A%20%22%2Bd%2Ebr%2EtoFixed%282%29%29%2Estyle%28%22left%22%2C%20%28d3%2Eevent%2EpageX%29%20%2B%20%22px%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22top%22%2C%20%28d3%2Eevent%2EpageY%20%2D%2018%29%20%2B%20%22px%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%2Eon%28%22mouseout%22%2C%20function%28d%29%20%7B%09sc%5Ftip%5Bploidy%2D1%5D%2Etransition%28%29%20%2Edelay%281000%29%2Eduration%28500%29%09%2Estyle%28%22opacity%22%2C%200%29%3B%7D%29%3B%0A%20%20%20%20%20%20%20%20if%28ref%5Fline%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20for%28i%3D0%3Bi%3C%20nLoci%2Elength%3Bi%2B%2B%29%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20svg%2Eselect%28%22%23%22%2Bdiv%5Fid%2B%22%2D%22%2B%22sc%2Daxis%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2Bploidy%29%2Eappend%28%22line%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x1%22%2C%200%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x2%22%2C%20left%5Fmargin%20%2B%20%20%28win%5Fscale%2Aloci%5Fwidth%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y1%22%2C%20%20scy%28refl%5Fpos%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y2%22%2C%20scy%28refl%5Fpos%29%20%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%22%2C%20refl%5Fcolor%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%2Ddasharray%22%2C%225%2C5%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%2Dwidth%22%2Crefl%5Fstroke%5Fw%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22overlines%22%29%3B%0A%0A%0A%20%20%20%20%20%20%20%20%20%20%7D%7D%0A%7D%0A%2F%2A%2A%2F%0A%0Avar%20gnbox%20%3D%20%7B%20%0A%20%20draw%3A%20function%28context%2C%20size%29%7B%0A%20%20%20%20%20%20let%20s%20%3D%20Math%2Esqrt%28size%29%2F2%3B%0A%20%20%20%20%20%20let%20h%20%3D%20ann%5Fh%3B%0A%20%20%20%20%20%20context%2EmoveTo%28s%2Ch%29%3B%0A%20%20%20%20%20%20context%2ElineTo%28s%2C%2Dh%29%3B%0A%20%20%20%20%20%20context%2ElineTo%28%2Ds%2C%2Dh%29%3B%0A%20%20%20%20%20%20context%2ElineTo%28%2Ds%2Ch%29%3B%0A%20%20%20%20%20%20context%2EclosePath%28%29%3B%0A%20%20%7D%0A%7D%0A%0A%2F%2A2d%20genome%20plot%2A%2F%0Aif%28plots%3D%3D%222d%22%29%7B%0A%20%20%0A%20%20var%20g2d%5Ftip%20%3D%20%5B%5D%3B%0A%20%20g2d%5Ftip%5Bploidy%2D1%5D%20%3D%20d3%2Eselect%28%22body%22%29%2Eappend%28%22div%22%29%0A%20%20%20%20%20%2Eattr%28%22class%22%2C%20div%5Fid%2B%22%2D%22%2B%22g2dtooltip%22%29%0A%20%20%20%20%20%2Estyle%28%22opacity%22%2C%200%29%0A%20%20%20%20%20%2Eattr%28%22style%22%2C%20%22position%3A%20absolute%3Btext%2Dalign%3A%20center%3Bwidth%3A%20100px%3Bheight%3A%2050px%3B%09%20padding%3A%202px%3B%09font%3A%2012px%20sans%2Dserif%3B%09box%2Dsizing%3A%20border%2Dbox%3B%09border%3A%200px%3Bborder%2Dradius%3A%208px%3Bpointer%2Devents%3A%20none%3B%22%29%20%3B%0A%0Ad3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22g2dplot%22%29%2Edata%28g2dData%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Ekey%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%2EselectAll%28%22paths%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Edata%28function%28d%2Ci%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20var%20sc%5Fdata%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20for%28var%20l%3D0%3Bl%3Cd%2Ebar%2Elength%3Bl%2B%2B%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20objj%20%3D%20%7B%22br%22%3Ad%2Ebar%5Bl%5D%2C%22nm%22%3Ad%2Elabel%5Bl%5D%2C%22cte%22%3Ad%2Ecategory%5Bl%5D%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sc%5Fdata%2Epush%28objj%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20return%20sc%5Fdata%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eenter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22path%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22d%22%2Cd3%2Esymbol%28%29%2Esize%28loci%5Fwidth%2Aloci%5Fwidth%29%2Etype%28gnbox%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2Cfunction%20%28d%29%20%7B%20return%20%22translate%28%22%2B%28loci%5Fwidth%2F2%29%2B%22%2C%22%2Bg2dy%28d%2Ebr%29%2B%22%29%22%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22fill%22%2C%20function%28d%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Fif%28d%2Ebr%20%3E%3D%200%29%7B%20return%20plot%5Fcolor%3B%7D%20else%20%7Breturn%20%22red%22%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Fvar%20scatter%5Ffill%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20switch%28plot%5Ff%5B0%5D%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22eq%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3D%3D%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22gt%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3E%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22gte%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3E%3D%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22lt%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3C%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22lte%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3C%3D%20plot%5Ff%5B1%5D%29%7Breturn%20plot%5Ff%5B2%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22gtalt%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3E%20plot%5Ff%5B1%5D%20%26%26%20d%2Ebr%20%3C%20plot%5Ff%5B2%5D%29%7Breturn%20plot%5Ff%5B3%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22gtealte%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3E%3D%20plot%5Ff%5B1%5D%20%26%26%20d%2Ebr%20%3C%3D%20plot%5Ff%5B2%5D%29%7Breturn%20plot%5Ff%5B3%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22gtolt%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3E%20plot%5Ff%5B1%5D%20%7C%7C%20d%2Ebr%20%3C%20plot%5Ff%5B2%5D%29%7Breturn%20plot%5Ff%5B3%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22gteolte%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28d%2Ebr%20%3E%3D%20plot%5Ff%5B1%5D%20%7C%7C%20d%2Ebr%20%3C%3D%20plot%5Ff%5B2%5D%29%7Breturn%20plot%5Ff%5B3%5D%3B%20%7D%20else%20%7Breturn%20plot%5Fcolor%3B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22none%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20plot%5Fcolor%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%22col%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28plot%5Ff%5B1%5D%20%3D%3D%20%22byCategory%22%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20scatter%5Fcolor%5Fmap%5Ffn%28d%2Ecte%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20colors%5Btimes%5D%28d%2Ecte%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20plot%5Fcolor%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eon%28%22mouseover%22%2C%20function%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20g2d%5Ftip%5Bploidy%2D1%5D%2Etransition%28%29%2Eduration%28200%29%2Estyle%28%22opacity%22%2C%20%2E9%29%2Estyle%28%22background%2Dcolor%22%2C%22%23F5F5F5%22%29%2Estyle%28%22width%22%2C100%2B%28d%2Enm%2Elength%2A3%29%2B%27px%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20g2d%5Ftip%5Bploidy%2D1%5D%2Ehtml%28%22name%3A%20%22%2Bd%2Enm%2B%22%3Cbr%3E%20value%3A%20%22%2Bd%2Ecte%2B%22%3Cbr%3E%20position%3A%20%22%2Bd%2Ebr%29%2Estyle%28%22left%22%2C%20%28d3%2Eevent%2EpageX%29%20%2B%20%22px%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22top%22%2C%20%28d3%2Eevent%2EpageY%20%2D%2018%29%20%2B%20%22px%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%2Eon%28%22mouseout%22%2C%20function%28d%29%20%7B%09g2d%5Ftip%5Bploidy%2D1%5D%2Etransition%28%29%20%2Edelay%281000%29%2Eduration%28500%29%09%2Estyle%28%22opacity%22%2C%200%29%3B%7D%29%3B%0A%20%20%20%20%20%20%20%20if%28ref%5Fline%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20for%28i%3D0%3Bi%3C%20nLoci%2Elength%3Bi%2B%2B%29%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20svg%2Eselect%28%22%23%22%2Bdiv%5Fid%2B%22%2D%22%2B%22g2d%2Daxis%2D%22%2BnLoci%5Bi%5D%2Ename%2B%22%2D%22%2Bploidy%29%2Eappend%28%22line%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x1%22%2C%200%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x2%22%2C%20left%5Fmargin%20%2B%20%20%28win%5Fscale%2Aloci%5Fwidth%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y1%22%2C%20%20g2dy%28refl%5Fpos%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y2%22%2C%20g2dy%28refl%5Fpos%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%22%2C%20refl%5Fcolor%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%2Ddasharray%22%2C%225%2C5%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%2Dwidth%22%2Crefl%5Fstroke%5Fw%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2Cdiv%5Fid%2B%22%2D%22%2B%22overlines2%22%29%3B%0A%0A%0A%20%20%20%20%20%20%20%20%20%20%7D%7D%0A%7D%0A%2F%2A%2A%2F%0A%0Aif%28plots%3D%3D%22tags%22%29%7B%0A%20%20d3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22tags%22%29%2Edata%28tagData%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Ekey%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22line%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x1%22%2C%20loci%5Fwidth%2F2%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22x2%22%2C%20loci%5Fwidth%2F2%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y1%22%2C%200%20%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22y2%22%2C%20plot%5Fheight%20%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22stroke%22%2C%20%22black%22%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20d3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22tags%22%29%2Edata%28tagData%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Ekey%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22circle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22cx%22%2C%20loci%5Fwidth%2F2%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22cy%22%2C%20loci%5Fwidth%2F2%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22r%22%2C%20loci%5Fwidth%2F2%20%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22fill%22%2C%20tagColor%29%3B%0A%0A%20%20%7D%0A%0A%0A%0A%0A%7D%20else%20%7B%0A%20%20if%28heat%5Fscale%3D%3D%22ordinal%22%29%7B%0A%20%20var%20chDataReduced%20%3D%20d3%2Enest%28%29%0A%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%2Erollup%28function%28v%29%20%7B%20%20var%20a%3D%5B%5D%3Bfor%28var%20i%3D0%3B%20i%3C%20v%2Elength%3Bi%2B%2B%29%7B%20a%2Epush%28v%5Bi%5D%2Edata%29%3B%20%20%20%7D%3Breturn%20a%5B0%5D%3B%7D%29%0A%20%20%2Eentries%28chData%29%3B%0A%0A%0A%20%20var%20chDataReducedBarData%20%3D%20d3%2Enest%28%29%0A%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%2Erollup%28function%28v%29%20%7B%20v%3Dv%2Esort%28function%28a%2Cb%29%7Breturn%20Math%2Eabs%28a%5B%27ch%5Fstart%27%5D%29%20%2D%20Math%2Eabs%28b%5B%27ch%5Fstart%27%5D%29%7D%29%3Bbar%3D%5B%5D%3B%20for%28var%20g%3D0%3Bg%3Cv%2Elength%3Bg%2B%2B%29%7Bbar%2Epush%28v%5Bg%5D%2Edata%29%3B%7D%3Breturn%20bar%3B%7D%29%0A%20%20%2Eentries%28chData%29%3B%0A%20%20var%20chDataReducedBarLabel%20%3D%20d3%2Enest%28%29%0A%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%2Erollup%28function%28v%29%20%7B%20v%3Dv%2Esort%28function%28a%2Cb%29%7Breturn%20Math%2Eabs%28a%5B%27ch%5Fstart%27%5D%29%20%2D%20Math%2Eabs%28b%5B%27ch%5Fstart%27%5D%29%7D%29%3Bbar%3D%5B%5D%3B%20for%28var%20g%3D0%3Bg%3Cv%2Elength%3Bg%2B%2B%29%7Bbar%2Epush%28v%5Bg%5D%2Ename%29%3B%7D%3Breturn%20bar%3B%7D%29%0A%20%20%2Eentries%28chData%29%3B%0A%0A%20%20var%20chDataReducedBarLink%20%3D%20d3%2Enest%28%29%0A%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%2Erollup%28function%28v%29%20%7B%20v%3Dv%2Esort%28function%28a%2Cb%29%7Breturn%20Math%2Eabs%28a%5B%27ch%5Fstart%27%5D%29%20%2D%20Math%2Eabs%28b%5B%27ch%5Fstart%27%5D%29%7D%29%3Bbar%3D%5B%5D%3B%20for%28var%20g%3D0%3Bg%3Cv%2Elength%3Bg%2B%2B%29%7Bbar%2Epush%28v%5Bg%5D%2Ehlink%29%3B%7D%3Breturn%20bar%3B%7D%29%0A%20%20%2Eentries%28chData%29%3B%0A%20%20var%20chDataReducedCount%20%3D%20d3%2Enest%28%29%0A%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%2Erollup%28function%28v%29%20%7B%20return%20v%2Elength%3B%7D%29%0A%20%20%2Eentries%28chData%29%3B%0A%09var%20chDataRange%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20%20var%20a%2Cb%3Bfor%28var%20i%3D0%3B%20i%3C%20v%2Elength%3Bi%2B%2B%29%7B%20a%20%3D%20v%5Bi%5D%2Eloci%5Fstart%3B%20b%3Dv%5Bi%5D%2Eloci%5Fend%3B%20%20%20%20%7D%3Breturn%20%22%22%2Ba%2B%22%2D%22%2Bb%2B%22bp%20%22%3B%7D%29%0A%2Eentries%28chData%29%3B%0A%0A%20%20for%28var%20i%20%3D%200%3Bi%20%3C%20chDataReduced%2Elength%3Bi%2B%2B%29%20%7B%0A%0A%0A%20%20%20%20chDataReduced%5Bi%5D%2Erange%20%3D%20chDataRange%5Bi%5D%2Evalue%3B%0A%0A%20%20%20%20chDataReduced%5Bi%5D%2Ebar%20%3D%20chDataReducedBarData%5Bi%5D%2Evalue%3B%0A%20%20%20%20chDataReduced%5Bi%5D%2Elabel%20%3D%20chDataReducedBarLabel%5Bi%5D%2Evalue%3B%0A%20%20%20%20chDataReduced%5Bi%5D%2Ecount%20%3D%20chDataReducedCount%5Bi%5D%2Evalue%3B%0A%20%20%20%20chDataReduced%5Bi%5D%2Ehlink%20%3D%20chDataReducedBarLink%5Bi%5D%2Evalue%3B%0A%20%20%7D%0A%20%20%20%0A%20%20delete%20chDataReducedBarData%3B%0A%20%20delete%20chDataReducedBarLabel%3B%0A%20%20delete%20chDataReducedCount%3B%0A%20%20delete%20chDataReducedBarLabel%3B%0A%0A%20%20var%20tip%20%3D%20%5B%5D%3B%0A%20%20tip%5Bploidy%2D1%5D%20%3D%20d3%2Eselect%28%22body%22%29%2Eappend%28%22div%22%29%0A%20%20%20%20%20%2Eattr%28%22class%22%2C%20div%5Fid%2B%22%2D%22%2B%22chtooltip%22%29%0A%20%20%20%20%20%2Estyle%28%22opacity%22%2C%200%29%0A%20%20%20%20%20%2Eattr%28%22style%22%2C%20%22position%3A%20absolute%3Btext%2Dalign%3A%20center%3Bwidth%3A%20180px%3Bheight%3A%20140px%3B%09%20padding%3A%202px%3B%09font%3A%2012px%20sans%2Dserif%3B%09box%2Dsizing%3A%20border%2Dbox%3B%09border%3A%200px%3Bborder%2Dradius%3A%208px%3Bpointer%2Devents%3A%20none%3B%22%29%20%3B%0A%0A%20%20%20%20%20var%20tip2%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20tip2%5Bploidy%2D1%5D%20%3D%20d3%2Eselect%28%22body%22%29%2Eappend%28%22div%22%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%20div%5Fid%2B%22%2D%22%2B%22chtooltip2%22%29%0A%20%20%20%20%20%20%20%20%20%2Estyle%28%22opacity%22%2C%200%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22style%22%2C%20%22position%3A%20absolute%3Btext%2Dalign%3A%20center%3Bwidth%3A%20180px%3Bheight%3A%20140px%3B%09%20padding%3A%202px%3B%09font%3A%2012px%20sans%2Dserif%3B%09box%2Dsizing%3A%20border%2Dbox%3B%09border%3A%200px%3Bborder%2Dradius%3A%208px%3Bpointer%2Devents%3A%20none%3B%22%29%20%3B%0A%20%20%20%20%20var%20clickFlag%3Dfalse%3B%0A%20%20%20%20%20if%28interactivity%29%7B%0A%0A%20%20%20%20%20d3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%2Edata%28chDataReduced%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Ekey%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%2Eon%28%22mouseover%22%2C%20function%28d%29%20%7Btip%5Bploidy%2D1%5D%2Etransition%28%29%2Eduration%28200%29%09%2Estyle%28%22opacity%22%2C%20%2E9%29%2Estyle%28%22background%2Dcolor%22%2C%22%23F5F5F5%22%29%2Estyle%28%22width%22%2C180%2Bd%2Ecount%2A%28d3%2Emax%28d%2Elabel%29%2Elength%2A3%29%2B%27px%27%29%3B%0A%20%20%20%20%20tip%5Bploidy%2D1%5D%2Ehtml%28%22%3Cdiv%20%20style%3D%27float%3Atop%3Bposition%3Arelative%3Bheight%3A35%25%3B%27%20%3E%3Cdiv%20style%3D%27border%2Dradius%3A%205px%3Bfloat%3Aleft%3Bposition%3Arelative%3Bheight%3A55px%3Bwidth%3A30%25%3Bbackground%2Dcolor%3A%22%2Bcolors%5Btimes%5D%28d%2Evalue%29%2B%0A%20%20%20%20%20%22%3B%27%20%3E%3C%2Fdiv%3E%3Cdiv%20%20style%3D%27float%3Aleft%3Bposition%3Arelative%3Bwidth%3A70%25%3B%27%20%3E%3Cp%20%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20%20%3C%2Ffont%3E%20%3Cfont%20size%3D%271%27%20%20%3E%3Cb%3E%20%22%2B%22%22%2B%0A%20%20%20%20%20%22%20%3Cbr%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20Count%3A%3C%2Ffont%3E%22%2Bd%2Ecount%2B%22%20%3Cbr%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20%20%3C%2Ffont%3E%20%22%2B%22%22%2B%0A%20%20%20%20%20%22%3C%2Ffont%3E%3Cbr%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20%20%3C%2Ffont%3E%3Cfont%20size%3D%271%27%3E%22%2B%22%22%2B%22%3C%2Fp%3E%3C%2Ffont%3E%3C%2Fdiv%3E%3C%2Fdiv%3E%3Cdiv%20id%20%3D%27%22%2Bdiv%5Fid%2B%22%2DmicroBar%22%2Bploidy%2B%22%27%20style%3D%27float%3Atop%3Bposition%3Arelative%3Bheight%3A35%25%27%3E%3C%2Fdiv%3E%3Cbr%3E%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A20%25%3Bposition%3Arelative%3Bcolor%3A%27black%22%2B%0A%20%20%20%20%20%22%3B%27%3E%3Cfont%20size%3D%272%27%20%3E%22%2Bd%2Erange%2B%22%3C%2Ffont%3E%3C%2Fp%3E%3C%2Fdiv%3E%22%29%0A%20%20%20%20%20%2Estyle%28%22left%22%2C%20%28d3%2Eevent%2EpageX%29%20%2B%20%22px%22%29%0A%20%20%20%20%20%2Estyle%28%22top%22%2C%20%28d3%2Eevent%2EpageY%20%2D%2018%29%20%2B%20%22px%22%29%3B%20var%20svgWidth%20%3D%20175%2Bd%2Ecount%2A%28d3%2Emax%28d%2Elabel%29%2Elength%29%2A3%3Bvar%20svgHeight%20%3D%2050%3Bvar%20barPadding%20%3D%205%3Bvar%20barWidth%20%3D%20%28svgWidth%20%2F%20d%2Ebar%2Elength%29%3Bvar%20mysvg%20%3D%20d3%2Eselect%28%27%23%27%2Bdiv%5Fid%2B%27%2DmicroBar%27%2Bploidy%29%2Eappend%28%22svg%22%29%2Eattr%28%22width%22%2CsvgWidth%29%2Eattr%28%22heigth%22%2CsvgHeight%29%3Bvar%20barChart%20%3D%20mysvg%2EselectAll%28%27rect%27%29%2Edata%28d%2Ebar%29%2Eenter%28%29%2Eappend%28%27rect%27%29%2Eattr%28%27height%27%2CsvgHeight%2D40%29%2Eattr%28%27width%27%2C%20barWidth%29%2Eattr%28%27transform%27%2C%20function%20%28d%2C%20i%29%20%7B%20var%20translate%20%3D%20%5BbarWidth%20%2A%20i%2C%200%5D%3B%20%20return%20%27translate%28%27%2B%20translate%20%2B%27%29%27%3B%7D%29%2Estyle%28%22fill%22%2Cfunction%28d%29%7Breturn%20colors%5Btimes%5D%28d%29%3B%7D%29%3B%0A%20%20%20%20%20%20t%5Fdata%3D%5B%5D%3B%0A%20%20%20%20%20%20for%28j%3D0%3Bj%3Cd%2Elabel%2Elength%3Bj%2B%2B%29%7B%0A%20%20%20%20%20%20%20%20t%5Fdata%2Epush%28%7Blb%3Ad%2Elabel%5Bj%5D%2Chl%3Ad%2Ehlink%5Bj%5D%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20var%20ttext%3Dmysvg%2EselectAll%28%22%2Enode%22%29%2Edata%28t%5Fdata%29%2Eenter%28%29%2Eappend%28%22svg%3Aa%22%29%2Eattr%28%22xlink%3Ahref%22%2C%20function%28d%2Ci%29%7B%20return%20d%2Ehl%3B%7D%29%0A%20%20%20%20%20%2Eappend%28%22svg%3Atext%22%29%2Eattr%28%22y%22%2CsvgHeight%2A0%2E4%29%0A%20%20%20%20%20%2Eattr%28%22transform%22%2C%22rotate%2890%29%22%29%0A%20%20%20%20%20%2Eattr%28%27transform%27%2C%20function%20%28d%2C%20i%29%20%7B%20var%20translate%20%3D%20%5BbarWidth%20%2A%20i%2C%200%5D%3B%20%20return%20%27translate%28%27%2B%20translate%20%2B%27%29%27%3B%7D%29%0A%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20%229px%22%29%2Estyle%28%22pointer%2Devents%22%2C%20%22all%22%29%0A%20%20%20%20%20%2Eattr%28%22class%22%2C%22ttt%22%29%2Estyle%28%22cursor%22%2C%22pointer%22%29%0A%20%20%20%20%20%2Etext%28function%28d%2Ci%29%7Breturn%20d%2Elb%3B%7D%29%3B%20%20%7D%29%0A%20%20%20%20%20%2Eon%28%22mouseout%22%2C%20function%28d%29%20%7B%09tip%5Bploidy%2D1%5D%2Etransition%28%29%20%2Edelay%281000%29%2Eduration%28500%29%09%2Estyle%28%22opacity%22%2C%200%29%3B%7D%29%2Estyle%28%22visibility%22%2C%22visible%22%29%2Estyle%28%22fill%22%2Cfunction%28d%29%7B%20return%20colors%5Btimes%5D%28d%2Evalue%29%3B%7D%29%0A%20%20%20%20%20%2Eon%28%22click%22%2C%20function%28d%29%20%7B%0A%0A%0A%20%20%20%20%20%20%20if%28clickFlag%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20tip2%5Bploidy%2D1%5D%2Estyle%28%22opacity%22%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%7Delse%7B%0A%20%20%20%20%20%20%20%20%20%20%20tip2%5Bploidy%2D1%5D%2Etransition%28%29%2Eduration%28200%29%09%2Estyle%28%22opacity%22%2C%20%2E9%29%2Estyle%28%22background%2Dcolor%22%2C%22%23F5F5F5%22%29%2Estyle%28%22width%22%2C180%2Bd%2Ecount%2A%28d3%2Emax%28d%2Elabel%29%2Elength%2A3%29%2B%27px%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20tip2%5Bploidy%2D1%5D%2Ehtml%28%22%3Cdiv%20%20style%3D%27float%3Atop%3Bposition%3Arelative%3Bheight%3A35%25%3B%27%20%3E%3Cdiv%20style%3D%27border%2Dradius%3A%205px%3Bfloat%3Aleft%3Bposition%3Arelative%3Bheight%3A55px%3Bwidth%3A30%25%3Bbackground%2Dcolor%3A%22%2Bcolors%5Btimes%5D%28d%2Evalue%29%2B%0A%20%20%20%20%20%20%20%20%20%20%20%22%3B%27%20%3E%3C%2Fdiv%3E%3Cdiv%20%20style%3D%27float%3Aleft%3Bposition%3Arelative%3Bwidth%3A70%25%3B%27%20%3E%3Cp%20%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20%20%3C%2Ffont%3E%20%3Cfont%20size%3D%271%27%20%20%3E%3Cb%3E%20%22%2B%22%22%2B%0A%20%20%20%20%20%20%20%20%20%20%20%22%20%3Cbr%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20Count%3A%3C%2Ffont%3E%22%2Bd%2Ecount%2B%22%20%3Cbr%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20%20%3C%2Ffont%3E%20%22%2B%22%22%2B%0A%20%20%20%20%20%20%20%20%20%20%20%22%3C%2Ffont%3E%3Cbr%3E%3Cfont%20size%3D%271%27%20color%3D%27grey%27%20%3E%20%20%3C%2Ffont%3E%3Cfont%20size%3D%271%27%3E%22%2B%22%22%2B%22%3C%2Fp%3E%3C%2Ffont%3E%3C%2Fdiv%3E%3C%2Fdiv%3E%3Cdiv%20id%20%3D%27%22%2Bdiv%5Fid%2B%22%2DmicroBar2%22%2Bploidy%2B%22%27%20style%3D%27float%3Atop%3Bposition%3Arelative%3Bheight%3A35%25%27%3E%3C%2Fdiv%3E%3Cbr%3E%3Cdiv%20%20style%3D%27float%3Atop%3Bheight%3A20%25%3Bposition%3Arelative%3Bcolor%3A%27black%22%2B%0A%20%20%20%20%20%20%20%20%20%20%20%22%3B%27%3E%3Cfont%20size%3D%272%27%20%3E%22%2Bd%2Erange%2B%22%3C%2Ffont%3E%3C%2Fp%3E%3C%2Fdiv%3E%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22left%22%2C%20%28d3%2Eevent%2EpageX%29%20%2B%20%22px%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22top%22%2C%20%28d3%2Eevent%2EpageY%20%2D%2018%29%20%2B%20%22px%22%29%3B%20var%20svgWidth%20%3D%20175%2Bd%2Ecount%2A%28d3%2Emax%28d%2Elabel%29%2Elength%29%2A3%3Bvar%20svgHeight%20%3D%2050%3Bvar%20barPadding%20%3D%205%3Bvar%20barWidth%20%3D%20%28svgWidth%20%2F%20d%2Ebar%2Elength%29%3Bvar%20mysvg2%20%3D%20d3%2Eselect%28%27%23%27%2Bdiv%5Fid%2B%27%2DmicroBar2%27%2Bploidy%29%2Eappend%28%22svg%22%29%2Eattr%28%22width%22%2CsvgWidth%29%2Eattr%28%22heigth%22%2CsvgHeight%29%3Bvar%20barChart%20%3D%20mysvg2%2EselectAll%28%27rect%27%29%2Edata%28d%2Ebar%29%2Eenter%28%29%2Eappend%28%27rect%27%29%2Eattr%28%27height%27%2CsvgHeight%2D40%29%2Eattr%28%27width%27%2C%20barWidth%29%2Eattr%28%27transform%27%2C%20function%20%28d%2C%20i%29%20%7B%20var%20translate%20%3D%20%5BbarWidth%20%2A%20i%2C%200%5D%3B%20%20return%20%27translate%28%27%2B%20translate%20%2B%27%29%27%3B%7D%29%2Estyle%28%22fill%22%2Cfunction%28d%29%7Breturn%20colors%5Btimes%5D%28d%29%3B%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20t%5Fdata%3D%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%28j%3D0%3Bj%3Cd%2Elabel%2Elength%3Bj%2B%2B%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20t%5Fdata%2Epush%28%7Blb%3Ad%2Elabel%5Bj%5D%2Chl%3Ad%2Ehlink%5Bj%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20var%20ttext%3Dmysvg2%2EselectAll%28%22%2Enode%22%29%2Edata%28t%5Fdata%29%2Eenter%28%29%2Eappend%28%22svg%3Aa%22%29%2Eattr%28%22xlink%3Ahref%22%2C%20function%28d%2Ci%29%7B%20return%20d%2Ehl%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eappend%28%22svg%3Atext%22%29%2Eattr%28%22y%22%2CsvgHeight%2A0%2E4%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22transform%22%2C%22rotate%2890%29%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%27transform%27%2C%20function%20%28d%2C%20i%29%20%7B%20var%20translate%20%3D%20%5BbarWidth%20%2A%20i%2C%200%5D%3B%20%20return%20%27translate%28%27%2B%20translate%20%2B%27%29%27%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22font%2Dsize%22%2C%20%229px%22%29%2Estyle%28%22pointer%2Devents%22%2C%20%22all%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22class%22%2C%22ttt%22%29%2Estyle%28%22cursor%22%2C%22pointer%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%2Etext%28function%28d%2Ci%29%7Breturn%20d%2Elb%3B%7D%29%3B%20%7D%20return%20clickFlag%20%3D%20%21clickFlag%3B%20%7D%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Fwithout%20interactvity%0A%20%20%20%20%20%20%20%20%20%20%20%20d3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22chLoc%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Edata%28chDataReduced%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Ekey%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22visibility%22%2C%22visible%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%2Estyle%28%22fill%22%2Cfunction%28d%29%7B%20return%20colors%5Btimes%5D%28d%2Evalue%29%3B%7D%29%3B%0A%20%20%20%20%20%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Fwitout%20interactivity%20end%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%0A%0A%20%20%20%20%20if%28labels%29%7B%0A%0A%20%20%20%20%20%20var%20chDataLabels%20%3D%20d3%2Enest%28%29%0A%20%20%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%20%20%2Erollup%28function%28v%29%20%7B%20%20var%20a%3D%5B%5D%3Bfor%28var%20i%3D0%3B%20i%3C%20v%2Elength%3Bi%2B%2B%29%7B%20a%2Epush%28v%5Bi%5D%2Ename%29%3B%20%20%20%7D%3Breturn%20a%5B0%5D%3B%7D%29%0A%20%20%2Eentries%28chData%29%3B%0A%20%20var%20chDataLabel%20%3D%20d3%2Enest%28%29%0A%2Ekey%28function%28d%29%20%7B%20return%20d%2Eloci%3B%20%7D%29%0A%2Erollup%28function%28v%29%20%7B%20%20var%20a%3D%5B%5D%3Bfor%28var%20i%3D0%3B%20i%3C%20v%2Elength%3Bi%2B%2B%29%7B%20a%2Epush%28v%5Bi%5D%2Elabel%29%3B%20%20%20%7D%3Breturn%20a%5B0%5D%3B%7D%29%0A%2Eentries%28chData%29%3B%0A%20%20%20%20%20for%28var%20i%20%3D%200%3Bi%20%3C%20chDataReduced%2Elength%3Bi%2B%2B%29%20%7B%0A%0A%0A%20%20%20%20%20%20chDataReduced%5Bi%5D%2Elabel%5Fid%20%3D%20chDataLabel%5Bi%5D%2Evalue%3B%0A%20%20%20%20%20%20chDataReduced%5Bi%5D%2Elabels%20%3DchDataLabels%5Bi%5D%2Evalue%3B%0A%0A%20%20%20%20%7D%0A%0A%20%20%20%20d3%2EselectAll%28%22%2E%22%2Bdiv%5Fid%2B%22%2D%22%2B%22labels%22%29%2Edata%28chDataReduced%2C%20function%28d%29%20%7Breturn%20%28d%20%26%26%20d%2Elabel%5Fid%29%7C%7Cd3%2Eselect%28this%29%2Eattr%28%22id%22%29%3B%7D%29%0A%20%20%20%20%2Etext%28function%28d%29%7B%20return%20d%2Elabels%3B%7D%29%0A%20%20%20%20%2Eattr%28%22transform%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20var%20xRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22x%22%29%3B%0A%20%20%20%20%20var%20yRot%20%3D%20d3%2Eselect%28this%29%2Eattr%28%22y%22%29%3B%0A%20%20%20%20%20return%20%60rotate%28%24%7Blabel%5Fangle%7D%2C%20%24%7BxRot%7D%2C%20%20%24%7ByRot%7D%20%29%60%0A%20%20%20%20%20%7D%29%3B%0A%20%20%20%7D%0A%7D%0A%0A%7D%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%20%20%2F%2Fheatmap%20code%20end%0A%20%7D%0A%0A%0A%7D%0A"></script>
<script src="data:application/x-javascript,%28function%28%29%20%7B%0A%20%20const%20out%24%20%3D%20typeof%20exports%20%21%3D%20%27undefined%27%20%26%26%20exports%20%7C%7C%20typeof%20define%20%21%3D%20%27undefined%27%20%26%26%20%7B%7D%20%7C%7C%20this%20%7C%7C%20window%3B%0A%20%20if%20%28typeof%20define%20%21%3D%3D%20%27undefined%27%29%20define%28%27save%2Dsvg%2Das%2Dpng%27%2C%20%5B%5D%2C%20%28%29%20%3D%3E%20out%24%29%3B%0A%20%20out%24%2Edefault%20%3D%20out%24%3B%0A%0A%20%20const%20xmlNs%20%3D%20%27http%3A%2F%2Fwww%2Ew3%2Eorg%2F2000%2Fxmlns%2F%27%3B%0A%20%20const%20xhtmlNs%20%3D%20%27http%3A%2F%2Fwww%2Ew3%2Eorg%2F1999%2Fxhtml%27%3B%0A%20%20const%20svgNs%20%3D%20%27http%3A%2F%2Fwww%2Ew3%2Eorg%2F2000%2Fsvg%27%3B%0A%20%20const%20doctype%20%3D%20%27%3C%3Fxml%20version%3D%221%2E0%22%20standalone%3D%22no%22%3F%3E%3C%21DOCTYPE%20svg%20PUBLIC%20%22%2D%2F%2FW3C%2F%2FDTD%20SVG%201%2E1%2F%2FEN%22%20%22http%3A%2F%2Fwww%2Ew3%2Eorg%2FGraphics%2FSVG%2F1%2E1%2FDTD%2Fsvg11%2Edtd%22%20%5B%3C%21ENTITY%20nbsp%20%22%26%23160%3B%22%3E%5D%3E%27%3B%0A%20%20const%20urlRegex%20%3D%20%2Furl%5C%28%5B%22%27%5D%3F%28%2E%2B%3F%29%5B%22%27%5D%3F%5C%29%2F%3B%0A%20%20const%20fontFormats%20%3D%20%7B%0A%20%20%20%20woff2%3A%20%27font%2Fwoff2%27%2C%0A%20%20%20%20woff%3A%20%27font%2Fwoff%27%2C%0A%20%20%20%20otf%3A%20%27application%2Fx%2Dfont%2Dopentype%27%2C%0A%20%20%20%20ttf%3A%20%27application%2Fx%2Dfont%2Dttf%27%2C%0A%20%20%20%20eot%3A%20%27application%2Fvnd%2Ems%2Dfontobject%27%2C%0A%20%20%20%20sfnt%3A%20%27application%2Ffont%2Dsfnt%27%2C%0A%20%20%20%20svg%3A%20%27image%2Fsvg%2Bxml%27%0A%20%20%7D%3B%0A%0A%20%20const%20isElement%20%3D%20obj%20%3D%3E%20obj%20instanceof%20HTMLElement%20%7C%7C%20obj%20instanceof%20SVGElement%3B%0A%20%20const%20requireDomNode%20%3D%20el%20%3D%3E%20%7B%0A%20%20%20%20if%20%28%21isElement%28el%29%29%20throw%20new%20Error%28%60an%20HTMLElement%20or%20SVGElement%20is%20required%3B%20got%20%24%7Bel%7D%60%29%3B%0A%20%20%7D%3B%0A%20%20const%20requireDomNodePromise%20%3D%20el%20%3D%3E%0A%20%20%20%20new%20Promise%28%28resolve%2C%20reject%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20if%20%28isElement%28el%29%29%20resolve%28el%29%0A%20%20%20%20%20%20else%20reject%28new%20Error%28%60an%20HTMLElement%20or%20SVGElement%20is%20required%3B%20got%20%24%7Bel%7D%60%29%29%3B%0A%20%20%20%20%7D%29%0A%20%20const%20isExternal%20%3D%20url%20%3D%3E%20url%20%26%26%20url%2ElastIndexOf%28%27http%27%2C0%29%20%3D%3D%3D%200%20%26%26%20url%2ElastIndexOf%28window%2Elocation%2Ehost%29%20%3D%3D%3D%20%2D1%3B%0A%0A%20%20const%20getFontMimeTypeFromUrl%20%3D%20fontUrl%20%3D%3E%20%7B%0A%20%20%20%20const%20formats%20%3D%20Object%2Ekeys%28fontFormats%29%0A%20%20%20%20%20%20%2Efilter%28extension%20%3D%3E%20fontUrl%2EindexOf%28%60%2E%24%7Bextension%7D%60%29%20%3E%200%29%0A%20%20%20%20%20%20%2Emap%28extension%20%3D%3E%20fontFormats%5Bextension%5D%29%3B%0A%20%20%20%20if%20%28formats%29%20return%20formats%5B0%5D%3B%0A%20%20%20%20console%2Eerror%28%60Unknown%20font%20format%20for%20%24%7BfontUrl%7D%2E%20Fonts%20may%20not%20be%20working%20correctly%2E%60%29%3B%0A%20%20%20%20return%20%27application%2Foctet%2Dstream%27%3B%0A%20%20%7D%3B%0A%0A%20%20const%20arrayBufferToBase64%20%3D%20buffer%20%3D%3E%20%7B%0A%20%20%20%20let%20binary%20%3D%20%27%27%3B%0A%20%20%20%20const%20bytes%20%3D%20new%20Uint8Array%28buffer%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20bytes%2EbyteLength%3B%20i%2B%2B%29%20binary%20%2B%3D%20String%2EfromCharCode%28bytes%5Bi%5D%29%3B%0A%20%20%20%20return%20window%2Ebtoa%28binary%29%3B%0A%20%20%7D%0A%0A%20%20const%20getDimension%20%3D%20%28el%2C%20clone%2C%20dim%29%20%3D%3E%20%7B%0A%20%20%20%20const%20v%20%3D%0A%20%20%20%20%20%20%28el%2EviewBox%20%26%26%20el%2EviewBox%2EbaseVal%20%26%26%20el%2EviewBox%2EbaseVal%5Bdim%5D%29%20%7C%7C%0A%20%20%20%20%20%20%28clone%2EgetAttribute%28dim%29%20%21%3D%3D%20null%20%26%26%20%21clone%2EgetAttribute%28dim%29%2Ematch%28%2F%25%24%2F%29%20%26%26%20parseInt%28clone%2EgetAttribute%28dim%29%29%29%20%7C%7C%0A%20%20%20%20%20%20el%2EgetBoundingClientRect%28%29%5Bdim%5D%20%7C%7C%0A%20%20%20%20%20%20parseInt%28clone%2Estyle%5Bdim%5D%29%20%7C%7C%0A%20%20%20%20%20%20parseInt%28window%2EgetComputedStyle%28el%29%2EgetPropertyValue%28dim%29%29%3B%0A%20%20%20%20return%20typeof%20v%20%3D%3D%3D%20%27undefined%27%20%7C%7C%20v%20%3D%3D%3D%20null%20%7C%7C%20isNaN%28parseFloat%28v%29%29%20%3F%200%20%3A%20v%3B%0A%20%20%7D%3B%0A%0A%20%20const%20getDimensions%20%3D%20%28el%2C%20clone%2C%20width%2C%20height%29%20%3D%3E%20%7B%0A%20%20%20%20if%20%28el%2EtagName%20%3D%3D%3D%20%27svg%27%29%20return%20%7B%0A%20%20%20%20%20%20width%3A%20width%20%7C%7C%20getDimension%28el%2C%20clone%2C%20%27width%27%29%2C%0A%20%20%20%20%20%20height%3A%20height%20%7C%7C%20getDimension%28el%2C%20clone%2C%20%27height%27%29%0A%20%20%20%20%7D%3B%0A%20%20%20%20else%20if%20%28el%2EgetBBox%29%20%7B%0A%20%20%20%20%20%20const%20%7Bx%2C%20y%2C%20width%2C%20height%7D%20%3D%20el%2EgetBBox%28%29%3B%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20width%3A%20x%20%2B%20width%2C%0A%20%20%20%20%20%20%20%20height%3A%20y%20%2B%20height%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20const%20reEncode%20%3D%20data%20%3D%3E%0A%20%20%20%20decodeURIComponent%28%0A%20%20%20%20%20%20encodeURIComponent%28data%29%0A%20%20%20%20%20%20%20%20%2Ereplace%28%2F%25%28%5B0%2D9A%2DF%5D%7B2%7D%29%2Fg%2C%20%28match%2C%20p1%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20c%20%3D%20String%2EfromCharCode%28%600x%24%7Bp1%7D%60%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20c%20%3D%3D%3D%20%27%25%27%20%3F%20%27%2525%27%20%3A%20c%3B%0A%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%29%3B%0A%0A%20%20const%20uriToBlob%20%3D%20uri%20%3D%3E%20%7B%0A%20%20%20%20const%20byteString%20%3D%20window%2Eatob%28uri%2Esplit%28%27%2C%27%29%5B1%5D%29%3B%0A%20%20%20%20const%20mimeString%20%3D%20uri%2Esplit%28%27%2C%27%29%5B0%5D%2Esplit%28%27%3A%27%29%5B1%5D%2Esplit%28%27%3B%27%29%5B0%5D%0A%20%20%20%20const%20buffer%20%3D%20new%20ArrayBuffer%28byteString%2Elength%29%3B%0A%20%20%20%20const%20intArray%20%3D%20new%20Uint8Array%28buffer%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20byteString%2Elength%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20intArray%5Bi%5D%20%3D%20byteString%2EcharCodeAt%28i%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20new%20Blob%28%5Bbuffer%5D%2C%20%7Btype%3A%20mimeString%7D%29%3B%0A%20%20%7D%3B%0A%0A%20%20const%20query%20%3D%20%28el%2C%20selector%29%20%3D%3E%20%7B%0A%20%20%20%20if%20%28%21selector%29%20return%3B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20return%20el%2EquerySelector%28selector%29%20%7C%7C%20el%2EparentNode%20%26%26%20el%2EparentNode%2EquerySelector%28selector%29%3B%0A%20%20%20%20%7D%20catch%28err%29%20%7B%0A%20%20%20%20%20%20console%2Ewarn%28%60Invalid%20CSS%20selector%20%22%24%7Bselector%7D%22%60%2C%20err%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20const%20detectCssFont%20%3D%20%28rule%2C%20href%29%20%3D%3E%20%7B%0A%20%20%20%20%2F%2F%20Match%20CSS%20font%2Dface%20rules%20to%20external%20links%2E%0A%20%20%20%20%2F%2F%20%40font%2Dface%20%7B%0A%20%20%20%20%2F%2F%20%20%20src%3A%20local%28%27Abel%27%29%2C%20url%28https%3A%2F%2Ffonts%2Egstatic%2Ecom%2Fs%2Fabel%2Fv6%2FUzN%2DiejR1VoXU2Oc%2D7LsbvesZW2xOQ%2DxsNqO47m55DA%2Ewoff2%29%3B%0A%20%20%20%20%2F%2F%20%7D%0A%20%20%20%20const%20match%20%3D%20rule%2EcssText%2Ematch%28urlRegex%29%3B%0A%20%20%20%20const%20url%20%3D%20%28match%20%26%26%20match%5B1%5D%29%20%7C%7C%20%27%27%3B%0A%20%20%20%20if%20%28%21url%20%7C%7C%20url%2Ematch%28%2F%5Edata%3A%2F%29%20%7C%7C%20url%20%3D%3D%3D%20%27about%3Ablank%27%29%20return%3B%0A%20%20%20%20const%20fullUrl%20%3D%0A%20%20%20%20%20%20url%2EstartsWith%28%27%2E%2E%2F%27%29%20%3F%20%60%24%7Bhref%7D%2F%2E%2E%2F%24%7Burl%7D%60%0A%20%20%20%20%20%20%3A%20url%2EstartsWith%28%27%2E%2F%27%29%20%3F%20%60%24%7Bhref%7D%2F%2E%24%7Burl%7D%60%0A%20%20%20%20%20%20%3A%20url%3B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20text%3A%20rule%2EcssText%2C%0A%20%20%20%20%20%20format%3A%20getFontMimeTypeFromUrl%28fullUrl%29%2C%0A%20%20%20%20%20%20url%3A%20fullUrl%0A%20%20%20%20%7D%3B%0A%20%20%7D%3B%0A%0A%20%20const%20inlineImages%20%3D%20el%20%3D%3E%20Promise%2Eall%28%0A%20%20%20%20Array%2Efrom%28el%2EquerySelectorAll%28%27image%27%29%29%2Emap%28image%20%3D%3E%20%7B%0A%20%20%20%20%20%20let%20href%20%3D%20image%2EgetAttributeNS%28%27http%3A%2F%2Fwww%2Ew3%2Eorg%2F1999%2Fxlink%27%2C%20%27href%27%29%20%7C%7C%20image%2EgetAttribute%28%27href%27%29%3B%0A%20%20%20%20%20%20if%20%28%21href%29%20return%20Promise%2Eresolve%28null%29%3B%0A%20%20%20%20%20%20if%20%28isExternal%28href%29%29%20%7B%0A%20%20%20%20%20%20%20%20href%20%2B%3D%20%28href%2EindexOf%28%27%3F%27%29%20%3D%3D%3D%20%2D1%20%3F%20%27%3F%27%20%3A%20%27%26%27%29%20%2B%20%27t%3D%27%20%2B%20new%20Date%28%29%2EvalueOf%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20new%20Promise%28%28resolve%2C%20reject%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20canvas%20%3D%20document%2EcreateElement%28%27canvas%27%29%3B%0A%20%20%20%20%20%20%20%20const%20img%20%3D%20new%20Image%28%29%3B%0A%20%20%20%20%20%20%20%20img%2EcrossOrigin%20%3D%20%27anonymous%27%3B%0A%20%20%20%20%20%20%20%20img%2Esrc%20%3D%20href%3B%0A%20%20%20%20%20%20%20%20img%2Eonerror%20%3D%20%28%29%20%3D%3E%20reject%28new%20Error%28%60Could%20not%20load%20%24%7Bhref%7D%60%29%29%3B%0A%20%20%20%20%20%20%20%20img%2Eonload%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20canvas%2Ewidth%20%3D%20img%2Ewidth%3B%0A%20%20%20%20%20%20%20%20%20%20canvas%2Eheight%20%3D%20img%2Eheight%3B%0A%20%20%20%20%20%20%20%20%20%20canvas%2EgetContext%28%272d%27%29%2EdrawImage%28img%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20image%2EsetAttributeNS%28%27http%3A%2F%2Fwww%2Ew3%2Eorg%2F1999%2Fxlink%27%2C%20%27href%27%2C%20canvas%2EtoDataURL%28%27image%2Fpng%27%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20resolve%28true%29%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%29%0A%20%20%29%3B%0A%0A%20%20const%20cachedFonts%20%3D%20%7B%7D%3B%0A%20%20const%20inlineFonts%20%3D%20fonts%20%3D%3E%20Promise%2Eall%28%0A%20%20%20%20fonts%2Emap%28font%20%3D%3E%0A%20%20%20%20%20%20new%20Promise%28%28resolve%2C%20reject%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20if%20%28cachedFonts%5Bfont%2Eurl%5D%29%20return%20resolve%28cachedFonts%5Bfont%2Eurl%5D%29%3B%0A%0A%20%20%20%20%20%20%20%20const%20req%20%3D%20new%20XMLHttpRequest%28%29%3B%0A%20%20%20%20%20%20%20%20req%2EaddEventListener%28%27load%27%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20TODO%3A%20it%20may%20also%20be%20worth%20it%20to%20wait%20until%20fonts%20are%20fully%20loaded%20before%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20attempting%20to%20rasterize%20them%2E%20%28e%2Eg%2E%20use%20https%3A%2F%2Fdeveloper%2Emozilla%2Eorg%2Fen%2DUS%2Fdocs%2FWeb%2FAPI%2FFontFaceSet%29%0A%20%20%20%20%20%20%20%20%20%20const%20fontInBase64%20%3D%20arrayBufferToBase64%28req%2Eresponse%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20fontUri%20%3D%20font%2Etext%2Ereplace%28urlRegex%2C%20%60url%28%22data%3A%24%7Bfont%2Eformat%7D%3Bbase64%2C%24%7BfontInBase64%7D%22%29%60%29%2B%27%5Cn%27%3B%0A%20%20%20%20%20%20%20%20%20%20cachedFonts%5Bfont%2Eurl%5D%20%3D%20fontUri%3B%0A%20%20%20%20%20%20%20%20%20%20resolve%28fontUri%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20req%2EaddEventListener%28%27error%27%2C%20e%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20console%2Ewarn%28%60Failed%20to%20load%20font%20from%3A%20%24%7Bfont%2Eurl%7D%60%2C%20e%29%3B%0A%20%20%20%20%20%20%20%20%20%20cachedFonts%5Bfont%2Eurl%5D%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20resolve%28null%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20req%2EaddEventListener%28%27abort%27%2C%20e%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20console%2Ewarn%28%60Aborted%20loading%20font%20from%3A%20%24%7Bfont%2Eurl%7D%60%2C%20e%29%3B%0A%20%20%20%20%20%20%20%20%20%20resolve%28null%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20req%2Eopen%28%27GET%27%2C%20font%2Eurl%29%3B%0A%20%20%20%20%20%20%20%20req%2EresponseType%20%3D%20%27arraybuffer%27%3B%0A%20%20%20%20%20%20%20%20req%2Esend%28%29%3B%0A%20%20%20%20%20%20%7D%29%0A%20%20%20%20%29%0A%20%20%29%2Ethen%28fontCss%20%3D%3E%20fontCss%2Efilter%28x%20%3D%3E%20x%29%2Ejoin%28%27%27%29%29%3B%0A%0A%20%20let%20cachedRules%20%3D%20null%3B%0A%20%20const%20styleSheetRules%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20if%20%28cachedRules%29%20return%20cachedRules%3B%0A%20%20%20%20return%20cachedRules%20%3D%20Array%2Efrom%28document%2EstyleSheets%29%2Emap%28sheet%20%3D%3E%20%7B%0A%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20return%20%7Brules%3A%20sheet%2EcssRules%2C%20href%3A%20sheet%2Ehref%7D%3B%0A%20%20%20%20%20%20%7D%20catch%20%28e%29%20%7B%0A%20%20%20%20%20%20%20%20console%2Ewarn%28%60Stylesheet%20could%20not%20be%20loaded%3A%20%24%7Bsheet%2Ehref%7D%60%2C%20e%29%3B%0A%20%20%20%20%20%20%20%20return%20%7B%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%3B%0A%0A%20%20const%20inlineCss%20%3D%20%28el%2C%20options%29%20%3D%3E%20%7B%0A%20%20%20%20const%20%7B%0A%20%20%20%20%20%20selectorRemap%2C%0A%20%20%20%20%20%20modifyStyle%2C%0A%20%20%20%20%20%20modifyCss%2C%0A%20%20%20%20%20%20fonts%2C%0A%20%20%20%20%20%20excludeUnusedCss%0A%20%20%20%20%7D%20%3D%20options%20%7C%7C%20%7B%7D%3B%0A%20%20%20%20const%20generateCss%20%3D%20modifyCss%20%7C%7C%20%28%28selector%2C%20properties%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20sel%20%3D%20selectorRemap%20%3F%20selectorRemap%28selector%29%20%3A%20selector%3B%0A%20%20%20%20%20%20const%20props%20%3D%20modifyStyle%20%3F%20modifyStyle%28properties%29%20%3A%20properties%3B%0A%20%20%20%20%20%20return%20%60%24%7Bsel%7D%7B%24%7Bprops%7D%7D%5Cn%60%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20const%20css%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20detectFonts%20%3D%20typeof%20fonts%20%3D%3D%3D%20%27undefined%27%3B%0A%20%20%20%20const%20fontList%20%3D%20fonts%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20styleSheetRules%28%29%2EforEach%28%28%7Brules%2C%20href%7D%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20if%20%28%21rules%29%20return%3B%0A%20%20%20%20%20%20Array%2Efrom%28rules%29%2EforEach%28rule%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20if%20%28typeof%20rule%2Estyle%20%21%3D%20%27undefined%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28query%28el%2C%20rule%2EselectorText%29%29%20css%2Epush%28generateCss%28rule%2EselectorText%2C%20rule%2Estyle%2EcssText%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20else%20if%20%28detectFonts%20%26%26%20rule%2EcssText%2Ematch%28%2F%5E%40font%2Dface%2F%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20font%20%3D%20detectCssFont%28rule%2C%20href%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28font%29%20fontList%2Epush%28font%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28%21excludeUnusedCss%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20css%2Epush%28rule%2EcssText%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20return%20inlineFonts%28fontList%29%2Ethen%28fontCss%20%3D%3E%20css%2Ejoin%28%27%5Cn%27%29%20%2B%20fontCss%29%3B%0A%20%20%7D%3B%0A%0A%20%20const%20downloadOptions%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20if%20%28%21navigator%2EmsSaveOrOpenBlob%20%26%26%20%21%28%27download%27%20in%20document%2EcreateElement%28%27a%27%29%29%29%20%7B%0A%20%20%20%20%20%20return%20%7Bpopup%3A%20window%2Eopen%28%29%7D%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20out%24%2EprepareSvg%20%3D%20%28el%2C%20options%2C%20done%29%20%3D%3E%20%7B%0A%20%20%20%20requireDomNode%28el%29%3B%0A%20%20%20%20const%20%7B%0A%20%20%20%20%20%20left%20%3D%200%2C%0A%20%20%20%20%20%20top%20%3D%200%2C%0A%20%20%20%20%20%20width%3A%20w%2C%0A%20%20%20%20%20%20height%3A%20h%2C%0A%20%20%20%20%20%20scale%20%3D%201%2C%0A%20%20%20%20%20%20responsive%20%3D%20false%2C%0A%20%20%20%20%20%20excludeCss%20%3D%20false%2C%0A%20%20%20%20%7D%20%3D%20options%20%7C%7C%20%7B%7D%3B%0A%0A%20%20%20%20return%20inlineImages%28el%29%2Ethen%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20let%20clone%20%3D%20el%2EcloneNode%28true%29%3B%0A%20%20%20%20%20%20clone%2Estyle%2EbackgroundColor%20%3D%20%28options%20%7C%7C%20%7B%7D%29%2EbackgroundColor%20%7C%7C%20el%2Estyle%2EbackgroundColor%3B%0A%20%20%20%20%20%20const%20%7Bwidth%2C%20height%7D%20%3D%20getDimensions%28el%2C%20clone%2C%20w%2C%20h%29%3B%0A%0A%20%20%20%20%20%20if%20%28el%2EtagName%20%21%3D%3D%20%27svg%27%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28el%2EgetBBox%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28clone%2EgetAttribute%28%27transform%27%29%20%21%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20clone%2EsetAttribute%28%27transform%27%2C%20clone%2EgetAttribute%28%27transform%27%29%2Ereplace%28%2Ftranslate%5C%28%2E%2A%3F%5C%29%2F%2C%20%27%27%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20const%20svg%20%3D%20document%2EcreateElementNS%28%27http%3A%2F%2Fwww%2Ew3%2Eorg%2F2000%2Fsvg%27%2C%27svg%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20svg%2EappendChild%28clone%29%3B%0A%20%20%20%20%20%20%20%20%20%20clone%20%3D%20svg%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20console%2Eerror%28%27Attempted%20to%20render%20non%2DSVG%20element%27%2C%20el%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20clone%2EsetAttribute%28%27version%27%2C%20%271%2E1%27%29%3B%0A%20%20%20%20%20%20clone%2EsetAttribute%28%27viewBox%27%2C%20%5Bleft%2C%20top%2C%20width%2C%20height%5D%2Ejoin%28%27%20%27%29%29%3B%0A%20%20%20%20%20%20if%20%28%21clone%2EgetAttribute%28%27xmlns%27%29%29%20clone%2EsetAttributeNS%28xmlNs%2C%20%27xmlns%27%2C%20svgNs%29%3B%0A%20%20%20%20%20%20if%20%28%21clone%2EgetAttribute%28%27xmlns%3Axlink%27%29%29%20clone%2EsetAttributeNS%28xmlNs%2C%20%27xmlns%3Axlink%27%2C%20%27http%3A%2F%2Fwww%2Ew3%2Eorg%2F1999%2Fxlink%27%29%3B%0A%0A%20%20%20%20%20%20if%20%28responsive%29%20%7B%0A%20%20%20%20%20%20%20%20clone%2EremoveAttribute%28%27width%27%29%3B%0A%20%20%20%20%20%20%20%20clone%2EremoveAttribute%28%27height%27%29%3B%0A%20%20%20%20%20%20%20%20clone%2EsetAttribute%28%27preserveAspectRatio%27%2C%20%27xMinYMin%20meet%27%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20clone%2EsetAttribute%28%27width%27%2C%20width%20%2A%20scale%29%3B%0A%20%20%20%20%20%20%20%20clone%2EsetAttribute%28%27height%27%2C%20height%20%2A%20scale%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20Array%2Efrom%28clone%2EquerySelectorAll%28%27foreignObject%20%3E%20%2A%27%29%29%2EforEach%28foreignObject%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20foreignObject%2EsetAttributeNS%28xmlNs%2C%20%27xmlns%27%2C%20foreignObject%2EtagName%20%3D%3D%3D%20%27svg%27%20%3F%20svgNs%20%3A%20xhtmlNs%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20%20%20if%20%28excludeCss%29%20%7B%0A%20%20%20%20%20%20%20%20const%20outer%20%3D%20document%2EcreateElement%28%27div%27%29%3B%0A%20%20%20%20%20%20%20%20outer%2EappendChild%28clone%29%3B%0A%20%20%20%20%20%20%20%20const%20src%20%3D%20outer%2EinnerHTML%3B%0A%20%20%20%20%20%20%20%20if%20%28typeof%20done%20%3D%3D%3D%20%27function%27%29%20done%28src%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%20%20else%20return%20%7Bsrc%2C%20width%2C%20height%7D%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20inlineCss%28el%2C%20options%29%2Ethen%28css%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20style%20%3D%20document%2EcreateElement%28%27style%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20style%2EsetAttribute%28%27type%27%2C%20%27text%2Fcss%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20style%2EinnerHTML%20%3D%20%60%3C%21%5BCDATA%5B%5Cn%24%7Bcss%7D%5Cn%5D%5D%3E%60%3B%0A%0A%20%20%20%20%20%20%20%20%20%20const%20defs%20%3D%20document%2EcreateElement%28%27defs%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20defs%2EappendChild%28style%29%3B%0A%20%20%20%20%20%20%20%20%20%20clone%2EinsertBefore%28defs%2C%20clone%2EfirstChild%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20const%20outer%20%3D%20document%2EcreateElement%28%27div%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20outer%2EappendChild%28clone%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20src%20%3D%20outer%2EinnerHTML%2Ereplace%28%2FNS%5Cd%2B%3Ahref%2Fgi%2C%20%27xmlns%3Axlink%3D%22http%3A%2F%2Fwww%2Ew3%2Eorg%2F1999%2Fxlink%22%20xlink%3Ahref%27%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20done%20%3D%3D%3D%20%27function%27%29%20done%28src%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%20%20%20%20else%20return%20%7Bsrc%2C%20width%2C%20height%7D%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%3B%0A%0A%20%20out%24%2EsvgAsDataUri%20%3D%20%28el%2C%20options%2C%20done%29%20%3D%3E%20%7B%0A%20%20%20%20requireDomNode%28el%29%3B%0A%20%20%20%20return%20out%24%2EprepareSvg%28el%2C%20options%29%0A%20%20%20%20%20%20%2Ethen%28%28%7Bsrc%2C%20width%2C%20height%7D%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20svgXml%20%3D%20%60data%3Aimage%2Fsvg%2Bxml%3Bbase64%2C%24%7Bwindow%2Ebtoa%28reEncode%28doctype%2Bsrc%29%29%7D%60%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20done%20%3D%3D%3D%20%27function%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20done%28svgXml%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20return%20svgXml%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%7D%3B%0A%0A%20%20out%24%2EsvgAsPngUri%20%3D%20%28el%2C%20options%2C%20done%29%20%3D%3E%20%7B%0A%20%20%20%20requireDomNode%28el%29%3B%0A%20%20%20%20const%20%7B%0A%20%20%20%20%20%20encoderType%20%3D%20%27image%2Fpng%27%2C%0A%20%20%20%20%20%20encoderOptions%20%3D%200%2E8%2C%0A%20%20%20%20%20%20canvg%0A%20%20%20%20%7D%20%3D%20options%20%7C%7C%20%7B%7D%3B%0A%0A%20%20%20%20const%20convertToPng%20%3D%20%28%7Bsrc%2C%20width%2C%20height%7D%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20canvas%20%3D%20document%2EcreateElement%28%27canvas%27%29%3B%0A%20%20%20%20%20%20const%20context%20%3D%20canvas%2EgetContext%28%272d%27%29%3B%0A%20%20%20%20%20%20const%20pixelRatio%20%3D%20window%2EdevicePixelRatio%20%7C%7C%201%3B%0A%0A%20%20%20%20%20%20canvas%2Ewidth%20%3D%20width%20%2A%20pixelRatio%3B%0A%20%20%20%20%20%20canvas%2Eheight%20%3D%20height%20%2A%20pixelRatio%3B%0A%20%20%20%20%20%20canvas%2Estyle%2Ewidth%20%3D%20%60%24%7Bcanvas%2Ewidth%7Dpx%60%3B%0A%20%20%20%20%20%20canvas%2Estyle%2Eheight%20%3D%20%60%24%7Bcanvas%2Eheight%7Dpx%60%3B%0A%20%20%20%20%20%20context%2EsetTransform%28pixelRatio%2C%200%2C%200%2C%20pixelRatio%2C%200%2C%200%29%3B%0A%0A%20%20%20%20%20%20if%20%28canvg%29%20canvg%28canvas%2C%20src%29%3B%0A%20%20%20%20%20%20else%20context%2EdrawImage%28src%2C%200%2C%200%29%3B%0A%0A%20%20%20%20%20%20let%20png%3B%0A%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20png%20%3D%20canvas%2EtoDataURL%28encoderType%2C%20encoderOptions%29%3B%0A%20%20%20%20%20%20%7D%20catch%20%28e%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%28typeof%20SecurityError%20%21%3D%3D%20%27undefined%27%20%26%26%20e%20instanceof%20SecurityError%29%20%7C%7C%20e%2Ename%20%3D%3D%3D%20%27SecurityError%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console%2Eerror%28%27Rendered%20SVG%20images%20cannot%20be%20downloaded%20in%20this%20browser%2E%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20throw%20e%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28typeof%20done%20%3D%3D%3D%20%27function%27%29%20done%28png%2C%20canvas%2Ewidth%2C%20canvas%2Eheight%29%3B%0A%20%20%20%20%20%20return%20Promise%2Eresolve%28png%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20%28canvg%29%20return%20out%24%2EprepareSvg%28el%2C%20options%29%2Ethen%28convertToPng%29%3B%0A%20%20%20%20else%20return%20out%24%2EsvgAsDataUri%28el%2C%20options%29%2Ethen%28uri%20%3D%3E%20%7B%0A%20%20%20%20%20%20return%20new%20Promise%28%28resolve%2C%20reject%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20image%20%3D%20new%20Image%28%29%3B%0A%20%20%20%20%20%20%20%20image%2Eonload%20%3D%20%28%29%20%3D%3E%20resolve%28convertToPng%28%7B%0A%20%20%20%20%20%20%20%20%20%20src%3A%20image%2C%0A%20%20%20%20%20%20%20%20%20%20width%3A%20image%2Ewidth%2C%0A%20%20%20%20%20%20%20%20%20%20height%3A%20image%2Eheight%0A%20%20%20%20%20%20%20%20%7D%29%29%3B%0A%20%20%20%20%20%20%20%20image%2Eonerror%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20reject%28%60There%20was%20an%20error%20loading%20the%20data%20URI%20as%20an%20image%20on%20the%20following%20SVG%5Cn%24%7Bwindow%2Eatob%28uri%2Eslice%2826%29%29%7DOpen%20the%20following%20link%20to%20see%20browser%27s%20diagnosis%5Cn%24%7Buri%7D%60%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20image%2Esrc%20%3D%20uri%3B%0A%20%20%20%20%20%20%7D%29%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%3B%0A%0A%20%20out%24%2Edownload%20%3D%20%28name%2C%20uri%2C%20options%29%20%3D%3E%20%7B%0A%20%20%20%20if%20%28navigator%2EmsSaveOrOpenBlob%29%20navigator%2EmsSaveOrOpenBlob%28uriToBlob%28uri%29%2C%20name%29%3B%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20const%20saveLink%20%3D%20document%2EcreateElement%28%27a%27%29%3B%0A%20%20%20%20%20%20if%20%28%27download%27%20in%20saveLink%29%20%7B%0A%20%20%20%20%20%20%20%20saveLink%2Edownload%20%3D%20name%3B%0A%20%20%20%20%20%20%20%20saveLink%2Estyle%2Edisplay%20%3D%20%27none%27%3B%0A%20%20%20%20%20%20%20%20document%2Ebody%2EappendChild%28saveLink%29%3B%0A%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20blob%20%3D%20uriToBlob%28uri%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20url%20%3D%20URL%2EcreateObjectURL%28blob%29%3B%0A%20%20%20%20%20%20%20%20%20%20saveLink%2Ehref%20%3D%20url%3B%0A%20%20%20%20%20%20%20%20%20%20saveLink%2Eonclick%20%3D%20%28%29%20%3D%3E%20requestAnimationFrame%28%28%29%20%3D%3E%20URL%2ErevokeObjectURL%28url%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%20catch%20%28e%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console%2Eerror%28e%29%3B%0A%20%20%20%20%20%20%20%20%20%20console%2Ewarn%28%27Error%20while%20getting%20object%20URL%2E%20Falling%20back%20to%20string%20URL%2E%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20saveLink%2Ehref%20%3D%20uri%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20saveLink%2Eclick%28%29%3B%0A%20%20%20%20%20%20%20%20document%2Ebody%2EremoveChild%28saveLink%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28options%20%26%26%20options%2Epopup%29%20%7B%0A%20%20%20%20%20%20%20%20options%2Epopup%2Edocument%2Etitle%20%3D%20name%3B%0A%20%20%20%20%20%20%20%20options%2Epopup%2Elocation%2Ereplace%28uri%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20out%24%2EsaveSvg%20%3D%20%28el%2C%20name%2C%20options%29%20%3D%3E%20%7B%0A%20%20%20%20const%20downloadOpts%20%3D%20downloadOptions%28%29%3B%20%2F%2F%20don%27t%20inline%2C%20can%27t%20be%20async%0A%20%20%20%20return%20requireDomNodePromise%28el%29%0A%20%20%20%20%20%20%2Ethen%28el%20%3D%3E%20out%24%2EsvgAsDataUri%28el%2C%20options%20%7C%7C%20%7B%7D%29%29%0A%20%20%20%20%20%20%2Ethen%28uri%20%3D%3E%20out%24%2Edownload%28name%2C%20uri%2C%20downloadOpts%29%29%3B%0A%20%20%7D%3B%0A%0A%20%20out%24%2EsaveSvgAsPng%20%3D%20%28el%2C%20name%2C%20options%29%20%3D%3E%20%7B%0A%20%20%20%20const%20downloadOpts%20%3D%20downloadOptions%28%29%3B%20%2F%2F%20don%27t%20inline%2C%20can%27t%20be%20async%0A%20%20%20%20return%20requireDomNodePromise%28el%29%0A%20%20%20%20%20%20%2Ethen%28el%20%3D%3E%20out%24%2EsvgAsPngUri%28el%2C%20options%20%7C%7C%20%7B%7D%29%29%0A%20%20%20%20%20%20%2Ethen%28uri%20%3D%3E%20out%24%2Edownload%28name%2C%20uri%2C%20downloadOpts%29%29%3B%0A%20%20%7D%3B%0A%7D%29%28%29%3B%0A"></script>
<script src="data:application/x-javascript,function%20saveSvg%28idd%2C%20name%29%20%7B%0A%20%20%20%20svgEl%20%3D%20document%2EgetElementById%28idd%29%3B%0A%20%20%20%20svgEl%2EsetAttribute%28%22xmlns%22%2C%20%22http%3A%2F%2Fwww%2Ew3%2Eorg%2F2000%2Fsvg%22%29%3B%0A%0A%20%20%20%20var%20rect%20%3D%20document%2EcreateElementNS%28%22http%3A%2F%2Fwww%2Ew3%2Eorg%2F2000%2Fsvg%22%2C%20%27rect%27%29%3B%0A%20%20rect%2EsetAttribute%28%27x%27%2C%20%270%27%29%3B%0A%20%20rect%2EsetAttribute%28%27y%27%2C%20%270%27%29%3B%0A%20%20rect%2EsetAttribute%28%27height%27%2C%20%27100%25%27%29%3B%0A%20%20rect%2EsetAttribute%28%27width%27%2C%20%27100%25%27%29%3B%0A%20%20rect%2EsetAttribute%28%27fill%27%2C%20%22white%22%29%3B%0A%20%20svgEl%2Eprepend%28rect%29%3B%0A%0A%20%20%20%20var%20svgData%20%3D%20svgEl%2EouterHTML%3B%0A%20%20%20%20var%20preface%20%3D%20%27%3C%3Fxml%20version%3D%221%2E0%22%20standalone%3D%22no%22%3F%3E%5Cr%5Cn%27%3B%0A%20%20%20%20var%20svgBlob%20%3D%20new%20Blob%28%5Bpreface%2C%20svgData%5D%2C%20%7Btype%3A%22image%2Fsvg%2Bxml%3Bcharset%3Dutf%2D8%22%7D%29%3B%0A%20%20%20%20var%20svgUrl%20%3D%20URL%2EcreateObjectURL%28svgBlob%29%3B%0A%20%20%20%20var%20downloadLink%20%3D%20document%2EcreateElement%28%22a%22%29%3B%0A%20%20%20%20downloadLink%2Ehref%20%3D%20svgUrl%3B%0A%20%20%20%20downloadLink%2Edownload%20%3D%20name%3B%0A%20%20%20%20document%2Ebody%2EappendChild%28downloadLink%29%3B%0A%20%20%20%20downloadLink%2Eclick%28%29%3B%0A%20%20%20%20document%2Ebody%2EremoveChild%28downloadLink%29%3B%0A%0A%0A%7D%0A"></script>
<script src="data:application/x-javascript,HTMLWidgets%2Ewidget%28%7B%0A%0A%20%20name%3A%20%27chromoMap%27%2C%0A%0A%20%20type%3A%20%27output%27%2C%0A%0A%20%20factory%3A%20function%28el%2Cwidth%2Cheight%29%20%7B%0A%0A%0A%0A%20%20%20%20return%20%7B%0A%0A%20%20%20%20%20%20renderValue%3A%20function%28x%29%20%7B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20adding%20the%20division%20with%20id%20%20required%20to%20render%20plot%0A%20%20%20%20%20%20%20%20d3%2Eselect%28el%29%2Eappend%28%22div%22%29%0A%20%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2C%20x%2Ediv%5Fid%29%3B%0A%20%20%20%20%20%20%20%20d3%2Eselect%28el%29%2Eappend%28%22div%22%29%0A%20%20%20%20%20%20%20%20%20%2Eattr%28%22id%22%2C%22dwopt%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%2F%2Fconsole%2Elog%28el%29%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20TODO%3A%20code%20to%20render%20the%20widget%2C%20e%2Eg%2E%0A%20%20%20%20%20%20%20%20%2F%2F%20%20var%20data%20%3D%20HTMLWidgets%2EdataframeToD3%28x%2EchData%29%3B%0A%20%20%20%20%20%20%20%20var%20a%3D%5B%5D%3B%0A%20%20%20%20%20%20%20%20var%20b%3D%5B%5D%3B%0A%20%20%20%20%20%20%20%20var%20c%3DHTMLWidgets%2EdataframeToD3%28x%2Eloci%5Flinks%29%3B%0A%20%20%20%20%20%20%20%20for%28i%3D0%3Bi%3Cx%2EchData%2Elength%3Bi%2B%2B%29%7B%0A%0A%20%20%20%20%20%20%20%20%20%20a%5Bi%5D%3DHTMLWidgets%2EdataframeToD3%28x%2EchData%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20for%28i%3D0%3Bi%3Cx%2EnLoci%2Elength%3Bi%2B%2B%29%7B%0A%0A%20%20%20%20%20%20%20%20%20%20b%5Bi%5D%3DHTMLWidgets%2EdataframeToD3%28x%2EnLoci%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%0A%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%0A%0A%20%20%20%20%20%20%20%20chromoMap%28a%2C%0A%20%20%20%20%20%20%20%20%20%20b%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Eploidy%5Fn%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Etitle%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Ecnt%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Ech%5Fgap%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Etop%5Fmargin%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Eleft%5Fmargin%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Echr%5Fwidth%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Echr%5Flength%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Echr%5Fcol%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Eheatmap%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Ech%5Fdomain%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Elg%5Fx%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Elg%5Fy%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Eheat%5Fscale%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Elabels%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Ediv%5Fid%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Ew%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Eh%2Cx%2Erng%2Cx%2Eheat%5Fcol%2Cx%2Ean%5Fcol%2Cx%2Ech%5Ftext%2Cx%2Elegend%2Cx%2Eaggregate%5Ffunc%2Cx%2Eplots%2Cx%2Etag%5Ffilter%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Eplot%5Fheight%2Cx%2Eplot%5Fticks%2Cx%2Eplot%5Fcolor%2Cx%2Eplot%5Fy%5Fdomain%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Eref%5Fline%2Cx%2Erefl%5Fpos%2Cx%2Erefl%5Fcolor%2Cx%2Erefl%5Fstroke%5Fw%2Cx%2EtagColor%2C%0A%20%20%20%20%20%20%20%20%20%20x%2ErenderHeat%2Cx%2Etext%5Ffont%5Fsize%2Cx%2Echr%5Fcurve%2Cx%2Etitle%5Ffont%5Fsize%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Elabel%5Ffont%2Cx%2Elabel%5Fangle%2Cx%2Egrid%5Farray%2Cx%2Evertical%5Fgrid%2Cx%2Egrid%5Fcolor%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Eplot%5Ffilter%2Cc%2Cx%2Euniq%5Fcates%2Cx%2Escatter%5Fcol%2Cx%2Egrid%5Ftext%2Cx%2Egrid%5Ftext%5Fsize%2Cx%2Egrid%5Ftext%5Fy%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Escatter%5Fmapping%2Cx%2Escatter%5Flg%5Fx%2Cx%2Escatter%5Flg%5Fy%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Eshow%5Flinks%2Cx%2Eseg%5Fanno%2Cx%2Edirected%5Fedges%2Cx%2Ey%5Fchr%5Fscale%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Elinks%5Fcolors%2Cx%2Elinks%5Flg%5Fx%2Cx%2Elinks%5Flg%5Fy%2Cx%2Elinks%5Fcolor%5Fmaps%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Ewin%5Fscale%2Cx%2Escale%5Fticks%2Cx%2Eexport%5Foptions%2Cx%2Eguides%2Cx%2Eguides%5Fcolor%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Eann%5Fh%2Cx%2Edisplay%5Fchr%2Cx%2Eplot%5Fshift%2Cx%2Eplot%5Flegend%5Flabel%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Ecat%5Flegend%5Flab%2Cx%2Eplot%5Fy%5Flabs%2Cx%2Eplot%5Fy%5Flab%5Fx%2Cx%2Eplot%5Fy%5Flab%5Fy%2C%0A%20%20%20%20%20%20%20%20%20%20x%2Eplot%5Fy%5Flab%5Fsize%2Cx%2Escale%5Fsuffix%2Cx%2Einteractivity%0A%0A%29%3B%0A%0A%0A%0A%20%20%20%20%20%20%7D%2C%0A%0A%20%20%20%20%20%20resize%3A%20function%28width%2Cheigh%29%20%7B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20already%20handled%20by%20main%20function%20that%20render%20plot%0A%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%29%3B%0A"></script>
</head>
<body style="background-color: white;">
<div id="htmlwidget_container">
<div id="htmlwidget-119ba31f63423a811c6b" class="chromoMap html-widget html-fill-item-overflow-hidden html-fill-item" style="width:960px;height:500px;">

</div>
</div>
<script type="application/json" data-for="htmlwidget-119ba31f63423a811c6b">{"x":{"chData":[{"name":["[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]","[telomere_FISH_probe]"],"data":[9.94948748015072,10.0690471470676,10.7050688404575,3.70406567225824,11.6020305782082,10.4106258465238,11.2949638661181,10.6631043674191,9.96311743340896,9.7283572666376,7.64487130593555,11.4118234485562,10.2976117810652,9.83820006513499,5.25245391495974,8.19321845389783,9.04273188649875,10.3584627768907,5.04988017624249,12.1182037223137,9.42273090001461,11.725606778576,10.5213009453458,10.92227909713,9.23519482173987,9.14650845675188,11.3275596686229,1.82483618565606,9.02598163699531,9.17224580889743,8.56648260847962,10.9562142716096,5.66974638460453,11.4356907337216,7.2660158458143,4.02510635492647,7.95362149004667,11.8590874449953,10.0778271609751,2.14287443031905,9.91215034181081,10.5456279619117,9.44244308874265,11.9067855127656,6.72658976016717,9.99722698079667,10.5676271659783,7.59445190510436,8.38020506546231,4.88274841944358,9.26823717967105,11.4235252006809,1.64761438343618,9.52181959624223,8.41990938123552,7.09862533003493,8.86323628618106,9.96897390888139,6.32117292994483,10.790231687679,10.8779891234942,9.48126237998683,10.5812100367043,11.6466003191657,8.59824204128209,9.98609904974067,12.2011920508923,7.56017733375004,11.4845821247906,10.740538292792,3.69239345297417,10.9352621094417,9.40770257321394,12.9002124593056,11.1751197122338,12.1171907377087,10.2514391560545,8.39694592711403,10.0101215103394,9.54440563329059,9.29082925295205,9.90016092165505,10.3516055492935,5.1591973552389,10.6960816083957,9.06806154545252,5.681266609328,9.36518660817409,11.0468614293121,9.63130109734764,11.4929233306766,10.446359977757,8.93353352244489,9.05387858124394,8.91905937548008,9.3328527572956,10.7414581638635,9.84506425026142,0.226747441109548,8.46670054934887,9.27356787987157,1.9672052296534,12.2472701942089,10.3770486755059,10.4938954897613,9.49763893454652,10.9216302104004,9.0918020980369,8.47892128622941,9.96583919250219,10.8388192373054,0.104011423041044,9.53972491732535,12.1885265877297,2.78476596236118,10.9379182995752,9.42886147378757,11.448110118572,12.6096535410917,9.14121087623654,9.96471326607966,10.0430162777688,7.30732915784599,10.3270240385994,11.1561466408104,11.9118961550335,8.85141202646566,4.1702230814735,9.71327551895686,12.5721668691132,9.02722509127647,11.434577508161,11.296133884678,9.78311179155748,9.4743312995349,12.5410874334813,9.01687287845464,8.90015071548505,8.83313576326764,8.04007397341537,1.32138449724141,8.62632541913688,10.833946176283,10.1588559050322,8.0760386772183,11.8839218295371,9.27662700442357,10.7766045365536,13.0664937719764,10.0536755384593,12.5334491291772,9.6523639556131,9.20582419885644,10.1436200869652,10.329029715336,3.92945023598776,4.69396732258444,9.15045938428783,11.0122528833333,9.14918905808155,10.9222257985425,10.0703413287971,9.61947557730207,8.62151669494394,11.6257928839397,9.00221331536185,8.91525643416696,9.124952924689,8.15799611470611,4.10519531216813,0.730646112910965,11.0277159409813,8.63424397653909,10.0890860945723,8.88031141934576,11.1978755390807,11.9440429589625,8.60835813963331,9.18620769946033,10.4816362741167,11.3237850824778,10.0114873902518,8.26794693070168,6.44149794372649,10.6476897564103,7.48220918430644,9.98784553907456,10.4259245663618,9.61758880286583,8.80397499176683,12.6949369325967,11.1612549921378,7.7406061336927,4.16175095213256,8.63451045365951,8.51972401774983,11.8043838926005,11.1814049094739,11.8640290599603,10.7022644328794,10.5363628472642,8.35714622612155,9.50209289612601,11.5780562777098,6.12536787401836,11.2780758991817,0.753758368910179,9.35444758778241,9.50951413289072,6.87471225936224,10.3520920516282,10.9462888864408,9.88388546077329,11.4410370271202,4.74687459378345,6.91860526332692,7.52142773503652,11.5105255882102,11.4213930561885,8.07473353272955,9.12823182154193,11.4248488961903,10.6052017611779,4.93114056171357,10.0477504041284,9.29522695750895,10.3214608293886,10.5604826552394,8.97345031197029,8.17260350910171,11.0210179831467,9.17863575429467,9.55486964641953,5.87043041665802,9.70979201162694,7.59235864699171,10.8172068521557,8.52466281555535,8.25125360013649,0.71564352989239,10.4889259108324,9.7801681430966,12.874585716596,10.9067558519265,8.52338076791684,11.4210301150178,10.3470220717201,8.32444745870925,10.1077401203505,7.9056110242499,10.9578434204521,10.0365382986886,5.73731660602647,10.309331409134,12.1112898445791],"hlink":["http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://","http://"],"cate":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"loci":["chromap-chr1-1-1","chromap-chr1-1-1","chromap-chr1-1-1","chromap-chr1-97-1","chromap-chr1-98-1","chromap-chr1-98-1","chromap-chr1-99-1","chromap-chr1-99-1","chromap-chr1-99-1","chromap-chr1-100-1","chromap-chr1-2-1","chromap-chr1-2-1","chromap-chr1-3-1","chromap-chr1-3-1","chromap-chr1-3-1","chromap-chr2-1-1","chromap-chr2-1-1","chromap-chr2-1-1","chromap-chr2-95-1","chromap-chr2-96-1","chromap-chr2-96-1","chromap-chr2-97-1","chromap-chr2-97-1","chromap-chr2-2-1","chromap-chr2-2-1","chromap-chr3-1-1","chromap-chr3-1-1","chromap-chr3-79-1","chromap-chr3-79-1","chromap-chr3-80-1","chromap-chr3-80-1","chromap-chr3-1-1","chromap-chr3-2-1","chromap-chr4-1-1","chromap-chr4-1-1","chromap-chr4-76-1","chromap-chr4-76-1","chromap-chr5-1-1","chromap-chr5-1-1","chromap-chr5-72-1","chromap-chr5-72-1","chromap-chr5-72-1","chromap-chr5-73-1","chromap-chr5-1-1","chromap-chr5-2-1","chromap-chr6-1-1","chromap-chr6-1-1","chromap-chr6-68-1","chromap-chr6-69-1","chromap-chr6-1-1","chromap-chr7-1-1","chromap-chr7-1-1","chromap-chr7-63-1","chromap-chr7-64-1","chromap-chr7-64-1","chromap-chr7-1-1","chromap-chrX-1-1","chromap-chrX-1-1","chromap-chrX-61-1","chromap-chrX-61-1","chromap-chrX-62-1","chromap-chrX-62-1","chromap-chrX-63-1","chromap-chrX-63-1","chromap-chrX-1-1","chromap-chrX-2-1","chromap-chrX-2-1","chromap-chrX-3-1","chromap-chr8-1-1","chromap-chr8-1-1","chromap-chr8-55-1","chromap-chr8-56-1","chromap-chr8-56-1","chromap-chr8-56-1","chromap-chr8-57-1","chromap-chr8-57-1","chromap-chr8-58-1","chromap-chr8-58-1","chromap-chr8-1-1","chromap-chr8-2-1","chromap-chr8-2-1","chromap-chr8-2-1","chromap-chr8-3-1","chromap-chr8-3-1","chromap-chr9-1-1","chromap-chr9-1-1","chromap-chr9-56-1","chromap-chr9-56-1","chromap-chr11-1-1","chromap-chr11-1-1","chromap-chr11-52-1","chromap-chr11-53-1","chromap-chr11-53-1","chromap-chr11-54-1","chromap-chr11-54-1","chromap-chr11-1-1","chromap-chr11-2-1","chromap-chr11-2-1","chromap-chr11-2-1","chromap-chr10-1-1","chromap-chr10-1-1","chromap-chr10-52-1","chromap-chr10-52-1","chromap-chr10-53-1","chromap-chr10-53-1","chromap-chr10-53-1","chromap-chr10-54-1","chromap-chr10-1-1","chromap-chr10-2-1","chromap-chr10-2-1","chromap-chr10-3-1","chromap-chr10-3-1","chromap-chr12-1-1","chromap-chr12-1-1","chromap-chr12-51-1","chromap-chr12-52-1","chromap-chr12-52-1","chromap-chr12-52-1","chromap-chr12-53-1","chromap-chr12-53-1","chromap-chr12-54-1","chromap-chr12-54-1","chromap-chr12-1-1","chromap-chr12-2-1","chromap-chr12-2-1","chromap-chr12-3-1","chromap-chr12-3-1","chromap-chr12-3-1","chromap-chr13-1-1","chromap-chr13-1-1","chromap-chr13-44-1","chromap-chr13-44-1","chromap-chr13-45-1","chromap-chr13-45-1","chromap-chr13-46-1","chromap-chr13-46-1","chromap-chr13-1-1","chromap-chr13-2-1","chromap-chr13-2-1","chromap-chr13-3-1","chromap-chr13-3-1","chromap-chr14-1-1","chromap-chr14-1-1","chromap-chr14-42-1","chromap-chr14-43-1","chromap-chr14-43-1","chromap-chr14-1-1","chromap-chr15-1-1","chromap-chr15-1-1","chromap-chr15-41-1","chromap-chr15-1-1","chromap-chr15-2-1","chromap-chr15-2-1","chromap-chr15-3-1","chromap-chr15-3-1","chromap-chr15-3-1","chromap-chr15-38-1","chromap-chr15-39-1","chromap-chr15-39-1","chromap-chr15-39-1","chromap-chr15-40-1","chromap-chr15-40-1","chromap-chr16-1-1","chromap-chr16-1-1","chromap-chr16-1-1","chromap-chr16-2-1","chromap-chr16-2-1","chromap-chr16-2-1","chromap-chr16-3-1","chromap-chr16-3-1","chromap-chr16-33-1","chromap-chr16-34-1","chromap-chr16-34-1","chromap-chr16-34-1","chromap-chr16-35-1","chromap-chr16-35-1","chromap-chr16-36-1","chromap-chr16-36-1","chromap-chr17-1-1","chromap-chr17-1-1","chromap-chr17-1-1","chromap-chr17-2-1","chromap-chr17-2-1","chromap-chr17-31-1","chromap-chr17-32-1","chromap-chr17-32-1","chromap-chr17-33-1","chromap-chr17-33-1","chromap-chr18-1-1","chromap-chr18-1-1","chromap-chr18-1-1","chromap-chr18-2-1","chromap-chr18-2-1","chromap-chr18-30-1","chromap-chr18-31-1","chromap-chr18-31-1","chromap-chr18-32-1","chromap-chr18-32-1","chromap-chr20-1-1","chromap-chr20-1-1","chromap-chr20-1-1","chromap-chr20-2-1","chromap-chr20-2-1","chromap-chr20-3-1","chromap-chr20-24-1","chromap-chr20-24-1","chromap-chr20-3-1","chromap-chr20-25-1","chromap-chr20-25-1","chromap-chr20-26-1","chromap-chr20-26-1","chromap-chr19-1-1","chromap-chr19-1-1","chromap-chr19-1-1","chromap-chr19-2-1","chromap-chr19-23-1","chromap-chr19-23-1","chromap-chr19-24-1","chromap-chrY-1-1","chromap-chrY-1-1","chromap-chrY-1-1","chromap-chrY-2-1","chromap-chrY-2-1","chromap-chrY-20-1","chromap-chrY-3-1","chromap-chrY-21-1","chromap-chrY-21-1","chromap-chrY-21-1","chromap-chrY-22-1","chromap-chrY-22-1","chromap-chrY-23-1","chromap-chrY-23-1","chromap-chrY-3-1","chromap-chrY-3-1","chromap-chr22-1-1","chromap-chr22-1-1","chromap-chr22-1-1","chromap-chr22-2-1","chromap-chr22-2-1","chromap-chr22-17-1","chromap-chr22-17-1","chromap-chr22-18-1","chromap-chr22-18-1","chromap-chr22-19-1","chromap-chr22-19-1","chromap-chr22-19-1","chromap-chr22-20-1","chromap-chr22-2-1","chromap-chr22-3-1","chromap-chr22-3-1","chromap-chr21-1-1","chromap-chr21-1-1","chromap-chr21-1-1","chromap-chr21-18-1","chromap-chr21-19-1"],"loci_start":[1,1,1,238998167,241487731,241487731,243977295,243977295,243977295,246466859,2489566,2489566,4979130,4979130,4979130,1,1,1,234703009,237199849,237199849,239696690,239696690,2496842,2496842,1,1,193338172,193338172,195816866,195816866,1,2478696,1,1,187711733,187711733,1,1,176564610,176564610,176564610,179051435,1,2486827,1,1,165855083,168330532,1,1,1,154366413,156856194,156856194,1,1,1,148610378,148610378,151087217,151087217,153564057,153564057,1,2476841,2476841,4953681,1,1,135129076,137631467,137631467,137631467,140133857,140133857,142636247,142636247,1,2502392,2502392,2502392,5004782,5004782,1,1,135923384,135923384,1,1,127581811,130083415,130083415,132585019,132585019,1,2501606,2501606,2501606,1,1,126364233,126364233,128841963,128841963,128841963,131319693,1,2477732,2477732,4955462,4955462,1,1,123403065,125871127,125871127,125871127,128339188,128339188,130807249,130807249,1,2468063,2468063,4936124,4936124,4936124,1,1,106905786,106905786,109391967,109391967,111878148,111878148,1,2486183,2486183,4972364,4972364,1,1,102064942,104554331,104554331,1,1,1,99503601,1,2487591,2487591,4975181,4975181,4975181,92040831,94528421,94528421,94528421,97016011,97016011,1,1,1,2509400,2509400,2509400,5018798,5018798,80300753,82810151,82810151,82810151,85319550,85319550,87828948,87828948,1,1,1,2522954,2522954,75688584,78211537,78211537,80734490,80734490,1,1,1,2511667,2511667,72838291,75349956,75349956,77861621,77861621,1,1,1,2478623,2478623,4957245,57008303,57008303,4957245,59486925,59486925,61965547,61965547,1,1,1,2442402,53732816,53732816,56175217,1,1,1,2488150,2488150,47274823,4976298,49762971,49762971,49762971,52251120,52251120,54739268,54739268,4976298,4976298,1,1,1,2540925,2540925,40654776,40654776,43195699,43195699,45736623,45736623,45736623,48277546,2540925,5081848,5081848,1,1,1,41793144,44251564],"loci_end":[2489565,2489565,2489565,241487730,243977294,243977294,246466858,246466858,246466858,248956423,4979129,4979129,7468693,7468693,7468693,2496841,2496841,2496841,237199848,239696689,239696689,242193529,242193529,4993682,4993682,2478695,2478695,195816865,195816865,198295559,198295559,2478695,4957389,2502824,2502824,190214556,190214556,2486826,2486826,179051434,179051434,179051434,181538259,2486826,4973651,2475449,2475449,168330531,170805979,2475449,2489781,2489781,156856193,159345973,159345973,2489781,2476840,2476840,151087216,151087216,153564056,153564056,156040895,156040895,2476840,4953680,4953680,7430519,2502391,2502391,137631466,140133856,140133856,140133856,142636246,142636246,145138637,145138637,2502391,5004781,5004781,5004781,7507171,7507171,2471335,2471335,138394717,138394717,2501605,2501605,130083414,132585018,132585018,135086622,135086622,2501605,5003209,5003209,5003209,2477731,2477731,128841962,128841962,131319692,131319692,131319692,133797422,2477731,4955461,4955461,7433191,7433191,2468062,2468062,125871126,128339187,128339187,128339187,130807248,130807248,133275310,133275310,2468062,4936123,4936123,7404184,7404184,7404184,2486182,2486182,109391966,109391966,111878147,111878147,114364328,114364328,2486182,4972363,4972363,7458544,7458544,2489389,2489389,104554330,107043718,107043718,2489389,2487590,2487590,101991189,2487590,4975180,4975180,7462770,7462770,7462770,94528420,97016010,97016010,97016010,99503600,99503600,2509399,2509399,2509399,5018797,5018797,5018797,7528196,7528196,82810150,85319549,85319549,85319549,87828947,87828947,90338345,90338345,2522953,2522953,2522953,5045906,5045906,78211536,80734489,80734489,83257441,83257441,2511666,2511666,2511666,5023331,5023331,75349955,77861620,77861620,80373285,80373285,2478622,2478622,2478622,4957244,4957244,7435866,59486924,59486924,7435866,61965546,61965546,64444167,64444167,2442401,2442401,2442401,4884802,56175216,56175216,58617616,2488149,2488149,2488149,4976297,4976297,49762970,7464446,52251119,52251119,52251119,54739267,54739267,57227415,57227415,7464446,7464446,2540924,2540924,2540924,5081847,5081847,43195698,43195698,45736622,45736622,48277545,48277545,48277545,50818468,5081847,7622771,7622771,2458421,2458421,2458421,44251563,46709983],"label":["chromap-Lchr1-1-1","chromap-Lchr1-1-1","chromap-Lchr1-1-1","chromap-Lchr1-97-1","chromap-Lchr1-98-1","chromap-Lchr1-98-1","chromap-Lchr1-99-1","chromap-Lchr1-99-1","chromap-Lchr1-99-1","chromap-Lchr1-100-1","chromap-Lchr1-2-1","chromap-Lchr1-2-1","chromap-Lchr1-3-1","chromap-Lchr1-3-1","chromap-Lchr1-3-1","chromap-Lchr2-1-1","chromap-Lchr2-1-1","chromap-Lchr2-1-1","chromap-Lchr2-95-1","chromap-Lchr2-96-1","chromap-Lchr2-96-1","chromap-Lchr2-97-1","chromap-Lchr2-97-1","chromap-Lchr2-2-1","chromap-Lchr2-2-1","chromap-Lchr3-1-1","chromap-Lchr3-1-1","chromap-Lchr3-79-1","chromap-Lchr3-79-1","chromap-Lchr3-80-1","chromap-Lchr3-80-1","chromap-Lchr3-1-1","chromap-Lchr3-2-1","chromap-Lchr4-1-1","chromap-Lchr4-1-1","chromap-Lchr4-76-1","chromap-Lchr4-76-1","chromap-Lchr5-1-1","chromap-Lchr5-1-1","chromap-Lchr5-72-1","chromap-Lchr5-72-1","chromap-Lchr5-72-1","chromap-Lchr5-73-1","chromap-Lchr5-1-1","chromap-Lchr5-2-1","chromap-Lchr6-1-1","chromap-Lchr6-1-1","chromap-Lchr6-68-1","chromap-Lchr6-69-1","chromap-Lchr6-1-1","chromap-Lchr7-1-1","chromap-Lchr7-1-1","chromap-Lchr7-63-1","chromap-Lchr7-64-1","chromap-Lchr7-64-1","chromap-Lchr7-1-1","chromap-LchrX-1-1","chromap-LchrX-1-1","chromap-LchrX-61-1","chromap-LchrX-61-1","chromap-LchrX-62-1","chromap-LchrX-62-1","chromap-LchrX-63-1","chromap-LchrX-63-1","chromap-LchrX-1-1","chromap-LchrX-2-1","chromap-LchrX-2-1","chromap-LchrX-3-1","chromap-Lchr8-1-1","chromap-Lchr8-1-1","chromap-Lchr8-55-1","chromap-Lchr8-56-1","chromap-Lchr8-56-1","chromap-Lchr8-56-1","chromap-Lchr8-57-1","chromap-Lchr8-57-1","chromap-Lchr8-58-1","chromap-Lchr8-58-1","chromap-Lchr8-1-1","chromap-Lchr8-2-1","chromap-Lchr8-2-1","chromap-Lchr8-2-1","chromap-Lchr8-3-1","chromap-Lchr8-3-1","chromap-Lchr9-1-1","chromap-Lchr9-1-1","chromap-Lchr9-56-1","chromap-Lchr9-56-1","chromap-Lchr11-1-1","chromap-Lchr11-1-1","chromap-Lchr11-52-1","chromap-Lchr11-53-1","chromap-Lchr11-53-1","chromap-Lchr11-54-1","chromap-Lchr11-54-1","chromap-Lchr11-1-1","chromap-Lchr11-2-1","chromap-Lchr11-2-1","chromap-Lchr11-2-1","chromap-Lchr10-1-1","chromap-Lchr10-1-1","chromap-Lchr10-52-1","chromap-Lchr10-52-1","chromap-Lchr10-53-1","chromap-Lchr10-53-1","chromap-Lchr10-53-1","chromap-Lchr10-54-1","chromap-Lchr10-1-1","chromap-Lchr10-2-1","chromap-Lchr10-2-1","chromap-Lchr10-3-1","chromap-Lchr10-3-1","chromap-Lchr12-1-1","chromap-Lchr12-1-1","chromap-Lchr12-51-1","chromap-Lchr12-52-1","chromap-Lchr12-52-1","chromap-Lchr12-52-1","chromap-Lchr12-53-1","chromap-Lchr12-53-1","chromap-Lchr12-54-1","chromap-Lchr12-54-1","chromap-Lchr12-1-1","chromap-Lchr12-2-1","chromap-Lchr12-2-1","chromap-Lchr12-3-1","chromap-Lchr12-3-1","chromap-Lchr12-3-1","chromap-Lchr13-1-1","chromap-Lchr13-1-1","chromap-Lchr13-44-1","chromap-Lchr13-44-1","chromap-Lchr13-45-1","chromap-Lchr13-45-1","chromap-Lchr13-46-1","chromap-Lchr13-46-1","chromap-Lchr13-1-1","chromap-Lchr13-2-1","chromap-Lchr13-2-1","chromap-Lchr13-3-1","chromap-Lchr13-3-1","chromap-Lchr14-1-1","chromap-Lchr14-1-1","chromap-Lchr14-42-1","chromap-Lchr14-43-1","chromap-Lchr14-43-1","chromap-Lchr14-1-1","chromap-Lchr15-1-1","chromap-Lchr15-1-1","chromap-Lchr15-41-1","chromap-Lchr15-1-1","chromap-Lchr15-2-1","chromap-Lchr15-2-1","chromap-Lchr15-3-1","chromap-Lchr15-3-1","chromap-Lchr15-3-1","chromap-Lchr15-38-1","chromap-Lchr15-39-1","chromap-Lchr15-39-1","chromap-Lchr15-39-1","chromap-Lchr15-40-1","chromap-Lchr15-40-1","chromap-Lchr16-1-1","chromap-Lchr16-1-1","chromap-Lchr16-1-1","chromap-Lchr16-2-1","chromap-Lchr16-2-1","chromap-Lchr16-2-1","chromap-Lchr16-3-1","chromap-Lchr16-3-1","chromap-Lchr16-33-1","chromap-Lchr16-34-1","chromap-Lchr16-34-1","chromap-Lchr16-34-1","chromap-Lchr16-35-1","chromap-Lchr16-35-1","chromap-Lchr16-36-1","chromap-Lchr16-36-1","chromap-Lchr17-1-1","chromap-Lchr17-1-1","chromap-Lchr17-1-1","chromap-Lchr17-2-1","chromap-Lchr17-2-1","chromap-Lchr17-31-1","chromap-Lchr17-32-1","chromap-Lchr17-32-1","chromap-Lchr17-33-1","chromap-Lchr17-33-1","chromap-Lchr18-1-1","chromap-Lchr18-1-1","chromap-Lchr18-1-1","chromap-Lchr18-2-1","chromap-Lchr18-2-1","chromap-Lchr18-30-1","chromap-Lchr18-31-1","chromap-Lchr18-31-1","chromap-Lchr18-32-1","chromap-Lchr18-32-1","chromap-Lchr20-1-1","chromap-Lchr20-1-1","chromap-Lchr20-1-1","chromap-Lchr20-2-1","chromap-Lchr20-2-1","chromap-Lchr20-3-1","chromap-Lchr20-24-1","chromap-Lchr20-24-1","chromap-Lchr20-3-1","chromap-Lchr20-25-1","chromap-Lchr20-25-1","chromap-Lchr20-26-1","chromap-Lchr20-26-1","chromap-Lchr19-1-1","chromap-Lchr19-1-1","chromap-Lchr19-1-1","chromap-Lchr19-2-1","chromap-Lchr19-23-1","chromap-Lchr19-23-1","chromap-Lchr19-24-1","chromap-LchrY-1-1","chromap-LchrY-1-1","chromap-LchrY-1-1","chromap-LchrY-2-1","chromap-LchrY-2-1","chromap-LchrY-20-1","chromap-LchrY-3-1","chromap-LchrY-21-1","chromap-LchrY-21-1","chromap-LchrY-21-1","chromap-LchrY-22-1","chromap-LchrY-22-1","chromap-LchrY-23-1","chromap-LchrY-23-1","chromap-LchrY-3-1","chromap-LchrY-3-1","chromap-Lchr22-1-1","chromap-Lchr22-1-1","chromap-Lchr22-1-1","chromap-Lchr22-2-1","chromap-Lchr22-2-1","chromap-Lchr22-17-1","chromap-Lchr22-17-1","chromap-Lchr22-18-1","chromap-Lchr22-18-1","chromap-Lchr22-19-1","chromap-Lchr22-19-1","chromap-Lchr22-19-1","chromap-Lchr22-20-1","chromap-Lchr22-2-1","chromap-Lchr22-3-1","chromap-Lchr22-3-1","chromap-Lchr21-1-1","chromap-Lchr21-1-1","chromap-Lchr21-1-1","chromap-Lchr21-18-1","chromap-Lchr21-19-1"]}],"nLoci":[{"name":["chr1","chr2","chr3","chr4","chr5","chr6","chr7","chrX","chr8","chr9","chr11","chr10","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr20","chr19","chrY","chr22","chr21"],"start":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"end":[248956422,242193529,198295559,190214555,181538259,170805979,159345973,156040895,145138636,138394717,135086622,133797422,133275309,114364328,107043718,101991189,90338345,83257441,80373285,64444167,58617616,57227415,50818468,46709983],"ch_average":[1.00000000401677,0.972835036859724,0.796507108366568,0.764047596105183,0.729196934430544,0.686087863546207,0.640055686693857,0.626779957605512,0.582988120639797,0.555899367624666,0.54261151994951,0.537433103603301,0.535335897201061,0.459374887944746,0.429969701404086,0.409674868357784,0.362868106141356,0.334425762812521,0.322840779431031,0.258857219834471,0.23545332056328,0.229869206707466,0.204125958253553,0.187623130234508],"n":[100,97,80,76,73,69,64,63,58,56,54,54,54,46,43,41,36,33,32,26,24,23,20,19],"seq_len":[248956422,242193529,198295559,190214555,181538259,170805979,159345973,156040895,145138636,138394717,135086622,133797422,133275309,114364328,107043718,101991189,90338345,83257441,80373285,64444167,58617616,57227415,50818468,46709983]}],"ploidy_n":1,"title":null,"cnt":false,"ch_gap":5,"top_margin":25,"left_margin":50,"chr_width":15,"chr_length":4,"chr_col":["black",""],"heatmap":false,"ch_domain":["1","2489566","4979130","7468694","9958258","12447823","14937387","17426951","19916515","22406079","24895644","27385208","29874772","32364336","34853901","37343465","39833029","42322593","44812157","47301722","49791286","52280850","54770414","57259979","59749543","62239107","64728671","67218235","69707800","72197364","74686928","77176492","79666057","82155621","84645185","87134749","89624313","92113878","94603442","97093006","99582570","102072135","104561699","107051263","109540827","112030391","114519956","117009520","119499084","121988648","124478213","126967777","129457341","131946905","134436469","136926034","139415598","141905162","144394726","146884290","149373855","151863419","154352983","156842547","159332112","161821676","164311240","166800804","169290368","171779933","174269497","176759061","179248625","181738190","184227754","186717318","189206882","191696446","194186011","196675575","199165139","201654703","204144268","206633832","209123396","211612960","214102524","216592089","219081653","221571217","224060781","226550346","229039910","231529474","234019038","236508602","238998167","241487731","243977295","246466859","248956423"],"lg_x":0,"lg_y":0,"heat_scale":"linear","labels":false,"div_id":"chromap","w":550,"h":null,"rng":0,"heat_col":[],"an_col":["#10B85F",""],"ch_text":[true,true],"legend":[false,false],"aggregate_func":["avg",""],"plots":["none",""],"tag_filter":[["none","0"]],"plot_height":[30,0],"plot_ticks":[4,0],"plot_color":["blue",""],"plot_y_domain":[[0,0]],"ref_line":[false,true],"refl_pos":[0,0],"refl_color":["grey",""],"refl_stroke_w":[2,0],"tagColor":["red",""],"renderHeat":[true,true],"text_font_size":[10,0],"chr_curve":5,"title_font_size":12,"label_font":9,"label_angle":-90,"vertical_grid":false,"grid_array":[0,5000,10000],"grid_color":"grey","plot_filter":[["none","0"]],"loci_links":{"src_loci":["none"],"targ_loci":["none"]},"uniq_cates":0,"scatter_col":"#FFC0CB","grid_text":null,"grid_text_size":12,"grid_text_y":20,"scatter_mapping":false,"scatter_lg_x":0,"scatter_lg_y":0,"show_links":false,"seg_anno":false,"directed_edges":false,"y_chr_scale":0,"links_colors":null,"links_lg_x":0,"links_lg_y":0,"links_color_maps":false,"win_scale":100,"scale_ticks":5,"export_options":false,"guides":false,"guides_color":"lightgrey","ann_h":1,"display_chr":[true,false],"plot_shift":[1,0],"plot_legend_label":["",""],"cat_legend_lab":"","plot_y_labs":["",""],"plot_y_lab_x":10,"plot_y_lab_y":0,"plot_y_lab_size":15,"scale_suffix":"bp","interactivity":true},"evals":[],"jsHooks":[]}</script>
<script type="application/htmlwidget-sizing" data-for="htmlwidget-119ba31f63423a811c6b">{"viewer":{"width":450,"height":350,"padding":10,"fill":true},"browser":{"width":960,"height":500,"padding":10,"fill":true}}</script>
</body>
</html>
